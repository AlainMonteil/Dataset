<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T11:22+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>Quantum cryptography is arguably the fastest growing area in quantum information science. Novel theoretical protocols are designed on a regular basis, security proofs are constantly improving, and experiments are gradually moving from proof-of-principle lab demonstrations to in-field implementations and technological prototypes. In this review, we provide both a general introduction and a state of the art description of the recent advances in the field, both theoretically and experimentally. We start by reviewing protocols of quantum key distribution based on discrete variable systems. Next we consider aspects of device independence, satellite challenges, and high rate protocols based on continuous variable systems. We will then discuss the ultimate limits of point-to-point private communications and how quantum repeaters and networks may overcome these restrictions. Finally, we will discuss some aspects of quantum cryptography beyond standard quantum key distribution, including quantum data locking and quantum digital signatures.</p>
        <p>1. E91 protocol 2. BBM92 protocol E. Two-way quantum communication 1. Ping pong protocol 2. Two-way QKD protocols 3. Intercept-resend strategy 4. Non-orthogonal attack strategies 5. Further considerations IV. Device-independent QKD A. Introduction B. The link between Bell violation and unpredictability C. Quantitative bounds D. Protocols for DI-QKD 1. The setup for DI-QKD 2. The spot-checking CHSH QKD protocol E. Historical remarks F. Putting DI-QKD protocols into practice G. Measurement device independence (MDI) H. Twin-field QKD V. Experimental DV-QKD protocols A. Detector technology 25 B. Decoy state BB84 25 C. Differential phase shift QKD 26 D. Coherent one-way 27 E. DV MDI-QKD 27 F. High-dimensional QKD 29 G. Photonic integrated circuits 30 VI. Satellite quantum communications 32 A. Introduction 32 B. The satellite opportunity 33 C. Type of orbits and applications 33 1. Space-link losses 33 2. Low-Earth-orbit (LEO) 34 3. Higher Earth orbits (MEO and GEO) 35 4. Night and day use of the link 35 D. Beyond satellite QKD 35 1. Other protocols 35 2. Tests of quantum mechanics in space 36 E. Concluding remarks 37 VII. Continuous-variable QKD 37 A. Brief introduction to CV systems 37 B. Historical outline 37 C. One-way CV-QKD protocols 38 D. Computation of the key rate 38 E. Ideal performances in a thermal-loss channel 39 F. Finite-size aspects 40 G. Two-way CV-QKD protocols 40 1. Asymptotic security of two-way CV-QKD 41 2. Asymptotic key rates 41 3. Further considerations 42 H. Thermal-state QKD 42 1. One-way thermal communication 42 2. Two-way thermal communication 43 I. Unidimensional protocol 43 J. CV-QKD with discrete modulation 44 K. CV MDI-QKD 44 1. Basic concepts and protocol 44 2. Security and key rates 44 3. Variants of CV MDI-QKD 46 4. Multipartite CV MDI-QKD 46 VIII. Experimental CV-QKD 46 A. Introduction 46 B. Point-to-point CV-QKD 46 1. Coherent state encoding 47 2. Detection 47 3. Post-processing 50 C. Implementation of advanced CV-QKD 50 1. Squeezed-state protocols 51 2. CV MDI-QKD 51 IX. Theoretical security aspects 51 A. Finite-size analysis in QKD 51 B. Finite-size statistical analysis 52 1. Privacy amplification 52 2. Guaranteeing large smooth min-entropy 52 C. Uncertainty principle versus entanglement: an intuitive approach to QKD security 53 D. CV protocols 53 E. Extensions and Outlook 54 X. Quantum hacking 54 A. Hacking DV-QKD protocols 55 1. PNS and intensity-based attacks 55 2. Trojan horse attacks 56 3. Backflash attacks 57 4. Faked states and detector efficiency mismatch 57 B. Hacking CV-QKD protocols 58 1. Attacks on the local oscillator 59 2. Saturation attacks on detectors 59 3. Trojan horse attacks 60 C. General considerations 60 D. Device-independence as a solution? 60 XI. Limits of point-to-point QKD 61 A. Overview 61 B. Adaptive protocols and two-way assisted capacities 62 C. General weak-converse upper bound 64 D. LOCC simulation of quantum channels 64 E. Teleportation covariance and simulability 65 F. Strong and uniform convergence 65 G. Stretching of an adaptive protocol 66 H. Single-letter upper bound for two-way assisted capacities 66 I. Bounds for teleportation-covariant channels 67 J. Capacities for distillable channels 68 K. Open problems 69 XII. Repeater chains and quantum networks 69 A. Overview 69 B. Ideal chains of quantum repeaters 70 C. Quantum communication networks 70 D. Practical designs for quantum repeaters 71 1. Probabilistic quantum repeaters 72 2. Deterministic quantum repeaters 73 3. Memory-less quantum repeaters 74 XIII. QKD against a bounded quantum memory 75 A. Introduction 75 B. Entropic uncertainty relations 75 C. Bounded quantum storage model 76 D. Quantum data locking 76 E. Quantum data locking for communication: the quantum enigma machine 77 F. Practical quantum data locking 78 G. Experimental demonstrations 78 XIV. Quantum random number generation 78 A. Introduction 78 B. Protocols for DI-QRE 80 1. The setup for DI-QRE 80 2. The spot-checking CHSH QRE protocol 80 C. Historical remarks and further reading 81 D. Implementations 81 E. Randomness amplification 81 XV. Quantum Digital Signatures 82 A. Introduction 82 B. Definitions and security properties 82 C. What is a quantum digital signature scheme and why it is useful? 83 D. The Lamport one-time signature scheme 84 E. The Gottesman-Chuang QDS 84 1. The protocol 84 2. Security intuition 85 3. Remarks 85 4. Practical limitations of GC-QDS 86 F. Practical QDS: Lifting the limitations 86 1. Simplifying state comparison 86 2. No quantum memory requirement 87 3. QDS from QKD technology 87 4. Insecure quantum channels 88 G. A generic modern QDS protocol 88 1. Description 88 2. Security intuition and performance 89 H. Extending QDS: Multiple parties, longer messages, and MDI 89 I. Experimental QDS realizations 90 1. Proof-of-principle 90 2. Kilometer-range and fully-secure QDS 90 J. Classical unconditional secure signatures 90 K. Summary and outlook 91 XVI. Conclusions 91 Acknowledgments 92 A. Formulas for Gaussian states 92 1. Symplectic action and its computation 93 2. Fidelity between arbitrary Gaussian states 94 3. Entropic quantities 95 References 96</p>
        <p>Quantum information [1][2][3][4][5][6][7][8][9][10][11] is the core science behind the so-called second quantum revolution [12,13], or quantum 2.0. This is the rapid development of new disrupting technologies that are based on the most powerful features and resources of quantum mechanics, such as quantum entanglement [14], teleportation [15][16][17][18], and the no-cloning theorem [19,20]. In this context, quantum computing [1] has recently gained a lot of momentum, also thanks to the involvement of multinational corporations in competition to develop the first large quantum computer. In particular, superconducting chips based on Josephson junctions [21] are rapidly scaling up their number of qubits and soon may start to factorize non-trivial integers by using Shor's algorithm [22,23]. The threat for the Rivest-Shamir-Adleman (RSA) protocol [24] and the other public key cryptosystems not only comes from quantum computing but also from potential advances in number theory, where an efficient factorization algorithm might be found for classical Turing machines (e.g., already in 2004 the test of primality has become polynomial, thanks to the Agrawal-Kayal-Saxena algorithm [25]).</p>
        <p>An important point to understand is that the fragility of current classical cryptosystems not only is a potential threat for the present, but a more serious and realistic threat for the future. Today, eavesdroppers may intercept cryptograms that they are not able to decrypt. However, they may store these encrypted communications and wait for their decryption once a sufficiently large quantum computer is technologically available (or a new classical algorithm is discovered). This means that the confidentiality of messages may have a very limited lifespan. Following Michele Mosca [26], we may write a simple inequality. Let us call x the security shelf-life which is the length of time (in years) we need the classical cryptographic keys to be secure. Then, let us call y the migration time which is the time (in years) needed to adapt the current classical infrastructure with quantumsecure encryption. Finally, let us call z the collapse time which is the time (in years) for a large quantum computer to be built. If x + y &gt; z then "worry" [26].</p>
        <p>It is therefore clear that suitably countermeasures are necessary. One approach is known as post-quantum cryptography. This is the development of novel classical cryptosystems which are robust to factorization and other quantum algorithms. This is certainly one option but it does not completely solve the problem. The point is that there may be undiscovered quantum algorithms (or undiscovered classical ones) that might easily break the security of the new cryptosystems. In other words, postquantum cryptography is likely to offer only a partial and temporary solution to the problem. By contrast, quantum key distribution (QKD) offers the ultimate solution: restoring security and confidentiality by resorting to unbreakable principles of nature, such as the uncertainty principle or the monogamy of entanglement [27][28][29][30].</p>
        <p>Even though QKD offers the ultimate solution to the security problem, its ideal implementation is hard to implement in practice and there are a number of open problems to be addressed. One the one side, fully-device independent QKD protocols [31,32] (discussed in Section IV) provide the highest level of quantum security but they are quite demanding to realize and are characterized by extremely low secret key rates. On the other hand, more practical QKD protocols assume some level of trust in their devices, an assumption that allows them to achieve reasonable rates, but this also opens the possibility of dangerous side-channel attacks.</p>
        <p>Besides a trade-off between security and rate, there is also another important one which is between rate and distance. Today, we know that there is a fundamental limit which restricts any point to point implementation of QKD. Given a lossy link with transmissivity η, two parties cannot distribute more than the secret key capacity of the channel, which is -log 2 (1η) [33], i.e., a scaling of 1.44η secret bits per channel use at long distance. Ideal implementations of QKD protocols based on continuous-variable systems [7,9] and Gaussian states [6] may approach this capacity [34], while those based on discrete variables falls below by additional factors. In order to overcome this limit and enable long-distance high-rate implementations of QKD, we need the develop quantum repeaters [35][36][37] and quantum networks [38]. In this way, we may achieve better long-distance scalings and further boost the rates by resorting to more complex routing strategies. The study of quantum repeaters and secure QKD networks is one of the hottest topics today [39][40][41][42][43][44][45][46][47][48].</p>
        <p>The present review aims at providing an overview of the most important and most recent advances in the field of quantum cryptography, both theoretically and experimentally. After a brief introduction of the general notions, we will review the main QKD protocols based on discrete-and continuous-variable systems. We will consider standard QKD, device-independent and measurement-device independent QKD. We will discuss the various levels of security for the main communication channel, from asymptotic security proofs to analyzes accounting for finite-size effects and composability aspects. We will also briefly review quantum hacking and side-channel attacks. Then, we will present the most recent progress in the exploration of the ultimate limits of QKD. In particular, we will discuss the secret key capacities associated with the most important models of quantum channels over which we may implement pointto-point QKD protocols, and their extension to quantum repeaters and networks. Practical aspects of quantum repeaters will then be thoroughly discussed. Finally, we will treat topics beyond QKD, including quantum data locking, quantum random number generators, and quantum digital signatures.</p>
        <p>A. Generic aspects of a QKD protocol</p>
        <p>In our review we consider both discrete-variable systems, such as qubits or other quantum systems with finite-dimensional Hilbert space, and continuous-variable systems, such as bosonic modes of the electromagnetic field which are described by an infinite-dimensional Hilbert space. There a number of reviews and books on these two general areas (e.g., see Refs. [1,6]). Some of the concepts are repeated in this review but we generally assume basic knowledge of these systems. Here we mention some general aspects that apply to both types of systems.</p>
        <p>A generic "prepare and measure" QKD protocol can be divided in two main steps: quantum communication followed by classical postprocessing. During quantum communication the sender (Alice) encodes instances of a random classical variable α into non-orthogonal quantum states. These states are sent over a quantum channel (optical fiber, free-space link) controlled by the eavesdropper (Eve), who tries to steal the encoded information. The linearity of quantum mechanics forbids to perform perfect cloning [19,20], so that Eve can only get partial information while disturbing the quantum signals. At the output of the communication channel, the receiver (Bob) measures the incoming signals and obtains a random classical variable β. After a number of uses of the channel, Alice and Bob share raw data described by two correlated variables α and β.</p>
        <p>The remote parties use part of the raw data to estimate the parameters of the channel, such as its transmissivity and noise. This stage of parameter estimation is important in order to evaluate the amount of post-processing to extract a private shared key from the remaining data. Depending on this information, they in fact perform a stage of error correction, which allows them to detect and eliminate errors, followed by a stage of privacy amplification that allows them to reduce Eve's stolen information to a negligible amount. The final result is the secret key.</p>
        <p>Depending on which variable is guessed, we have direct or reverse reconciliation. In direct reconciliation, it is Bob that post-process its outcomes in order to infer Alice's encodings. This procedure is usually assisted by means of forward CC from Alice to Bob. By contrast, in reverse reconciliation, it is Alice who post-process her encoding variable in order to infer Bob's outcomes. This procedure is usually assisted by a final round of backward CC from Bob to Alice. Of course, one may more generally consider two-way procedures where the extraction of the key is helped by forward and feedback CCs, which may be even interleaved with the various communication rounds of the protocol.</p>
        <p>Let us remark that there may also be an additional post-processing routine, called sifting, where the remote parties communicate in order to agree instances while discard others, depending on the measurement bases they have independently chosen. For instance this happens in typical DV protocols, where the Z-basis is randomly switched with the X-basis, or in CV protocols where the homodyne detection is switched between the q and the p quadrature.</p>
        <p>Sometimes QKD protocols are formulated in entanglement-based representation.</p>
        <p>This means that Alice' preparation of the input ensemble of states is replaced by an entangled state Ψ AB part of which is measured by Alice. The measurement on part A has the effect to conditionally prepare a state on part B. The outcome of the measurement is one-to-one with the classical variable encoded in the prepared states. This representation is particularly useful for the study of QKD protocols, so that their prepare and measure formulation is replaced by an entanglement-based formulation for assessing the security and deriving the secret key rate.</p>
        <p>The asymptotic security analysis is based on the assumption that the parties exchange a number n ≫ 1 (ideally infinite) of signals. The attacks can then be divided in three classes of increasing power: Individual, collective, and general-coherent. If the attack is individual, Eve uses a fresh ancilla to interact with each transmitted signal and she performs individual measurements on each output ancillary systems. The individual measurements can be done run-by-run or delayed at the end of the protocol, so that Eve may optimize over Alice and Bob's CC (also known as delayed-choice strategy). In the presence of an individual attacks, we have three classical variables for Alice, Bob and Eve, say α, β and γ. The asymptotic key rate is then given by the difference of the mutual information [49] I among the various parties according to Csiszar and Korner's classical theorem [50]. In direct reconciliation (DR), we have the key rate</p>
        <p>where I(α : β) := H(α) -H(α|β) with H being the Shannon entropy and H(|) its conditional version. In reverse reconciliation (RR), we have instead</p>
        <p>If the attack is collective then Eve still uses a fresh ancilla for each signal sent but now her output ancillary systems are all stored in a quantum memory which is collectively measured at the end of the protocol after Alice and Bob's CCs. In this case, we may compute a lower bound to the key rate by replacing Eve's mutual information with Eve's Holevo information on the relevant variable. In direct reconciliation, one considers Eve's ensemble of output states conditioned to Alice's variable α, i.e., {ρ E|α , P (α)} where P (α) is the probability of the encoding α. Consider then Eve's average state ρ E := dαP (α)ρ E|α . Eve's Holevo information on α is equal to</p>
        <p>where S(ρ) := -Tr(ρlog 2 ρ) is the von Neumann entropy.</p>
        <p>In reverse reconciliation, Eve's Holevo information on β is given by</p>
        <p>where ρ E|β is Eve's output state conditioned to the outcome β with probability P (β). Thus, we may write the two key rates [51] R DR := I(α : β) -I(α : E), (5) R RR := I(α : β) -I(β : E).</p>
        <p>In a general-coherent attack, Eve's ancillae and the signal systems are collectively subject to a joint unitary interaction. The ancillary output is then stored in Eve's quantum memory for later detection after the parties' CCs. In the asymptotic scenario, it has been proved [52] that this attack can be reduced to a collective one by running a random symmetrization routine which exploits the quantum de Finetti theorem [52][53][54]. By means of random permutations, one can in fact transform a general quantum state of n systems into a tensor product ρ ⊗n , which is the structure coming from the identical and independent interactions of a collective attack.</p>
        <p>Finite-size effects come into place when the number of signal exchanged n is not so large to be considered to be infinite (see IX for more details). If we assume that the parties can only exchange a finite number of signals, them the key rate must be suitably modified and takes the form</p>
        <p>Here ξ accounts for non-ideal reconciliation efficiency of classical protocols of error correction and privacy amplification, while ∆(n, ǫ) represents the penalty to pay for using the Holevo quantity I E = I(α : E) or I(β : E) in the non-asymptotic context. An important point is the computation of ∆(n, ǫ) which is function of the number of signals exchanged n, and of composite ǫ-parameter that contains contributions from the probability that the protocol aborts, the probability of success of the error correction, parameter estimation etc. This is related to the concept of composability that we briefly explain in the next section. Composable security proofs are today known for both discrete-and continuous-variable QKD protocols [55][56][57][58][59][60][61][62].</p>
        <p>Cryptographic tasks often form parts of larger protocols. Indeed the main reason for our interest in QKD is that secure communication can be built by combining key distribution with the one-time pad protocol. If two protocols are proven secure according to a composable security definition, then the security of their combination can be argued based on their individual functionalities and without the need to give a separate security proof for the combined protocol. Since individual cryptographic tasks are often used in a variety of applications, composability is highly desirable. Furthermore, the early security proofs for QKD [63,64] did not use a composable definition and were consequently shown to be inadequate (even when combined with the one-time pad) [65].</p>
        <p>The concept of composability was first introduced in classical cryptography [66][67][68][69] before being generalized to the quantum setting [70][71][72]. A new security definition was developed [73,74] that is composable in the required sense and is the basis of the accepted definition, which we discuss here. The main idea behind a composable security definition is to define an ideal protocol, which is secure by construction, and then show that the real implementation is virtually indistinguishable from the ideal in any situation. Therefore, in effect it takes into account the worst possible combined protocol for the task in question. To think about this concretely, it is often phrased in terms of a game played by a distinguisher whose task it is to guess whether Alice and Bob are implementing the real protocol or the ideal. The distinguisher is permitted to do anything that an eavesdropper could in a real implementation of the protocol. They are also given access to the outputs of the protocol, but not to any data private to Alice and Bob during the protocol (e.g., parts of any raw strings that are not publicly announced).</p>
        <p>Coming up with a reasonable ideal for a general cryptographic task is not usually straightforward because the ideal and real protocols have to be virtually indistinguishable even after accounting for all possible attacks of an adversary. However, in the case of key distribution it is relatively straightforward. The ideal can be phrased in terms of a hypothetical device that outputs string S A to Alice and S B to Bob (each having n possible values) such that</p>
        <p>This captures that Alice's and Bob's strings are identical and uncorrelated with E (which represents all of the systems held by Eve). These conditions are often spelled out separately:</p>
        <p>1. P (S A = S B ) ρ I = 0 (correctness, i.e., Alice and Bob have identical outputs).</p>
        <p>2. ρ I SAE = n -1 1 1 n ⊗ ρ E (the output string is secret). The ideal protocol then says perform the real protocol and if it does not abort, replace the output with one from this hypothetical device with the same length. It may seem strange that the ideal involves running the real. However, if the ideal protocol just said use the hypothetical device, a distinguisher could readily distinguish it from the real protocol by blocking the quantum channel between Alice and Bob. This would force the real protocol to abort, while the ideal would not. By defining the ideal using the real protocol, both protocols abort with the same probability for any action of the distinguisher.</p>
        <p>From the point of view of the distinguisher, the aim is to distinguish two quantum states: those that the protocol outputs in the real and ideal case. The complete output of the real protocol (taking into account the possibility of abort) can be written is the state conditioned on the real protocol not aborting, |⊥ as a special symbol representing abort (this is orthogonal to all the |x or |y terms in the sum), p(⊥) and p( ⊥) = 1p(⊥) are the probabilities of abort and not abort respectively. (Note that any information sent over the authenticated public channel that Eve could listen in on during the implementation is included in E.)</p>
        <p>The output of the ideal is instead</p>
        <p>with ρ I SASB E defined in Eq. ( 8). The measure of distinguishability for these is the trace distance D [1]. This has the operational meaning that, given either σ R SASB E or σ I SASB E with 50% chance of each, the optimal probability of guessing which is</p>
        <p>which accounts for any possible quantum strategy to distinguish them. If the distance is close to zero, then the real protocol is virtually indistinguishable from the real. Quantitatively, if D(σ R SASB E , σ I SASB E ) ≤ ε for all possible strategies an eavesdropper could use, then the protocol is said to be ε-secure. The analogue of this definition for probability distributions was used in [75] to prove security of a QKD protocol against an adversary limited only by the no-signalling principle. However, it is more common to express security in another way as described below.</p>
        <p>By using properties of the trace distance it can be shown that the probability of successfully distinguishing can be bounded by the sum of contributions from the two conditions stated previously [76]. These are usually called the correctness error ε corr = p( ⊥)P (S A = S B ) ρ R , and the secrecy error,</p>
        <p>The correctness error is the probability that the protocol outputs different keys to Alice and Bob. The secrecy error is the probability that the key output to Alice can be distinguished from uniform given the system E. In security proofs it is often ε corr and ε secr that are computed.</p>
        <p>DV protocols can be seen as the earliest (and possibly the simplest) form of QKD. Despite the development of the famous BB84 protocol with its name accorded based on a 1984 paper [77], the first ideas for the use of quantum physics in the service of security can be traced as far back as the early 70s (A detailed history on the beginnings of quantum cryptography can be found in Ref. [78]). Wiesner was then toying with the idea of making bank notes that would resist counterfeit [78]. The first paper published on quantum cryptography, on the other hand was in 1982 [79]. In this section we give a brief description of DV protocols for QKD. It is instructive to introduce some preliminary notation which will be useful in the subsequent sections. The reader expert in quantum information may skip most of the following notions.</p>
        <p>Recall that a qubit is represented as a vector in a bidimensional Hilbert space, which is drawn by the following basis vectors:</p>
        <p>Any pure qubit state can thus be expressed as a linear superposition of these basis states, |ψ = α|0 + β|1 = cos(θ/2)|0 + e iφ sin(θ/2)|1 , (11) with θ ∈ (0, π), φ ∈ (0, 2π) and i the imaginary unit. This state can be pictorially represented as a vector in the so-called "Bloch sphere". When θ = 0 or θ = π, we recover the basis states |0 and |1 , respectively, which are placed at the poles of the sphere. When θ = π/2, the qubit pure state is a vector lying on the equator of the sphere. Here we can identify the four vectors aligned along the x and ŷ axes, which are obtained in correspondence of four specific values of φ, i.e., we have:</p>
        <p>These four states are particularly important in QKD as they are associated with the popular BB84 protocol [77]. The basis vectors in Eq. (10) are eigenstates of the Pauli matrix</p>
        <p>which we shall simply refer to as the "Z basis", as it is customary in QKD. Similarly, the states in Eqs. (12) and (13) are eigenstates of the Pauli matrix</p>
        <p>known as the X basis, and the states in Eqs. (14) and (15) are eigenstates of</p>
        <p>known as the Y basis. It is worth noting that each of these pairs of eigenstates forms a basis which are mutually unbiased to one another, referred to as mutually unbiased bases (MUB). Formally, two orthogonal basis of a d-dimensional Hilbert space, say {|ψ 1 , ..., ψ d } and {|ψ 1 , ..., ψ d }, are mutually unbiased if | ψ i |φ j | 2 = 1/d for any i and j. Measuring a state from one MUB in another would thus produce either one of the eigenstates with equal probability. Using the three Pauli matrices and the bidimensional identity matrix</p>
        <p>it is possible to write the most generic state of a qubit in the form of a density operator,</p>
        <p>with n the Bloch vector and σ = {σ x , σ y , σ z }. This notation comes handy when the qubit states are mixed, which can be described with a vector n whose modulo is less than 1, as opposed to pure states, for which |n| = 1.</p>
        <p>To give a physical meaning to the representation of a qubit, we can interpret the qubit state in Eq. (11) as the polarization state of a photon. In this case, the Bloch sphere is conventionally called the Poincaré sphere, but its meaning is unchanged. The basis vectors on the poles of the Poincaré sphere are usually associated with the linear polarization states |H = |0 and |V = |1 , where H and V refer to the horizontal or vertical direction of oscillation of the electromagnetic field, respectively, with respect to a given reference system. The X basis states are also associated with linear polarization but along diagonal (|D = |+ ) and anti-diagonal (|A = |-) directions. Finally, the Y basis states are associated with right-circular (|R = | + i ) and left-circular (|L = |i ) polarization states. Any other state is an elliptical polarization state and can be represented by suitably choosing the parameters θ and φ.</p>
        <p>It is worth noting that polarization can be cast in oneto-one correspondence with another degree of freedom of the photon which is particularly relevant from an experimental point of view. This is illustrated in Fig. 1. The light source emits a photon that is split into two arms by the first beam-splitter (BS). The transmission of this BS represents the angle θ of the Bloch sphere. More precisely, if r and t are the reflection and transmission coefficients of the BS, respectively, such that |r| 2 + |t| 2 = 1, we can write r = cos(θ/2) and t = e iφ sin(θ/2) so to recover Eq. (11). If the BS is 50:50, then θ = π/2 and the state after the BS becomes</p>
        <p>The phase φ now has a clear physical meaning, i.e., it represents the relative electromagnetic phase between the upper and lower arms of the interferometer in Fig. 1. This phase can be modified by acting on the phase shifters in Fig. 1 and this is one of the most prominent methods to encode and decode information in QKD. In fact, it is fair to say that the vast majority of QKD experiments were performed using either the polarization or the relative phase to encode information. As we well know, from a historical perspective, the first QKD protocols were introduced using DVs, especially polarization. This remains even today the simplest way to describe an otherwise complex subject. The seminal BB84 protocol [77] was described using polarization. In 1991 Ekert suggested a scheme, the "E91" [80], that for the first time exploits entanglement for cryptographic purposes. The conceptual equivalence of this scheme with the BB84 protocol was demonstrated in 1992 by Bennett, Brassard and Mermin [81], who also proposed a simplified version of the E91 later called "BBM92" or more simply "EPR scheme". However, this supposed equivalence cannot be taken strictly as it can be shown that the entangled based protocol of E91 can provide device independent security, which is impossible for the BB84 using separable states even in a noise free scenario [82]. A few years later, Lo and Chau first [83] and Shor and Preskill later [84], will exploit this equivalence between the prepare-and-measure BB84 and the entanglement-based BBM92 to demonstrate the unconditional security of the BB84 protocol. Another important protocol, the "B92" [85], was proposed in 1992 by Bennett, showing that QKD can be performed with even only two non-orthogonal states. In the next sections, we will describe these protocols and the advances over them in more detail.</p>
        <p>In this section, we outline the most intuitive DV-QKD protocols, generally denoted "prepare-and-measure". Here, the transmitting user, Alice, prepares the optical signals by encoding on them a discrete random variable, e.g., a bit. The optical signals are then sent to the receiving user, Bob, who measures them in order to retrieve the information sent by Alice. In describing the protocols in this category, we will often use a single-photon description highlighting the protocol's 'in principle' workings, even if in practice true single-photon sources are not yet widely available.</p>
        <p>In the BB84 protocol, Alice (the transmitter) prepares a random sequence of four states in two complementary bases. These are usually chosen as |0 , |1 (Z basis), |+ , |-(X basis). However, other choices are possible, including the four states in Eqs. ( 12)- (15). The users associate a binary 0 (a binary 1) with the non-orthogonal states |0 and |+ (|1 and |-). The non-orthogonality condition guarantees that an eavesdropper cannot clone or measure the prepared states with perfect fidelity. This is true because the no cloning theorem assures that she cannot replicate a particle of unknown state [19,20]. This implies that she cannot perfectly retrieve the information encoded by Alice and that her action causes a disturbance on the quantum states that can be detected by the legitimate users. The states prepared by Alice are sent to Bob (the receiver), who measures them in one of the two bases Z or X, selected at random. If, for a particular photon, Bob chooses the same basis as Alice, then in principle, Bob should measure the same bit value as Alice and thus he can correctly infer the bit that Alice intended to send. If he chose the wrong basis, his result, and thus the bit he reads, will be random.</p>
        <p>When the quantum communication is over, Bob notifies Alice over a public channel what basis he used to measure each photon, for each of the photons he detected. Alice reports back her bases and they discard all the events corresponding to different bases used. Provided no errors occurred or no one manipulated the photons, the users should now both have an identical string of bits which is called "sifted key".</p>
        <p>At this point, Alice and Bob test their key by agreeing upon a random subset of the bits to compare their results. If the bits agree, they are discarded and the remaining bits form the shared secret key. In the absence of noise or any other measurement error, a disagreement in any of the bits compared would indicate the presence of an eavesdropper on the quantum channel.</p>
        <p>For the sake of clarity, we shall describe how an eavesdropper can gain any information while inducing noise. This is really simple quantum mechanics. Let us as-sume, for simplicity, that Eve makes a measurement to project the state of the photon onto one given by |θ = cos(θ/2)|0 + e iφ sin(θ/2)|1 and a state orthogonal to it, |θ ⊥ . She can infer Alice's state |a , after Alice's disclosure on the public channel of the basis used by Bayes theorem, Pr(|a ||θ ) = Pr(|θ ||a )Pr(|a ) Pr(|θ ||a )Pr(|a ) + Pr(|θ ||a ⊥ )Pr(|a ⊥ ) (22) As Pr(|a ) = 1/2 and Alice's disclosure limits the possible states to only |a and |a ⊥ for a run, the above simplifies to Pr(|a ||θ ) = Pr(|θ ||a ). In order to have an idea of Eve's information gain, let us consider a specific example [27]; assuming |a = |0 . It can be easily shown that Pr(|0 ||θ ) = | 0|θ | 2 = cos 2 (θ/2). Her uncertainty, H Z E , on Alice's encoding is given by Shannon's binary entropic function as</p>
        <p>If Alice had used the X basis, a similar calculation would have given Pr(|+ ||θ ) = | +|θ | 2 = (1 + sin θ cos φ)/2 and Eve's corresponding uncertainty, H X E is</p>
        <p>The first thing to note is that, to have zero uncertainty for H Z E is to set θ = 0 corresponding to a measurement in the Z basis (mathematically, it is certainly possible to set θ = π, however this simply means that |θ ≡ |1 and the measurement basis is still Z). However, this forces a maximal uncertainty for H X E i.e. when Alice uses the X basis. On the other hand, minimizing the uncertainty of H X E (e.g. by setting θ = π/2 and φ = 0) would maximize H Z E . This is certainly in line with the use of MUBs where maximizing the information gain when measuring in one basis maximizes the uncertainty for the complimentary basis. The only way out, i.e. to minimize both uncertainty is to use two different measurement bases corresponding to Alice's choices of bases; this can be chosen randomly and the events where the choices do not match would be discarded. This is precisely Bob's situation! Hence we can see how Alice and Bob can actually share maximal information in principle as they discard the runs where their bases do not match. Eve on the other hand does not have that luxury, as she would only have her bases match Alice's half the time and her information gain is 0.5. This is the most basic intercept-resend attack strategy. Now, let us consider what happens after Eve makes a measurement. Quantum mechanics tells us that her measurement would project Alice's state into an eigenstate of her measurement basis, and she would thus forward to Bob the state |θ . Bob on the other hand, when measuring in the same basis as Alice (when she sends |a ) would thus register an error (|a ⊥ ) with probability | a ⊥ |θ | 2 = sin 2 (θ/2) in those instances. Hence, if Eve uses the Z basis for measurement while Alice and Bob's are X the error rate in these instances becomes 1/2. However, as she would be able to guess correctly half the time, the error rate is halved and on average, the users will detect an error with a probability of 25%.</p>
        <p>Obviously this choice of θ need not be limited to 0 or φ/2. A well known example is when θ = π/4, a measurement in the so called Breidbart basis. This would make H Z E = H X E . The calculation for the error that Bob would note is straightforward. Let us take the case when Alice and Bob uses the Z basis. When Eve projects her the qubit into the state |θ , this happens with probability cos 2 (π/8). Bob gets an erroneous result with probability sin 2 (π/8). In the instance Eve projects onto |θ ⊥ which happens with probability sin 2 (π/8), Bob registers an error with probability cos 2 (π/8). The error rate thus becomes 2 cos 2 (π/8) sin 2 (π/8) = 0.25. A similar calculation can be done for the case when Alice uses the X basis to also yield an error rate of 25%.</p>
        <p>In a noiseless scenario, the presence of an error would reveal with certainty the presence of an eavesdropper. In this case the users can abort the whole communication, discard their key and start a new communication. However, in realistic situation, noise is always present given imperfection of physical implementations. It is tempting to imagine that one can characterize the errors on the physical channel and then any 'extra' error can be assumed due to Eve. However, assuming Eve can actually substitute the channel with a perfect noiseless one, Alice and Bob would not be able to distinguish between errors that are genuine (i.e. not due to Eve) or errors due to her meddling. A pessimistic stand is to assume all errors due to Eve. Aborting the protocol every time an error is detected would translate into Alice and Bob never able to establish a secure key. Thus the trick is not so much in detecting an eavesdropper, rather, given the presence of an eavesdropper, how can one still distill a secret key.</p>
        <p>When noise is present, the users can detect an error even if Eve is not on the line. In this case they run an error correction algorithm followed by a compression algorithm called privacy amplification (PA). The amount of PA necessary is estimated by the users starting from the percentage of errors measured in their experiment, the so-called "quantum bit error rate" (QBER). Hence the search for an ultimate security proof is simply the search for the best strategy Eve can employ to achieve the highest information gain given the amount of QBER detected.</p>
        <p>A general attack strategy an eavesdropper can consider is to attach an ancilla, |E , (a quantum system possibly higher dimension than a qubit) to Alice's qubit and let them interact in the hope of gleaning some information. This interaction (with Alice's state in the computational basis) can be written as</p>
        <p>with |E ij being Eve's possible ancillary states after the interaction. These equations literally mean that when Alice sends a |0 (|1 ) state, Bob has a probability F 0 (F 1 ) of getting the right result when measuring in the Z basis and D 0 (D 1 ) otherwise.</p>
        <p>There are two points worth noting here; firstly, the Stinespring dilation theorem allows us to limit our consideration of Eve's ancillae to a four dimensional quantum system or two qubits. Secondly, given linearity, the interaction with Eve's ancillae can also be written directly for Alice's X basis, thus defining the QBER in that basis. In order to ensure that the QBER in both bases Z and X are equal, the overlap between Eve's ancillary states must be defined accordingly. We begin by rewriting the above equations more concisely as</p>
        <p>where |a ∈ {|0 , |1 , |+ , |-} and a|a ⊥ = 0. Unitarity of U ensures</p>
        <p>E aa |E aa ⊥ = 0, (30) and F a + D a = 1. Imposing the symmetry of errors in both bases leads to</p>
        <p>E aa |E a ⊥ a = 0, (32) E aa ⊥ |E a ⊥ a = D a cos (y), (33) implying the QBER</p>
        <p>This is the essence of a symmetric attack [86] which can be seen as a contraction of the Bloch sphere by F a -D a . Assume that Eve keeps her ancillary system in a quantum memory and waits for Alice and Bob to end all the classical communication related with the reconciliation of the bases (sifting). In this way she can distinguish between her ancillary states given by |E aa and |E a ⊥ a ⊥ . Then assume that she can also perform a joint measurement on her entire quantum memory, a scenario known as 'collective attack'. In such a case, Eve's amount of information is upper bounded by the Holevo information</p>
        <p>where S(•) is the von Neumann entropy, and ρ E (a) (ρ E (a ⊥ )) is Eve's state for Alice's |a (|a ⊥ ). In the presence of this symmetric collective attack, it can be shown that the secret key rate is then given by [86] R BB84 = 1 -S(ρ E ) = 1 -2H 2 (D a ), (36) where the binary Shannon entropy H 2 is computed over the QBER D a . As a result, a key can be extracted for a QBER with a value no greater than approximately 11%. This security threshold value of 11% is exactly the same as the one that is found by assuming the most general 'coherent attack' against the protocol, where all the signal states undergo a joint unitary interaction together with Eve's ancillae, and the latter are jointly measured at the end of protocol. In this general case the security proof was provided by Shor and Preskill [84].</p>
        <p>The main idea to show the unconditional security of the BB84 protocol is based on the reduction of a QKD protocol into an entanglement distillation protocol (EDP). Given a set of non-maximally entangled pairs, the EDP is a procedure to distill a smaller number of entangled pairs with a higher degree of entanglement using only local operations and classical communication (LOCC). In some ways, employing this for a security proof for QKD actually makes perfect sense as it involves the two parties ending with a number of maximally entangled pairs. Given the monogamous nature of entanglement, no third party can be privy to any results of subsequent measurements the two make.</p>
        <p>In particular, Shor and Preskill [84] showed that EDP can be done using quantum error correction codes, namely the Calderbank-Shor-Steane (CSS) code [1] which has the interesting property which decouples phase errors from bit errors. This allows for corrections to be made independently. In this way, one can show that the key generation rate becomes</p>
        <p>where e b and e p are bit and phase error rates with e b = e p . This results in the same formula of Eq. (36). It is simple to see that R = 0 for e b ≈ 11%.</p>
        <p>The BB84 protocol has also been extended to use six states in three bases to enhance the key generation rate and the tolerance to noise [87]. 6-state BB84 is identical to BB84 except, as its name implies, rather than using two or four states, it uses six states on three bases X, Y and Z. This creates an obstacle to the eavesdropper who has to guess the right basis from among three possibilities rather than just two of the BB84. This extra choice causes the eavesdropper to produce a higher rate of error, for example, 1/3 when attacking all qubits with a simple IR strategy; thus becoming easier to detect.</p>
        <p>One can extend the analysis of Eve's symmetric collective attack to the 6-state BB84 by considering a third basis for Eq. ( 34) which immediately sets a further constraint on Eve's ancillary state; i.e. cos y = 0 (Eve's states |E aa ⊥ and |E a ⊥ a are orthogonal). The new QBER D ′ a is then given by</p>
        <p>as also noted in [88] (but reported in terms of the fidelity rather than the QBER). Assuming a symmetric collective attack [86], a similar calculation to the one for BB84 gives the following secret key rate for the 6-state protocol as</p>
        <p>This rate exactly coincides with the unconditional key rate, proven against coherent attacks, and gives a security threshold value of about 12.6% slightly improving that of the BB84 protocol. Before moving on, it is worth noting that the symmetric attacks described in both the BB84 protocol as well as the 6-state protocol are equivalent to the action of quantum cloning machines (QCMs) [89]. Notwithstanding the no-cloning theorem, QCMs imperfectly clone a quantum state, producing a number of copies, not necessarily of equal fidelity. QCMs which result in copies that have the same fidelity are referred to as symmetric. In the case of the BB84, the states of interest come from only 2 MUBs, hence the relevant QCM would be the phase covariant QCM which clones all the states of the equator defined by two MUBs (the term 'phase covariant' comes from the original formulation of the QCM cloning states of the form (|0 + e iφ |1 )/ √ 2 independently of φ [90]; this QCM thus copies equally well the states from the X and Y bases). As for the 6-state protocol, the relevant QCM is universal, meaning that it imperfectly clones all states from 3 MUBs with the same fidelity.</p>
        <p>In 1992, Charles Bennett proposed what is arguably the simplest protocol of QKD, the "B92" [85]. It uses only two states to distribute a secret key between the remote parties. This is the bare minimum required to transmit one bit of a cryptographic key. More precisely, in the B92 protocol, Alice prepares a qubit in one of two quantum states, |ψ 0 and |ψ 1 , to which she associates the bit values 0 and 1, respectively. The state is sent to Bob, who measures it in a suitable basis, to retrieve Alice's bit. If the states |ψ 0 , |ψ 1 were orthogonal, it is always possible for Bob to deterministically recover the bit. For instance, if |ψ 0 = |0 and |ψ 1 = |1 , Bob can measure the incoming states in the Z basis and recover the information with 100% probability.</p>
        <p>However, Bob's ability to retrieve the information without any ambiguity also implies that Eve can do it too. She will measure the states midway between Alice and Bob, deterministically retrieve the information, prepare new states identical to the measured ones, and forward them to Bob, who will never notice any difference from the states sent by Alice. Orthogonal states are much alike classical ones, that can be deterministically measured, copied and cloned. Technically, the orthogonal states are eigenstates of some common observable, thus measurements made using that observable would not be subjected to any uncertainty. The no-cloning theorem [19,20] does not apply to this case.</p>
        <p>By contrast, measurements will be bounded by inherent uncertainties if Alice encodes the information in two non-orthogonal states, for example the following ones:</p>
        <p>As Bennett showed in his seminal paper [85], any two non-orthogonal states, even mixed, spanning disjoint subspaces of the Hilbert space can be used. In the actual case, the scalar product s is optimized to give the best performance of the protocol. For the states in Eq. ( 41), this parameter is fixed and amounts to 1/ √ 2; i.e. the states are derived from bases which are mutually unbiased one to the other. Given the complementary nature of the observables involved in distinguishing between these states, neither Bob nor Eve can measure or copy the states sent by Alice with a 100% success probability. However, while Alice and Bob can easily overcome this problem (as described in the following) and distil a common bit from the data, Eve is left with an unsurmountable obstacle, upon which the whole security of the B92 protocol is based.</p>
        <p>In B92, Bob's decoding is peculiar and worth describing. It is a simple example of "unambiguous state discrimination" (USD) [91,92]. To explain it, it is useful to remember that the state |0 (|+ ) is an eigenstate of Z (X) and that |± = (|0 ± |1 )/ √ 2, as it is easy to verify from Eqs. (10), (12) and (13). Suppose first that Alice prepares the state |ψ 0 . When Bob measures it with Z, he will obtain |0 with probability 100% whereas when he measures it with X, he will obtain either |+ or |with probability 50%. In particular, there is one state that Bob will never obtain, which is |1 . Now suppose that Alice prepares the other state of B92, |ψ 1 . Bob will still measure in the same bases as before but in this case, if we repeat the previous argument, we conclude that Bob can never obtain the state |as a result. See the table below for a schematic representation of Bob's outcomes and their probabilities (Pr) depending on Alice's encoding state and Bob's chosen basis for measurement. bit Alice Bob (Z) Bob (X)</p>
        <p>From the table it is clear that, for the conditional probability p(A|B) of guessing Alice's encoding A given Bob's outcome B, we may write</p>
        <p>In other words, Bob can logically infer that when he detects |1 , Alice must have prepared the state |+ , so he decodes the bit as '1', whereas when he detects |-, Alice must have prepared the state |0 so he decodes the bit as '0'. Whenever he detects any other state, Bob is unsure of Alice's preparation and the users decide to simply discard these "inconclusive" events from their records. This way, using this sort of "reversed decoding", which is typical of USD, and his collaboration with Alice, Bob manages to decode the information encoded by Alice. Despite the fact that USD can also be used by Eve, the unconditional security of the B92 protocol was rigorously proven in [93] for a lossless scenario and then extended to a lossy, more realistic, case in [94], under the assumption of single photons prepared by Alice. This assumption is not necessary in the B92 version with a strong reference pulse, which has been proven secure in [95]. Remarkably, this particular scheme has been shown to scale linearly with the channel transmission at long distance, a desirable feature in QKD. Two interesting variants of this scheme appeared in [96] and [97], which allow for a much simpler implementation.</p>
        <p>Generally speaking, the performance of the B92 protocol is not as good as that of BB84. The presence of only two linearly independent states makes it possible for the eavesdropper to execute a powerful USD measurement on the quantum states prepared by Alice. This makes the B92 very loss dependent and reduces its tolerance to noise from a depolarizing channel to about 3.34% [93]. This value is much smaller than the one pertaining to the BB84 protocol, which is 16.5% [84] (it should be stressed here that these values refer to the depolarizing parameter p for a depolarizing channel acting on a state ρ as (1p)ρ + p/3 i σ i ρσ i with σ i as the Pauli matrices).</p>
        <p>However, it was recently shown that the B92 can be made loss-tolerant if Alice prepares a pair of uninformative states in addition to the usual B92 states, while leaving Bob's setup unchanged [98]. This is due to the fact that the two extra states make the B92 states linearly dependent, thus preventing the possibility of a USD measurement by Eve. The existence of the uninformative states paved the way to a device-independent entanglement-based description of the B92 protocol [99], which was not previously available. In this description, Eve herself can prepare a non-maximally entangled state and distribute it to Alice and Bob. By measuring in suitable bases, Alice and Bob can test the violation of the Clauser-Horne inequality [100], a special form of Bell inequality, thus guaranteeing the security of the protocol from any attack allowed by quantum mechanics, irrespective of the detailed description of the hardware. Despite the radically different security proof used [101], the tolerance to the noise from a depolarizing channel was found to be 3.36%, remarkably close to the value of the standard prepare-and-measure B92 protocol.</p>
        <p>Before concluding, it is worth mentioning that both the prepare-and-measure B92 [85] and the entanglementbased B92 [99] have a clear advantage in the implementation, as experimentally shown in [102]. The asymmetry of the B92 states allows for an automatic feedback that can keep distant systems aligned without employing adhoc resources at no extra cost for the key length.</p>
        <p>DV-QKD protocols are ideally defined on qubits (or qudits) for which security analysis drawn are based on. Moving from a theoretical protocol where single qubits are used to carry one bit of classical information to a practical implementation should in principle require the most faithful adaptation possible. However in practice, perfect single-photon sources are generally not available and there is some probability for a source to emit multiple photons with identical encodings in a given run of the QKD protocol. This can be a security vulnerability to an eavesdropper who employs the photon number splitting (PNS) attack [103,104]. The essential idea behind the attack is that Eve can perform a quantum non-demolition measurement to determine the number of photons in a run and when it is greater than 1, she could steal one of the excess photons while forwarding the others to Bob. In this way Bob would not be able to detect her presence while she lies in wait for Alice's basis revelation to make sharp measurements of the stolen photons and obtain perfect information of the multi-photon runs. The case for single photons can be attacked using the ancillary assisted attack strategy described earlier.</p>
        <p>A weak coherent laser source is commonly used to implement DV-QKD protocols. Such a source generates a pulse having a finite probability of multiple photons with the number of photons n described by the Poisson distribution. Thus, the probability for a pulse sent to contain a number of photons n is given by</p>
        <p>where µ being the average photon number per pulse. It is not difficult to imagine that an eavesdropper's information gain thus increases with µ. Intuitively, one can imagine that as secret bits can only be derived from the single photon pulses, the number of bits from the multiphoton pulses needs to be subtracted from the total signal gain for the raw key. Writing p as the fraction of signals detected by Bob, we write the minimum fraction for single photon pulses as P, where P = [p -Pr(n &gt; 1)]/p. Considering the case of Eve committing to an individual attack strategy, the QBER estimated as e, need to be rescaled to e ′ = e/P for PA purposes with the assumption that all errors stem from Eve's attack of single photon pulses. Let Q be the ratio of the total bits for a raw key over the total signals detected. The effective key rate is then given by</p>
        <p>where r PA is the rate for PA and H 2 (e) is the rate due to error correction procedure (note that the QBER need not to be rescaled for error correction). For an individual attack strategy, the PA rate is given by r P A = log 2 (1 + 4e ′ -4e ′ 2 ), for e ′ ≤ 0.5 and 1 otherwise. In a realistic setup, considerations for dark counts (Bob's detector clicking for vacuum pulses) must also be taken into account. It should also be noted that for a BB84 setup, Eq. ( 45) would be multiplied further by a factor of half to reflect the instances where Alice's and Bob's choice of measurement bases coincide. A full fledge treatment for the above can be referred to in [104]. While the PNS attack decreases the secure key generation rate drastically, the decoy state method and the SARG04 protocol are possible approaches to solve these issues.</p>
        <p>As we have seen in the previous section, practical implementations which include multi photon pulses is detrimental to the key rate when the legitimate parties cannot distinguish between photons detected from single or multi photon pulses. At best, they can try to determine the fraction of single photon pulses received and have privacy amplification done only on that. The case of the individual attack strategy by an eavesdropper was studied in [104] with the key rate reflected by equation (45). In Ref. [105], commonly referred to as 'GLLP', a more general scenario was considered. In some sense, this can be understood as a generalization to the EDP based security proof of BB84 to include non-single photon sources.</p>
        <p>In a nutshell, it demonstrates that it is sufficient to consider the PA rate for single-photon pulses when considering a string derived from both single and multi-photon pulses. Thus, the key rate is essentially given by equation (45) except for P and r PA terms substituted with Q 1 and H 2 (e 1 ), where Q 1 and e 1 are the gain and the QBER corresponding to single-photon pulses. Hence, if one can determine accurately the gain (which could be greater than P) as well as the amount of error relevant to the single photon pulses (which may be less than e ′ ), then the PA rate may be reduced and the key rate would definitely receive a boost. This is where the decoy state method comes in. First introduced in Ref. [106], it was shown to be practically useful in Ref. [107], where the method was studied assuming three different intensities under finite-size effects (see also Ref. [108]). It was further developed and worked on in Refs. [109,110]. The decoy states technique has enabled QKD to be executed over distances beyond a hundred kilometers despite the imperfections in implementation.</p>
        <p>In a practical setup, Bob's gain is a weighted average of all detected photons (including the empty pulses) and can be written as</p>
        <p>where Y i is the probability that Bob detects conclusively an i-photon pulse sent by Alice. The QBER also has contribution from multi-photon pulses, and can be written as</p>
        <p>Let us note that Alice and Bob can only determine the values of Q m and E m in an actual implementation and do not have any information of the values of Y i . However, if one considers using differing values of the light intensity, µ, then one can have a system of linear equations (based on Eq. ( 46) for varying µ) with the solution set {Y 0 , Y 1 , ...}. Another system of linear equations based on Eq. ( 47) provides the solution set {e 0 , e 1 , ...}.</p>
        <p>It is now a rather straightforward matter to determine Q 1 : Alice could send to Bob photon pulses with varying intensities of light. Only one intensity is preferred for key bits while the other intensities would be used as decoy, i.e. decoy states. As these would be done randomly, Eve would not know which photons would be used for key purposes and which were the decoys. Linear algebra then should provide a standard method to derive the solution sets and Alice and Bob would know exactly the values for Y 1 and e 1 . These values are the most pertinent.</p>
        <p>All seems well except for the fact that the value of i in equations (46) and (47) runs from 0 to infinite! This literally means that to have a precise value for Y 1 and e 1 , Alice should in principle, use and infinite number of decoy states. This was in fact the consideration done in Ref. [109]. Using parameters of an experimental setup, they demonstrated how the decoy state technique could benefit the BB84 protocol by extending the distance. Nevertheless, given the fact that the event of producing a pulse with higher number of photons is less likely compared to one with lesser in number, a finite number of decoy states can be quite sufficient. Ref. [110] showed that an implementation using only two decoy states (with the sum of the intensities lower than that of the signal state) is sufficient and in the limit of vanishing intensities of the decoys, the values estimated for Y 1 and e 1 asymptotically approaches the ideal infinite decoy case. See also Sec. 4.3 of Ref. [111] for a brief review on decoy states.</p>
        <p>While the decoy state technique mitigates the problem of PNS attacks by introducing new elements to the BB84 protocol, a more subtle approach was introduced in 2004 by Scarani, Acin, Ribordy, and Gisin, "SARG04" [112], a variant of the BB84 at the classical communication stage. The PNS attack thrives on the information revealed regarding the basis used in prepare and measure protocols like BB84. Thus, a natural way against such an attack would be to discount such an element from the protocol. The SARG04 protocol shares the first step of photon transmission with BB84: Alice sends one of four states selected randomly from 2 MUBs, Z or X, and Bob performs a measurement with the two bases. In the second step however, when Alice and Bob determine for which bits their bases matched, Alice does not directly announce her bases but a pair of non-orthogonal states, one of which being used to encode her bit.</p>
        <p>The decoding is similar to that of the B92 protocol; it is a procedure of USD between states in the announced pair. For example, assume Alice transmits |0 and Bob measures it with the basis X. Alice would announce the set {|0 , |+ }. If Bob's measurement results in |+ , then Bob cannot infer Alice's state conclusively as the output |+ could have resulted from either |0 or |+ as input. In such a case, the particular run would be discarded. If the result was |instead, then it is stored for post processing because it could have only resulted from the measurement of the |0 state. Since the two states in a set are non-orthogonal, the PNS attack cannot provide Eve with perfect information on the encoded bit.</p>
        <p>The SARG04 protocol has been shown to be secure up to QBER values of 9.68% and 2.71% for single photon and double photon pulses respectively [113] using the EDP type proof. It is worth noting that similar modification to the classical phase of the six state protocol can be done to give a 'six-state SARG04' where key bits can be derived from even 4 photon pulse. This is secure for QBER values of 11.2%, 5.60%, 2.37% and 0.788% for 1, 2, 3 and 4 photon pulses respectively. See also the recent analysis in Ref. [114].</p>
        <p>In 1991, Artur Ekert developed a new approach to QKD by introducing the E91 protocol [80]. The security of the protocol is guaranteed by a Bell-like test to rule out Eve. The E91 considers a scenario where there is a single source that emits pairs of entangled particles, each described by a Bell state, in particular the singlet state |Ψ = (|01 -|10 )/ √ 2. The twin particles could be polarized photons, which are then separated and sent to Alice and Bob, each getting one half of each pair. The received particles are measured by Alice and Bob by choosing a random basis, out of three possible bases. These bases are chosen in accordance to a Clauser, Horne, Shimony and Holt (CHSH) test [115]. Explicitly, the angles chosen by Alice are</p>
        <p>corresponding to the bases Z, (X + Z)/ √ 2 and X, respectively. Bob's on the other hand chooses</p>
        <p>corresponding to (X + Z)/ √ 2, X and (X -Z)/ √ 2. As in BB84, they would discuss in the clear which bases they used for their measurements. Alice and Bob use the instances where they chose different basis to check the presence of Eve. By disclosing the data related to these instances they check the violation of the CHSH quantity</p>
        <p>where a i b j represents the expectation value when Alice measures using a i and Bob, b j . If the inequality -2 ≤ E ≤ 2 holds, it would indicate either that the received photons are not truly entangled (which could be due to an attempt to eavesdrop) or that there is some problem with the measurement device. By contrast, if everything works perfectly and there is no eavesdropper, Alice and Bob expected value of E is the maximal violation -2 √ 2. One way of looking at it is by writing the state of entangled photons subjected to a depolarizing channel, resulting into the isotropic mixed state</p>
        <p>with probability p. It can be shown that the CHSH test has maximal violation -2 √ 2 provided that p = 1, i.e., for an unperturbed 'Eve-less' channel.</p>
        <p>In the case of maximal violation of the CHSH test, Alice and Bob are sure that their data is totally decoupled from any potential eavesdropper. From the instances where they chose the same bases, they therefore process their perfectly anti-correlated results into a shared private key. While QKD generally capitalizes on the nocloning theorem and the inability of perfectly distinguishing between two non-orthogonal states, the essential feature of the E91 protocol is its use of the nonlocal feature of entangled states in quantum physics. Eve's intervention can be seen as inducing elements of physical reality which affects the non-locality of quantum mechanics.</p>
        <p>The BBM92 protocol [81] was, in some sense, aimed as a critic to E91's reliance on entanglement for security. Building upon E91 with a source providing each legitimate party with halves of entangled pairs, BBM92 works more efficiently by having both the legitimate parties each measure in only two differing MUBs instead of the three bases of E91. The two MUBs can be chosen to be the same as that of BB84. By publicly declaring the bases, Alice and Bob select the instances where they chose the same basis to obtain correlated measurement results, from which a secret key can be distilled. A sample is then disclosed publicly to check for errors and evaluate the amount of eavesdropped information.</p>
        <p>The idea is that Eve cannot become entangled to Alice's and Bob's qubits while not causing any error in their measurements. This points out to the claim that there is no need for the legitimate parties to commit to a Bell test. The similarity between BBM92 and BB84 is obvious. If Alice possesses the source, her measurement (in a random basis) would prepare the state to be sent to Bob in one of the 4 possible of the BB84 states. Hence, without a Bell test, we are essentially left with BB84. There is no way of telling whether Alice started off by measuring part of a Bell state or by preparing a qubit state using a random number generator. This observation is at the basis of the entanglement-based representation of prepare and measure protocols, which is a powerful theoretical tool in order to prove the security of QKD protocols.</p>
        <p>Using or not entangled pairs in a QKD protocol is nonconsequential in the context of standard eavesdropping on the main communication channel. However, it is also important to note that a protocol with a Bell test provides a higher level of security because it allows to relax the assumption that the legitimate parties have control over the other degrees of freedom of the quantum signals. This makes way for the most pessimistic security definition, i.e., device-independent security, a topic to be delved into later. The security analysis of entanglementbased QKD protocols is still the subject of very active research, with recent investigations and simplified proofs based on entanglement distillation protocols [116,117].</p>
        <p>Quantum cryptographic protocols making a bidirectional use of quantum channels started with the introduction of deterministic protocols for the purpose of secure direct communication [118][119][120] and later evolved into more mature schemes of two-way QKD [121,122]. A defining feature of these protocols is that encodings are not based on preparing a quantum state but rather applying a unitary transformation, by one party (often Alice) on the traveling qubit sent by another party (Bob) in a bidirectional communication channel. The initial idea of direct communication aimed at allowing two parties to communicate a message secretly, without the need of first establishing a secret key. However the reality of noisy channels would render any such direct communication between parties invalid or very limited. For this reason, two-way protocols for direct communication were soon replaced by QKD versions, with appropriate security proofs [123].</p>
        <p>The ping pong direct communication protocol [118] derives its name from the to and from nature of the traveling qubits between the communicating parties in the protocol. The ping comes from Bob submitting to Alice half of a Bell pair he had prepared, |Ψ + = (|01 + |10 )/ √ 2, and the pong is Alice's submitting of the qubit back to Bob. With probability c, Alice would measure the received qubit in the Z basis; otherwise, she would operate on it with either the identity I with probability p 0 or the σ z Pauli operator with probability 1p 0 , re-sending the qubit back to Bob. The former is the case where she could check for disturbance in the channel and is referred to as the control mode (CM), while the latter is the essential encoding feature of the protocol and referred to as the encoding mode (EM).</p>
        <p>The operations in EM flip between two orthogonal Bell states as I retains |Ψ + , while σ z provides</p>
        <p>This allows Bob to distinguish between them and infer Alice's encoding perfectly. The details of the CM is as follows: Alice measures the received qubit in the Z basis and announces her result over a public channel. Bob then measures his half of the (now disentangled) Bell pair and can determine if Eve had interacted with the traveling qubit. It should be noted that, in this protocol, Alice is not expected to resend anything to Bob in CM. See Fig. 2 for a schematic representation.</p>
        <p>Bell pair Ψ+ is sent by Bob to Alice, while the other part is kept. If Alice chooses the EM (solid lines), she performs either I or σz on the received qubit, which is then sent back to Bob. Finally, Bob performs a Bell detection on the received and kept qubits. If Alice chooses the CM (dotted lines), she measures the incoming qubit in the Z basis (A1), and informs Bob who also measures its kept qubit in the same basis (Bcm).</p>
        <p>By using the instances in CM, the parties may check the presence or not of Eve. In particular, Eve's action goes undetected only with an exponentially decreasing probability in the number of bits gained. Therefore for long enough communication, its presence is almost certainly discovered and the protocol aborted. If not present, then Alice's message is privately delivered to Bob via the EM instances with a sufficient degree of privacy. The message that Alice transmits to Bob is not subject to any form of further processing.</p>
        <p>Note that direct private communication is very fragile and easily fails in realistic conditions where noise on the line is inevitable and, therefore, the presence of Eve must always be assumed as worst-case scenario. Note that a similar severe limitation also affects schemes of quantum direct communication in continuous-variable systems [124,125]. In particular, the ping pong protocol is also subject to a powerful denial-of-service attack [126] which can be partially mitigated if Alice returns the qubit to Bob in CM. Finally, note that the protocol can be easily extended [127] to include all the Pauli operators plus the identity, therefore doubling of the communication capacity, resembling the superdense coding scenario.</p>
        <p>Two-way protocols for QKD do not need to use entanglement as in the ping pong protocol. According to Refs. [121,122], Bob prepares a state |a randomly selected from the two MUBs X and Z to be sent to Alice. In EM, Alice encodes a bit using either the identity (corresponding to bit value '0') and iσ y (corresponding to bit value '1'), i.e.,</p>
        <p>where |a ⊥ is the state orthogonal to |a . The qubit is then sent back to Bob who measures it in the same preparation basis. With some probability, Alice chooses the CM where the incoming qubit is instead measured, and another qubit is prepared and sent back to Bob for his measurement. This 'double check' was specifically introduced in Ref. [122] known as the LM05 protocol. This clearly increases the detection performance of the protocol. For instance, given an attack scenario where Eve measures the traveling qubits in either of the two MUBs Z and X, the probability of detecting her is 37.5%. Security proofs are based on the fact that Eve is forced to attack both the forward and backward paths [128]. In general, from the CM, Alice and Bob derive the amount of noise in the channels, which determines how much PA has to be performed in the post-processing. By disclosing part of the data in EM, they can also estimate the amount of error correction to be performed. Practical implementations of the protocol were already carried out as early as 2006 in Ref. [129] as well as Refs. [130][131][132]. We now discuss basic eavesdropping strategies.</p>
        <p>The simplest attack scheme is IR where Eve measures the traveling qubit in both channels with a basis of her choice (randomly selected between the same bases used by Bob). As she would effectively prepare the traveling qubit into her basis of choice by virtue of a projective measurement, she plays the role of Bob and would be able to ascertain Alice's encoding perfectly. In LM05, she would introduce errors 1/4 of the time in each path. This strategy leads to a security threshold of 11.9%, in terms of maximal error (detected in CM) before no key is distillable.</p>
        <p>It is worth noting that this attack results in an asymmetry between Alice-Eve's and Bob-Eve's mutual information. While Eve attempts to estimate Alice's encoding by inferring the evolution of the state of the traveling qubit, her estimation of the result of Bob's final measurement is another matter entirely. This leads to the idea that Alice and Bob could actually consider doing a reverse reconciliation (RR) procedure for distilling a key, where Alice would correct her bits to guess Bob's string. In RR, the security threshold is increased to 25%.</p>
        <p>Here Eve would attach an ancilla to the traveling qubit in the forward path and another in the backward path with the most optimal possible interaction between them to glean the maximal amount of information while minimizing the disturbance on the channel. In this way, the security threshold for LM05 is about 10% in DR, while remaining 25% in RR. A specific sub-optimal version of this attack is the DCNOT attack strategy, where Eve's ancilla is a qubit, used in the forward as well as the backward path. The unitary transformation used by Eve in both paths would be the same CNOT gate (hence the name double CNOT attack or DCNOT).</p>
        <p>Let us write Alice's encoding as U which acts on a qubit in the computational basis as U |i → |i ⊕ j where ⊕ is the addition modulo 2 operation and i, j = 0, 1. The action of the CNOT gates together with Alice's encoding U A can be written as follows:</p>
        <p>where qubits with subscript E refers to Eve's ancillae. We see that Eve's qubit would record the evolution of Bob's qubit. This is not at all surprising as the CNOT gate allows for the perfect copying of states of the Z basis.</p>
        <p>The case where Bob uses the X basis is no hindrance either to Eve. Despite the fact that a CNOT between a qubit in the X basis (as control qubit) and one in Z (for target) would entangle the qubits, a subsequent CNOT would serve to disentangle them.</p>
        <p>The attack would leave no trace of an eavesdropper in EM while she gains all the information. The attack is however very noisy and easily detectable in CM with an error rate of 25%. If Eve attacks a fraction f of the runs, then her information gain is f with an error rate of f /4.</p>
        <p>A general security proof for two-way DV-QKD was reported in Ref. [123] but methods employed led to an overpessimistic estimation of the key rate (1.7% for LM05). On the other hand, the approach of Ref. [133] based on entropic bounds does not directly apply to two-way QKD protocols based on unitary encodings. A tight security proof is therefore still very much an open problem. A number of eavesdropping strategies and technical issues have been also described in Refs. [134,135], and the performance against lossy channels have been thoroughly studied in Refs. [136][137][138], where the key rate of the LM05 has been compared with that of the BB84 at the same distances.</p>
        <p>Two-way QKD protocols were also extended to considering non-orthogonal unitaries [139][140][141][142]. For instance, the encoding unitaries I and the (I-iσ y )/ √ 2 were considered by Ref. [143], while Ref. [141] exploited the notion of mutually unbiased unitary-operator bases (MUUB) [144]. Another development has been the extension of the LM05 from two to three MUBs (similar to the extension of BB84 to the six-state protocol). The improvement in security provided by the protocol known as 6DP [145] by making use of three MUBs instead of only two is expected. However the extension to include the third MUB is non-trivial given the no-go theorem which forbids the flipping of an arbitrary state selected from 3 MUBs (see also Ref. [146]). This can be seen as follows: if we assume the existence of a unitary transformation U f that flips between the orthogonal state of the Z basis, which can be written as U f |0 = -|1 and U f |1 = |0 . The negative phase factor in the first equation is necessary to ensure U f also flips between the states in the X basis. However, U f would not flip between the states in the Y basis,</p>
        <p>A security proof for a QKD protocol is a mathematical theorem based on particular assumptions. These assumptions might encode that the devices work in a particular way, e.g., that Alice generates a |0 state and sends it to Bob, who measures in the {|0 , |1 } basis. Although we have rigorous security proofs for QKD protocols, finding devices satisfying the assumptions of these proofs is difficult. Any features of the real devices not modeled in the security proof could compromise security, and there are cases where this has happened in actual implementations (e.g. [147][148][149][150]). Attacks that exploit features not modeled in the security proof are known as side-channel attacks.</p>
        <p>Identified side-channel attacks can be patched sending the hacker back to the drawing board. This leads to a technological arms race between the hackers and protocol designers and a sequence of (hopefully) increasingly secure protocols. Device-independent protocols provide a way to break out of this hack-and-patch cycle with respect to side-channel attacks on the devices. They are able to do so because they make no assumptions about how the devices used in the protocols operate in their security proofs-instead, security follows from the classical input-output behavior, which is tested in the protocol. In this way, a device independent protocol checks that the devices are functioning sufficiently well during the protocol. This has a second advantage: in standard QKD protocols with trusted devices, in principle a user should check the functionality of their devices regularly to ensure their behavior is still in line with the assumptions of the security proof. This is a technically challenging task and not one that can be expected of an average user. By contrast, in a device-independent protocol, no sophisticated testing is needed to detect devices that are not functioning sufficiently well (although, technical knowhow is needed to fix them).</p>
        <p>At first it may seem intuitive that this is an impossible task: how can we put any constraints on the workings of a device without probing its internal behavior? In particular, is it possible to test the input-output behavior and ensure that the outputs of a device could not have been pre-determined by its manufacturer? In fact, the intuition that this is impossible is correct if there is only one device. However, with two or more devices, this can be done, thanks to Bell's theorem. The basic idea is that if two devices are unable to communicate, are given random inputs and their input-output behavior gives rise to a distribution that violates a Bell inequality, then their outputs could not have been pre-determined and hence are a suitable starting point to generate a key. Because this idea is central to device-independence we will elaborate on it first before discussing DI-QKD protocols.</p>
        <p>Consider two parties, Alice and Bob, each of whom have a device. Alice and Bob are each able to make one of two inputs to their device and obtain one of two outputs. Quantum mechanically, these devices may be set up to measure halves of a pair of entangled qubits, with the inputs corresponding to the choice of basis. Crucially, although this may be what honest parties should do to set up their devices, for the security argument, no details of the setup are required. In order to describe the behavior of such devices we will use the following notation. Alice's input is modeled by a binary random variable A and Bob's by B and their respective outputs are binary random variables X and Y . It is convenient to use the following tables to represent the conditional distribution P XY |AB as a 4 × 4 matrix:</p>
        <p>Suppose now that Alice and Bob's devices behave according to a particular distribution P XY |AB and imagine an eavesdropper holding some additional information about the devices and for ease of this exposition, let us assume that this information is classical and use the random variable Z to describe it. This classical information tells Eve additional information about what is happening. One can think of this in the following way: Eve supplies devices that behave according to P z XY |AB , but picks z with probability p z such that from Alice and Bob's point of view the device behavior is the same, i.e.,</p>
        <p>If the devices are used in such a way that each device cannot access the input of the other then they must act in a local manner (P z X|AB = P z X|A and P z Y |AB = P z Y |B ). The question of interest is then whether Eve could have supplied deterministic devices giving rise to the observed distribution. This can be stated mathematically as the question whether P XY |AB can be written in the form (57) with P z XY |AB = P z X|A P z Y |B and P z X|A=a (x), P z Y |B=b (y) ∈ {0, 1} for all x, y, a, b ∈ {0, 1}. In other words, is P XY |AB a convex combination of the 16 local deterministic distributions</p>
        <p>If not, then at least some of the time Eve must be sending a distribution P z XY |AB to which she doesn't know either Alice's or Bob's outcome after later learning their inputs.</p>
        <p>A Bell inequality is a relation satisfied by all local correlations (i.e., all P XY |AB that can be written as a convex combination of local deterministic distributions). The CHSH inequality can be expressed in this notation as C, P ≤ 2, where</p>
        <p>and C, P = Tr(C T P ) is the Hilbert-Schmidt inner product. Bell's theorem states that there are quantum correlations that violate this inequality. To describe these we introduce a class of distributions parameterized in terms of ε ∈ [0, 1/2] as follows</p>
        <p>Define the state |ψ θ := cos θ 2 |0 + sin θ 2 |1 . Then assume that Alice and Bob measure the two halves of the maximally-entangled state 1 √ 2 (|00 + |11 ) in the following bases:</p>
        <p>This gives rise to a distribution of the form P ε as in Eq. ( 58) where</p>
        <p>which leads to C, P εQM = 2 √ 2, i.e., the maximal violation of the CHSH inequality. Recall that the Tsirelson's bound [151] states that if P is quantum-correlated then C, P ≤ 2 √ 2. One way to think about how random the outcomes are is to try to decompose this distribution in such a way as to maximize the local part. For 0 ≤ ε ≤ 1/8, this is achieved using the following decomposition whose optimality can be verified using a linear program</p>
        <p>If Eve used this decomposition she would be able to guess Alice's outcome with probability 8ε + 1 2 (1 -8ε) = 1 2 + 4ε. Thus, Alice's outcome would have some randomness with respect to Eve.</p>
        <p>We note however that while the first eight terms in this decomposition are local, the last is a maximally non-local distribution [152,153], often called a PR-box [154]. This is well-known not to be realizable in quantum theory. The stated strategy is hence not available to an eavesdropper limited by quantum mechanics. To analyze the case of a quantum-limited eavesdropper, we also have to ensure that P z XY |AB is quantum-realizable for all z. It is not easy to do this in general, but in the case where A, B, X and Y are binary it can be shown that it is sufficient to consider qubits [152]. For other cases, there is a series of increasingly tight outer approximations to the quantum set that can be tested for using semidefinite programs [155].</p>
        <p>Considering a quantum-limited eavesdropper reduces Eve's power and hence leads to more randomness in the outcomes. For a distribution of the form P ε for ε QM ≤ ε ≤ 1/8, for instance, Eve can do a quantum decomposition as follows:</p>
        <p>allowing her to predict the outcome correctly with probability 8</p>
        <p>ε-εQM</p>
        <p>The argument just given is intended to give an intuition to the idea of why violating a Bell inequality means that there is some randomness in the outcomes. However, knowing that there is some randomness is not enough; we also need to know how much key can be extracted from the raw data.</p>
        <p>Given a pair of uncharacterized devices we would like to know how much secure key we can extract from their outputs. Because the devices are uncharacterized, we need to test their behavior. Such a test involves repeatedly making random inputs to the devices and checking some function of the chosen inputs and the device outputs. For convenience, in this section we will mostly consider the average CHSH value. Conditioned on this test passing, the protocol will go on to extract key.</p>
        <p>We would like a statement that says that for any strategy of Eve the probability that both the average CHSH value is high and the key extraction fails is very small. For this to be the case we need to connect the CHSH value with the amount of extractable key. Since key is shared randomness, before considering sharing we can ask how much randomness can Alice extract from her outcomes for a given CHSH value. For a cq-state (i.e., a state of the form ρ AE = x P X (x)|x x| ⊗ ρ x E , where X denotes a string of many values), this can be quantified by the (smooth) min-entropy [74] S min (X|E) of Alice's string X conditioned on E. This is a difficult quantity to evaluate, in part because of the lack of structure. In fact, Eve's behavior need not be identical on every round and she need not make measurements round by round, but can keep her information quantum. However, a simpler round-by-round analysis in which the conditional von Neumann entropy is evaluated can be elevated to give bounds against the most general adversaries via the entropy accumulation theorem (EAT) [156,157]. The basic idea is that, provided the protocol proceeds in a sequential way, then the total min-entropy of the complete output of n rounds conditioned on E is (up to correction factors of order √ n) at least n times the conditional von Neumann entropy of one round evaluated over the average CHSH value.</p>
        <p>The evaluation of the conditional von Neumann entropy as a function of the CHSH value was done in [158]. There it was shown that for any density operator ρ ABE , if the observed distribution P XY |AB has CHSH value</p>
        <p>, then the conditional von Neumann entropy satisfies the bound</p>
        <p>where H 2 (...) is the binary Shannon entropy. Combining this with the EAT, we obtain a quantitative bound on the amount of uniform randomness that can be extracted from Alice's outcomes of roughly n times this.</p>
        <p>The bound (63) is obtained by using various technical tricks specific to the CHSH scenario. For general non-local games/device measurements we do not know of good ways to obtain tight bounds on the conditional von Neumann entropy. Instead, a typical way to obtain a bound is to note that S(X|E) ≥ S min (X|E), and that S min (X|E) can be bounded via a hierarchy of semidefinite programs [155,159], as discussed in [160,161]. However, the bounds obtained in this way are fairly loose and it is an open problem to find good ways to improve them. As mentioned in Section IV A, use of deviceindependence eliminate security flaws due to inadequate modeling of devices. There are nevertheless, a number of other assumptions we make in this scenario (note that these assumptions are also made in the trusted-devices case):</p>
        <p>1. Alice and Bob have secure laboratories and control over all channels connecting their laboratory with the outside world. (Without this assumption, the untrusted devices could simply broadcast their outputs to the adversary outside the laboratory, or Eve could send a probe into the laboratory to inspect any secret data.) For any devices in their labs, Alice and Bob can prevent unwanted information flow between it and any other devices.</p>
        <p>2. Each party has a reliable way to perform classical information processing.</p>
        <p>3. Alice and Bob can generate perfectly random (and private) bits within their own laboratories.</p>
        <p>4. Alice and Bob are connected by an authenticated classical channel on which an adversary could listen without detection.</p>
        <p>5. Alice and Bob are also connected by an insecure quantum channel on which an adversary can intercept and modify signals in any way allowed by quantum mechanics.</p>
        <p>Security is proven in a composable way (cf. Section II D) allowing a key output by the protocol to be used in an arbitrary application. Note that because the protocol is device-independent, the prolonged security of any output relies on the devices not being reused [162] in subsequent protocols (note that the same devices can be used many times within a run of the protocol), although modified protocols to mitigate this problem have been proposed [162].</p>
        <p>A protocol acts as a filter. It is a procedure that can be fed by a set of devices such that bad devices lead to an "abort" with high probability, and good devices lead to success with high probability. There are many possible types of protocol; we will describe a specific protocol here, based on the CHSH game with spot-checking.</p>
        <p>The protocol has parameters α ∈ (0, 1),</p>
        <p>), which are to be chosen by the users before it commences.</p>
        <p>1. Alice uses a preparation device to generate an entangled pair. She keeps one half and sends the other to Bob. This step and the subsequent one refer to the generation, sending and storage of an entangled state, but for security Alice and Bob do not rely on this taking place correctly (if the state created is not of high enough quality the protocol should abort).</p>
        <p>2. Bob stores it and reports its receipt to Alice.</p>
        <p>3. Alice picks a random bit T i , where T i = 0 with probability 1α and T i = 1 with probability α. She sends T i to Bob over the authenticated classical channel.</p>
        <p>4. If T i = 0 (corresponding to no test) then Alice and Bob each make some fixed inputs (choices of bases) into their devices, A i = 0 and B i = 2 and record the outcomes, X i and Y i .</p>
        <p>If T i = 1 (corresponding to a test) then Alice and Bob each independently pick uniformly random inputs A i ∈ {0, 1} and B i ∈ {0, 1} to their devices and record the outcomes, X i and Y i .</p>
        <p>5. Steps 1-4 are repeated n times, increasing i each time.</p>
        <p>6. For all the rounds with T i = 1, Bob sends his inputs and outputs to Alice who computes the average CHSH value (assigning +1 or -1 in accordance with the entries of matrix C). If this value is below βδ, Alice announces that the protocol aborts.</p>
        <p>7. If the protocol does not abort, Alice and Bob use the rounds with T i = 0 to generate a key using error correction and privacy amplification over the authenticated classical channel. The EAT tells them how much key can be extracted, subject to adjustments for the communicated error correction information.</p>
        <p>To explain the structure of the protocol it is helpful to think about an ideal implementation. In this, the preparation device generates a maximally entangled state 1 √ 2 (|00 + |11 ) and for A, B ∈ {0, 1} the measurements are as described in (59). Furthermore, for B = 2, the measurement is in the {|ψ 0 , |ψ π } basis, i.e., the same basis as for A = 0. If α is chosen to be small, on most of the rounds both parties measure in the {|0 , |1 } basis which should give perfectly correlated outcomes, suitable for key. However, on some of the rounds (those with T i = 1), a CHSH test is performed, in order to keep the devices honest. These are the spot-checks that give the protocol its name. The parameter β is the expected CHSH value of the setup (β = 2 √ 2 in the ideal implementation) and δ is some tolerance to statistical fluctuations.</p>
        <p>The probability that an ideal implementation with no eavesdropping leads to an abort is called the completeness error. Using the implementation given above, this occurs when statistical fluctuations cause devices with an expected CHSH value of β to produce a value below βδ. An ideal implementation behaves in an i.i.d. way and hence standard statistical bounds imply that the completeness error is exponentially small in the number of rounds.</p>
        <p>It is worth making some remarks about the protocol.</p>
        <p>1. It is important that the preparation device is unable to access information from Alice's measurement device, even though these may be in the same lab (if access were granted, the preparation device could send previous measurement results to Eve via the quantum channel).</p>
        <p>2. The choice T i needs to be communicated after the state is shared (otherwise Eve can choose whether to intercept and modify the quantum state depending on whether or not a test will be performed). This requires Alice and Bob to have a (short-lived) quantum memory; without such a memory, Alice and Bob could instead use some pre-shared randomness to make these choices and then consider the modified protocol to be one for key expansion.</p>
        <p>For reasonable parameter ranges, this would still lead to expansion, because α can be low and so a small amount of pre-shared key is needed to jointly choose the values of {T i }.</p>
        <p>3. Bob's device can tell when it is being used to generate key (B i = 2). Crucially though, Alice's device cannot (Alice's device learns only A i and not the value of T i ), and it is this that forces her device to behave honestly; not doing so will lead to her getting caught out if the round is a test. If Bob's device does not behave close enough to the way it should in the case B i = 2, then the protocol will abort during error correction step.</p>
        <p>There are many other possible protocols, but they follow the same basic idea of generating shared randomness while occasionally doing tests based on some non-local game, estimate the amount of min-entropy that any devices that pass the tests with high probability must give and then using classical protocols to eliminate errors and remove any information Eve may have through privacy amplification.</p>
        <p>Using violation of a Bell inequality as part of a key distribution protocol goes back to the Ekert protocol [80], and many device-independent protocols can be seen as a development of this. However, Ekert's work didn't envisage foregoing trust on the devices, and the idea behind this came many years later under the name of selfchecking [31]. The first protocol with a full security proof was that of Barrett, Hardy and Kent [32], and their protocol is even secure against eavesdroppers not limited by quantum theory, but by some hypothetical post-quantum theory, provided it is no-signalling. However, it has the drawback of a negligible key rate and the impracticality of needing as many devices as candidate entangled pairs to ensure all of the required no-signalling conditions are met. Following this were several works that developed protocols with reasonable key rates, proving security against restricted attacks [158,[163][164][165] with as many devices as candidate entangled states [101,160,166,167]. Later proofs avoided such restrictions [75,[168][169][170], but still were not able to tolerate reasonable levels of either noise or had poor rates (or both). Using the EAT [157] leads to a reasonable rate and noise tolerance [156], and better rates still can be derived from recent strengthened versions of the EAT [171].</p>
        <p>Although device-independence in principle allows for stronger security, adopting it in practice is more challenging than ordinary QKD. This is because it is difficult to generate correlations that violate a Bell inequality at large separations. Using photons is a natural way to quickly distribute entanglement. However, detecting single photons is difficult. In a device-dependent QKD protocol such as BB84, failed detection events slow down the generation of key, but it is possible to post-select on detection; in a device-independent protocol, below a certain detection threshold, no key can be securely generated. This is because post-selecting on detection events leads to the possibility that the post-selected events appear to be non-local when they are in fact not. To treat this problem, suppose that each detector detects a photon with probability η ∈ [0, 1]. A distribution of the form P ε from Eq. (58) will become</p>
        <p>where the third outcome corresponds to a no-detection event. Post-selecting on both detectors clicking recovers the distribution P ε , but it can be the case that P ε is not a convex combination of local deterministic distributions, but that P ε,η is. To avoid this, the experimental conditions need to be such that the distribution including no-click events has no deterministic decomposition.</p>
        <p>In the terminology of Bell experiments, this is referred to as closing the detection loophole. For the distribution P ε,η given above, this loophole is closed provided η &gt; 2/(3 -8ε). Note that for η ≤ 2/3 this cannot be satisfied for any ε. Hence, for protocols based on CHSH, 2/3 is a lower bound on the detection efficiency required. This is known as Eberhard's bound [172].</p>
        <p>Another loophole that is of interest for Bell experiments is the locality loophole, which is closed by doing measurements at space-like separation. The desire to close this loophole comes from a concern that the devices are able to talk to each other during the measurements, and, in particular, that one device is able to learn the measurement choice of the other, which makes it trivial to violate a Bell inequality in a classical deterministic way. It was a longstanding technical problem to simultaneously close the locality and detection loopholes, a feat that was only recently achieved [173][174][175]. In the context of DI-QKD, however, it is not necessary to close the locality loophole (although it does not hurt). The reason is that for QKD it is necessary that Alice's and Bob's lab are secure (Assumption 1 above). If their devices could communicate with each other during the measurements then this assumption is broken, and it makes little sense to allow communication between devices without allowing it from the devices to Eve.</p>
        <p>In DI-QKD one avoids the formulation of a mathematical model describing the devices involved in the experiment and aims at proving the security of the communication protocol only from the collected data. This is possible because only a purely quantum experiment can provide data that violate Bell inequalities. This approach is conceptually powerful but limited in terms of attainable key rates. Here we review the main ideas of measurement device independent (MDI) QKD [176,177]. This is a framework in which no assumptions is made on the detectors involved in the QKD protocols, which can be operated by a malicious eavesdropper. In a typical MDI-QKD protocol, both trusted users Alice and Bob send quantum signals to a central receiver (also called relay). The assumptions are that Alice and Bob have perfect control on the quantum state they prepare and send through the quantum channels. On the other hand, no assumption is made on the central relay, which can be under control of Eve. In this way one does not need to bother about the trustfulness of any detector or in general of any measurement device. Although at first sight it may seem impossible to extract any secrecy at all from such a scheme, it is indeed possible to exploit this MDI scheme to generate secret key at a nonzero rate.</p>
        <p>In a simple (idealized) scheme of MDI-QKD, Alice and Bob locally prepare single-photon states with either rectilinear {|H , |V } or diagonal {|D , |A } polarization. These states are sent to a central relay that is assumed under control of Eve. Notice that initially the states sent to Eve are statistically independent. Any possible physical transformation may affect the signals traveling through the quantum channels that connect Alice and Bob to the central relay. Also, Eve can apply any measurement on the received signals, or she can store them in a long term quantum memory. However, to explain the working principle of MDI-QKD let us assume for a moment that the channels from the trusted users to Eve are noiseless, and that Eve performs a Bell detection on the incoming signals. These assumptions will be relaxed later. Moreover, we require that Eve publicly announces the outcome α = 0, 1, 2, 3 of the Bell detection.</p>
        <p>The ideal Bell detection is a measurement with four POVM elements, Λ α := σ α |β β|σ α , where |β = 2 -1/2 (|HH + |V V ) is a maximally entangled state, and σ α are the Pauli operators (including the identity),</p>
        <p>Note that, if both Alice and Bob encode information in the rectilinear basis, then they know that their encoded bit values are the same if the outcome is α = 0 or α = 3, otherwise they know that they are opposite if α = 1 or α = 2. Therefore, Bob can obtain Alice's bit by flipping (or not flipping) his local bit according to the value of α. Similar is the situation if Alice and Bob use the diagonal basis, as depicted in Table I. If the parties choose different bases, they simply discard their data.</p>
        <p>The above example shows that the Bell detection performed by the relay can induce (or post-select) strong correlations between the bits locally prepared by the trusted While a noiseless communication channel and an ideal Bell detection do not introduce any error, noise in the communication channels and non-ideal Bell measurement introduce an error rate in this virtual communication channel connecting Alice and Bob. Standard parameter estimation procedures can then be applied to estimate the QBER and then provide a lower bound on the secret key rate. As a matter of fact Eve can apply any quantum operation at the relay, however she is expected to declare one value of α = 0, 1, 2, 3 for any pair of signals received, otherwise the trusted users will abort the protocol.</p>
        <p>To move from this abstract mathematical model towards experimental implementations, one shall replace single-photon states with phase-randomized attenuated coherent states. Moreover, with a linear optics implementation one can only realize two of the four POVM elements of Bell detection, this does not affect the working principle of MDI-QKD and has only the effect of introducing a non-deterministic element that reduces the secret key rate. In this context, a practical design for DV MDI-QKD has been proposed in Ref. [177], where it has been shown that it can be implemented using decoy states along the same methodology of the BB84 protocol. We remind that decoy states are crucial for DV QKD to overcome photon number splitting attacks that the eavesdropper can implement in realistic cases, where the signals emitter does not generate truly single photon states. In DV MDI-QKD, both Alice and Bob emits pulses randomly changing the intensity and revealing it, publicly, only after the quantum communication has been concluded. This avoid that Eve may adapt her attacks.</p>
        <p>In the protocol described in Ref. [177], the parties generate weak coherent pulses passing through two distinct polarization modulators, which operate randomly and independently. After this step, the signals are sent through two intensity modulators, which generate the decoy states. The protocol proceeds with the Bell measure-ment realized by the relay. The signals are mixed in a 50 : 50 beam splitter, and the outputs processed by two polarizing beam splitters (PBS), filtering the input photons into states |H or |V , and finally detected by two pairs of single-photon detectors. The Bell measurement is successful when two of the four detectors click.</p>
        <p>Assuming that the rectilinear basis is used to generate the key the asymptotic key rate is given by the following expression [</p>
        <p>where</p>
        <p>] is the joint probability that both emitters generate single-photon pulses, with µ A and µ B describing the intensities (or the mean photon number) of the photon sources of Alice and Bob, respectively. The quantity Y 11 rect gives the gain, while e 11 diag is the QBER when Alice and Bob correctly send singlephoton pulses. The function H 2 (x) is the binary Shannon entropy. The gain G rect and the QBER Q rect account for the cases where the parties sent more than one photon.</p>
        <p>In particular, δ(x) = f (x) H 2 (x) gives the leak of information from imperfect error correction, with f ≥ 1 being the efficiency of classical error correction codes.</p>
        <p>In ideal conditions of perfect transmission and perfect single photon sources, the key rate of Eq. ( 65) would be just the gain Y 11 rect . By contrast, assuming more realistic conditions the key rate is re-scaled by the probability P 11 rect and reduced subtracting a term proportional to information lost to perform privacy amplification [second term on the right-side of Eq. ( 65)], and error correction (third term). The security of decoy-state DV MDI-QKD, including finite-size effects, has been assessed in Ref. [178]. See also Refs. [179,180] for practical decoystate analyzes of the MDI-QKD protocol.</p>
        <p>The above example is a special case of a general approach that protect QKD from side-channel attacks on the measurement devices. In the more general framework introduced by Ref. [176], each honest user prepares a bipartite quantum state and sends one subsystem to the relay. The state received by the relay has thus the form ρ AA ′ ⊗ ρ B ′ B , where the system A, B are those retained by the Alice and Bob, respectively. A generic operation applied by the relay is described by a quantum instrument [181] characterized by a set of operators Λ z A ′ B ′ →E . This includes a measurement with outcome z and storage of information in a quantum memory E. If Eve applies the measurement and then announces the outcome z, for any given value of z the correlations between Alice, Bob, and Eve, are described by the tripartite state</p>
        <p>where</p>
        <p>AB is no more factorized and exhibits correlations between Alice and Bob. To extract secret bits from such a state Alice and Bob must apply local measurements to obtain a tri-partite classical-quantum state ρ z XEY for any given value of z. The asymptotic secret key rate is obtained from the expression of the mutual information between Alice and Bob averaged over z, I AB = z p(z)I(X; Y ) ρ z minus the average Holevo information between Alice and Eve, χ AE = z p(z)I(X; E) ρ z (in the case of direct reconciliation). The general approach of Ref. [176] not only provides a security proof for DV MDI-QKD schemes but also sets the basis for an extension to CV systems, later realized in Ref. [182].</p>
        <p>In the MDI-QKD protocol, the idea is to use a middle relay that may be untrusted, i.e., run by Eve. This is a very first step towards the end-to-end principle of networks which assumes a scenario with unreliable middle nodes. On the other hand, despite MDI-QKD employs a relay, it is not able to beat the PLOB bound for point-to-point QKD [33]. This limitation has been recently lifted by the introduction of a more efficient protocol called "twin-field" (TF) QKD [183]. The TF-QKD protocol has led to further theoretical investigations [184] and a number of TF-inspired variants, including the phase-matching (PM) protocol [185] (see also Ref. [186]), the "sending or not sending" (SNS) version of TF-QKD [187][188][189], recently improved into the active odd-parity pair (AOPP) protocol [190], and the nophase-postselected TF (NPPTF) protocol [191][192][193] (see also Refs. [194,195]).</p>
        <p>In the TF-QKD protocol, Alice and Bob send two phase-randomized optical fields (dim pulses) to the middle relay (Charlie/Eve) to produce a single-photon interference to be detected by a single-photon detector, whose outcomes are publicly declared. The term twin derives from the fact that the electromagnetic phases of the optical fields should be sufficiently close in order to interfere. More precisely, Alice and Bob send to the relay pulses whose intensity µ i (for i = A or B) is randomly selected between three possible values. Then, they respectively choose phases ψ A and ψ B as ψ i = (α i + β i + δ i ) ⊕ 2π, where α i ∈ {0, π} encodes a bit, β i ∈ {0, π/2} determines the basis, and the final term δ i is randomly selected from M slices of the interval [0, 2π), so that it takes one of the values 2πk/M for k = {0, 1..., M -1}.</p>
        <p>To ensure only phases close enough are selected, after disclosing on an authenticated channel, Alice and Bob only accept the same choices of the slice, i.e., the instances for δ A = δ B . These pulses interfere at the relay interfere constructively (or destructively). Then, Alice announces the basis she used β A and the intensity µ A for each instance. The key is extracted from the basis β A = β B = 0 and for one of the intensities. In fact, a bit α A can be shared between Alice and Bob by considering the absolute difference between α A and α B to be equal to 0 or π (depending on the relay's announcement). The rest of the results can be used for other purposes, including FIG. 3. Key rate of the TF-QKD protocol [183] versus Alice-Bob total distance in standard optical fiber (0.2 dB/km), assuming ideal (green line) and realistic (blue line) conditions.</p>
        <p>For the realistic key rate we assume 10 -8 dark count probability per detector, 75% loss at the relay, 50% detector efficiency, and error correction efficiency of 1.1. For the ideal key rate we consider no dark counts and perfect detector efficiency.</p>
        <p>For more details and other assumptions on these key rates see Ref. [183]. We also plot the point-to-point repeaterless PLOB bound [33] and the single-repeater bound [39,40]. We can see that the PLOB is violated, showing that the TF-QKD protocol is equivalent to an active repeater. At the same time, it cannot beat the secret-key capacity of an ideal repeater.</p>
        <p>estimating error rates as well as decoy-state parameters. Note that the twin pulses are in principle set by requiring δ A to be as close as possible to δ B , and the nonzero difference between them introduces an intrinsic QBER. The two become identical provided that M is infinitely large. Realistically, a finite but large value of M can be used though this decreases the probability of matching two phase slices. An estimation made in Ref. [183] gives the optimal value M = 16 with a QBER of ≈ 1.28%.</p>
        <p>In Ref. [183], the authors considered a restricted scenario where the 'global phase' does not leak any useful information to Eve, giving a key rate</p>
        <p>where R(•) is the secret key rate of an efficient BB84 protocol [196] with tagging argument [197], and µ, L are the intensity and the distance respectively. Later, Ref. [198] considered a collective attack where Eve makes use of identical beam splitters set along each path connecting Alice and Bob to the relay. While this attack considerably increases Eve's gain, the key rate scaling O( √ η) remains unchanged. As a matter of fact, using the TF-QKD protocol (and the PM-QKD protocol) over a communication line with total Alice-Bob's transmissivity η, not only is the PLOB bound beaten, but the rate performance is also not so far from the single-repeater bound of -log 2 (1 -√ η) [39,40]. See Fig. 3. Yet other variants of the TF-QKD protocol have been proposed [199][200][201] and experimental implementations have been carried out [202][203][204][205]. In particular, the proofof-concept experiment in Ref. [202] has recently overcome the PLOB bound for the first time, a result previously thought to be out of the reach of present technology.</p>
        <p>The original BB84 protocol requires perfect single photon sources which emit only one photon at a time. Since these sources are notoriously hard to build they have been replaced by coherent state sources which are heavily attenuated to a fraction of a photon per pulse. However, these sources lead to security concerns due to the probability to have more than a photon per pulse and a photon splitting attack has been proposed and demonstrated to exploit the wrong assumption in the security proofs. As described before a rigorous security [105,206] analysis has been proposed with the idea of estimating the ratio of secure signals from which the secure bits are distilled by post-processing. For practical sources the bounds found in the security analysis are not tight leading to a degradation of system performance. To circumvent this problem several novel protocols with different encoding schemes have been proposed and in the following sections we explain the development of their implementations in detail. Despite the different encoding schemes all DV QKD system have single photon detectors in common to detect the arriving states. To achieve high key rates high count rates and, thus, low dead times are necessary. Extremely long distances require however low dark count rates.</p>
        <p>At the receiver side the arriving photon pulses are processed by e.g. beam splitters, interferometers or a like to decode the information encoded in various degrees of freedoms. After optical processing the photons are detected by single photon detectors which set limits on the achievable performance.</p>
        <p>Indium Gallium Arsenide (InGaAs) avalanche photodiodes detect single photons by generating a strong electron avalanche at the absorption of a photon when operated with a reverse voltage above the breakdown voltage. However, the strong avalanche current can lead to trapped electron charges in defects. Spontaneously released they trigger a second avalanche pulse, a so-called afterpulse. A common approach to suppress the afterpulse is gating. To further suppress this afterpulse and to allow for gating frequencies beyond 1 GHz, a selfdifferentiating technique was introduced to detect much weaker avalanches [207]. Operating at -30 • C the APD was gated at 1.25 GHz, obtaining a count rate of 100 MHz with an detection efficiency of 10.8%, an afterpulse probability of about 6% and a dark count rate of about 3 kHz.</p>
        <p>To achieve higher quantum efficiencies and in particular lower dark count rates, superconducting nanowire single photon detectors (SNPDs) have been developed. They consist of a nanometer thick and hundreds of nanometer wide nanowire with a length of hundreds of micrometers. Compactly patterned in a meander structure they fill a square or circular area on the chip. The nanowire is cooled below its superconducting critical temperature and a bias current just below the superconducting critical current is applied. An incident photon breaks up Cooper pairs in the nanowire which lowers the superconducting critical current below the bias current which produces a measurable voltage pulse. A recent development [208] shows dark count rates of 0.1 Hz, low jitter of 26 ps and a quantum efficiency of 80 % at a temperature of 0.8 K. SNSPDs have been integrated into photonic circuits [209,210].</p>
        <p>As described before decoy state QKD severely increases security and distance for attenuated coherent laser pulse sources and is much more practical in comparison to single photon sources. The first implementation was performed in 2006 with one decoy state by modifying a commercial two-way idQuantique system [211]. In the two-way protocol with phase encoding Bob sent bright laser pulses to Alice who after attenuating them to the single photon level and applying a phase shift sent them back to Bob for measurement. The intensity of the pulses was randomly modulated by an acousto-optical modulator inserted into Alice's station to either signal state or decoy state level before sending the pulses back to Bob. Shortly later the same group implemented a two decoy state protocol with an additional vacuum state to detect the background and dark count detection probability [212].</p>
        <p>The demonstration of two-decoy states BB84 in a oneway QKD system was reported by three groups at the same time in 2007. In Ref. [213] phase encoding was employed and secure key generation was shown over a distance of 107 km using optical fiber on a spool in the lab. Including finite statistics in the parameter estimation, a secret key rate of 12 bit/s was achieved. To generate the decoy states pulses from a DFB laser diode at a repetition rate of 2.5 MHz were amplitude modulated with an amplitude modulator. For detection single-photon sensitive superconducting transition-edge detectors were employed.</p>
        <p>The second group demonstrated two-decoy state QKD over a 144 km free-space link with 35 dB attenuation between the canary islands La Palma and Tenerife [214].</p>
        <p>Here, the BB84 states were polarization encoded. Four 850 nm laser diodes oriented at 45 • relative to the neighbouring one were used in the transmitter. At a clock rate of 10 MHz one of them emitted a 2 ns pulse. The decoy states of high intensity were generated at random times by two laser diodes emitting a pulse at the same time, while for the vacuum state no pulse was emitted. The receiver performed polarization analysis using polarizing beam splitters and four avalanche photo detectors. A secure key rate of 12.8 bit/s was achieved.</p>
        <p>The third group used polarization encoding and demonstrated secret key generation over 102 km of fiber [215]. The transmitter consisted of 10 laser diodes each of which produced 1 ns pulses at the central wavelength of 1550 nm with a repetition rate of 2.5 MHz. Four laser diodes were used for signal and high intensity decoy state generation, respectively, using a polarization controller to transform the output polarization of a laser diode to the respective polarization of one of the four BB84 states. Two additional laser diodes were used for calibrating the two sets of polarization basis which was performed in a time multiplexed fashion. The outputs of the 10 laser diodes were routed to a single optical fiber using a network of multiple beam splitters and polarization beam splitters. An additional dense wavelength division multiplexing filter ensured that the wavelengths of the emitted photons was equal. The receiver consisted of two single photon detectors and a switch to randomly choose one polarization basis.</p>
        <p>Using advances in InGaAs avalanche photon detection (APD) operating in self-differencing mode [207] GHz clocked decoy state QKD was demonstrated in 2008 [216]. A self-differencing circuit can sense smaller avalanche charges thereby reducing after pulse probability and thus dead time. The demonstrated QKD system clocked at 1.036 GHz was based on a phase encoded GHz system implementing the BB84 protocol [217] and used two decoy states generated by an intensity modulator. Dispersion shifted single mode fiber was employed since for channel lengths over 65 km fiber chromatic dispersion must be compensated for in standard SMF28 single mode fiber.</p>
        <p>In the standard BB84 protocol Bob measures in the wrong basis 50 % of the time. Moreover, in decoy state BB84, it is advantageous to send the states with higher intensity more often than the others. To increase the usable signal generation rate an efficient version with asymmetric bases choice and highly unbalanced intensities was introduced, with an implementation reported in [218]. They prove the protocol's composable security for collective attacks and improved parameter estimation with a numerical optimization technique. Based on phase encoding the GHz system achieved a secure key rate of 1.09 MBit/s in contrast to 0.63 MBit/s for the standard protocol over 50 km of fiber. Its experimental implementation is depicted in Fig. 4a.</p>
        <p>Composable security against coherent attacks was only achieved recently. Ref. [219] describes an experiment demonstrating it with a modified two-way commercial plug-and-play QKD system where the authors also included imperfect state generation. Security against coherent attacks was furthermore demonstrated in [220] with a one-way phase-encoding system. With the latter system the authors achieved a distance in ultra-low loss fiber (0.18 dB/km) of 240 km. Using APDs with a detection efficiency of 10 % a dark count rate of 10 counts/s was achieved at -60 • C reached with a thermal-electrical cooler.</p>
        <p>The current distance record of 421 km ultra low loss optical fiber (0.17 dB/km) was achieved simplified BB84 scheme with a one-decoy state [221]. The distance record was achieved by optimizing the individual components and simplifying the protocol. The system was clocked at 2.5 GHz and used efficient superconducting detectors (about 50 %) with a dark count rate below 0.3 Hz. The protocol was based on a scheme with three states using time bin encoding. Two states were generated in the Z basis, a weak coherent pulse in the first or the second time bin, respectively. The third state, a state in the X basis, was a superposition of two pulses in both time bins. While the Z basis states were used to estimate the leaked information to the eavesdropper, the X basis state was used to generate the raw key. The experimental setup is shown in Fig. 4b.</p>
        <p>Differential phase shift QKD encodes information into the differential phase shift of two sequential pulses. The first QKD system employing this encoding technique was reported in 2004 over 20 km fiber [222]. A continuouswave laser diode from an external-cavity laser was intensity modulated at 1 GHz to carve 125 ps long pulses. Afterwards a phase modulator was used to modulate the phase of each pulse randomly by 0 or π. An attenuator attenuated the beam to 0.1 photon per pulse. At the receiver side the differential phase between two sequential pulses was measured with an unbalanced Mach-Zehnder interferometer. The incoming pulses were split 50:50 and before recombination at another 50:50 splitter, one arm was delayed by the interval of time between two pulses. The two outputs of the unbalanced Mach-Zehnder interferometer were detected by gated avalanche single photon detectors. The Mach-Zehnder interferometer was as waveguides and the arm length difference could be controlled thermally.</p>
        <p>Using superconducting single photon detectors and a 10 GHz clock frequency keys were distributed over 200 km dispersion shifted fiber [223]. In a different experiment, a secure bit rate in the MBit/s range was achieved over 10 km by using a 2 GHz pulse train with 70 ps long pulses [224]. At the receiver after the unbalanced Mach-Zehnder interferometer the photons were upconverted in a nonlinear process and detected by a Silicon avalanche photo diode which enabled count rates of 10 MHz with a low timing jitter.</p>
        <p>High-rates of 24 kbit/s over 100 km were achieved using 2 GHz sinusoidally gated avalanche photo diodes and the important influence of laser phase noise has been studied [225]. Using a Michelson interferometer with unequal arm length based on a beam splitter and two Faraday mirrors and superconducting detectors at the receiver the maximum transmission distance has been boosted to 260 km in standard telecom fiber [226]. Its experimental implementation is depicted in Fig. 4c.</p>
        <p>The DPS-QKD protocol has been tested in the Tokyo QKD network [227,228].</p>
        <p>The first proof-of-principle implementation of the COW protocol has been reported in 2005 [229]. A 1550 nm continuous-wave laser beam was intensity modulated to generate the quantum or decoy states and a variable attenuator attenuates the beam to the single photon level. Bits were encoded into arrival time by two consecutive pulses: A vacuum state followed by a coherent state represented bit 0, a coherent state followed by a vacuum state represented bit 1. The decoy state was represented by two coherent states. On the receiver side the beam was split by a tap coupler (tapping e.g. 10 %). While the highly transmittive output was detected by a single photon detector, the tap was injected into an interferometer with asymmetric arms which interfered the two pulses. One output of the interferometer was measured by a single photon detector and the measurement outcomes were used to calculate the visibility to check channel disturbances. The unbalanced interferometer was implemented as Michelson interferometer by using a 3 dB coupler and two Faraday mirrors.</p>
        <p>Running at a high clock speed of 625 MHz a fully automated system was built and demonstrated over 150 km in deployed telecom fiber [230]. The high clock speed was reached with a continuous-wave distributed fiber-Bragg telecom laser diode, a 10 GHz Lithium Niobate intensity modulator and Peltier cooled InGaAs avalanche photo diodes in free-running mode for short distances and SNSPDs operating at sub-4 K with lower noise for long distances. Synchronization was achieved by wavelength division multiplexing of a synchronization channel and a classical communication channel through a second optical fiber. Using ultra-low loss fibers and low-noise superconducting detector operating at 2.5 K a distance of 250 km was reached [231]. While the previous implementations all used an asymptotic security proof finite-size effects were taken into consideration in the implementation described in 2014 [232] which reached 21 kbit per second over 25 km fiber with gated InGaAs detectors and a key distillation in FPGAs. Here, the COW QKD system was tested with one single optical fiber only using dense-wavelength division multiplexing for quantum and all classical channels.</p>
        <p>The distance record of a system implementing the coherent one-way protocol was reported in 2015 [233] reaching 307 km. Novel free-running InGaAs/InP negative feedback avalanche detectors operated at 153 K with low background noise (few dark counts per second) and low loss optical fibers as well as a novel composable finite-key size security analysis enabled the result. The experimental implementation is schematically depicted in Fig. 4d.</p>
        <p>DV MDI-QKD was first experimentally demonstrated in 2013 by three groups. The first group implemented MDI-QKD between three locations in Calgary with a distance of about 12 km between Alice and the untrusted relay Charlie and about 6 km between Bob and Charlie [234]. Alice's and Bob's transmitter generated timebin qubits at a rate of 2 MHz using an attenuated pulsed laser at 1552 nm and an intensity and phase modulator. The generated states were chosen by Alice and Bob independently from the set</p>
        <p>By choosing between three intensity levels, vacuum, a decoy state level and a signal state level, the decoy state protocol was implemented. Both transmitters were synchronized by a master clock located at Charlie which was optically transmitted to the respective stations through another deployed fiber. After receiving the photons Charlie performed a Bell state measurement by superimposing the pulses at a balanced beam splitter and detecting the outputs with gated In-GaAs single photon detectors with 10 µs dead time. If the two detectors coincidentally clicked within 1.4 ns the states were projected into a Bell state. Those instances were publicly announced by Charlie.</p>
        <p>The second group implemented the protocol over 50 km in the lab [235]. They implemented a similar qubit time-bin encoding scheme as in the Calgary experiment, but used four decoy intensity levels with 0, 0.1, 0.2 and 0.5 photons per pulse on average. A pulsed laser was fed through an unbalanced Mach-Zehnder interferometer to generate two time-bin pulses. The encoding of qubits and decoy were implemented with three amplitude and one phase modulator situated in a thermostatic container for stability reasons. After traveling through 25 km of fiber the untrusted relay Charlie performed a Bell state measurement identically to described above. The employed photo detectors used an upconversion technique where a nonlinear process in periodically poled lithium niobate converted the 1550 nm photons to 862 nm detected by Silicon avalanche photo detectors with a dark count rate of 1 kHz.</p>
        <p>The third implementation [236] was a proof-ofprinciple demonstration based on polarization qubits instead and demonstrated MDI-QKD over 8.5 km long fiber links between the two trusted parties and the relay. Using a continuous wave laser pulses were carved with an amplitude modulator. The decoy state levels were chosen by variable optical attenuators and the polarization encoding was performed with an automatic polarization controller. The relay was built from a balanced beam splitter and two polarization beam splitters. Four gated InGaAs avalanche single photon detectors with a dark count probability of 15 ppm and 10 µs dead time de- [218]. A laser diode emitted pulses at 1550 nm which were intensity modulated (IM) to generate the different intensity of the states. An unbalanced Mach-Zehnder interferometer with a phase modulator (PM) in one arm was used to generate the different BB84 states, i.e. 0 and π for the Z basis and π/2 and 3π/2 for the X basis. After attenuation to the single photon level with a variable attenuator (VA), the states were transmitted through a fiber. At Bob's side decoding was performed with an identical Mach-Zehnder interferometer and a PM either set to 0 or π. A fiber stretcher (FS) matched the two interferometers. The detection unit (DU) consisted of two InGaAs APDs. BS: Beam Splitter, PBS: Polarizing Beam Splitter, OPM: Optical Power Meter, PC: Polarization Controller. b) Simplified one-decoy state BB84 protocol with three states implemented over 421 km [221]. Alice uses a phase randomized laser pulse with a repetition rate of 2.5 GHz which is tightly bandpass filtered around 1550 nm. The pulses pass through an unbalanced Michelson interferometer with 200 ps delay made of beam splitter and two Faraday mirrors (FM) and a piezo in one of the arms to control the phase, to enable time bin encoding. Afterwards the pulses are intensity modulated (IM) to generate the different qubit states. After dispersion compensation (DCF) and attenuation to the single photon level (variable attenuator: VA), the pulses are transmitted through an ultra-low-loss (ULL) fiber. To implement the different bases choices at Bob's station the pulses are split with a beam splitter. One of its outputs is directly detected with an SNSPD, measuring the arrival time in Z basis which is used for the raw key. The other is used to measure the X basis by passing the pulses through an unbalanced interferometer identical to Alice's. This measurement is used to estimate the eavesdropper information. c) Implementation of the differential phase shift protocol reported in [226] over 260 km with a rate of 2 GHz. A continuous wave (CW) laser at 1560 nm is chopped into pulses with an intensity modulator (IM). A phase modulator then randomly applies a π/2 or -π/2 phase shift on the pulses before they are attenuated to the single photon level. The pulses are then transmitted through standard telecom fiber (STF). At Bob's side the encoded information is decoded by a Faraday Michelson interferometer (FMI) which interferes a pulse with the one before and after it. The two outputs of the interferometer were detected by superconducting single photon detectors (SSPD). TDC: time to digit converter. d) Coherent one-way protocol implementation over 307 km with a repetition rate of 625 MHz reported in [233]. Pulses were carved into a continuous wave laser beam at 1550 nm using two different intensities to encode bits using consecutive time bins. After attenuating to the single photon level the pulses were sent through an ultra-low loss (ULL) single mode fiber (SMF). Bob's receiver is similar to the receiver described in b).</p>
        <p>tected their output.</p>
        <p>The distance of MDI-QKD was then boosted to 200 km [237] and 404 km [238] using ultra-low loss fiber with an attenuation of 0.16 dB/km. To achieve such a large communication length of 404 km the MDI-QKD protocol was optimized to improve on the effects of statistical fluctuations on the estimation of crucial security parameters. The protocol consisted of four decoy states with three levels in the X basis and only one in the Z basis. The probabilities for each was carefully optimized to obtain largest key rate. Five intensity modulators and one phase modulator was employed to implement those. The receiver was implemented in the same way as described above for the first two experiments. Superconducting single photon detectors improved the quantum efficiency (about 65%) and dark count rate (30 Hz). Furthermore to achieve 404 km in the order of 10 14 successful transmissions were recorded which took with a clock rate of 75 MHz over 3 months. The achieved secret key rate was 3.2 × 10 -4 bits per second.</p>
        <p>Furthermore at zero transmission distance a secret key rate of 1.6 MBit/s was reached [239] by introducing a pulsed laser seeding technique to achieve indistinguishable laser pulses at 1 GHz repetition rate. The new technique where a master laser pulse is injected into a slave laser as a seed to trigger stimulated emission at a defined time yielded very low timing jitter and close-to-transform limited pulses.</p>
        <p>To demonstrate MDI-QKD over quantum networks in star topology extending over 100 km distance, cost-effective and commercially available hardware was used to build a robust MDI-QKD system based on time-bin encoding [240]. Similar plug and play systems with timebin or polarization encoding and different level of immunity against environmental disturbances have been implemented as well in other groups [241][242][243][244][245].</p>
        <p>F. High-dimensional QKD Most discrete variable (DV) QKD schemes encode quantum states in qubits (d = 2), such as the polarization states used in the first QKD experiment [246]. Going back to the early 2000s, there has been considerable interest in developing large-alphabet DV QKD schemes that encode photons into qudits: high-dimensional basis states with d &gt; 2. Such schemes offer the ability to encode multiple (log 2 d) bits of information in each photon. This benefit is not without a drawback; the information density per mode decreases as (log 2 d)/d. Nevertheless, high-dimensional QKD (HD QKD) can offer major advantages over their qubit counterparts.</p>
        <p>HD QKD can increase the effective secret key generation rate when this rate is limited by the bandwidth mismatch between the transmitter and the receiver. This mismatch happens when either the transmitter is limited to a flux below the available receiver bandwidth or the single-photon detector is saturated by the high photon flux received. While the former does not typically occur with attenuated laser source, the latter often arises due to detector dead time. In a superconducting nanowire single photon detector (SNSPD), the dead time is dominated by the time it takes to recover its supercurrent (which flows with zero resistance)-during which the nanowire is insensitive to any photon [247].</p>
        <p>Fig. 5 shows a representative plot of qubit-based DV QKD secret key rate versus distance for currently achievable parameters. Three distinct regimes are apparent: regime II denotes normal operation where the secret key rate scales as the transmissivity in the fiber, which decays exponentially with distance. At longer distances, we enter regime III where the received photon rate is comparable to the detectors' background rate-masking any correlation between the key-generating parties and abruptly reducing the secret key rate. However, at short distances with low photon loss (regime I with distances up to ∼ 100 km), the secret key rate is limited due to the detector dead time. The highest QKD key rate is achieved in this regime and it currently amounts to 13.72 Mb/s [248]. To increase this key rate further, more detectors could be added so to distribute the initial intensity among them. Another strategy would be increasing the dimensionality of the alphabet to reduce the transmitted photon rate until the detectors are just below saturation. To date, multiple degrees of freedom have been investigated for high-dimensional QKD, including position-momentum [249], temporal-spectral [250][251][252][253][254][255], and orbital angular momentum (OAM) [256][257][258]. Initial security analysis by Cerf et al. for discrete largealphabet QKD showed improved resilience against noise and loss [259]. HD QKD with discrete quantum states is capable of tolerating error rates than the 11% limit for qubit-based protocols. However, the proposed scheme with its two early proposals-one using OAM and another using temporal-spectral encoding-was challenging to demonstrate. The main difficulty lies in the measurement of discrete high-dimensional states within at least two mutually unbiased bases. Efficient implementation of the scheme for the two proposed degrees of freedom required single-photon detectors that scale with the dimensionality d-prohibiting the use of large d. Therefore, there has been a strong desire in developing HD QKD schemes with the ability to measure higher-order correlations using only a few single photon detectors.</p>
        <p>One detector-efficient temporal scheme-borrowing techniques from continuous variable (CV) QKD and applying them to the temporal-spectral modedemonstrated QKD operations with an extremely high alphabet of d = 1278, i.e., over 10 bits per photon [255]. However, no security proof against collective or coherent attacks was available at the time. The challenge is that time and energy states are not inherently discrete, but rather they form a continuous basis. Therefore, the security proof on discrete dimensional bases do not transfer directly to these continuous-basis schemes. Considerable effort was made to extend the proofs for CV QKD to HD QKD by realizing that the security of temporal-spectral HD QKD can be guaranteed by measuring the covariance matrices between Alice's and Bob's information.</p>
        <p>Measuring the covariance matrices involves detection in the frequency basis. Direct spectral detection of the incoming light can be done using a single-photon-limited spectrometer: a spectral grating followed by d single photon detectors. However, the required number of detectors would again prevent reaching a large dimensionality. To work around these limitations, new techniques were introduced to convert the spectral information to time information by using group-velocity dispersion [260], Franson interferometers [261], or a time-varying series of phase shifts [253].</p>
        <p>The development of temporal-spectral encoded HD QKD spurred record demonstrations of secret key capacity at 7.4 secret bits per detected photon [262] and secret key generation rates of 23 Mbps [263] and 26.2 Mbps [264] with d = 16 at 0.1 dB loss and d = 4 at 4 dB induced loss, respectively. Furthermore, a 43-km (12.7 dB loss) field demonstration between two different cities show a maximum secret key generation rate of 1.2 Mbps [263]. Since HD QKD is vulnerable against photon number splitting attacks as it relies on transmission of single photons, these demonstrations make use of decoy state techniques to close this security loophole [265]. More recently, the security of temporal-spectral HD QKD has been extended to include the composable security framework, which takes into account statistical fluctuations in estimating parameters through only a finite number of measurements [266,267].</p>
        <p>High-dimensional QKD with OAM has also witnessed rapid development due as it is directly compatible with free-space QKD systems [268]. Since OAM modes rely on the preparation and the measurement of discrete highdimensional states, the security proofs extend directly from the work by Cerf et al. Recently, the security proof has also been successfully extended to include finite-key analysis for composable security [269].</p>
        <p>A photon carrying an OAM information has a helical or twisted wave front with an azimuthal phase ϕ which wraps around ℓ (helicity) times per wavelength. For the popular Laguerre-Gauss mode, a photon carrying an ℓ OAM can be described as |Ψ ℓ Z = e iℓϕ . ℓ is an unbounded integer, which allows arbitrarily high encoding dimension, but practically one limits ℓ ∈ [-L, L] to achieve a dimensionality d = 2L+1. A mutually unbiased basis set can be constructed using a linear combination of OAM modes</p>
        <p>Both sets of quantum states can be generated using a spatial light modulator (SLM) [270], a digital micro-mirror device (DMD) [271], or a tunable liquid crystal device known as q-plates [272,273].</p>
        <p>The first laboratory demonstration of highdimensional OAM QKD achieved a secret key gen-eration rate of 2.05 bits per sifted photon using a seven-dimensional alphabet (L = 3 and d = 7) [257]. More recently, a 300-m free-space field demonstration in Ottawa with four-dimensional quantum states achieved 0.65 bits per detected photon with an error rate of 11%: well below the QKD error rate threshold for d = 4 at 18% [256]. Although moderate turbulence was present during the experiment, going to longer distances will require active turbulence monitoring and compensation [274].</p>
        <p>The main challenge in high-dimensional OAM QKD towards achieving a high secret key generation rate is the relatively low switching speed of the encoding and decoding devices when compared to the multi-gigahertzbandwidth electro-optic modulators used in time-bin encoded high-dimensional QKD. QKD demonstrations involving SLM, DMD, and q-plates so far have required a time in the order of 1 ms to reconfigure-limiting the QKD clock rate in the kHz regime. While q-plates can potentially be operated at GHz rates by using electrooptic tuning, these have yet to be demonstrated [275]. One appealing new direction is the use of photonic integrated circuits (PICs), which may dramatically reduce the configuration time. Thermo-optically tuned on-chip ring resonators have demonstrated a switching time of 20 µs [276,277]. More recently, precise control of OAM mode generation has been demonstrated using a 16 × 16 optical phase array which allows for generation of higher fidelity OAM states [278]. Furthermore, large scale onchip MEMS-actuation has also been demonstrated with a switching time of 2.5 µs with the potential of application to OAM generation and control [279].</p>
        <p>Demonstrations of HD QKD using a single set of conjugate photonic degrees of freedom, such as time-energy or OAM, to increase the secret key generation rate have been successful. Investigation in new techniques, which include the miniaturized photonic integrated circuit platform (see Sec. V G), to manipulate and detect multiple degrees of freedom simultaneously can dramatically increase the dimensionality that would improve the secret key rate even further. Moreover, a more detailed study into the choices of degrees of freedom and the choice of mutually unbiased bases can shed light into which means of encoding is most robust for the different QKD settings. For example, it has been hinted that the Laguerre-Gauss OAM modes show greater resilience to cross talk in turbulent environments than the Hermite-Gaussian OAM modes [280]. With the potential of high-dimensional QKD systems generating secret keys at rates commensurate to those of data communication rates, further study into HD QKD in a measurement-device-independent configuration is warranted.</p>
        <p>QKD devices have more demanding requirements than those offered by standard off-the-shelf telecommunica-tion equipments. QKD transmitter needs single photon sources or weak coherent sources modulated at an extremely high (≥ 20 dB) extinction ratio for low-error QKD operations. Furthermore, quantum-limited detectors such as single photon detectors or shot-noise limited homodyne detectors are also required on the receiver side.</p>
        <p>Photonic integrated circuits (PICs) provide a compact and stable platform for the integration of multiple highspeed quantum photonic operations into a single compact monolithic circuit. PICs allow experimentalists to engineer quantum devices in the different material platforms at lithographic precision to meet the stringent requirements of QKD devices. The amount of complexity that can be achieved with PICs has been shown to enable practical implementation of wavelength multiplexing for higher secret key rates [281,282], multi-protocol operations for flexibility [283], and additional monitoring and compensation capabilities against timing and polarization drifts in the channel [284]. Various material platforms have been explored for building high-performance QKD devices-each with its own strengths and weaknesses. (See [285] for further discussion of the different material platforms.)</p>
        <p>Active III-V laser materials, such as indium phosphide (InP), is a promising platform for QKD transmitters because of the availability of gain laser medium for producing weak coherent light [286]. The InP platform also has the advantage of building quantum well structures using other ternary and quaternary III-V semiconductors that are lattice-matched to InP, such as InGaAs, InGaAsP, or InAlAsP [287]. Within these quantum wells, carrierselectrons and holes-are confined within the resulting one-dimensional potential wells. Applying electric field to the well shifts the energies of the carriers, which in turn changes its absorption spectrum and its refractive index shift. This process, named Quantum-confined Stark effect (QCSE) [288], is the strongest electro-optic modulation available in the platform-albeit with the undesirable phase-dependent loss. Intensity and phase modulation with QCSE has been demonstrated to achieve high extinction ratio beyond 50 dB at bandwidths ≥ 40 GHz [289].</p>
        <p>The SiO 2 -Si 3 N 4 TriPleX technology has record low loss passive components at ∼ 10 -4 dB/cm [290] which makes it an attractive platform for time-based or phasebased QKD receiver components in high-speed gigahertzclocked QKD operations, where Bob has to interfere weak coherent pulses spaced by ∼ 1 ns. The combination of low propagation loss and high interference visibility and stability can enable Bob to maintain low error-rate QKD operations without sophisticated stabilization circuitry typically required for fiber-based or bulk optical interferometers [283]. The TriPleX platform, however, relies solely on thermo-optic phase modulation which is slow (with ∼MHz bandwidth) for high-speed QKD operations.</p>
        <p>Silicon photonics recently has gained traction as the leading platform for quantum communications with the promise of its high density integration with the exist-ing complementary metal-oxide-semiconductor (CMOS) processes that have enabled monolithic integration of both photonic and electronic components. With no natural electro-optic nonlinearity, silicon photonics rely on the slow thermo-optic phase modulation [291] to achieve high-visibility interference [292]. Carrier injection and depletion within an intrinsic region between p-doped and n-doped silicon offer high-speed modulation within silicon photonics, but with a phase-dependent loss that must be mitigated [293,294]. Recently, MEMS-based phase shifters have shown great promise in miniaturizing the device further, in lowering the power consumption, and in achieving gigahertz-bandwidth phase shifts without the undesirable phase-dependent loss [295].</p>
        <p>While the development of a fully integrated light source within the silicon photonics platform is still underway, the platform has been proven to be highly amenable to heterogeneous bonding of the active III-V materials mentioned above [296][297][298][299][300]. Moreover, superconducting nanowire single photon detectors (SNSPDs) have been integrated into silicon photonics using a pick-and-place method, paving the way for a possible monolithic compact QKD receiver with single photon counting capabilities [301]. Quantum-limited homodyne detectors have also been demonstrated with sufficiently large noise clearance between shot noise and electronic noise that can be useful for CV QKD applications [302,303].</p>
        <p>A recent demonstration of QKD with PIC uses an InP transmitter to leverage its on-chip source capability and a TriPleX to leverage its low-loss performance. The experiment showcased PIC's flexibility in being able to demonstrate multiple time-bin encoded protocols using the same chip set at a clock rate of one GHz [283]. More recently, recent demonstrations of time-bin and polarization QKD transmitters in silicon photonics with further miniaturized components hinted at possible performance advantage over off-the-shelf fiber optical components with LiNbO 3 -based modulators [305,306]. Silicon photonics recently proved possible QKD operations using polarization encoding over a 43-km intercity fiber link which was commonly thought too unstable because of fiber polarization drifts [284]. The experiment demonstrated secret-key rate generation comparable to stateof-the-art time-bin demonstrations but with polarization stabilization capabilities. See Fig. 6.</p>
        <p>The PIC platform also offers new methods of generating quantum sources of light: single photons and entangled photon sources. While weak coherent light is currently the most popular approach for QKD operations, its Poissonian statistics create side-channel vulnerability that must be closed with decoy state approaches [106][107][108][109][110]. QKD with true single photons or entangled photons can circumvent this problem without needing decoy state protocols [28], which consume random bits. In the InP platform, single photons can be generated from quantum dots that are grown epitaxially to emit light in the standard telecom 1550 nm window. In silicon photonics, onchip entangled pair sources based on spontaneous four- wave mixing (SFWM) have been demonstrated without the need of any off-chip filtering [307,308].</p>
        <p>One important challenge that remains in these novel quantum sources is in increasing the brightness to be sufficient for gigahertz-clocked QKD operations. Currently, the amount of output flux of these quantum sources has been limited at ∼ 10 MHz even at near unity collection efficiency [309,310]. These quantum sources are typically pumped using a coherent laser. Increasing the pump power of the quantum dot sources induces multi-photon emissions which degrade the single photon purity. However, alternative schemes of excitation have shown great promise of reducing the probability of multi-photon emissions by several orders of magnitude [311]. Increasing the pump power of the entangled SFWM sources has been shown to induce two-photon absorption which saturates the source brightness [312].</p>
        <p>Integrated photonics is poised to deliver major benefits towards building QKD networks. The miniaturization of devices coupled with highly robust manufacturing processes can accelerate the adoption of QKD for real-world data encryption, especially with the MDI configuration. In this setting, only several central receiver nodes need to have cryogenic high-efficiency SNSPDs [313], while all the clients can make use of personal PICs to generate secret keys among each other. The lithographic precision afforded by the platform also promises the possibility of identical integrated light sources for MDI QKD [304,314].</p>
        <p>In conclusion, PIC presents a novel opportunity to design new devices that meet the needs of low-error QKD operations. Investigations into new device physics through heterogeneous integration of the multiple platforms can enable the development of new quantum sources and receivers with superior performance [315]. Furthermore, PIC's phase stable platform also lends itself to highly-dense-multiplexed QKD operations, which can dramatically increase the secret-key generation rate.</p>
        <p>The quantum communication protocols on which QKD is based are very well suited to be applied in space. Space channels, in connection with ground single-links and networks, may be exploited in a number of scenarios embracing the entire planet Earth, the satellite networks around it and novel and more ambitious projects aimed at more distant links with the Moon or other planets. In the context of an evolving society that leverage more and more on secure communications, space is expected to play a crucial role in quantum communications as it is now playing for global communication, navigation and positioning, time distribution, imaging and sensoring, realized by several generation of satellites.</p>
        <p>The extension of the QKD to secure links to long distance, to connect nodes of networks spanning large scales, including national, continental, planetary as well as space missions, was devised in feasibility studies more than a decade ago [323][324][325][326][327]. The extension to space of quantum communications (QC) was initially proposed in combination with experiments devoted to testing fundamental principles and resources of quantum information in the novel space context. Some of these were directed to the development of a payload for the International Space Station (ISS) [328,329], others as standalone satellites [324].</p>
        <p>These proposals were supported by the early evidence of long distance free-space QC experiments on the ground [330][331][332]. In this way it was proved that significant portion of atmosphere paths were suitable not only for classical optical communications but also for the quantum one. Indeed, the degrading role of the atmosphere on the channel performances was already assessed in terms of beam widening and wandering, fading of signal and scintillation at the receiver as a function of the turbulence level, wavelength and link length [333,334]. However, the single photon discrimination at the correct wavelength, arrival time and direction as well as the detection with an effective rejection of the background noise is more demanding than the classical counterpart.</p>
        <p>Starting in 2003 with an experimental campaign at the Matera Laser Ranging Observatory (Italy), it was possible to demonstrate that the exchange of single photons are suitably achievable between a LEO satellite and the ground [335]. In this case, even without an active photon source in orbit, the demonstration was obtained by exploiting satellites equipped with optical retroreflectors, and directing to them a train of pulses with calibrated energy such that the collected portion that is retroreflected back toward the transmitter on the Earth is a coherent state with a content of a single photon or less. A suitable bidirectional telescope on the ground allows for the transmission of the uplink train of pulses and of the single photons in downlink. This technique was then extended to demonstrate QC using different degrees of freedom, as later discussed [336,337] and is a candidate for QKD with a very compact payload [336].</p>
        <p>The application of space QC for a global QKD was considered since the beginning as an effective solution to joint separate networks of fibre-based ground links. Indeed, the key exchange between a trusted satellite and two ground terminals may then be used to generate a secure key between the two terminals via one-time pad. Despite these attracting opportunities for the improvement of secure communications on ground, as well as other that have been conceived for the use in space (described below), the realization of a satellite for QKD was kept on hold in Europe and USA and found at the beginning of this decade a concrete interest in Asia. More in detail China and Japan put in their roadmaps the demonstration of the space QKD with ambitious but concrete plans to develop and launch satellites for QC. The Japanese SOTA satellite was indeed launched in 2014 and Chinese Micius in 2015, as will be described below. The perspective of using a very compact payloads as nanosat o cubesat has recently vamped the European initiatives, spurring for the development of space components of great efficiency and small dimension [338,339]. Such direction is expected to be beneficial for the ground QKD as well, for the realization of high performance small components to be used in compact and power-saving QKD terminals on ground networks.</p>
        <p>The type of key exchange provided by an orbiting terminal changes significantly with the type of orbit. The altitude has relevant implications in the losses of the optical link. Although the possible configuration of a space QKD setup could use the transmitter in both the space terminal (downlink of the qubits) and the ground terminal (uplink), the detrimental impact of the atmosphere is asymmetric. Indeed in the uplink, the propagation of the wavefront associated to the qubit stream in the turbulent atmosphere occurs at the beginning of the path. This induce a non uniform modulation of the wavefront phase. The subsequent propagation results in the development of an amplitude modulation at the satellite altitude, with a significant beam diameter broadening and a scintillation that causes a fluctuation of the link transmissivity. On the contrary, in the downlink the propagation of the qubit train occurs in vacuum and get degraded by the atmosphere only in the final portion, with an exponential air density increase within the last 10 km. The broadening of the beam at the receiving terminal is then mainly due to the diffraction and the scintillation is also reduced. Therefore the downlink is the common configuration, and the subsequent analysis will be referred to it.</p>
        <p>The evaluation of the QKD rate in a space link is based on the analysis of the losses and the fluctuations of the corresponding optical channel. From classical studies in satellite optical communications [334], we know that the geometric losses (namely the losses due to diffraction) may be modeled considering, at the transmitter, a Gaussian beam with waist w 0 passing through a telescope aperture of diameter D. The far-field distribution at distance d ≫ D, can be written in terms of the coordinates (x, y) of the plane transverse to propagation as</p>
        <p>where a = 2w 0 /D is the ratio between the beam waist and the Tx aperture radius. As first obtained by Siegman, to optimize the received power it is necessary to choose a ≃ 0.89 for classical communication. However, for QKD we may use different values if we consider the single-photon regime after the Tx aperture. By using a ≃ 2 we obtain in the far-field (at distance d from the transmitter) a beam which is well-approximated by a Gaussian beam with radius w(d) ≃ 0.9 λ D d. The total losses of the channel is evaluated in dB as ≃ -10 log 10 In Fig. 7 we show the expected losses with a selection of significant wavelengths and telescope diameters as a function of the terminal separation. The range of losses is radically different according to the orbit altitude, conditioning the possible applications. In the classification below, we discuss the roles played by the different satellites and types of orbits for the purpose of QC.</p>
        <p>This type of orbit, reaching not above the altitude of 2000 km, was the first choice to demonstrate QC protocols from space. This is because of the relative ease to reach the orbit with multiple launcher options combined with the lower exposition to the aggressive ionizing radiation affecting higher altitudes. The rapid round-trip time around Earth of about one to two hours combined with a wide selection of orbit inclinations, open possibilities so as to cover all the planet in hours with a single sat or to maintain a constant position relative to the Sun. Among the limitations of LEO there is the fact that the passage over a ground terminal is limited to just a few minutes of effective link, whereas the sat is above the 10 degrees of elevation from the horizon. Moreover, satellite speed relative to ground may reach 7 km/s for a 400-km orbit, like that of the ISS, which causes a varying Doppler shift of the order of tens of GHz.</p>
        <p>LEO sats for QKD were the first to be considered [328,340], initially as payload to be operated on the ISS for six months to one year, and then as independent spacecrafts. Ajisai, a LEO sat devoted to geodynamic studies, was used as the first source of single photons in orbit using its corner-cube retroreflectors. These were illuminated by a train of pulses from the Matera Laser Ranging Observatory (MLRO, Italy) in such a way that a single photon was reflected on average by the satellite [335]. This approach was later used with 4 satellites equipped with polarization preserving retroreflectors to realize an orbiting source of polarization qubits, providing the experimental feasibility of the BB84 protocol on a spacelink [336]. See Fig. 8. The QBER observed was well within the applicability of the BB84 protocol, and in line with criteria of both general or pragmatic security [341].</p>
        <p>Later and still at MLRO, the use of temporal modes, or phase encoding, was also demonstrated [337]. The Chinese satellite Micius was announced as a major step of the space program of the Chinese Academy of Science [342] and was launched on the 16th of August 2016. It provided the experimental verification of various QC protocols in space. Indeed the spacecraft was equipped as a quantum optics lab capable not only to generate coherent and entangled states and to transmit them to the ground but also to measure qubit sent by the ground terminal. In this way, ground-to-satellite quantum teleportation was realized by teleporting six input states in mutually unbiased bases with an average fidelity of 0.80 ± 0.01 from the Ngari ground station in Tibet [343]. The decoy-BB84 protocol was realized with a key rate exceeding 10 kbps at about the central part of the satellite passage. This remarkable result was possible by very accurate pointing of the downward beam, whose far field angle was about 10 µrad at 1/e 2 and the pointing fluctuation was reported to be a factor five lower [344]. The wavelength for the qubit was chosen to be about 850 nm and the observed losses were about 22 dB, in line with the theoretical modeling based on a 300-mm telescope.</p>
        <p>Entangled-based QKD was also demonstrated by Micius, using a high visibility source onboard. The twin beam downlink was used to establish a secret key (via violation of Bell inequalities) between the two stations of Delingha and Lijiang, with a slant distance of about 1200 km [345]. Due to the composition of the losses of the two channels, the QKD rate resulted of the order of half a bps. In 2017, entangled-based QKD (in particular, the Ekert protocol [80]) was also realized with one of the entangled photons measured at the satellite while the other one was detected at the receiver in the Delingha ground station. The link losses ranged from 29 dB at 530 km to 36 dB at 1000 km, allowing for a max key rate of a few bps [346]. Micius was also used for demonstrating an intercontinental quantum network, distributing the keys for a text and video exchange between the ground stations of Xinglong (China), Nanshan (China) and Graz (Austria) [347].</p>
        <p>In 2017, QKD was also demonstrated in downlink from the Tiangong-2 Space Lab, where a compact transmitter with a 200-mm telescope was installed. Photons were transmitted down to the 1.2-m telescope at the Nanshan ground station [348]. The key rate was assessed to reach beyond 700 bps with about 30 dB of losses. In the same year, a Japanese team at the NICT developed the SOTA lasercom terminal for testing the optical downlinks as well as QC with a low-cost platform, the microsatellite SOCRATES at an altitude of 650 km [349].</p>
        <p>Since the beginning of this decade, the cubesats have grown rapidly in the several areas of space science and technology, including space QC [338,339]. Two main tasks are envisaged for such small sats: the test of novel technology for QC in the space context and the operation of a apace network for capillary coverage of low rate QKD. For the first purpose, the Singapore NUS team developed a prototype of source and detector that was successfully operated first on a balloon and then in Space [350,351]. Several proposal of cubesat use have been put forward worldwide (e.g., see [339]).</p>
        <p>The medium Earth orbit (MEO) is above LEO and below the geostationary orbit (GEO), the latter being at 35,786 km above Earth's equator. The MEO in-cludes the Global Navigation Satellite Systems (GNSS) while GEO includes weather and communication satellites. These higher orbits are preferable because they would extend the link duration (becoming permanent for a GEO). However, they involve larger losses and the payloads are exposed to much more aggressive ionizing radiation from the Sun.</p>
        <p>The first experimental single-photon exchange with a MEO sat at 7000 km of slant distance was realized in 2016 at MLRO [352]. The QKD links were modeled in previous studies [326,327]. A recent result addressing the photon exchange with two Glonass sats has supported the future possibility of QKD-enabled secure services for the GNSS satellites [353]. This opportunity is seriously considered, given the critical service that the navigation system are playing in several continents. Finally, the feasibility of quantum-limited measurement of optical signal from an existing GEO communication satellite has been recently carried out [354].</p>
        <p>Space QKD was so far investigated experimentally during night-time only. However, the operation in daylight is of great interest for a significative expansion of the satellite usage. The possibility of a daylight use in intersatellite communication was supported by a study on the ground [355]. The key ingredients were a strong rejection of the background radiation, via a precise pointing and a narrow field-of-view, together with the reduction of the temporal integration interval for the arrival qubits, obtained by means of a very precise temporal synchronization. Finally, the wavelength of 1550 nm was used thanks to its lower scattering.</p>
        <p>Several areas may be found in which quantum communication from and in space are crucial. Below we review some possible other protocols (beyond QKD) that can be realized by sending single photons at large distance in space. We discuss some fundamental tests that were and can be realized in this context.</p>
        <p>Some possible protocols that can be realized with long distance quantum communication are quantum digital signature (QDS) and blind quantum computing (BQC). A QDS refers to the quantum mechanical equivalent of a digital signature (see Sec. XV). In a QDS protocol, Alice sends a message with a digital signature to two recipients, Bob and Charlie. Then QDS guarantees nonrepudiation, unforgeability, and transferability of a signature with information-theoretical security. A very recent longdistance ground demonstration exploiting decoy states has been realized without assuming any secure channel. A one-bit message was successfully signed through a 102km optical fiber [356].</p>
        <p>A second example is BQC where a client sends a quantum state |ψ to the server, with such state encoding both the chosen algorithm and the input (for a review see Ref. [357]). For a cloud computer (an in particular a cloud quantum computer), the privacy of the users may be a serious issue. BQC allows a client to execute a quantum algorithm by using one or more remote quantum computers while at the same time keeping the results of the computation hidden. By satellite quantum communication it could be possible to send quantum states from a satellite to ground servers that may perform the BQC.</p>
        <p>Quantum communication in free space at large distance is the key ingredient to perform fundamental tests of quantum mechanics in an unexplored scenario. Indeed, as for any scientific theory, quantum mechanics can be considered valid only within the limits in which it has been experimentally verified. By exploiting quantum communication in space it is possible to extend such limits, by observing quantum phenomena in unexplored conditions, such as moving terminals and/or larger and larger distances. The possibly interplay of quantum mechanics with general (or special) relativity can be studied in this context [358,359]. Bell's inequality with observers at relative motion and gravitational-induced redshifts on quantum objects are some very significant experiments that can be performed in space (for a detailed review of these possible experiments see [359]). As paradigmatic examples of the possibilities offered by space quantum communication we may recall two recent demonstrations: the violation of a Bell's inequality at a distance of about 1200km [345] and the Wheeler's delayed-choice experiment along a 3500-km space channel [360].</p>
        <p>As we know, Bell's inequalities [361] demonstrate that a local hidden variable model cannot reproduce the experimental results that can be achieved by entangled states. Nowadays, Bell's inequality are used as a simple and effective tool to certify the presence of entanglement between separate observers. In 2017, the Micius satellite, orbiting at an altitude of about 500km and hosting a source of polarization entangled photons, allowed the demonstration of the persistence of entanglement at the record distance of 1200km between the two ground station of Delingha and Lijiang in China [345]. The experiment realized the violation of the CHSH inequality, with a value S = 2.37 ± 0.09 larger than the limit of 2 by four standard deviations. This result confirmed the nonlocal feature of quantum mechanics excluding the local models of reality on the thousand km scale. Previous demon-strations [332,362], using fiber or ground free-space links were limited to one order of magnitude less in distance, due to photon loss in the fiber or the Earth curvature for ground free-space links.</p>
        <p>Quantum mechanics predicts that quantum entanglement should be measured at any distance: however, it is tempting to challenge such prediction and verify if some unexpected effects (such as gravitational influence) will put some limits of such distance. The availability of quantum communication in space now allows to extend such limit at larger and larger distance. For instance, by using an entangled source on a GEO satellite that sends the two photons on ground, it would be possible to increase by one order of magnitude the distance between two entangled photons.</p>
        <p>The second example is Wheeler's delayed-choice experiment [363], a wave-particle duality test that cannot be fully understood using only classical concepts. Waveparticle duality implies that is not possible to reveal both the wave-and particle-like properties of a quantum object at the same time. Wheeler's gedankenexperiment was invented to highlight the contradictory interpretation given by classical physics on a single photon measured by Mach-Zehnder interferometer (MZI). In his idea, a photon emerging from the first beam splitter (BS) of a MZI may find two alternative configurations: the presence or absence of a second BS at the output of the interferometer. In the former/latter case the apparatus reveals the wave/particle-like character of the photon. In a classical interpretation, one could argue that the photon decides its nature at the first BS. However, if the MZI configuration is chosen after the photon entered the interferometer (hence the name delayed-choice), a purely classical interpretation of the process would imply a violation of causality. Several implementations of Wheeler's Gedankenexperiment have been realized on the ground [364]. In the experiment of Ref. [365], a spacelike separation between the choice of the measurement and the entry of the particle into the interferometer was achieved with a 48-m-long polarization interferometer and a fast EOM controlled by a QRNG.</p>
        <p>Then, in Ref. [358], the delayed-choice paradigm has been extended to space, by exploiting the temporal degree of freedom of photons reflected by a rapidly moving satellite in orbit. The two time bins represents the two distinct paths of the interferometer. Photon polarization was used as an ancillary degree of freedom to choose the insertion or removal of the BS at the measurement apparatus and thus observe interference or which-path information. The experiment showed the correctness of the wave-particle model for a propagation distance of up to 3500 km, namely at a much larger scale than all previous experiments.</p>
        <p>We have reviewed the opportunities offered by space quantum communications and their possible applications. In particular, they are expected to have a great impact in the creation of a secure quantum network around the globe. The design of a QKD network in space encompass the realization of the single-link connections, the modeling of their performances and their further exploitation in networks based on multiples ground stations. The study of such features needs further investigations both theoretically and experimentally.</p>
        <p>Recall that CV quantum systems are described by an infinite-dimensional Hilbert space [6,7]. Consider a quantum system made of n bosonic modes of the electromagnetic field with tensor-product Hilbert space ⊗ n k=1 H k and associated n pairs of field operators â † k , âk , with k = 1, . . . , n. For each mode k we can define the following field quadratures</p>
        <p>These operators can be arranged in an N -mode vector x := (q 1 , p1 , . . . , qn , pn ) T . Using the standard bosonic commutation relation, for field's creation (â † k ) and annihilation (â k ) operators, one can easily verify that the any pairs of entries of vector x satisfy the following commutation relation</p>
        <p>where Ω lm is the symplectic form [6]. From Eqs. ( 70)-( 72) we can see that the vacuum noise is here set to 1.</p>
        <p>An n-mode quantum state can be represented either as a density operator ρ acting on ⊗ n k=1 H k or as a Wigner function defined over a 2n-dimensional phase space (see Ref. [6] for more details). In particular, a state is Gaussian if its Wigner function is Gaussian, so that it is completely characterized by the first two statistical moments, i.e., the mean value x := x = Tr (xρ) and covariance matrix (CM) V, whose arbitrary element is defined by</p>
        <p>where ∆x i := xixi and {, } is the anti-commutator. For a single-mode, one can consider different classes of quantum states, the most known are the coherent states. These are states with minimum (vacuum) noise uncertainty, symmetrically distributed in the two quadratures, and characterized by their complex amplitudes in the phase space. They are denoted as |α , where α = q + ip, where (q, p) are the components of the mean value. Another important class is that of squeezed states, where the noise is less than the vacuum in one of the two quadratures (while greater than in the other) [6]. The reader can consult Appendix A for more details on the CV notation (which typically varies between quantum information and quantum optics) and a number of formulas that are relevant for calculations with Gaussian states.</p>
        <p>The basic one-way CV-QKD protocols can be classified with respect to the quantum states employed (coherent or squeezed), the type of encoding adopted (Gaussian modulation or discrete alphabet), and the type of measurement used (homodyne or heterodyne detection). In particular, Gaussian protocols based on the Gaussian modulation of Gaussian states have received an increasing attention in the latest years, not only because Gaussian states are routinely produced in quantum optics labs but also because they are relatively easy to study, due to their description based on mean value and CM.</p>
        <p>As an alternative to DV-QKD protocols, which are ideally based on a single photon detection, CV-QKD protocols encode keys into CV observables of light fields [7] that can be measured by shot-noise limited homodyne detection. In a homodyne detector an optical signal is coupled to a shot-noise limited strong local oscillator (LO) beam on a balanced beamsplitter and the light intensities on the output ports are measured. Depending on the optical phase difference between the signal and LO, the difference of photocurrents produced at each of the two detectors will be proportional to one of the two field quadratures. The LO therefore carries the phase reference, which allows to switch between the measurement of q-and p-quadrature (or more generally perform the state tomography by measuring the Wigner function associated to the state).</p>
        <p>The first proposal of using the quadratures of the bosonic field for implementing QKD dates back to 1999, when Ralph [366] considered the encoding of key bits by using four fixed quadrature displacements of bright coherent or two-mode entangled beams. Later, Ralph discussed the security of the two-mode entanglementbased scheme in more detail [367], considering not only intercept-resend attacks but also CV teleportation. The latter was identified as an optimal attack against the protocol, imposing the requirements of high signal squeezing and low channel loss [367]. Independently, Hillery [368] suggested a CV-QKD protocol based on quadrature encoding of a single-mode beam, randomly squeezed in one of the quadrature directions. Security against interceptresend and beam-splitting attacks were assessed on the basis of the uncertainty principle. Another early CV-QKD scheme was suggested by Reid [369] and based on the verification of EPR-type correlations to detect an eavesdropper.</p>
        <p>In 2000 Cerf et al. [370] proposed the first all continuous QKD protocol, where the quadratures of a squeezed beam were used to encode a Gaussian-distributed secure key. The security of the protocol was shown against individual attacks based on the uncertainty relations and the optimality of a quantum cloner. Later, reconciliation procedures were introduced for Gaussian-distributed data, which allowed to implement error correction and privacy amplification close to the theoretical bounds [371]. Another CV-QKD protocol based on the Gaussian modulation of squeezed beams was suggested by Gottesman and Preskill [372]. This protocol was shown to be secure against arbitrary attacks at feasible levels of squeezing, by using quantum error-correcting codes.</p>
        <p>In 2001 Grosshans and Grangier introduced a seminal coherent-state protocol with Gaussian quadrature modulation and showed its security against individual attacks [373] by resorting to the CV version of the nocloning theorem [374]. The standard protocol based on the direct reconciliation (DR), where Alice is the reference side for the information post-processing, was however limited to 50% channel transmittance, i.e., 3dB. As an attempt to beat the 3dB limit, the use of postselection in CV-QKD was suggested by Silberhorn et al. [424]. Alternatively, it was shown that the use of the reverse reconciliation (RR), where the reference side is Bob, allowed the coherent-state protocol to be secure against individual attacks up to arbitrarily-low channel transmittances [375]. In 2004, the heterodyne detection was then suggested for coherent-state protocols by Weedbrook et al. [376]. This non-switching protocol has the advantage that both the quadratures are measured, therefore increasing the key rate.</p>
        <p>The security of CV-QKD against collective Gaussian attacks was shown independently by Navascués et al. [377] and by García-Patrón and Cerf [378]. Collective Gaussian attacks were fully characterized by Pirandola et al. [379], who later derived the secret-key capacities for CV-QKD [33,34]. Security against collective attacks was extended to the general attacks by Renner and Cirac [54] using the quantum de Finetti theorem applied to infinitedimensional systems. This concluded the security proofs for the basic one-way CV-QKD protocols in the asymptotic limit of infinitely large data sets [380,381]. Next developments were the study of finite-size effects and fully composable proofs (e.g. see Ref [60]).</p>
        <p>The family of one-way CV-QKD protocols can be divided into four major ones, depending on the signal states and the type of measurements applied. It was already mentioned that CV-QKD can be realized using coherent or squeezed signal states, and the homodyne measurement is used to obtain quadrature value of an incoming signal. As an alternative to the homodyne detection, the heterodyne measurement can be applied. Here the signal mode is divided on a balanced beamsplitter and q-and p-quadratures are simultaneously detected using homodyne detectors at the outputs. A vacuum noise is then unavoidably being mixed to the signal.</p>
        <p>The "prepare and measure" realization of a generic one-way CV-QKD protocol includes the following steps:</p>
        <p>• Alice encodes a classical variable α in the amplitudes of Gaussian states which are randomly displaced in the phase space by means of a zero-mean Gaussian distribution, whose variance is typically large. If coherent states are used, the modulation is symmetric in the phase space. If squeezed states are used instead, then the displacement is along the direction of the squeezing and Alice randomly switches between q-and p-squeezings.</p>
        <p>• Alice then sends the modulated signal states to Bob through the quantum channel, which is typically a thermal-loss channel with transmissivity η and some thermal noise, quantified by the mean number of thermal photons in the environment n or, equivalently, by the excess noise</p>
        <p>In some cases, one may have a fading channel where the channel's transmissivity varies over time (e.g. due turbulence) [382].</p>
        <p>• At the output of the quantum channel, Bob performs homodyne or heterodyne detection on the incoming signals, thus retrieving his classical variable β. If homodyne is used, this is randomly switched between the q-and the p-quadratures.</p>
        <p>• If Alice and Bob have switched between different quadratures, they will implement a session of classical communication (CC) to reconciliate their bases, so as to keep only the choices corresponding to the same quadratures (sifting).</p>
        <p>• By publicly declaring and comparing part of their sifted data, Alice and Bob perform parameter estimation. From the knowledge of the parameters of the quantum channel, they can estimate the maximum information leaked to Eve, e.g., in a collective Gaussian attack. If this leakage is above a certain security threshold, they abort the protocol.</p>
        <p>• Alice and Bob perform error correction and privacy amplification on their data. This is done in DR if Bob aims to infer Alice's variable, or RR if Alice aims to infer Bob's one.</p>
        <p>In a Gaussian CV-QKD protocol, where the Gaussian signal states are Gaussianly-modulated and the outputs are measured by homodyne or heterodyne detection, the optimal attack is a collective Gaussian attack. Here Eve combines each signal state and a vacuum environmental state via a Gaussian unitary and collects the output of environment in a quantum memory for an optimized and delayed joint quantum measurement. The possible collective Gaussian attacks have been fully classified in Ref. [34]. A realistic case is the so-called entangling cloner [374] where Eve prepares a TMSV state with variance ω = n+1 and mixes one of its modes with the signal mode via a beam-splitter with transmissivity η, therefore resulting in a thermal-loss channel. In this scenario, the asymptotic secret key rates in DR (◮) or RR (◭) are respectively given by</p>
        <p>where ξ ∈ (0, 1) is the reconciliation efficiency, defining how efficient are the steps of error correction and privacy amplification, I(α : β) is Alice and Bob's mutual information on their (sifted) variables α and β, while I(α : E) [I(β : E)] is Eve's Holevo information on Alice's (Bob's) variable.</p>
        <p>Theoretical evaluation of these rates is performed in the equivalent entanglement-based representation of the protocol, where Alice's preparation of signal states on the input mode a is replaced by a TMSV state Φ µ aA in modes a and A. A Gaussian measurement performed on mode A is able to remotely prepare a Gaussian ensemble of Gaussian states on mode a. For instance, if A is subject to heterodyne, then mode a is projected onto a coherent state whose amplitude is one-to-one with the outcome of the heterodyne and is Gaussianly modulated in phase space with variance µ -1. In this representation, Alice's classical variable is equivalently represented by the outcome of her measurement.</p>
        <p>Once mode a is propagated through the channel, it is perturbed by Eve and received as mode B by Bob. Therefore, Alice and Bob will share a bipartite state ρ AB . In the worst case scenario, the entire purification of ρ AB is assumed to be held by Eve. This means that we assume a pure state Ψ ABE involving a number of extra modes E such that Tr E (Ψ ABE ) = ρ AB . For a Gaussian protocol under a collective Gaussian attack, we have that Ψ ABE is pure, so that the Eve's reduced output state ρ E := Tr AB (Ψ ABE ) has the same entropy of ρ AB , i.e.,</p>
        <p>Assuming that Alice and Bob performs rank-1 Gaussian measurements (like homodyne or heterodyne), then they project on pure states. In DR, this means that the output α of Alice measurement, with probability p(α), generates a pure conditional Gaussian state Ψ BE|α whose CM does not depend on the actual value of α. Then, because the reduced states ρ B(E)|α := Tr E(B) (Ψ BE|α ) have the same entropy, we may write the following equality for</p>
        <p>By using Eqs. ( 76), ( 77) and ( 78) in the key rates of Eqs. ( 74) and ( 75) we may simplify the Holevo quantities as</p>
        <p>This is a remarkable simplification because the two rates are now entirely computable from the output bipartite state ρ AB and its reduced versions ρ B|α and ρ A|β . In particular, because all these state are Gaussian, the von Neumann entropies in Eqs. ( 79) and ( 80) are very easy to compute from the CM of ρ AB . Similarly, the mutual information I(α : β) can be computed from the CM. Given the expressions of the rates, one can also compute the security thresholds by solving R ◮ = 0 or R ◭ = 0.</p>
        <p>The ideal performances of the main one-way Gaussian protocols can be studied in a thermal-loss channel, assuming asymptotic security, perfect reconciliation (ξ = 1), and infinite Gaussian modulation. Let us consider the entropic function</p>
        <p>so that s(1) = 0 for the vacuum noise. For the protocol with Gaussian-modulated coherent states and homodyne detection [374], one has</p>
        <p>s(ω)</p>
        <p>For the non-switching protocol with Gaussian-modulated coherent states and heterodyne detection [376], one instead has</p>
        <p>s(ω)</p>
        <p>For the protocol with Gaussian-modulated squeezed states (in the limit of infinite squeezing) and homodyne detection [370], here we analytically compute</p>
        <p>Note that, for this specific protocol, a simple bound can be derived at low η and low n, which is given by [</p>
        <p>Finally, for the protocol with Gaussian-modulated infinitely-squeezed states and heterodyne detection [384], here we analytically compute</p>
        <p>s(ω)</p>
        <p>Note that this is a particular case of protocol where trusted noise added at the detection can have beneficial effects on its security threshold [381]. In CV-QKD this effect was studied in Refs. [384][385][386] and later in Refs. [387][388][389] as a tool to increase the lower bound to the secret key capacity of the thermal-loss and amplifier channels.</p>
        <p>In particular, the protocol presented in Ref. [389] has the highest-known security threshold so far (see also Sec. XI). Also note that for a pure-loss channel (ω = 1), we find</p>
        <p>which is half of the PLOB boundlog 2 (1-η). According to Ref. [34], this bound is achievable if one of these two protocols is implemented in the entanglement-based representation and with a quantum memory. In particular for the squeezed-state protocol with homodyne detection, the use of the memory allows Alice and Bob to always choose the same quadrature, so that we may remove the sifting factor 1/2 from R ◭ sq,hom in Eq. ( 90).</p>
        <p>The practical security of CV-QKD [29] deals with finite data points obtained experimentally. In this finitesize regime the security of CV-QKD was first analyzed against collective attacks [390] by including corrections to the key rate taking into account of the data points used and discarded during parameter estimation and the convergence of the smooth min-entropy towards the von Neumann entropy. The channel estimation in the finitesize regime of CV-QKD was further studied in Ref. [391] where it was suggested the use of a double Gaussian modulation, so that two displacements are applied and each signal state can be used for both key generation and channel estimation. See also Ref. [392] for excess noise estimation using the method of moments.</p>
        <p>The finite-size security under general coherent attacks have been also studied. Ref. [58,59] used entropic uncertainty relations for the smooth entropies to show this kind of security for an entanglement-based protocol based on TMSV states. The analysis was extended to the protocol with squeezed states and homodyne detection [393]. Finite-size security for one-way coherent-state protocols against general attacks was studied in Ref. [394] by using post-selection and employing phase-space symmetries. More recently, it was shown that, for coherent-state protocols, the finite-size security under general attacks can be reduced to proving the security against collective Gaussian attacks by using the de Finetti reduction [60].</p>
        <p>In a two-way CV-QKD scheme [395], similar to its DV counterpart [118,122], Alice and Bob use twice the insecure channel in order to share a raw key. During the first quantum communication, Bob randomly prepares and sends a reference state to Alice who, in turn, encodes her information by performing a unitary transformation on the received state, before sending it back to Bob for the final measurement. The appeal of this type of protocol is its increased robustness to the presence of excess noise in the channel. From an intuitive point of view, this is due to the fact that Eve needs to attack both the forward and backward transmissions in order to steal information, resulting in an increased perturbation of the quantum system. The promise is a higher security threshold with respect to one-way protocols.</p>
        <p>Let us now describe in detail a two-way protocol based on coherent states and heterodyne detection [395]. Here Bob prepares a reference coherent state |β whose amplitude is Gaussianly-modulated with variance µ B . This is sent through the quantum channel and received as a mixed state ρ(β) by Alice. At this point, Alice randomly decides to close (ON) or open (OFF) the "circuit" of the quantum communication. When the circuit is in ON, Alice encodes a classical variable α on the reference state by applying a displacement D(α) whose amplitude is Gaussianly-modulated with variance µ A . This creates the state D(α)ρ(β) D(-α) which is sent back to Bob, where heterodyne detection is performed with outcome γ ≃ α + β. From the knowledge of γ and β, Bob can generate a post-processed variable α ′ ≃ α. In DR, the key is generated by Bob trying to infer Alice's variable α. In RR, the situation is reversed with Alice guessing Bob's variable α ′ .</p>
        <p>When the circuit is in OFF, Alice first applies heterodyne detection on the incoming reference state ρ(β), obtaining a variable β ′ . Then she prepares a new Gaussianmodulated coherent state |α to be sent back to Bob. His heterodyne detection provides an output variable α ′ . In such a case the parties may use the variables {β, β ′ } and {α, α ′ } to prepare the key. In DR the variables β and α are guessed while, in RR, the primed variables β ′ and α ′ are. For both the ON and the OFF configuration, Alice and Bob publicly declare and compare a fraction of their data in order to estimate the transmissivity and noise present in the round-trip process.</p>
        <p>Note that the control of the parties over the ON/OFF setup of the two-way communication represents an additional degree of freedom evading Eve's control. As a matter of fact, Alice and Bob may decide which setup to use for the generation of the key. The safest solution is to use the ON configuration if Eve performs an attack of the round-trip based on two memoryless channels, while the OFF configuration is used when Eve performs an attack which has memory, i.e., with correlations between the forward and the backward paths.</p>
        <p>The security of two-way CV-QKD protocols has been first studied in the asymptotic limit of infinitely-many uses of the channel and large Gaussian modulation [395][396][397]. The most general coherent attack can be reduced by applying de Finetti random permutations [54] which allow the parties to neglect possible correlations established by Eve between different rounds of the protocol. In this way the attack is reduced to a two-mode attack which is coherent within a single round-trip quantum communication. Then, the security analysis can be further simplified by using the extremality of Gaussian states [398], which allows one to just consider two-mode Gaussian attacks. The most realistic of these attacks is implemented by using two beam-splitters of transmissivity η, where Eve injects two ancillary modes E 1 and E 2 , the first interacting with the forward mode and the second with the backward mode. Their outputs are then stored in a quantum memory which is subject to a final collective measurement.</p>
        <p>In each round-trip interaction, Eve's ancillae E 1 and E 2 may be coupled with to another set of modes so as to define a global pure state. However, these additional ancillary modes can be neglected if we consider the asymptotic limit where Eve's accessible information is bounded by the Holevo quantity [379]. As a result, we may just consider a two-mode Gaussian state ρ E1E2 for Eve's input ancillary modes. In practical cases, its CM can be assumed to have the normal form</p>
        <p>where ω is the variance of the thermal noise, I = diag(1, 1), Z = diag(1, -1), and matrix G describes the two-mode correlations. Here the parameters ω, g and g ′ must fulfill the bona fide conditions [399] |g|</p>
        <p>We notice that when g = g ′ = 0, then CM of Eq. ( 91) describes the action of two independent entangling cloners, i.e., the attack simplifies to one-mode Gaussian attack.</p>
        <p>Here we provide the asymptotic secret key rates of the main two-way protocols based on coherent states and heterodyne or homodyne detection [395]. For each protocol, we summarize the key rates in DR (◮) or RR (◭) for the two configurations in ON or OFF. In particular, ON is assumed against one-mode Gaussian attacks, while OFF is assumed to be used under two-mode Gaussian attacks [395][396][397]. For an ON key rate under two-mode attacks see Ref. [396], but we do not consider this here.</p>
        <p>For the two-way protocol based on coherent states and heterodyne detection we write the key rates</p>
        <p>where</p>
        <p>, the eigenvalues νi are computed numerically and</p>
        <p>Note that, if we set g = g ′ = 0 in the OFF rates, we retrieve the two rates of the one-way coherent-state protocol in Eqs. ( 84) and (85). Consider now the two-way coherent state protocol with homodyne detection. In this case, the solution is fully analytical. In fact, we have the following key rates</p>
        <p>where the ν k are given in Eq. ( 97), and</p>
        <p>Other cases with encoding by squeezed states and decoding by heterodyne/homodyne detection, have been discussed in Ref. [397].</p>
        <p>As discussed in Refs. [395][396][397] the security thresholds of the two-way protocols, given by setting R = 0 in the expression above, are higher of the corresponding oneway protocols. This makes two-way CV-QKD a good choice in communication channels affected by high thermal noise (e.g., at the THz or microwave regime). The security analysis provided in Refs. [395][396][397] is limited to the asymptotic regime. However, recently the composable security has been also proven in Ref. [400]. Other studies on the security of two-way CV-QKD protocols have been carried out in Refs. [401,402], besides proposing the use of optical amplifiers [403]. It is also important to note that, besides the Gaussian two-way protocols, one may also consider schemes that are based on quantum illumination [404] or may implement floodlight QKD [405][406][407][408]. The latter is a two-way quantum communication scheme which allows one to achieve, in principle, Gbit/s secret-key rate at metropolitan distances. This is done by employing a multiband strategy where the multiple optical modes are employed in each quantum communication.</p>
        <p>H. Thermal-state QKD</p>
        <p>In the protocols treated so far one assumes that the Gaussian states are pure. This requirement can however be relaxed. The possibility of using "noisy" coherent states, i.e., thermal states, was first considered in Ref. [409] which showed that thermal states are suitable for QKD if the parties adopt RR and the signals are purified before transmission over the channel. This approach was later reconsidered in Ref. [410], which proved its security in realistic quantum channels. Refs. [411,412] showed that thermal states can be directly employed in CV-QKD (without any purification at the input) if the protocol is run in DR. Similarly, they can be directly employed in two-way CV-QKD if the protocol is run in RR [413]. This possibility opened the way for extending CV-QKD to longer wavelengths down to the microwave regime, where the protocols can be implemented for short-range applications and are sufficiently robust to finite-size effects [414]. More recently, the terahertz regime has been also proposed for short-range uses of CV-QKD [415]. Following this idea, another work [416] has proposed the same regime for satellite (LEO) communications where the issue of the thermal noise is mitigated.</p>
        <p>For simplicity, we focus on the one-way protocol where Bob homodynes the incoming signals, randomly switching between the quadratures. An alternative noswitching implementation based on heterodyne detection can be considered as well. The protocol starts with Alice randomly displacing thermal states in the phase space according to a bivariate Gaussian distribution. She then sends the resulting state to Bob, over the insecure quantum channel. The generic quadrature Â = (q A , p A ) of Alice's input mode A can be written as Â = 0 + α, where the real number α is the Gaussian encoding variable with variance V α , while operator 0 accounts for the thermal 'preparation noise', with variance V 0 ≥ 1. The overall variance of Alice's average state is therefore</p>
        <p>The variance V 0 can be broken down as V 0 = 1 + µ th , where 1 is the variance of the vacuum shot-noise, and µ th ≥ 0 is the variance of an extra trusted noise confined in Alice's station and uncorrelated to Eve. Bob homodynes the incoming signals, randomly switching between position and momentum detections. In this way, Bob collects his output variable β which is correlated to Alice's encoding α. After using a public channel to compare a subset of their data, to estimate the noise in the channel and the maximum information eavesdropped, the parties may apply classical post-processing procedures of error correction and privacy amplification in order to extract a shorter secret-key.</p>
        <p>The security analysis of this type of protocol is analogous to that of the case based on coherent states. Being the protocol Gaussian, the security is upper-bounded by collective Gaussian attacks and Eve's accessible information overestimated by the Holevo bound. Assuming a realistic entangling-cloner attack, in the typical limit of large variance V α ≫ 1, we obtain the following expressions for the asymptotic key-rates [411,412]</p>
        <p>where function Λ(x, y) := τ x+(1-τ )y and s (x) is defined in Eq. ( 81).</p>
        <p>The two-way thermal protocol [413] extends the oneway thermal protocol [411,412] to two-way quantum communication. The steps of the protocol are the same as described in Sec. VII G but with thermal states replacing coherent ones. Therefore, Bob has an input mode B 1 , described by the generic quadrature B1 = 0 + β 1 , where β 1 is the encoding Gaussian variable having variance V β1 while mode 0 has variance V 0 = 1 + µ th ≥ 1. After the first quantum communication Alice receives the noisy mode A 1 and randomly switches between the two possible configurations [397,413]. In case of ON configuration, Alice encodes a Gaussian variable α with variance V α = V β1 , randomly displacing the quadrature of the incoming mode Â1 → Â2 = Â1 + α. When the twoway circuit is set OFF, Alice homodynes the incoming mode A 1 with classical output α 1 , and prepares another Gaussian-modulated thermal state Â2 = 0 + α 2 , with the same preparation and signal variances as Bob, i.e., V 0 and V a2 = V β1 . In both cases, the processed mode A 2 is sent back to Bob in the second quantum communication through the channel. At the output, Bob homodynes the incoming mode B 2 with classical output β 2 .</p>
        <p>At the end of the double quantum communication, Alice publicly reveals the configuration used in each round of the protocol, and both the parties declare which quadratures were detected by their homodyne detectors. After this stage, Alice and Bob possess a set of correlated variables, which are α 1 ≈ β 1 and α 2 ≈ β 2 in OFF configuration, and α ≈ β in ON configuration. By comparing a small subset of values of these variables, the parties may detect the presence of memory between the first and the second use of the quantum channel. If two-mode coherent attacks are present then they use the OFF configuration, extracting a secret-key from α 1 ≈ β 1 and α 2 ≈ β 2 . If memory is absent, the parties assume one-mode collective attacks against the ON configuration, and they post-process α and β. We remark that the switching between the two configurations can be used as a virtual basis against Eve [397], who has no advantage in using two-mode correlated attacks against the CV two-way protocol.</p>
        <p>Let us assume the realistic Gaussian attack composed by two beam-splitters of transmissivity η, where Eve injects two ancillary modes E 1 and E 2 in a Gaussian state whose CM is specified in Eq. (91. This is a two-mode (one-mode) attack for g, g ′ = 0 (= 0). Assuming ideal reconciliation efficiency, working in the asymptotic limit of many signals and large Gaussian modulations, one can compute the following secret key rates for the two-way thermal protocol with homodyne decoding</p>
        <p>s(ω)</p>
        <p>As an alternative to the standard CV-QKD protocols described above, where both quadratures have to be modulated and measured (be it simultaneously or subsequently), one may consider a unidimensional (UD) protocol [417,418], which relies on a single quadrature modulation at Alice's side while Bob performs a randomlyswitched homodyne detection. Because it requires a single modulator, the UD CV-QKD protocols provide a simple experimental realization with respect to conventional CV QKD. This also means that the trusted parties are not able to estimate the channel transmittance in the un-modulated quadrature, which remains an unknown free parameter in the protocol security analysis. This parameter however can be limited by considerations of physicality of the obtained CMs. In other words, Eve's collective attack should be pessimistically assumed to be maximally effective, but is still limited by the physicality bounds related to the positivity of the CM and its compliance with the uncertainty principle [6,419].</p>
        <p>Therefore, Eve's information can be still upperbounded and the lower bound on the key rate can be evaluated. The performance of the protocol was compared to standard one-way CV-QKD in the typical condition of a phase-insensitive thermal-loss channel (with the same transmittance and excess noise for both the quadratures). While the UD protocol is more fragile to channel loss and noise than conventional CV-QKD, it still provides the possibility of long-distance fiber-optical communication. In fact, in the limit of low transmissivity η and infinitely strong modulation, the key rate for the UD CV-QKD protocol with coherent-state and homodyne detection is approximately given by (η log 2 e)/3 [417], which is slightly smaller than the similar limit for the standard one-way protocol with coherent states and homo-dyne detection [420] for which the rate is approximately given by (η log 2 e)/2. UD CV-QKD was recently extended to squeezed states [421], which were shown to be advantageous only in the DR scenario if the anti-squeezed quadrature is modulated. The security of coherent-state UD CV-QKD was recently extended to the finite-size regime [422].</p>
        <p>In CV-QKD, information is encoded in quantum systems with infinite-dimensional Hilbert spaces. This allows the sender to use bright coherent states and highlyefficient homodyne detections, which naturally boost the communication rate. These features do not come for free. At the error correction stage, one pays a penalty in mapping the continuous output data from the physical Gaussian channel into a binary-input additive white Gaussian-noise channel. This mapping is more accurate by employing discrete modulation [423]. The first discrete-modulated CV-QKD protocol was based on a binary encoding of coherent states [424] and was designed to overcome the 3dB limitation of CV-QKD in DR. Later protocols have consider three [425] or arbitrary number of phase-encoded coherent states [426].</p>
        <p>The basic idea in Ref. [424] is to perform a binary encoding which assigns the bit-value 0 (1) to a coherent state with positive (negative) displacement. Then, the receiver switches the homodyne detection setup, measuring quadrature q or p. After the quantum communication, the parties discard unfavorable data by applying an advantage distillation routine [427,428], which is a post-selection procedure which extracts a key by using two-way classical communication. The asymptotic security of this protocol was first studied under individual attacks [424] and later against collective attacks, with also a proof-of-concept experiment [429]. In general, the security of CV-QKD with non-Gaussian modulation remains an open question. In the asymptotic limit, its security has been proven against Gaussian attacks [430] and, more recently, general attacks [431].</p>
        <p>As we know, MDI-QKD [176,177] has been introduced to overcome a crucial vulnerability of QKD systems, i.e., the side-channel attacks on the measurement devices of the parties. The basic advantage of MDI scheme is that Alice and Bob do not need to perform any measurement in order to share a secret key. The measurements are in fact performed by an intermediate relay, which is generally untrusted, i.e., controlled by Eve. This idea can also be realized in the setting of CV-QKD with the promise of sensibly higher rates at metropolitan distances. The protocol was first introduced on the arXiv at the end of 2013 by Ref. [182] and independently re-proposed in Ref. [432].</p>
        <p>The protocol proceeds as follows: Alice and Bob possess two modes, A and B respectively, which are prepared in coherent states |α and |β . The amplitude of these coherent states is randomly-modulated, according to a bi-variate Gaussian distribution with large variance. Each one of the parties send the coherent states to the intermediate relay using the insecure channel. The modes arriving at the relay, say A ′ and B ′ , are measured by the relay by means a CV Bell detection [433]. This means that A ′ and B ′ are first mixed on a balanced beam splitter, and the output ports conjugately homodyned: on one port it is applied a homodyne detection on quadrature q, which returns the outcome q -, while the other port is homodyned in the p-quadrature, obtaining an outcome p + . The outcomes from the CV-Bell measurement are combined to form a new complex outcome γ := (q -+ip + )/ √ 2 which is broadcast over a public channel by the relay.</p>
        <p>For the sake of simplicity, let us consider lossless links to the relay. Then we can write γ ≃ αβ * , so that the public broadcast of γ creates a posteriori correlations between Alice's and Bob's variables. In this way, each of the honest parties may infer the variable of the other. For instance, Bob may use the knowledge of β and γ to compute β *γ ≃ α recovering Alice's variable up to detection noise [182]. Eve's knowledge of the variable γ does not help her to extract information on the individual variables α and β. This means that Eve needs to attack the two communication links with the relay in order to steal information, which results in the introduction of loss and noise to be quantified by the parties. In terms of mutual information this situation can be described writing that I(α : γ) = I(β : γ) = 0, while as a consequence of the broadcast of variable γ Alice-Bob conditional mutual information is non-zero, i.e., I(α : β|γ) &gt; I(α : β) = 0.</p>
        <p>As discussed in Ref. [182], the best decoding strategy is to guess the variable of the party who is closer to the relay (i.e., whose link has the highest transmissivity). Also note that, as proven in Ref. [62], the whole raw data can be used to perform both secret key extraction and parameter estimation. This is because the protocol allows the parties to recover each other variable from the knowledge of γ, so that they can locally reconstruct the entire CM of the shared data without disclosing any information.</p>
        <p>The security of CV MDI-QKD has been first studied in the asymptotic limit [182,434] (including fading channels [382]) and recently extended to finite-size security [435,436] and then composable security [61,62]. The asymptotic security analysis starts by considering the general scenario of a global unitary operation correlating all the uses of the protocol. However, using random permutations [52,54], Alice and Bob can reduce this scenario to an attack which is coherent within the single use of the protocol. After de Finetti reduction, this is a joint attack of both the links and the relay. In particular, since the protocol is based on the Gaussian modulation and Gaussian detection of Gaussian states, the optimal attack will be Gaussian [6,377,378]. More details can be found in Ref. [182].</p>
        <p>In analogy with the two-way CV-QKD protocol, a realistic two-mode Gaussian attack consists of Eve attacking the two links by using two beam-splitters of transmissivity η A and η B that are used to inject to modes E 1 and E 2 in a Gaussian state with CM given in Eq. ( 91). Detailed analysis of the possible two-mode attacks showed that, in the asymptotic regime, the optimal attack is given by the negative EPR attack, which corresponds to the case where g = -g ′ with g ′ = -√ ω 2 -1 in Eq. ( 91). In such a case Eve injects maximally entangled states with correlations contrasting those established by the CV-Bell detection, resulting in a reduction of the key rate. Indeed, assuming the asymptotic limit of many uses, large variance of the signal modulation, and ideal reconciliation efficiency, it is possible to obtain a closed formula describing the secret key rate for CV MDI-QKD. In particular, we can distinguish between two setups: the symmetric configuration, where the relay lies exactly midway the parties (η A = η B ), and the asymmetric configuration (η A = η B ). Assuming that Alice is the encoding party and Bob is the decoding party (inferring Alice's variable), the general expression of the asymmetric configuration takes the form</p>
        <p>where χ := 2 (η A + η B ) /(η A η B ) + ε, ε is the excess noise, and s (x) is defined in Eq. ( 81). For pure-loss links (ε = 0) the rate of Eq. ( 109) reduces to</p>
        <p>The asymmetric configuration, under ideal conditions, allows to achieve long-distance secure communication. In particular, for η A = 1 and arbitrary η B the maximum achievable distance can be of 170 km (in standard optical fibers with attenuation 0.2 dB/Km) and key rate of 2 × 10 -4 bit/use [437]. Under such conditions, the rate of Eq. ( 110) becomes</p>
        <p>which coincides with the RR rate of the one-way protocol with coherent states and heterodyne detection. The performance degrades moving the relay in symmetric position with respect to Alice and Bob. In such a case, we set χ = 2/η + ε where η := η A = η B , and we write the rate [182,434]</p>
        <p>For pure-loss links, this simplifies to</p>
        <p>and the maximum achievable distance is about 3.8 km of standard optical fiber from the relay. Finite-size analysis and composable security have been developed for CV MDI-QKD. In Refs. [435,436] finitesize corrections have been studied assuming Gaussian attacks. The estimation of the channel parameters is provided within confidence intervals which are used to identify the worst-case scenario, corresponding to assuming the lowest transmissivity and the highest excess noise compatible with the limited data. The analysis showed that using signal block-size in the range of 10 6 ÷ 10 9 data points is sufficient to obtain a positive secret key rate of about 10 -2 bits/use.</p>
        <p>The composable security proof of CV MDI-QKD has been developed in Ref. [62] using the lower bound provided by the smooth-min entropy, and designing a novel parameter estimation procedure [61] which allows to simplify the analysis. The security has been proved against general attacks using the optimality of Gaussian attacks for Gaussian protocols, and the de Finetti reduction of general attacks to collective ones. The lower bound to the key rate is given by the following expression</p>
        <p>where ξ accounts for all sources of non-ideality in the protocol, I AB is Alice-Bob mutual information and I E Eve's accessible information. The parameter k is the number of signals used for the energy test, n is the total number of signal exchanged, and</p>
        <p>The quantity ǫ ′′ = k 4 ǫ ′ /50 is the overall security parameter with ǫ ′ := ǫ + ǫ s + ǫ EC + ǫ PE . Here ǫ comes from the leftover hash lemma, ǫ s is the smoothing parameter, ǫ EC is the error probability of the error correction routine, and ǫ PE that of the parameter estimation. The functional ∆ AEP 2pǫs 3 , d quantifies the error committed bounding the smooth-min entropy using the asymptotic equipartition property (AEP) [62,438]. The dimensionality parameter d describes the number of bits used in the analog-to-digital conversion (ADC) sampling, by which the unbounded continuous variables used in the protocols (q, p) are mapped into discrete variables, described as a set of 2 2d elements (cardinality). The two parameters, d A and d B , describe the dimensions of the sampling of Alice and Bob variables, set to perform the energy test. Parameter p gives the probability of success of the error correction. The result obtained by Ref. [62] confirmed that CV MDI-QKD is composably secure against general attacks and the use of block-size of 10 7 ÷10 9 data points is sufficient to generate a positive key rate against general coherent attacks.</p>
        <p>Several schemes have been introduced to modify the original design of the CV MDI-QKD scheme. One approach has been based on the used of non-Gaussian operations, like noiseless linear amplifiers (NLA) and photon subtraction/addition (whose importance is well-known in entanglement distillation [439]). The use of NLAs in MDI-QKD setups was investigated in Ref. [440] while photon subtraction has been explored in Refs. [441,442]. Among other approaches, CV MDI-QKD has been studied with squeezed states [443] (with composable security [444]), discrete modulation (alphabet of four coherent states) [445], phase self-alignment [446], imperfect phase reference calibration [447], and unidimensional encoding [448]. A multi-party version of the CV MDI-QKD protocol [449] has been also introduced and it is discussed below.</p>
        <p>An interesting feature to achieve in quantum cryptography is the ability to reliably connect many trusted users for running a secure quantum conference or quantum secret-sharing protocols [450][451][452][453]. The MDI architecture, restricted to two [182] or three users [454], has been recently generalized in this direction. In the scalable MDI network of Ref. [449], an arbitrary number N of remote users send Gaussian-modulated coherent states |α k to an untrusted relay where a generalized multipartite Bell detection is performed. This detection consists of a suitable cascade of beam-splitters with increasing transmissivities T k = 1k -1 , followed by N -1 homodyne detection in the q-quadrature, and a final homodyne detection in the p-quadrature. The result can be denoted as a single variable γ := (q 2 , . . . , q N , p) which is broadcast to all parties. This measurement is responsible for creating bosonic GHZ-type correlations among the parties. Ideally, it projects on an asymptotic bosonic state with Einstein-Podolsky-Rosen (EPR) conditions N k=1 pk = 0 and qkqk ′ = 0 for any k, k ′ = 1, . . . , N .</p>
        <p>After the measurement is broadcast, the individual variables α k of the parties share correlations which can be post-processed to obtain a common secret key. To implement quantum conferencing, the parties choose the ith user as the one encoding the key, with all the others decoding it in DR. To realize quantum secret sharing, the parties split in two ensembles which locally cooperate to extract a single secret key across the bipartition. The scheme is studied in a symmetric configuration, where the users are equidistant from the relay and the links are modeled by memoryless thermal channels, with same transmissivity and thermal noise. In this scenario, high rates are achievable at relatively short distances. The security of the quantum conferencing has been proved in both the asymptotic limit of many signals and the composable setting that incorporates finite-size effects. The analysis shows that, in principle, 50 parties can privately communicate at more than 0.1 bit/use within a radius of 40m. With a clock of 25MHz this corresponds to a key rate of the order of 2.5Mbits per second for all the users.</p>
        <p>As discussed in the previous section, the various kinds of CV-QKD protocols basically differ by the choice of input states (coherent or squeezed states), input alphabets (Gaussian or discrete) and detection strategy (homodyne or heterodyne detection). Most of these schemes have been tested in proof-of-concept experiments in a laboratory setting while a few have been going through different stages of developments towards real-life implementations. Specifically, the scheme based on Gaussian modulation of coherent states and homodyne detection has matured over the last 15 years from a simple laboratory demonstration based on bulk optical components creating keys with very low bandwidth [455][456][457][458] to a robust telecombased system that generates keys with relatively high bandwidth [459][460][461][462][463][464][465][466][467][468][469][470][471] and allows for in-field demonstrations [472,473] and network integration [474][475][476]. In the following sections, we will first describe the experimental details of the standard point-to-point coherent state protocol with emphasis on the most recent developments followed by a discussion of some proof-of-concept experiments demonstrating more advanced CV-QKD protocols such as squeezed state QKD and measurement-deviceindependent QKD.</p>
        <p>The very first implementation of CV-QKD was based on coherent state modulation and homodyne detection [455]. The optical setup comprised bulk optical components and the operating wavelength was 780 nm. This seminal work together with some follow-up experiments [456][457][458] constituted the first important generation of CV-QKD systems. Despite its successful demonstration of the concept of CV-QKD, it was however unsuitable for realizing robust long-distance and high-speed QKD in optical fibers because of the use of telecomincompatible wavelengths, the relatively low mechanical stability of the systems and the low efficiency of the employed error-correction protocols.</p>
        <p>To overcome these impediments, a new generation of CV-QKD systems was developed. This new generation made use of telecom wavelength, was mainly based on telecom components, combined optimized errorcorrection schemes and comprised several active feedback control systems to enhance the mechanical stability [460,462,463,471]. With these new innovations, key rates of up to 1Mbps for a distance of 25km [460] and key rates of around 300bps for a distance of 100km [462] have been obtained. Recently, two different field tests of CV-QKD through commercial fiber networks were performed over distances up to ≃ 50km with rates &gt; 6kpbs [476], which are the longest CV-QKD field tests so far, achieving two orders-of-magnitude higher secret key rates than previous tests.</p>
        <p>A third generation of CV-QKD systems are now under development. They are based on the generation of power for a phase reference (or local oscillator (LO)) at the receiver station in contrast to previous generations where the power of the LO was generated at the transmitter station and thus co-propagating with the signal in the fiber. These systems have also evolved from simple proof-of-concept demonstrations [477,478] to technically more advanced demonstrations using telecom components [461,464,469,474,479,480].</p>
        <p>The basic optical configuration for realizing CV-QKD is shown in Fig. 9. The signal is modulated in amplitude and phase according to a certain distribution (often a continuous Gaussian or a discrete QPSK distribution). It is then multiplexed in time, polarization and/or frequency with a phase reference (a strong local oscillator or a weak pilot tone) and subsequently injected into the fiber channel. At the receiver side, the signal and reference are de-multiplexed and made to interfere on a balanced homodyne (or heterodyne) detector. A subset of the measurement data are used for sifting and parameter estimation, while the rest are used for the generation of a secret key via error correction and privacy amplification.</p>
        <p>In Fig. 10 we show the main layouts of three different types of point-to-point CV-QKD experiments based on coherent state encoding with a Gaussian distribution. The three experiments represent important steps in the development of a telecom compatible QKD system, and they illustrate different techniques for encoding and detection. The experiment in Fig. 10a [463] applies a time-multiplexed LO propagating along the fiber with the signal while the experiments in Fig. 10b [461] and Fig. 10c [470] use a locally generated LO. The two latter experiments deviate by the signal encoding strategy (centered or up-converted base-band), the detection method (homodyne or heterodyne) and the phase and frequency difference determination. The experimental details are described in the figure caption and discussed in the following sections.</p>
        <p>The overarching aim for all QKD systems is to generate secret keys with as high speed as possible and over as long distance as possible. These two quantifying parameters for QKD are strongly connected and they crucially depend on the system's clock rate, the excess noise produced by the system and the efficiency, quality and speed of the post-processing algorithms. With these critical parameters in mind, in the following we describe the technical details associated with transmitter, the receiver and the post-processing schemes.</p>
        <p>At the transmitter station, a telecom laser is often transformed into a train of pulses using an amplitude modulator with a certain clock rate (e.g. 1MHz [463] or 50MHz [460]). It is also possible to use a CW signal where the clock rate is determined by the measurement bandwidth. The clock rate should be large as it dictates the upper bound for the final rate of the secret key and the accuracy in estimating the parameters of the channel. However, using high clock rates also places extra demands on the detection system and the post-processing schemes as discussed later. After pulse generation, a pair of modulators encode information using different strategies. The traditional approach is to create a base band signal around the carrier frequency but in more recent implementations, the base band signal is up-converted to the GHz range to limit the amount of photons scattered from the carrier [479]. As the base band signal is separated from the carrier in frequency, it is possible to significantly suppress the carrier through interference and thus reduce the amount of excess noise resulting from scattered carrier photons [464,470].</p>
        <p>At the receiver side, the signal is detected using either homodyne, dual-homodyning or heterodyne detection. A homodyne detector (sometimes called single-quadrature intradyne detection) basically consists of the interference of two light beams with identical frequencies -the signal and the local oscillator -on a balanced beam splitter, and two PIN diodes combined in subtraction and followed by a transimpedance amplification stage. In dual-homodyne detection (also known a phase diverse detection), the LO and the signal are split in balanced couplers and sent to two individual homodyne detector to measured orthogonal phase-space components simultaneously. It enhances the phase estimation capabilities Laser AM PM MUX DEMUX Ref FIG. 9. Schematic setup of a generic experimental CV-QKD system. A laser beam is modulated with an amplitude and a phase modulator, and subsequently multiplexed with a reference beam, sent through the optical fiber and de-multiplexed at the receiver site. The quadrature variables of the signal is then measured with a homodyne or heterodyne detector. A subset of the measurement outcomes are used for the estimation of channel parameters while the rest are used for secret key generation using error-reconciliation and privacy amplification.</p>
        <p>as two quadratures are measured but it also increases the complexity of the setup. The heterodyne detection scheme combines the advantages of the homodyne and dual-homodyne schemes: It mimics the low-complexity of homdyning and outputs the enhanced phase information of dual-homodyning. In heterodyne detection, the LO frequency is offset with respect to the carrier frequency of the signal, and therefore is down-converting the signal band to an intermediate frequency. Electronic downconversion is subsequently able to extract information about orthogonal phase space quadratures similar to dual-homodyning. It is worth noting that in the quantum community dual-homodyne detection is often referred to as a heterodyne detection while in the classical community heterodyne detection is reserved for the scheme described above. The gained signal information and noise penalties are basically similar for the two approaches but the hardware implementations are very different.</p>
        <p>The figure of merits associated with the detectors are the quantum efficiency, the bandwidth and the electronic noise power relative to the shot noise power. Naturally, a large clock rate requires a large homodyne detector bandwidth. E.g. in Ref. [460] a detector with GHz bandwidth was used to resolve a 50MHz clock rate while in Ref. [463] a much lower bandwidth suffices to detect 1MHz clocked pulses. Homodyne detectors with large bandwidths are commercially available but they have relatively poor electronic noise performance and low quantum efficiency. Although these detectors have been widely used for CV-QKD, a new generation of improved homodyne detectors are under development [481,482] which in turn will improve the performance of future QKD systems.</p>
        <p>Homodyne and heterodyne detectors require a stable phase and frequency reference also known as a local oscillator (LO). Two strategies for realizing such a reference have been studied:</p>
        <p>Transmission of LO. The traditional strategy is to use a LO from the same laser as the signal and let it co-propagate with the signal through the optical fiber. Different techniques for combining the LO and signal have been tested including time multiplexing [471] and time-polarization multiplexing [463]. This method however entails some significant problems. First, due to channel loss, the power of the LO at the receiver is strongly reduced and thus in some cases insufficient for proper homodyne detection, second, the large power of the LO in the fiber scatters photons and thus disturbs the other quantum or classical fiber channels [460,465,468], and third, the co-propagating LO is vulnerable to sidechannel attacks [463,483]. The approach is thus incompatible with the existing telecom infra-structure and it opens some security loopholes.</p>
        <p>Receiver generation of LO. The alternative strategy which is now gaining increasing interest and which is compatible with classical coherent communication is to use a LO that is generated at the receiver station, thereby avoiding the transmission of the large powered LO through the optical fiber. To enable coherent detection between the LO and the signal, strong synchronization of the frequencies and phases is required. This can be performed in post-processing similar to carrier-phase recovery schemes applied in classical communication: The phase and frequency synchronization of the LO do not have to be carried out prior to signal measurements but can be corrected a posteriori in digital signal processing (DSP). This is done by measuring the phase and frequency differences and subsequently counter-rotate the reference axes to correct for the drifts. Phase and frequency estimation cannot be performed by using the quantum signal as a reference since its power is too weak. Therefore, a small reference beam or pilot tone must be sent along with the signal in the fiber channel to establish the phase and frequency at the receiver. However, it is important to note that this pilot tone is very dim compared to a LO and thus do not result in the complications associated with the transmission of a LO. CV-QKD with a locally generated LO have been demonstrated by transmitting the reference beam with the signal using time multiplexing [461,480], frequency multiplexing [479] and frequency-polarization multiplexing [464]. In all these works, advanced DSP was used to correct for phase and frequency mismatch in post-measurements. The quality of the DSP algorithm is of utmost importance as inaccuracies in correcting for drifts directly lead to excess noise and thus a reduction of the resulting key rate and distance. Recovery of the clock has been achieved either by using or wavelength multiplexed clock laser [460], known patterns as a header to the quantum signal [464] or a second frequency multiplexed pilot tone [479]. pulses of 100ns with repetition rate 1MHz generated by a 1550nm telecom laser diode are split by an asymmetric beam splitter (99/1) into a signal beam (which is attenuated by variable attenuators (VATTs)) and a bright local oscillator. The signal is modulated by an amplitude (AM) and phase modulator (PM) and subsequently delayed by 200ns using a fiber delay line and a Faraday mirror. The LO and signal are then multiplexed in time and further in polarization (with a polarizing beam splitter (PBS)) before being injected into the fiber channel. At Bob's site the LO and signal are polarization de-multiplexed with a PBS and a dynamical polarization controller (DPC) and time-multiplexed with a delay line of the LO. The pulses are finally interfered in a homodyne detector. The PM in the LO enables random π phase shift and thus random quadrature measurement. Taken from Ref. [463]. b) A CW telecom laser at 1550nm is transformed into 1nsec pulses with a repetition rate of 100MHz using an amplitude modulator (AM). The Gaussian distributed signal is produced with a pair of modulators (AM and PM) and its brightness is controlled with a variable optical attenuator (VOA). Phase synchronization signals are also produced in the modulators time-multiplexed with the quantum signal, either regularly as in (a) and (b) or randomly as in (c). The signals are injected into the channel and measured with a locally generated local oscillator at Bob. An AM produces local oscillator pulses while a PM randomly switches their phases by π to allow for a random quadrature measurement. Phase and frequency synchronization between LO and signal is attained through DSP of the data produced by the interference between the LO and the reference pulses. Taken from Ref. [461]. c) Transmitter and receiver are to a large extent controlled by software, thereby reducing the complexity of the hardware. At the transmitter, software defines the pulse shape and the modulation pattern (here QPSK), and it ensures that the single side-banded signal -concentrated in a 10MHz band -is upconverted and combined with a pilot-tone which is used for controlling the frequency carrier-frequency offset and the phase noise. At the receiver, the signal is measured with a heterodyne detector using a locally generated, and frequency shifted LO. The output of the detector is demodulated into amplitude and phase quadrature components with a sampling rate of 200MS/s. Carrier-frequency offset, phase noise, clock skew and quadrature imbalance are subsequently corrected in digital-signal-processing, and the output is fed to the post-processing steps for key generation. Taken from Ref. [470]. Figures adapted with permissions from: a) Ref. [463] c NPG (2013), b) Ref. [461] c OSA (2015), and c) Ref. [470] c IEEE (2017).</p>
        <p>A critical part for the successful completion of CV-QKD is the remaining post-processing protocols which include error reconciliation, parameter estimation and privacy amplification. The latter scheme is standard for any communication system (and thus will not be discussed further in this review) while the two former schemes are more complicated as they require sophisticated computational algorithms specifically tailored for CV-QKD. Furthermore, the performance of CV-QKD, that is key rate and distance, critically depends on the efficiency of the error correction algorithm and the quality of parameter estimation scheme.</p>
        <p>Error reconciliation. In long-distance communication, the signal-to-noise ratio (SNR) of the acquired data is usually very low and thus the reconciliation of the Gaussian correlated variables is computationally very hard. Earlier versions of high-efficiency error correction protocols for CV-QKD could only handle data with an SNR larger than around 1, thereby inherently limiting the secure communication distance to about 25km corresponding to a small metropolitan sized network. However, in recent years there have been numerous new developments in constructing high-efficiency error-correcting codes operating at very low SNR. New code developments have resulted in a significant improvement of the performance of CV-QKD and was the key stepping stone for realizing long-distance communication. E.g. the work in ref. [463] performed error correction with an efficiency of 96% at an SNR=0.08 as obtained with an 80km link while in ref. [462] the efficiency was 95.6% at SNR=0.002 corresponding to a 150km fiber link.</p>
        <p>The key innovation leading to these improved codes is to combine multi-edge low density parity check (LDPC) codes with multidimensional reconciliation techniques [459,[484][485][486][487][488]. A rate-adaptive reconciliation protocol was proposed in Ref. [487] to keep high efficiency within a certain range of SNR, which can effectively reduce the SNR fluctuation of the quantum channel on the system performance. Throughputs of 25Mbit/s [485] and 30Mbit/s [488] have been achieved, which are not yet compatible with high speed system using clock speeds of more than 100 MHz [461]. However, the speed of the LDPC decoder do not currently representing the key bottleneck in extending the distance of QKD. One of the main limiting factors in extending the distance is the efficiency and quality in estimating the parameters of the system.</p>
        <p>Parameter Estimation. The quality of practical parameter estimation is crucial for the reliable extraction of secret keys for long-distance communication. In addition to the estimation of the phase and frequency differences for LO adjustments as discussed above, it is important also to estimate the transmitter's modulation variance µ, the channel transmittance η and the variance of the excess noise ε. The two variances are expressed in shot noise units and thus a careful calibration of the shot noise level is also required. Once all parameters are estimated, they are used to compute the bounds on the Eve's information. However, the reliability in warranting security strongly depends on the precision in estimating the parameters. Very large data block sizes are often required to reduce the finite-size effects to a level that is sufficiently low to claim security (see also IX). As an example, in Ref. [463], a secret key was generated by using blocks of size 10 9 for a 80km channel but by reducing the block size to 10 8 , no key could be extracted as a result of the finite-size effect. Likewise in Ref. [462] a block size of 10 10 was used to enable secret key generation over 100km. To extend the distance further, even larger data blocks are required. This places more stringent demands on the stability of the system to allow for longer measurement series, and it calls for an increase in the measurement rate realized by a larger clock rate and higher detector bandwidth.</p>
        <p>Practical key rate: Within a certain data block, half of the data are used for sifting (if homodyne detection is used), a subset is used for parameter estimation and another subset is used for phase synchronization of the local oscillator. The remaining data are then used for secret key generation and thus undergo error correction with efficiency ξ and privacy amplification. In a stable system it is also possible to perform error correction first, using the SNR estimate from the previous round, and then use all the data for parameter estimation. If the clock rate is given by C and the fraction of data used for key extraction is f , the final practical key rate in RR is given by</p>
        <p>where I AB is Alice-Bob mutual information and χ BE is Eve's Holevo information on Bob's variable. The fastest system of today produces secret keys of 1Mbps (for 25km) while the longest distance attained is 150km with a key rate of 30kbps. Both realizations are secure against collective attacks and include finite-size effects.</p>
        <p>The point-to-point coherent state protocol discussed above is by far the most mature CV-QKD scheme developed, and furthermore, since it is reminiscent of a coherent classical communication system, it is to some extend compatible with the existing telecom networks. However, the point-to-point scheme might in some cases be vulnerable to quantum hacking attacks and it possess some limitations in speed and distance. To circumvent some of these vulnerabilities and limitations, more advanced CV-QKD protocols have been proposed and experimentally tested in proof-of-principle type experiments using bulk optical components and often without post-processing. In the following we briefly discuss these demonstrations.</p>
        <p>There has been two implementations of QKD based on squeezed states. The schemes were discussed in Section VII C, and were shown to be capable of extending the distance of QKD [386] or to enable composable security [489]. In the following we briefly address the experimental details of these realizations.</p>
        <p>In both experiments, two-mode squeezed states were generated by interfering two single-mode squeezed states on a balanced beam splitter. The squeezed states were produced in cavity-enhanced parametric downconversion using non-linear crystals (PPKTP) inside high-quality optical cavities [490]. One mode of the twomode squeezed state was measured with high-efficiency homodyne detection at the transmitter station while the other mode was transmitted in free space to Bob who performed homodyne/heterodyne measurements. The homodyne measurements at Alice's station steered the state at Bob's station into a Gaussian distribution of amplitude or phase quadrature squeezed states and thus the scheme is effectively similar to a single-mode squeezed state protocol. The noise suppression below shot noise of the two-mode squeezed states were measured to be 3.5dB at 1064nm [386] and 10.5dB at 1550nm [489]. The clock rate of the experiments was in principle limited by the bandwidth of the cavity-enhanced parametric amplifiers (21MHz in Ref. [386] and 63MHz in Ref. [489]) but in the actual implementations, the bandwidth was set to a few kHz given by filters in the homodyne detectors.</p>
        <p>In such squeezed state systems, the size of the alphabet is often limited to the degree of anti-squeezing and thus it is not possible in practice to maximize the key rate with respect to the modulation depth. However, in Ref. [386] the Gaussian alphabet was further extended by modulating the mode sent to Bob with a pair of modulators. With this approach, the system becomes more robust against excess noise and thus it is possible to extend the distance over which secure communication can be realized. The squeezed state experiment in Ref. [489] was used to demonstrate CV-QKD with composable security. E.g. for a channel loss of 0.76 dB (corresponding to 2.7km fiber), they achieved composable secure key generation with a bit rate of 0.1 bit/sample using a reconciliation efficiency of 94.3%. Furthermore, the system was also used to demonstrate one-sided-device-independent security against coherent attacks.</p>
        <p>In a recent work [491], it was experimentally demonstrated that by using squeezed states encoding with a uni-dimensional and small alphabet, it is possible to completely eliminate the information of Eve in a purely lossy channel. This reduces the computational complexity of the post-processing protocols and therefore might be of interest in future CV-QKD schemes despite the limited size of the alphabet.</p>
        <p>As discussed in Section IV G, MDI-QKD schemes circumvent quantum hacking attacks on the measurement system. A CV version of the MDI-QKD scheme (see Section VII K) has been realized in a proof-of-concept experiment [182]. Here amplitude and phase modulation were applied to CW beams both at Alice's and at Bob's site. The modulated beams underwent free space propagation before being jointly measured in a CV Bell state analyzer. Such an analyzer consists normally of a balanced beam splitter -in which the two incoming beams interfere -followed by two homodyne detectors measuring orthogonal quadratures. In the current experiment, however, the Bell analyzer was significantly simplified by using the carriers of the signals as local oscillators: Through a proper phase space rotation of the carriers enabled by the interference, information about the sum of the amplitude quadratures and the difference of the phase quadratures were extracted by simple direct measurements of the beam splitter output modes followed by an electronic subtraction and summation. Losses of the channels were simulated in the experiments by varying the modulation depths of the modulators, and for an attenuation of respectively 2% and 60% for the two channels, a bit rate of 0.1 secret bits per use was deduced from a measured excess noise of 0.01SNU and an assumed post-processing efficiency of 97%.</p>
        <p>A. Finite-size analysis in QKD Here, we describe how to lift the security analysis of QKD protocols from more physical considerations to the same level of rigor as found for classical primitives in theoretical cryptography. This is crucial to assure that QKD can be safely used as a cryptographic routine in any type of applications. We have already seen the general structure of QKD protocols and discussed the precise composable security criterion in Section II. Here we describe in detail how to give mathematically precise finite key security analyzes. We emphasize that such finite key analyzes are crucial to understand the security properties of any practical quantum hardware, just as every distributed key will have finite length and will only be approximately secure.</p>
        <p>We start by reviewing the different known methods for finite key analyzes in Section IX B and then describe in more detail the state-of-the-art approach based on entropic uncertainty relations with side quantum information (Section IX C). As we will see, the security intuitively follows from the two competing basic principles of quantum physics: the uncertainty principle and entanglement. We then discuss CV protocols in Section IX D and end with an outlook Section IX E, commenting on extensions to device-independent QKD.</p>
        <p>It is natural to split the finite-size statistical analysis into two steps, and in fact most security proofs respect that structure. In the first step, discussed in Subsection IX B 1, called privacy amplification, we explain how the criterion for composable security (introduced in Subsection II D) can be satisfied as long as we can guarantee a sufficiently strong lower bound on a quantity called the smooth min-entropy H ε min of Alice and Bob's corrected raw key conditioned on Eve's side information. The second step, discussed in Subsection IX B 2 is then to find such lower bounds.</p>
        <p>Privacy amplification is a procedure that allows Alice and Bob, who are assumed to share a random bit string (called the raw key) about which the eavesdropper has only partial information, to extract a shorter random bit string (the secret key) that is guaranteed to be uncorrelated with the eavesdropper's information. To make this more precise, we first need to define what partial information about the raw key means. Since we are interested in finite-size effects, it turns out that the proper way to measure the eavesdropper's information is by assessing its probability of guessing the random bit string. This is done using the smooth min-entropy [53]. The higher the smooth min-entropy of the eavesdropper on the raw key, the more secret key can be extracted using the privacy amplification scheme.</p>
        <p>A simple way of extracting Alice's secret key is by applying a random hash function to her raw bit strings (technically, the random hash function must form a twouniversal family). This was shown to work even when the eavesdropper has a quantum memory by Renner [53] who provided a quantum generalization of the so-called Leftover Hashing Lemma. This method has the advantage that the random seed used to decide on the hash function is independent of the resulting random bit string (i.e. the extractor is strong) and hence the seed can be published over the public channel to Bob. This way both Alice and Bob can apply the same hash function, and since their initial bit strings agreed their final strings will too. Thus, we end up with Alice and Bob both holding bit strings that are independent of the eavesdropper's information -and thus a secret key between them has been successfully established.</p>
        <p>Therefore, as long as we can guarantee some lower bound on the min-entropy of the raw key, privacy amplification can be invoked to extract a secret key.</p>
        <p>There are a plethora of techniques available to analytically show that the smooth min-entropy of the raw key is indeed large given the observed data but it is worth summarizing the most important ones. We give a more detailed exposition of one of the most powerful techniques, based on entropic uncertainty relations, in Section IX C. We restrict our attention here to finite-dimensional quantum systems and discuss CV protocols in Section IX D.</p>
        <p>a. Asymptotic equipartition and exponential de Finetti [53]. Under the independent and identically distributed (i.i.d.) assumption where the total state of the system after the quantum phase has product form, the smooth min-entropy can be bounded by the von Neumann entropy of a single measurement, using the socalled quantum asymptotic equipartition property [492]. This von Neumann entropy can in turn be estimated using state tomography, performed on the quantum state shared between Alice and Bob. This approach often works directly when we only consider individual or collective attacks, as the state after the distribution phase then usually admits an i.i.d. structure. However, with general coherent attacks such a structure can no longer be guaranteed. Nonetheless, Renner [53], in his seminal work establishing the security of BB84 for finite length keys, uses an exponential de Finetti theorem to argue that, in a suitable sense, the general case can be reduced to the i.i.d. setting as well. This comes at a significant cost in extractable key, however.</p>
        <p>b. Asymptotic equipartition and post-selection [493]. In particular the latter reduction, using the exponential de Finetti theorem, leads to large correction terms that make the security proof impractical. It can be replaced by a significantly tighter method (based on similar representation-theoretic arguments), the so-called postselection technique [493].</p>
        <p>c. Virtual entanglement distillation [84,494]. This technique can be traced back to one of the early security proofs by Shor and Preskill [84] and has been adapted to deal with finite key lengths by Hayashi and Tsurumaru [494]. The basic idea is to interpret part of the raw key as a syndrome measurement of a Calderbank-Shor-Steane (CSS) code and use it to virtually distill entanglement on the remaining qubits. The crucial point is that this can be done after measurement (hence virtual) so that no multi-qubit quantum operations are required. The correctness and secrecy of Alice and Bob's key then follows directly from the fact that they effectively measured a close to maximally entangled state.</p>
        <p>d. Entropic uncertainty relations with side quantum information [495,496]. This approach is based on an entropic uncertainty relation [497] that allows us to directly reduce the problem of lower bounding the smooth min-entropy of the raw key conditioned on the eavesdropper's information with a different, more tractable problem. Namely, instead of bounding the min-entropy we need only ensure that the correlations between Alice's and Bob's raw keys are strong enough in an appropriate sense, which can be done by a comparably simple statistical tests. This reduction naturally deals with general attacks and gives tight bounds for finite keys.</p>
        <p>The intuition and some of the details behind this approach will be discussed in detail in the next section. The proof technique has recently been reviewed in detail and in a self-contained way in [498].</p>
        <p>e. Entropy accumulation [499]. A recent proof technique uses entropy accumulation [157] to argue that the smooth min-entropy accumulates in each round of the protocol. This security proof naturally deals with the socalled device independent setting (see Section IV). The bounds, while still not as strong as the ones that can be achieved using the last two methods discussed above, have recently been improved in [171].</p>
        <p>C. Uncertainty principle versus entanglement: an intuitive approach to QKD security One of the basic principles of quantum physics that is intuitively linked to privacy is Heisenberg's uncertainty principle [500]. In its modern information-theoretic form due to Maassen-Uffink [501] it states that for any two measurements X, Z with eigenvectors |x , |z , respectively, we have</p>
        <p>where H(X) =x p x log 2 p x denotes the entropy of the post-measurement probability distribution. Importantly, the bound on the right-hand side is independent of the initial state and the first ideas of directly making use of this uncertainty principle for security proofs can be traced back to [502,503]. It turns out, however, that when taking into account the most general coherent attacks, the adversary might have access to a quantum memory and with that to the purification of the state held by the honest parties. Now, when starting with a maximally entangled bipartite state Φ AB and applying measurement X or Z on the A-system, then it is easily checked that there always exists a measurement on the B-system that reproduces the measurement statistics on A, independent if X or Z was measured! This phenomenon was first discussed in the famous EPR paper [504] and in terms of entropies it implies that</p>
        <p>where H(X|B) := H(XB) -H(B) denotes the conditional von Neumann entropy of the post-measurement classical-quantum state. We emphasize that this is in contrast to classical memory systems B, for which the left-hand side of (118) would always respect the lower bound from (117).</p>
        <p>Luckily, entanglement turns out to be monogamous in the sense that for tripartite quantum states ABC the more A is entangled with B the less A can be entangled with C (and vice versa). Moreover, it is now possible to make this monogamy principle of entanglement quantitatively precise by showing that the Maassen-Uffink bound is recovered in the tripartite setting [495]</p>
        <p>It is this type of entropic uncertainty relation with quantum side information that is employed for deducing the security of QKD. (Entropic uncertainty relations with and without quantum side information as well as their applications in quantum cryptography are also reviewed in [505].) Note that there is now no need to distinguish between individual, collective, and coherent attacks but rather (119) directly treats the most general attacks. This is crucial for not ending up with too pessimistic estimates for finite secure key rates.</p>
        <p>To continue, we actually need an entropic uncertainty relation suitable for the finite key analysis. This is in terms of smooth conditional min-and max-entropies, taking the form [497]</p>
        <p>where Y n is Alice's raw key (of length n bits), Ŷ n is Bob's raw key, E denotes Eve's information and Θ n labels the basis choice of the measurements made in the n rounds by the honest parties (e.g., for BB84 if X or Z was chosen in each round). An information reconciliation protocol can then be used to make sure that Alice and Bob hold the same raw key. Taking into account the maximum amount of information that gets leaked to the eavesdropper in this process, denoted leak ec , this yields the bound</p>
        <p>Therefore, it only remains to statistically estimate H ε max (Y n | Ŷ n ), which can be done by calculating the number of bit discrepancies between Alice and Bob on a random sample of the raw keys [496].</p>
        <p>For infinite-dimensional systems, finite-key approaches based on exponential de Finetti or post-selection unfortunately fail [506], unless additional assumptions are made that lead to rather pessimistic finite-key rate estimates [54]. Fortunately, for protocols based on the transmission of TMSV states measured via homodyne detection (therefore squeezed-state protocols), the proof principle via entropic uncertainty applies as well, leading to a tight characterisation [58,59]. This follows the intuition from the early work [502] and is based on the entropic uncertainty relations with side quantum information derived in [507,508].</p>
        <p>Importantly, the analysis does not directly work with continuous position and momentum measurements but rather with a binning argument leading to discretized position and momentum measurements. Namely, a finite resolution measurement device gives the position Q by indicating in which interval I k;δ := kδ, (k + 1)δ of size δ &gt; 0 the value q falls (k ∈ Z). If the initial state is described by a pure state wave function |ψ(q) Q we get</p>
        <p>2 dq (122) with entropy</p>
        <p>For these definitions we then recover a discretized version of the of Everett-Hirschman [509,510] entropic uncertainty relation</p>
        <p>log 2 δ q δ p S</p>
        <p>(1) 0</p>
        <p>where S</p>
        <p>(1) 0 (•, •) denotes the 0th radial prolate spheroidal wave function of the first kind [511]. Extending this to quantum side information we find similarly as in the finite-dimensional case that [507]</p>
        <p>log 2 δ q δ p S</p>
        <p>(1) 0</p>
        <p>Extending this to the smooth min-entropy then allows for the same security analysis as in (119).</p>
        <p>For other classes of CV protocols where the entropic uncertainty approach is not known to work, finite key security is analyzed via a recently discovered Gaussian de Finetti reduction that exploits the invariance under the action of the unitary group U (n) (instead of the symmetric group S(n) as in usual de Finetti theorems) [60,400,512,513]. This then recovers the widely held belief that Gaussian attacks are indeed optimal in the finite key regime as well.</p>
        <p>Going forward from a theoretical viewpoint some of the main challenges in the security analysis of quantum key distribution schemes are:</p>
        <p>• To refine the mathematical models on which the security proofs are based to more accurately match the quantum hardware used in the actual implementations. This is of crucial importance to decrease the vulnerability to quantum hacking, which is typically based on side channel attacks exploiting weaknesses of the quantum hardware [514]. Intensified collaborations of theorists and experimentalists should help to close this gap between realistic implementations and provable security.</p>
        <p>• Device independent QKD makes fewer assumptions on the devices used and hence naturally takes care of issues with imperfect hardware. However, it still remains to determine the ultimate finite key rates possible in device-independent QKD. The state-of-the-art works are based on entropy accumulation [157,499] and have recently been improved [171]. In contrast to the tightest device dependent approach based on entropic uncertainty relations with side quantum information (as presented in Section IX C), the lower bounds on the smooth min-entropy are achieved in a device independent way by ensuring that there is enough entanglement present. The details are beyond the scope of this review but the open question is then to determine if the same experimentally feasible trade-off between security and protocol parameters is available as in the device dependent case.</p>
        <p>• From a more business oriented perspective it is crucial to argue that QKD schemes not only offer security in an abstract information-theoretic sense but are actually more secure in practice compared to widely used classical encryption schemes. That is, it is important to realize that in typical every day use cases no cryptographic scheme is absolutely secure but instead the relevant question is how much security one can obtain for how much money. Given the ongoing development around post-quantum or quantum-secure-cryptography [515] we believe that there is still significant territory to conquer for QKD.</p>
        <p>A practical implementation of QKD protocols is never perfect and the performance of protocols depends on the applicability of the security proofs and assumptions to the real devices, as well as on numerous parameters, including post-processing efficiency and the level of noise added to the signal at each stage (including the noise added due to attenuation). Broadly speaking, quantum hacking encompasses all attacks that allow an eavesdropper to gain more information about messages sent between the trusted parties than these parties assume to be the case, based on their security proofs. Since security proofs are constructed on physical principles, this can only be the case if one or more of the assumptions required by the security proof does not hold [516]. If this is the case, the proof will no longer be valid, and Eve may be able to gain more information about the message than Alice and Bob believe her to have. These assumptions include the existence of an authenticated channel between Alice and Bob, the isolation of the trusted devices (i.e. that Eve cannot access Alice and Bob's devices) and that the devices perform in the way that they are expected to. Certain forms of quantum hacking have already been mentioned in this review, such as the photon-number splitting (PNS) attack against DV-QKD protocols.</p>
        <p>Exploitable imperfections in the trusted parties' devices that allow quantum hacking are called sidechannels. These could take the form of losses within the trusted devices that could potentially contribute to Eve's information about the signal, or added noise within the devices that could be partially controlled by Eve, in order to influence the key data. Such partially controllable losses and noises constitute threats to the security of QKD protocols, if overlooked. Quantum hacking often serves one of two purposes: to directly gain information about the secret key or to disguise other types of attack on a protocol, by altering the trusted parties' estimation of the channel properties. To restore security, the trusted parties can either incorporate the side-channels into their security analysis, in order to not underestimate Eve's information, or can modify their protocol to include countermeasures. In this section, we will discuss some common side-channel attacks, and how their effects can be mitigated. See also Ref. [517] for a very recent review on the topic. It is clear that the study of quantum hacking is an important aspect for the real-life security of QKD implementations; it is central to the ongoing effort for the standardization of QKD by the European Telecommunications Standards Institute [518].</p>
        <p>The security proofs for many DV protocols, such as BB84 [519] and B92 [85], assume the use of single-photon sources. However, real QKD implementations often use strongly attenuated laser pulses, rather than true singlephoton sources, which will send some pulses with multiple photons [520]. The existence of such pulses allows the use of the (previously mentioned) PNS attack. This is where Eve beamsplits off all but one of the photons from the main quantum channel. Since Bob is expecting to receive a single-photon pulse, and since this pulse will be undisturbed (if Eve does not carry out any other attack), the trusted parties will not detect any additional error on the line. Eve can then store the photons she receives in a quantum memory until after all classical communication has been completed. She can then perform a collective measurement on her stored qubits, based on the classical communication, to gain information about the secret key, without revealing her presence to the trusted parties. For instance, in BB84, she will know all of the preparation bases used by Alice, after the classical communication is complete, and so will be able to gain perfect information about all of the key bits that were generated by multiphoton pulses.</p>
        <p>A method used to counter the PNS attack is the use of decoy states. For instance, the BB84 protocol can be modified into BB84 with decoy states [106][107][108][109][110]. In this protocol, Alice randomly replaces some of her signal states with multi-photon pulses from a decoy source. Eve will not be able to distinguish between decoy pulses, from the decoy source, and signal states, and so will act identically on both types of pulse. In the post-processing steps, Alice will publicly announce which pulses were decoy pulses. Using the yields of these decoy pulses, the trusted parties can then characterize the action of the channel on multi-photon pulses, and so can detect the presence of a PNS attack. They can then adjust their key-rate accordingly, or abort the protocol if secret key distribution is not possible.</p>
        <p>Imperfections in Alice's source can give rise to exploitable side-channels, which can allow Eve to carry out the PNS attack undetected. Huang et al [521] tested a source that modulates the intensity of the generated pulses by using different laser pump-currents, and found that different pump-currents cause the pulse to be sent at different times, on average. This means that the choice of intensity setting determines the probability that the pulse will be sent at a given time, and hence it is possible for Eve to distinguish between decoy states and signal states, based on the time of sending. Eve can then enact the PNS attack on states that she determines to be more likely to be signal states, whilst not acting on states that she determines to be likely to be decoy states. This would allow her PNS attack to go undetected by the trusted parties. They then bounded the key rate for BB84 with decoy states, using an imperfect source (for which the different intensity settings are in some way distinguishable).</p>
        <p>Huang et al. [521] also tested a source that uses an external intensity modulator to determine the intensity settings (meaning that the intensity is modulated after the laser pulse is generated). They found that such sources do not give a correlation between intensity setting and sending time, giving a possible countermeasure to attacks based on this side-channel. Another option is for Alice to change the time at which the pump-current is applied depending on the intensity setting, in order to compensate for this effect. Eve may be able to circumvent this countermeasure, however, by heating Alice's source using intense illumination. Fei et al. [522] found that if gain-switched semiconductor lasers are heated, the pulse timings of different intensity settings shift relative to each other, so Alice will no longer be able to compensate for the timing differences unless she knows that they have been changed. They also found that heating the gain medium can cause the time taken for the carrier density to fall to its default level between pulses to increase. This could lead to unwanted (by Alice) correlations between pulses, which could compromise the security of the protocol.</p>
        <p>Another form of hacking that can be used against DV-QKD protocols is the Trojan horse attack (THA) [523][524][525]. This encompasses a variety of different types of attack that involve sending quantum systems into one or both of the trusted parties' devices in order to gain information. For instance, Vakhitov et al. [525] considered the use of large pulses of photons to gain information about Alice's choice of basis and about Bob's choice of measurement basis, in BB84 and B92. The information is gained by sending a photon pulse into the trusted device via the main channel and performing measurements on the reflections. Considering the case in which the qubit is encoded via a phase shift, if Eve is able to pass her pulse through Alice's phase modulator, measuring the resulting pulse will give some information about the signal state. This is possible because Alice's phase modulator operates for a finite amount of time (rather than only being operational for exactly long enough to modulate the signal state), giving Eve a window in which to send her own pulse through, to be modulated similarly to the signal pulse. The process of Eve gaining information about the basis choice via reflectometry is described in some detail by Gisin et al. [523].</p>
        <p>The information may be partial, giving only the basis used, or may directly give the key bit. Even in the case in which only the basis can be obtained, the security of the protocol is still compromised, as Eve is now able to always choose the same measurement basis as Alice, for an intercept and resend attack, gaining complete information about the key without introducing any error. Alternatively, Eve may be able to target Bob's device. For B92 or SARG04, it is sufficient to know Bob's measurement basis in order to gain complete information about the key. In BB84, if Eve is able to ascertain the measurement basis that Bob will use prior to the signal state arriving at his device, she can carry out an undetectable intercept and resend attack by choosing the same basis as him. Vakhitov et al. [525] also note that even if Eve only gains information about Bob's basis after the signal state has been measured, this can help with a practical PNS attack, since it reduces the need for a quantum memory (Eve can carry out a measurement on the photons she receives immediately, rather than having to wait until after all classical communication is completed). This does not aid an eavesdropper who is limited only by the laws of physics, but it could help one who is using current technology.</p>
        <p>A number of methods of protecting against THAs have been proposed. Vakhitov et al. [525] suggested placing an attenuator between the quantum channel and Alice's setup, whilst actively monitoring the incoming photon number for Bob's setup. Gisin et al. [523] calculated the information leakage due to a THA, assuming heavy attenuation of the incoming state, and suggested applying phase randomization to any outgoing leaked photons. Lucamarini et al. [526] calculated the key rates for BB84, with and without decoy states (in the without case, assuming an ideal single-photon source), in the presence of a Trojan horse side-channel, parameterized by the outgoing photon number of the Trojan horse state. They then proposed an architecture to passively limit the potential information leakage via the Trojan horse system (without using active monitoring). This was done by finding the maximum incoming photon number in terms of the Laser Induced Damage Threshold (LIDT) of the optical fibre, which can be treated as an optical fuse. The LIDT is the power threshold over which the optical fibre will be damaged. The minimum energy per photon, which depends only on the frequency of the photons, is lower-bounded using an optical fibre loop, which selects for frequency (photons of too low a frequency will not totally internally reflect, and so will leave the loop). The maximum time for Eve's pulse is also known and bounded by the time it takes Alice's encoding device to reset between signals. Hence, the maximum number of photons per pulse can be upper-bounded. By correctly setting the attenuation of incoming photons, Alice can then upper-bound and reduce the information leakage due to any THA.</p>
        <p>Jain et al. [524] considered using THAs at wavelengths lower than the signal pulse in order to reduce the risk of detection by the trusted parties. This could reduce the efficacy of active monitoring of the incoming average photon number, as detectors often have a frequency band at which they are most sensitive, and so may not detect photons outside of this band. It could also lead to reduced attenuation of the Trojan state by passive attenuators, as the transmittance of a material is frequencydependent. Sajeed et al. [527] carried out experimental measurements on equipment used in existing QKD implementations at a potential THA wavelength as well as at the wavelength used by the signal state, and found that the new wavelength (1924 nm) reduced the probability of afterpulses in Bob's detectors, which could alert the trusted users to the attack. This came at the cost of increased attenuation and a lower distinguishability, due to the phase modulator being less efficient at the new wavelength. Jain et al. [524] suggest the use of a spectral filter to prevent attacks of this type. Further, the optical fibre loop in the setup proposed by Lucamarini et al. [526] would help prevent attacks at low wavelengths.</p>
        <p>Eve could also use a THA to target the intensity modulator, used by Alice to generate decoy states. If Eve can distinguish between decoy pulses and signal states, she can carry out a PNS attack without being detected, by ignoring decoy pulses and only attacking multi-photon signal states. Tamaki et al. [528] created a formalism for bounding the information leakage from the intensity modulator in terms of the operation of the modulator (i.e. the unitaries enacted by the modulator for each intensity level). They also develop the formalism for calculating the information leakage due to a THA against the phase modulator. Using these, they then calculated the key rate for BB84 with various types of THA (different assumptions about the details of the attack, and hence about the outgoing Trojan state), for fixed intensity of the outgoing Trojan horse mode.</p>
        <p>Vinay et al. [529] expanded on the work by Lucamarini et al. in [526], and showed that coherent states (displaced vacuum states) are the optimal Trojan horse state, amongst the Gaussian states, for Eve to use in an attack on BB84, assuming attenuation of the Trojan mode and a limited outgoing photon number. Based on a calculation of the distinguishability (a measure of the information leakage of a THA), they showed that adding thermal noise to both the signal state and the Trojan horse mode can provide an effective defence against a THA, greatly increasing the key rate for a given outgoing photon number. They then upper-bounded the distinguishability for THA attacks using different photon number statistics, expanding from the case of Gaussian states to more general separable states (allowing correlations between different Fock states, but assuming no entanglement between the Trojan horse mode and some idler state held by Eve). They found that this upper bound on the distinguishability was higher than the bound found in Ref. [526] but that it could be reduced to below the Lucamarini bound by applying their thermal noise defence. They also proposed the use of a shutter between Alice's device and the main channel, in conjunction with a time delay between the encoding apparatus and the shutter, as a defence that could be used in place of an attenuator. This would work by forcing the Trojan pulse to make several journeys through Alice's encoding apparatus, making it more difficult for Eve to accurately determine the encoded phase.</p>
        <p>A different type of side-channel attack is the detector backflash attack, introduced by Kurtsiefer et al. [530]. Detectors based on avalanche photodiodes (APDs) sometimes emit light (referred to as backflash light) upon detecting a pulse. This backflash light can give information to Eve about Bob's measurement outcome in a variety of ways. The polarization of the backflash light can give an indication of which components of Bob's system it has passed through, which could tell Eve which detector it originated from [531]. Alternatively, the travel time of the backflash photons (after entering Bob's detector) or path-dependent alterations to the profile of the outgoing light could also give Eve this information. This could tell Eve which measurement basis was chosen by Bob, and for certain detector setups could even reveal Bob's measurement outcome.</p>
        <p>Meda et al. [532] characterized two commercially used InGaAs/InP APDs and found that backflash light could be detected for a significant proportion of avalanche events. Pinheiro et al. [531] then built on this work by characterizing a commercial Si APDs; they also found that the backflash probability was significant, with a backflash probability greater than or equal to 0.065.</p>
        <p>Both papers found that the backflash light was broadband, and so could be reduced using a spectral filter. Pinheiro et al. [531] also characterized a photomultiplier tube, and found that it had a much lower backflash probability. They therefore suggested using photomultiplier tubes in place of APDs in Bob's detectors.</p>
        <p>The security of BB84 (and most DV protocols) is based on Eve and Bob's basis choices being independent. If Eve is able to exploit some imperfection in Bob's device that lets her influence Bob's basis or even choose it for him, this independence would no longer hold, and the security of the protocol may be breached. Makarov et al. [533] proposed a number of schemes that could allow an eavesdropper to control or influence Bob's detector basis or measurement results. These schemes use faked states; this is where Eve does not attempt to gain information without disturbing the signal state, but instead sends a state designed to take advantage of flaws in Bob's detection device to give him the results that she wants him to receive.</p>
        <p>Two of the proposed schemes take advantage of Bob's passive basis selection. Receiver implementations can select the measurement basis using a beamsplitter: this will randomly allow a photon through or reflect it onto another path. We call this passive basis selection, and differentiate it from active basis selection, in which Bob explicitly uses a random number generator to select the basis and changes the measurement basis accordingly [534]. If the beamsplitter used is polarization-dependent, Eve can tune the polarization of the pulses she sends such that they go to the basis of her choosing, allowing her to intercept and resend signals whilst ensuring that she and Bob always choose the same basis.</p>
        <p>The second scheme proposes a way around the countermeasure of placing a polarizer in front of the beamsplitter. Makarov et al. [533] suggest that imperfections in the polarizer will allow Eve to still choose Bob's basis if she uses sufficiently large pulses (albeit with heavy attenuation due to the polarizer). They also suggest the use of a polarization scrambler as a defence against these two schemes. Li et al. [535] proposed a similar type of attack, in which they exploit the frequency-dependence of the beamsplitter to allow them to choose Bob's basis with high probability.</p>
        <p>Makarov et al. [533] proposed two further schemes using faked states. One takes advantage of unaccounted for reflections in Bob's device, which could allow Eve to choose Bob's basis by precisely timing her pulses such that part of them reflects into the detectors in the correct time window for the chosen basis. This would require Eve to have a very good characterisation of Bob's device and carries the risk of detection due to side-effects caused by the part of the pulse that is not reflected. The second attack, briefly introduced in [533] and then expanded on in [536], exploits detector efficiency mismatch (DEM). This is where the detector corresponding to the outcome 0 has a different efficiency to the detector corresponding to the outcome 1 (here we are considering setups in which both bases are measured using the same pair of detectors, with a phase modulator beforehand to determine the basis used; it is also possible to have DEM in a setup in which four detectors are used) for some values of a parameter. This parameter could be time or some other parameter such as polarization, space or frequency. If Bob's detectors have DEM, a photon with a certain value of the parameter (e.g. a certain polarization) would be more likely to be detected by the detector giving the value 0, if it were to hit it, than to be detected by the detector giving the value 1, if it were to hit that detector (or vice versa). Note, however, that in reality the photon will only hit one of the detectors, depending on what value it encodes. In the attack, Eve intercepts Alice's states and measures them in some basis. She then sends a state to Bob in the opposite basis, with the timing chosen such that Bob is likely to receive no result rather than an error, reducing Bob's error rate at the cost of increasing loss (with the likelihood of this depending on how mismatched the detector efficiencies are). We say that one of Bob's detectors has been blinded, since it is less able to pick up signals.</p>
        <p>Lydersen et al. [148] demonstrated the possibility of using faked states to attack commercial QKD systems. They blinded the detectors using a continuous wave laser, exploiting the fact that APDs can be made to operate in linear mode; in this mode, the detectors do not register single photons. Eve sends in pulses to trigger Bob's detectors, and they will only give a result when he chooses the same basis as Eve (with the result in this case being the same as Eve's value). Lydersen et al. [537] showed that the APDs could also be blinded by heating them using bright light. Yuan et al. [538,539] argued that a properly operated APD would be difficult to keep in linear mode and that faked states attacks of this type could be identified by monitoring the photocurrent. Stipčević et al. [534] showed that detector blinding attacks can be treated as an attack on Bob's random number generator, and suggested that an actively selected basis with a four detector configuration (rather than using the same two detectors to measure both bases) could mitigate the effects of many types of blinding attack.</p>
        <p>Qi et al. [540] suggested a different attack based on DEM with the time parameter, which they called the time-shift attack. In this attack, Eve does not attempt to measure the signal state, but simply shifts the time at which it enters Bob's device, such that, if Bob has a detection event, it is more likely to be one value than another. For instance, if the detector corresponding to the outcome 0 has a higher efficiency at some given time than the detector corresponding to the outcome 1, Eve can know that if the time of arrival of the pulse is shifted such that it arrives at the detector at that particular time, and the pulse is detected by one of the detectors, it is more likely that the outcome was 0 than that it was 1. The greater the DEM, the more information Eve can gain about the key. This attack does not introduce any error in the resulting key bits, and was shown to be practical using current technology by Zhao et al. [541], who carried out the attack on a modified commercial system.</p>
        <p>In fact, there is no requirement that the DEM be parameterized by time. The detectors could be mismatched over polarization, frequency or even spatially [542]. Sajeed et al. [527] and Rau et al. [543] both showed that by altering the angle at which pulses enter Bob's device, it is possible to alter the relative sensitivity of the detectors, since the angle of entry will determine the angle at which the light hits the detectors, but small changes in the configuration of the setup could lead to different angles of incidence on each detector. The angle at which the pulse hits the detector determines the surface area of the detector that is hit by the pulse, and hence the sensitivity of the detector.</p>
        <p>One proposed countermeasure against attacks exploiting DEM is for Bob to use a four detector configuration, with the mapping of outcomes to detectors randomly assigned each time. However, this configuration is still vulnerable to a time-shift (or other DEM) attack, if the attack is coupled with a THA on Bob's device (which learns the detector configuration after the measurement has been carried out) [544]. A THA of this type is hard for Bob to defend against, and making Bob's device more complicated by adding hardware safeguards risks opening up more vulnerabilities for Eve to exploit, and so it is desirable to find a software solution (i.e. to calculate the key rate accounting for the possibility of DEM attacks).</p>
        <p>Fung et al. [542] found a formula for the key rate in the presence of a DEM for a very broad class of attacks, using a proof devised by Koashi [545]. Lydersen et al. [544] generalized this proof slightly. Both formulae require a thorough characterisation of the detector efficiencies over possible values of the DEM parameter. This may be difficult for the trusted parties, especially since they may not always know which parameters of the detector give rise to DEM. Fei et al. [546] calculated the key rate of BB84 with decoy states in the presence of DEM, using a new technique based on treating the detection process as a combination of the case in which there is no DEM and the case in which there is complete DEM (i.e. for some value of the parameter, there is 0% detection efficiency for one detector, but not for the other, and vice versa for some other value of the parameter). They then numerically simulated QKD in this case, and found that DEM decreases the secure key rate.</p>
        <p>The differences between the types of protocols and devices used in DV and CV protocols mean that not all hacking attacks on DV systems are directly applicable to CV systems. Some vulnerabilities, such as attacks on the local oscillator (LO), are specific to CV protocols, whilst some, such as THAs, are analogous to the attacks used on DV protocols. An important practical issue in the implementation of CV-QKD is calibration of the equipment used. The shot-noise must be determined, since it affects the parameter estimation. If this is not carried out accurately, the security of CV QKD may be undermined [547]. During calibration, the phase noise introduced during modulation should be estimated. By taking it into account in the security analysis, the key rate can be increased, since the phase noise added by the modulator can then be treated as trusted noise.</p>
        <p>To carry out measurements of Alice's signal states, Bob interferes them with an LO. Due to the difficulty of maintaining coherence between Alice's source and Bob's LO, implementations of CV-QKD often send the LO through the quantum channel. Since security proofs of CV-QKD do not account for this (as it is not theoretically necessary to send the LO through the channel), this leaves open some side-channels, which Eve can exploit. Häseler et al. [548] showed that the intensity of the LO must be monitored, in order to prevent Eve from replacing the signal state and LO with squeezed states, in such a way as to disguise an intercept and resend attack, by reducing the error relative to what the trusted parties would expect for such an attack. Huang et al. [549] and Ma et al. [550] proposed an attack on the LO based on the wavelength-dependency of beamsplitters. They found that by exploiting the wavelength-dependence of the beamsplitters in Bob's device, they could engineer Bob's outcomes, whilst preventing Bob from accurately determining the LO intensity. Huang et al. proposed a countermeasure in which a wavelength filter is applied at random, and any difference in channel properties between the cases in which it is applied and not applied is monitored.</p>
        <p>Jouguet et al. [551] devised another attack on the LO. This attack uses the fact that Bob's clock is triggered by the LO pulse. By changing the shape of the LO pulse, Eve can delay the time at which the clock is triggered. This can lead to Bob incorrectly calculating the shot-noise, and hence can allow Eve to carry out an intercept and resend attack undetected. As a countermeasure, Jouguet et al. suggest that Bob should measure the shot-noise in real-time by randomly applying strong attenuation to the signal. Huang et al. [552] built on this by showing that an attack exploiting the wavelength-dependence of beamsplitters could be used to defeat Bob's attempt to measure the shot-noise in realtime. However, they found that by adding a third attenuation value (rather than just on or off) to the strong attenuation could prevent their attack. Xie et al. [553] also found that a jitter effect in the clock signal can lead to an incorrect calculation of the shot noise, and Zhao et al. [554] identified a polarization attack where the eavesdropper attacks unmeasured LO pulses to control and tamper with the shot-noise unit of the protocol.</p>
        <p>In order to prevent LO attacks altogether, Qi et al. [478] and Soh et al. [477] proposed and analyzed a way in which Bob could generate the local oscillator locally (LLO). Alice regularly sends phase reference pulses, and Bob applies a phase rotation to his results during postprocessing, to ensure that they are in phase with Alice's source. Marie et al. [555] improved on this scheme, in order to reduce the phase noise. Ren et al. [556] proposed that even an LLO could be vulnerable to a hacking attack if the trusted parties assume that the phase noise is trusted, and cannot be used by Eve. In this case, Eve can lower the phase noise, by increasing the intensity of the phase reference pulses, and compensate for the reduced phase noise by increasing her attack on the signal states, so that the total noise on Bob's measurements remains the same.</p>
        <p>Qin et al. [557] considered saturation attacks on Bob's homodyne detectors. Such attacks exploit the fact that CV-QKD security proofs assume a linear relationship between the incoming photon quadratures and the measurement results (that the quadrature value linearly corresponds to the measurement result), but in reality, homodyne detectors have a finite range of linearity. Above a certain quadrature value, homodyne detectors will saturate, meaning that the measurement result will be the same whether the quadrature value is at the threshold level or above it. For instance, a quadrature value of 100 shot-noises could give the same measurement result as a quadrature value of 200 shot-noises. Qin et al. considered exploiting this by using an intercept and resend attack and then rescaling and displacing the measured states (multiplying them by some factor and then adding a constant displacement to them). By causing Bob's measurement results to partially overlap with the saturation region, Eve can alter the distribution of measurement results, and so reduce the trusted parties' error estimation.</p>
        <p>Qin et al. [557] also proposed some countermeasures, including the use of a Gaussian post-selection filter [558,559] to try and ensure that the measurement results used for key generation fall within the linear range of the detector and the use of random attenuations of Bob's signal, to test whether the measurement results are linearly related to the inputs. Qin et al. [560] expanded on their previous work, considering a slightly different attack in which an incoherent laser is used to displace Bob's measurement results into the saturated range. They also demonstrated saturation of a homodyne detector experimentally and numerically simulated their attack to show feasibility.</p>
        <p>CV protocols are also vulnerable to THAs [561]. By sending Trojan states into Alice's encoding device, Eve can try to learn how the signal states have been modulated, without disturbing the signal state itself. Derkach et al. [562] considered a leakage mode side-channel in Alice's device. They modeled this side-channel as a beamsplitter in Alice's device, coupling the signal state to a vacuum state after modulation. They also considered a side-channel allowing Eve to couple an untrusted noise to the signal state prior to detection. They then calculated the resulting key rates for both coherent state and squeezed state protocols, using reverse reconciliation. Derkach et al. suggest some countermeasures to the sender side-channel based on manipulation of the input vacuum state to the beamsplitter, and to the receiver side-channel based on measuring the output of the coupled noise. They then expanded on their earlier work [563], considering two types of side-channel leakage: leakage after modulation of the signal state and leakage prior to modulation, but after squeezing of the signal state (in the squeezed state protocol). They allowed multiple leakage modes from each side-channel. They calculated the key rates for both direct and reverse reconciliation, for side-channels of this type, and optimized the squeezing for post-modulation leakage.</p>
        <p>Pereira et al. [564] considered a THA on Alice, in the coherent state protocol, in which Eve is able to send a Trojan state with a bounded average photon number into Alice's box. This state is then modulated in a similar way to the signal state and returned to Eve. The key rate and security threshold are calculated, for reverse reconciliation. Active monitoring of incoming light is suggested as a countermeasure. Ma et al. [565] considered a THA on the two-way protocol, in which Eve sends a state into Alice's device, following Bob's signal state, and then measures this state to gain information about the modulation applied by Alice. They suggest the use of active monitoring to remove the Trojan state.</p>
        <p>Part of the noise originating from the trusted parties' devices can be assumed to be trusted and therefore not under the control of an eavesdropper. Such trusted noise could be the noise of the signal states (e.g. thermal noise in thermal-state protocols), noise added by the modulators or the noise of the detection. Trusted noise can have different impacts on CV QKD depending on the reconciliation direction. Trusted noise on the reference side of the protocol can even be helpful due to decoupling Eve's systems from the information shared by the trusted parties. On the other hand, noise on the remote side of reconciliation protocols can be harmful for the protocols, despite being trusted [381].</p>
        <p>A number of more general attacks exist, which can be used against both DV or CV protocols (although much of the current research has been focused on DV protocols), based on altering the properties of the devices used. These type of attacks can be used to create vulnerabilities even in well-characterized devices.</p>
        <p>Jain et al. [566] suggested and experimentally tested an attack that Eve could carry out during the calibration phase of a QKD protocol. The attack targets the system whilst Bob is calibrating his detectors (for a DV protocol) using a line length measurement (LLM). Attacks of this type are implementation dependent; in the system under consideration, Jain et al. found that by changing the phase of the calibration pulses sent by Bob during the LLM, they could induce a DEM (in the time parameter). This would open up the system to other types of attack (such as those previously mentioned), and would be especially problematic, since the trusted parties would not realise that Bob's device was miscalibrated. Building on this, Fei et al. [567] found that by sending faked calibration pulses during the LLM process, they could induce DEM or basis-dependent DEM with high probability. Fei et al. suggest adding a system to allow Bob to test his own device for calibration errors after the calibration process.</p>
        <p>Even if an implementation is perfect, it could be possible for Eve to create vulnerabilities, by damaging components of the trusted parties' devices using a laser. Bugge et al. [568] suggested that Eve could use a laser to damage to components such as the detectors or any active monitoring devices, allowing other attacks to be enacted. They showed that APDs could be damaged by intense laser light, reducing their detection efficiency and hence permanently blinding them. This creates loopholes for Eve, without requiring her to continuously ensure that the detectors are kept blinded. Higher laser powers rendered APDs completely non-functional; this could be exploited by Eve if an APD were being used as a monitoring device (e.g. for Trojan pulses). Makarov et al. [569] demonstrated this on a commercial system and then showed that they were able to melt a hole in a spatial filter, meant to protect against spatial DEM.</p>
        <p>Sun et al. [570] considered an attack on Alice's source. By shining a continuous wave laser onto Alice's gain medium, Eve is able to control the phase of Alice's pulses. This could open up loopholes for other attacks in both DV and CV systems. Sun et al. suggest monitoring the light leaving Alice's source and the use of active phase randomization.</p>
        <p>A conceptually different approach to dealing with sidechannels is the development of device-independent protocols (DI-QKD) [80], which can prevent a lot of side-channel attacks. As discussed in Section IV, this is a type of QKD that allows for untrusted devices, which could even have been produced by Eve. Schemes for implementing DI-QKD have been designed for both the DV [163] and the CV [571] cases. Where sources can be trusted, measurement device-independent QKD (MDI-QKD) schemes can be used instead. These have also been designed for both the DV [176,177] and the CV [182] cases. DI-and MDI-QKD protocols are harder to implement and so in general give lower key rates than device-dependent protocols. In spite of improving security, neither are immune to attack. In all protocols there is a requirement that Alice and Bob's devices be isolated from the outside world (in particular from Eve). If there is a hidden channel that allows Eve to gain access to measurement outcomes, then the key will not be secure. MDI-QKD is also vulnerable to source imperfections, such as the previously-mentioned attack by Sun et al. [570]. Therefore, device-independence cannot be seen as a panacea for side-channels.</p>
        <p>One of the crucial problems in QKD is to achieve long distances at reasonably-high rates. However, since the proposal of the BB84 protocol [77], it was understood that this is a daunting task because even an ideal implementation of this protocol (based on perfect singlephoton sources, ideal detectors and perfect error correction) shows a linear decay of the secret key rate R in terms of the loss η in the channel, i.e., R = η/2. One possible way to overcome the rate problem was to introduce CV QKD protocols. Their ideal implementation can in fact beat any DV QKD protocol at any distance, even though current practical demonstrations can achieve this task only for limited distances due to some implementation problems connected with finite reconciliation efficiency and other technical issues.</p>
        <p>One of the breakthrough in CV QKD was the introduction of the reverse reconciliation (RR) [373], where it is Alice to infer Bob's outcomes β, rather than Bob guessing Alice's encodings α, known as direct reconciliation (DR). This led the CV QKD community to considering a modified Devetak-Winter rate [51] in RR. This takes the form of I(α : β)χ(E : β), where the latter is Eve's Holevo information on Bob's outcomes. In a CV QKD setup, where both the energy and the entropy may hugely vary at the two ends of a lossy communication channel, there may be a non-trivial difference between the two reconciliation methods. Most importantly, it was soon realized that RR allowed one to achieve much longer distances, well beyond the 3dB limit of the previous CV approaches. At long distances (i.e., small transmissivity η), an ideal implementation of the CV QKD protocols proposed in Refs. [376,455] has rate R ≃ η/(2 ln 2) ≃ 0.72η. An open question was therefore raised:</p>
        <p>• What is the maximum key rate (secret key capacity) achievable at the ends of a pure-loss channel?</p>
        <p>With the aim of answering this question, a 2009 paper [34] introduced the notion of reverse coherent information (RCI) of a bosonic channel. This was quantity was previously defined in the setting of DVs [385,572]. It was called "negative cb-entropy of a channel" in Ref. [572] and "pseudocoherent information" in Ref. [4]; Ref. [385] introduced the terminology of RCI and, most importantly, it showed its fundamental use as lower bound for entanglement distribution over a quantum channel (thus extending the hashing inequality [51] from states to channels). Ref. [34] extended the notion to CVs where it has its more natural application.</p>
        <p>Given a bosonic channel E, consider its asymptotic Choi matrix σ E := lim µ σ µ E . This is defined over a sequence of Choi-approximating states of the form σ µ E :=</p>
        <p>, where Φ µ AB is a two-mode squeezed vacuum (TMSV) state [6] with n = µ -1/2 mean thermal photons in each mode. Then, we define its RCI as [34]</p>
        <p>with S(σ) := -Tr(σ log 2 σ) is the von Neumann entropy of σ. Here first note that, by changing Tr B with Tr A in Eq. ( 127), one defines the coherent information of a bosonic channel [34], therefore extending the definition of Refs. [573,574] to CV systems. Also note that I RCI (E) is easily computable for a bosonic Gaussian channel, because σ µ E would be a two-mode Gaussian state. Operationally, the RCI of a bosonic channel represents a lower bound for its secret key capacity and, more weakly, its entanglement distribution capacity [34]. A powerful CV QKD protocol reaching the RCI of a bosonic channel consists of the following steps:</p>
        <p>• Alice sends to Bob the B-modes of TMSV states Φ µ AB with variance µ. • Bob performs heterodyne detections of the output modes sending back a classical variable to assist Alice.</p>
        <p>• Alice performs an optimal and conditional joint detection of all the A-modes.</p>
        <p>The achievable rate can be computed as a difference between the Alice Holevo information χ(A : β) and Eve's Holevo information χ(E : β) on Bob's outcomes. Note that this is not a Devetak-Winter rate (in RR) but rather a generalization, where the parties' mutual information is replaced by the Holevo bound. Because Eve holds the entire purification of σ µ E , her reduced state ρ E has entropy S(ρ E ) = S(σ µ E ). Then, because Bob's detections are rank-1 measurements (projecting onto pure states), Alice and Eve's global state ρ AE|β conditioned to Bob's outcome β is pure. This means that S(ρ E|β ) = S(ρ A|β ). As a result, Eve's Holevo information becomes</p>
        <p>On the other hand, we also write</p>
        <p>where ρ A := Tr B (σ µ E ) and ρ A|β is conditioned to Bob's outcome. As a result we get the following achievable rate</p>
        <p>By taking the limit for large µ, this provides the key rate R(E) := lim µ R µ (E) = I RCI (E), so that the secret key capacity of the channel can be bounded as</p>
        <p>In particular, for a pure-loss channel E η with transmissivity η, we may write [34] K</p>
        <p>At long distances η ≃ 0, this achievable key rate decays as ≃ η/ ln 2 ≃ 1.44η bits per channel use. With the aim of providing an upper bound to the key rate of CV QKD protocols, in 2014 Ref. [575] introduced the Takeoka-Guha-Wilde (TGW) bound by employing the notion of squashed entanglement [576] for a bosonic channel. This led to the upper bound</p>
        <p>which is ≃ 2.88η bits per use at long distances. By comparing the lower bound in Eq. ( 132) and the upper bound in Eq. ( 133), we see the presence of a gap. This gap was finally closed in 2015 by Ref. [33] which derived the Pirandola-Laurenza-Ottaviani-Banchi (PLOB) upper bound for the pure-loss channel</p>
        <p>This was done by employing the relative entropy of entanglement (REE) [577][578][579], suitably extended to quantum channels, combined with an adaptive-to-block reduction of quantum protocols. As a result, Ref. [33] established the secret key capacity of the pure-loss channel to be</p>
        <p>This capacity cannot be beaten by any point-to-point QKD protocol at the two ends of the lossy channel. It can only be outperformed if Alice and Bob pre-share some secret randomness or if there is a quantum repeater splitting the quantum communication channel and assisting the remote parties. For this reason, the PLOB bound not only completely characterizes the fundamental rate-loss scaling of point-to-point QKD but also provides the exact benchmark for testing the quality of quantum repeaters. Note that a weaker version of the PLOB may also be written by explicitly accounting for the overall detector efficiency η det of a protocol. This corresponds to Alice and Bob having a composite channel of transmissivity η det η, so that the PLOB bound weakens tolog 2 (1η det η).</p>
        <p>Soon after the introduction of the PLOB bound, in early 2016 Ref. [39] (later published as Ref. [40]) established the secret key capacities achievable in chains of quantum repeaters and, more generally, quantum networks connected by pure-loss channels. In particular, in the presence of a single repeater, in the middle between the remote parties and splitting the overall pureloss channel E η of transmissivity η, one finds the following single-repeater secret key capacity</p>
        <p>In Fig. 11 we show the ideal key rates of state-ofthe-art point-to-point and relay-assisted QKD protocols, compared with the PLOB bound of Eq. ( 135) and the single-repeater bound of Eq. ( 136). By ideal rates we mean the optimal ones that can be computed assuming zero dark counts, perfect detector efficiency, zero misalignment error, as well as perfect error correction and reconciliation efficiency. Point-to-point protocols cannot beat the PLOB bound and asymptotically scales as ≃ η bits per channel use. This is the case for the BB84 protocol (both with single-photon sources and decoy-state implementation) and one-way CV-QKD protocols. Even though MDI-QKD is relay assisted, its relay is not efficient (i.e., it does not repeat), which is why DV-MDI-QKD is below the PLOB bound. After TF-QKD was introduced, a number of TF-inspired relay-assisted protocols were developed, all able to beat the PLOB bound. The middle relays of these protocols are efficient (i.e., they repeat). Their key rates cannot overcome the single repeater bound, but clearly follow its asymptotic rateloss scaling of ≃ √ η bits per channel use. In the following subsections, we provide the main mathematical definitions, tools, and formulas related to the study of the ultimate limits of point-to-point QKD protocols over an arbitrary quantum channel. Then, in subsequent Sec. XII we discuss the extension of these results to repeater-assisted quantum communications.</p>
        <p>Let us start by defining an adaptive point-to-point protocol P through a quantum channel E. Assume that Alice has register a and Bob has register b. These registers are (countable) sets of quantum systems which are prepared in some state ρ 0 ab by an adaptive LOCC Λ 0 applied to some fundamental separable state ρ 0 a ⊗ ρ 0 b . Then, for the first transmission, Alice picks a system a 1 ∈ a and sends Secret key rate (bits/use) FIG. 11. State of the art in high-rate QKD. We plot the ideal key rates of several point-to-point and relay-assisted protocols with respect to the PLOB bound [33] of Eq. ( 135) and the single-repeater bound [39,40] of Eq. ( 136). The key rates are expressed in terms of bits per channel use and plotted versus distance (km) at the standard fiber-loss rate of 0.2 dB per km. In particular, below the PLOB bound we consider: (CV) One-way coherent-state protocol with heterodyne detection [376], which coincides with the most asymmetric protocol for CV-MDI-QKD [182]. For long distances, the rate scales as 1/2 of the PLOB bound. The same asymptotic scaling is found for the coherent-state protocol with homodyne detection [455]; (1ph-BB84) The ideal BB84 protocol, implemented with single-photon sources [77]. This achieves the ideal rate of η/2; (decoy-BB84) BB84 protocol implemented with weak coherent pulses and decoy states achieving the ideal rate of η/(2e); (DV-MDI) Ideal implementation of a passive MDI-QKD node [176,177]. In particular, we plot the ideal performance of decoy state DV-MDI-QKD [177] with a rate of η/(2e 2 ). Then, we consider relay-assisted protocols able to beat the PLOB bound. In particular: (TF) Twin-field QKD protocol [183]; (PM) phase-matching QKD protocol [185]; (SNS) sending or not sending version of TF-QKD [187]; (AOPP) Active odd-parity pair protocol [190], which is an improved formulation of the SNS protocol; (NPPTF) No-phase-postselected TF-QKD protocol [191], including the variant of Ref. [195] with improved rate at short distances (blue dashed line). it through channel E; at the output, Bob receives a system b 1 which is included in his register b 1 b → b. Another adaptive LOCC Λ 1 is applied to the registers. Then, there is the second transmission a ∋ a 2 → b 2 through E, followed by another LOCC Λ 2 and so on (see Fig. 12). After n uses, Alice and Bob share an output state ρ n ab which is epsilon-close to some target state φ n with nR ε n bits. This means that, for any ε &gt; 0, one has ρ n abφ n ≤ ε in trace norm. This is also called an (n, R ε n , ε)-protocol. Operationally, the protocol P is completely characterized by the sequence of adaptive LOCCs L = {Λ 0 , Λ 1 . . .}.</p>
        <p>The (generic) two-way assisted capacity of the quantum channel is defined by taking the limit of the asymptotic weak-converse rate lim ε,n R ε n and maximizing over all adaptive protocols P, i.e.,</p>
        <p>The specification of the target state φ n identifies a corresponding type of two-way capacity. If φ n is a maximallyentangled state, then we have the two-way entanglement- distribution capacity D 2 (E). The latter is in turn equal to the two-way quantum capacity Q 2 (E), because transmitting qubits is equivalent to distributing ebits under two-way CCs. If φ n is a private state [580], then we have the secret key capacity K(E) and we have K(E) ≥ D 2 (E), because a maximally-entangled state is a particular type of private state. Also note that K(E) = P 2 (E), where P 2 is the two-way private capacity, i.e., the maximum rate at which Alice may deterministically transmit secret bits [581]. Thus, we may write the chain of (in)equalities</p>
        <p>The two-way capacity C(E) [i.e., any of the capacities in Eq. ( 138)] can be bounded by a general expression in terms of the REE [577][578][579]. First of all, recall that the REE of a quantum state σ is given by</p>
        <p>where γ is a separable state and S is the quantum relative entropy, defined by [577] S(σ||γ</p>
        <p>The notion of REE can be extended to an asymptotic state σ := lim µ σ µ , which is defined as a limit of a sequence of states σ µ (e.g., this is the case for energy unbounded states of CV systems). In this case, we may modify Eq. ( 139) into the following expression</p>
        <p>where γ µ is sequence of separable states that converges in trace-norm, i.e., such that ||γ µ -γ|| µ → 0 for some separable γ, and the inferior limit comes from the lower semi-continuity of the quantum relative entropy (valid at any dimension, including for CV systems [2]).</p>
        <p>With these notions in hand, we may write a general upper bound. In fact, for any quantum channel E (at any dimension, finite or infinite), we have [33] C</p>
        <p>where E ⋆ R (E) is defined by computing the REE of the output state ρ n ab , taking the limit for many channels uses, and optimizing over all the adaptive protocols P.</p>
        <p>To simplify the REE bound E ⋆ R (E) into a single-letter quantity, we adopt a technique of adaptive-to-block reduction or protocol "stretching" [33,389,582]. A preliminary step consists in using a suitable simulation of the quantum channel, where the channel is replaced by a corresponding resource state. Then, this simulation argument can be exploited to stretch the adaptive protocol into a much simpler block-type protocol, where the output is decomposed into a tensor product of resource states up to a trace-preserving LOCC.</p>
        <p>Given an arbitrary quantum channel E, we may consider a corresponding simulation S(E) = (T , σ) based on some LOCC T and resource state σ. This simulation is such that, for any input state ρ, the output of the channel can be expressed as</p>
        <p>See also Fig. 13. A channel E which is simulable as in Eq. ( 143) can also be called "σ-stretchable". Note that there are different simulations for the same channel. One is trivial because it just corresponds to choosing σ as a maximally-entangled state and T as teleportation followed by E completely pushed in Bob's LO. Therefore, it is implicitly understood that one has to carry out an optimization over these simulations, which also depend on the specific functional under study. More generally, the simulation can be asymptotic, i.e., we may consider sequences of LOCCs T µ and resource states σ µ such that [33]</p>
        <p>In other words a quantum channel E may be defined as a point-wise limit of a sequence of approximating channels E µ that are simulable as in Eq. ( 144). We call (T , σ) := lim µ (T µ , σ µ ) the asymptotic simulation of E. This generalization is crucial for bosonic channels and some classes of DV channels. Furthermore, it may reproduce the simpler case of Eq. ( 143). Note that both Eq. ( 143) and ( 144) play an important role in quantum resource theories (e.g., see also Eq. ( 54) of Ref. [584]). Given an asymptotic simulation of a quantum channel, the associated simulation error is correctly quantified in terms of the energy-constrained diamond (ECD) norm. Consider the compact set of energy-constrained states</p>
        <p>where N is the total multi-mode number operator. For two bosonic channels, E and E ′ , and N mean number of photons, we define the ECD distance as [33, Eq. ( 98)]</p>
        <p>(See also Ref. [583] for a slightly different definition, where the constraint is only enforced on the B part.) The condition in Eq. ( 144) means that, for any finite N , we may write the bounded-uniform convergence</p>
        <p>Since the first teleportation-based simulation of Pauli channels introduced in Ref. [585, Section V], the tool of channel simulation has been progressively developed over the years thanks to the contributions of several authors [586][587][588][589][590][591] and it is still today a topic of improvements and generalizations (e.g., see Table I in Ref. [389]). Here we have presented the most general formulation for FIG. 13. LOCC simulation of an arbitrary quantum channel E by means of an LOCC T applied to the input state ρ and a resource state σ, according to Eq. ( 143). For asymptotic simulation, we have the approximate channel E µ which is simulated by (T µ , σ µ ). We then take the point-wise limit for infinite µ, which defines the asymptotic channel E as in Eq. ( 144).</p>
        <p>the LOCC simulation of a quantum channel at any dimension (finite or infinite) as it has been formalized in Ref. [33]. This formulation enables one to deterministically simulate the amplitude damping (AD) channel.</p>
        <p>As a matter of fact, today we only know asymptotic simulations for the AD channel which either involves a limit in the dimension of the Hilbert space or a limit in the number of systems forming the resource state (e.g., implementing port-based teleportation [592][593][594][595] over an infinite number of Choi matrices [596]). It is an open problem to find a deterministic and non-asymptotic simulation for this channel, which would provide a better estimate of its secret key capacity, today still unknown. Also note that the tool of conditional channel simulation [597] seems to fail to simulate the AD channel, while it can easily simulate a diagonal amplitude damping ("DAD") channel or a "dephrasure" channel [598].</p>
        <p>Finally, note that the LOCC simulation is also useful to simplify adaptive protocols of quantum metrology and quantum channel discrimination [599]. See Ref. [600] for a review on adaptive quantum metrology and Ref. [601] for a recent review on quantum channel discrimination with applications to quantum illumination [602,603], quantum reading [604] and optical resolution [605][606][607].</p>
        <p>For some channels, the LOCC simulation takes a very convenient form. This is the case for the "teleportation covariant" channels, that are those channels commuting with the random unitaries of quantum teleportation [15][16][17][18], i.e., Pauli operators in DVs [1], phase-space displacements in CVs [6,7]. More precisely, a quantum channel E is called teleportation covariant if, for any teleportation unitary U , we may write</p>
        <p>for another (generally-different) unitary V . This property was discussed in Ref. [590,591] for DV systems and then in Ref. [33] for systems of any dimension.</p>
        <p>Note that this is a wide family, which includes Pauli channels (e.g., depolarizing or dephasing), erasure channels and bosonic Gaussian channels. Thanks to the property in Eq. ( 148), the random corrections of the teleportation protocol can be pushed at the output of these channels. For this reason, they may be simulated by teleportation. In fact, a teleportation-covariant channel E can be simulated as</p>
        <p>where T tele is a teleportation LOCC (based on Bell detection and conditional unitaries) and σ E is the Choi matrix of the channel, defined as σ E := I ⊗ E(Φ), with Φ being a maximally entangled state.</p>
        <p>For single-mode bosonic channels (Gaussian or non-Gaussian), we may write the asymptotic simulation [33]</p>
        <p>where T µ tele is a sequence of teleportation-LOCCs (based on finite-energy versions of the ideal CV Bell detection) and σ µ E := I ⊗E(Φ µ ) is a sequence of Choi-approximating states (recall that Φ µ is a TMSV state with n = µ -1/2 mean thermal photons in each mode).</p>
        <p>When a quantum channel can be simulated as in Eq. ( 149) or ( 150) may be called "Choi-stretchable" or "teleportation simulable". Let us also mention that, recently, non-asymptotic types of teleportation simulations have been considered for bosonic Gaussian channels [582,[608][609][610]]. These simulations remove the limit in the resource state (while the infinite-energy limit is still assumed in the CV Bell detection). It has been found that these simulations cannot provide tight results for quantum and private capacities as the asymptotic one in Eq. ( 150), as long as the energy of the resource state remains finite [611].</p>
        <p>An important point here is to evaluate the quality of the simulation of Eq. ( 150) for bosonic channels. It is known that the Braunstein-Kimble (BK) protocol for continuous-variable teleportation [16][17][18] strongly converges to the identity channel in the limit of infinite squeezing (both in the resource state and in the Bell detection). In other words, for any input state ρ, we may write the point-wise limit</p>
        <p>Because of this, the channel simulation of any teleportation-covariant bosonic channel strongly converges to the channel. This condition can be expressed in terms of the ECD norm, so that for any finite N we may write</p>
        <p>However, it is also known that the BK protocol does not converge uniformly to the identity channel [389]. In other words, if we consider the standard diamond norm which is defined over the entire set D of bipartite states, then we have</p>
        <p>For this reason, the uniform convergence in the teleportation simulation of bosonic channels is not guaranteed. However, it can be explicitly proven to hold for specific types of bosonic Gaussian channels.</p>
        <p>Recall that a single-mode Gaussian channel transforms the characteristic function as follows [612]</p>
        <p>where d ∈ R 2 is a displacement, while the transmission matrix T and the noise matrix N are 2 × 2 real, with</p>
        <p>In terms of mean value x and covariance matrix V, Eq. ( 154) corresponds to [6,[612][613][614] x</p>
        <p>Then, the asymptotic simulation of a single-mode Gaussian channel uniformly converges to the channel if and only if the channel's noise matrix N has full rank. As a specific case, this is true for phase-insensitive channels having diagonal T and N. See [615,616] for other details.</p>
        <p>By exploiting the LOCC simulation S(E) = (T , σ) of a quantum channel E, we may completely simplify an adaptive protocol. In fact, the output state ρ n ab can be decomposed into a tensor-product of resources states σ ⊗n up to a trace-preserving LOCC Λ. In other words, we may write [33, Lemma 3]</p>
        <p>For non-asymptotic simulations the proof goes as follows.</p>
        <p>As shown in Fig. 14, for the generic ith transmission, we replace the original quantum channel E with a simulation S(E) = (T , σ). Then, we collapse the LOCC T into the adaptive LOCC Λ i to form the composite LOCC ∆ i . As a result, the pre-transmission state ρ i-1 ab := ρ aaib is transformed into the following post-transmission state</p>
        <p>The next step is to iterate Eq. ( 157). One finds</p>
        <p>Because ρ 0 ab is separable, its preparation may be included in the LOCCs and we get Eq. ( 156) for a complicated but single trace-preserving LOCC Λ.</p>
        <p>For a bosonic channel with asymptotic simulation as in Eq. ( 144), the procedure is more involved. One first considers an imperfect channel simulation E µ (ρ) := T µ (ρ ⊗ σ µ ) in each transmission. By adopting this simulation, we realize an imperfect stretching of the protocol, with output state ρ µ,n ab := Λµ (σ µ⊗n ) for a tracepreserving LOCC Λµ . This is done similarly to the steps in Fig. 14, but considering E µ in the place of the original channel E. A crucial point is now the estimation of the error in the channel simulation, which must be controlled and propagated to the output state. Assume that, during the n transmissions of the protocol, the total mean number of photons in the registers is bounded by some large but finite value N . By using a "peeling argument" over the trace distance, which exploits the triangle inequality and the monotonicity under completely-positive maps, we may write the output simulation error in terms of the channel simulation error, i.e., [33,389,599]</p>
        <p>Therefore, we may write the trace-norm limit</p>
        <p>i.e., the asymptotic stretching ρ n ab = lim µ Λµ (σ µ⊗n ). This is true for any finite energy bound N , an assumption that can be removed at the very end of the calculations.</p>
        <p>Let us note that protocol stretching simplifies an arbitrary adaptive protocol over an arbitrary channel at any dimension, finite or infinite. In particular, it works by maintaining the original communication task. This means that an adaptive protocol of quantum communication (QC), entanglement distribution (ED) or key generation (KG), is reduced to a corresponding block protocol with exactly the same original task (QC, ED, or KG), but with the output state being decomposed in the form of Eq. (156) or Eq. ( 160). In the literature, there were precursory arguments, as those in Refs. [585,[587][588][589][590][591], which were about the transformation of a protocol of QC into a protocol of ED, over restricted classes of quantum channels. Most importantly, no control of the simulation error was considered in previous literature.</p>
        <p>A crucial insight from Ref. [33] has been the combination of protocol stretching with the REE, so that its properties of monotonicity and sub-additivity can be powerfully exploited. This is the key observation that leads to a single-letter upper bound for all the two-way capacities of a quantum channel. In fact, let us compute the REE of the output state decomposed as in Eq. (156). We derive ab ⊗ σ, as in Eq. ( 157). Adapted with permission from Ref. [33] c NPG (2017).</p>
        <p>products. By replacing Eq. ( 161) in Eq. ( 142), we then find the single-letter upper bound</p>
        <p>In particular, if the channel E is teleportation-covariant, it is Choi-stretchable, and we may write</p>
        <p>where E R (E) is the REE of the channel E [33, Theorem 5]. These results are suitable extended to asymptotic simulations. Using the weaker definition of REE in Eq. ( 141), the bounds in Eqs. ( 162) and ( 163) are also valid for bosonic channels with asymptotic simulations. For a bosonic Gaussian channel E, the upper bound in Eq. ( 163) is expressed in terms of its asymptotic Choi matrix σ E := lim µ σ µ E . By inserting Eq. ( 141) in Eq. ( 163), we derive</p>
        <p>for a suitable converging sequence of separable states γµ .</p>
        <p>Here σ µ E := I ⊗ E(Φ µ ) is Gaussian and also γµ can be chosen to be Gaussian, so that we are left with a simple computation of relative entropy between Gaussian states.</p>
        <p>In related investigations, Ref. [617] found that the weak converse upper bound E R (E) in Eq. ( 163) is also a strong converse rate, while Ref. [618] found that replacing the REE with the max-relative entropy of entanglement the strong converse bound can be written for any quantum channel (but the resulting bound is generally larger).</p>
        <p>Because the upper bounds in Eqs. ( 163) and ( 164) are valid for any teleportation-covariant channel, they may be applied to Pauli channels and bosonic Gaussian channels. Consider a qubit Pauli channel (165) where {p k } is a probability distribution and X, Y , and Z are Pauli operators [1]. Let us call H 2 the binary Shannon entropy and p max := max{p k }. Then, we may write [33,Eq. (33)]</p>
        <p>which can be easily generalized to arbitrary finite dimension (qudits).</p>
        <p>Consider now phase-insensitive Gaussian channels. The most important is the thermal-loss channel E η,n which transforms input quadratures x = (q, p) T as x → √ ηx + √ 1ηx E , where η ∈ (0, 1) is the transmissivity and E is the thermal environment with n mean photons.</p>
        <p>For this channel, we may derive [33, Eq. ( 23)]</p>
        <p>where we have set</p>
        <p>The thermal-loss channel is particularly important for QKD. From the variance parameter ω = n + 1/2, we define the so-called "excess noise" ε of the channel ω = (1η) -1 ηε + 1/2,which leads to</p>
        <p>Then, for a generic QKD protocol, we may write its rate as R = R(η, ε). The security threshold of the protocol is therefore obtained for R = 0 and expressed as ε = ε(η), providing the maximum tolerable excess noise as a function of the transmissivity. An open question is to find the optimal security threshold in CV-QKD. From Eq. ( 167), it is easy to see that this must be lower than the entanglement-breaking value ε UB = 1. In terms of lower bounds, we may consider the RCI which is however beaten by QKD protocols with trusted noise or two-way quantum communication. The highest security thresholds known in CV-QKD are plotted in Fig. 15, where we may also note the big gap between the best-known achievable thresholds and the upper bound. FIG. 15. Best-known security thresholds in CV-QKD expressed as maximum tolerable excess noise ε versus channel loss (dB). Each protocol is secure only below its threshold. The red line corresponds to the upper bound εUB = 1. The blue line is the lower bound εLB computed from the RCI of the thermal-loss channel [34]. The black dashed line is the bestknown security threshold, which is achieved by the one-way trusted noise protocol described in Ref. [389,Sec. VII]. Then, we show the thresholds for the one-way coherent-state protocol with heterodyne detection [376] and the two-way protocols with coherent states [395] (solid line) and largely-thermal states [413] (green dashed line). Reproduced with permission from Ref. [389] c IOPP (2018).</p>
        <p>For a noisy quantum amplifier E g,n we have the transformation x → √ gx + √ g -1x E , where g &gt; 1 is the gain and E is the thermal environment with n mean photons. In this case, we may compute [33, Eq. ( 26)]</p>
        <p>Finally, for an additive-noise Gaussian channel E ξ , we have x → x + (z, z) T where z is a classical Gaussian variable with zero mean and variance ξ ≥ 0. In this case, we have the bound [33,Eq. (29)]</p>
        <p>J. Capacities for distillable channels Within the class of teleportation-covariant channels, there is a sub-class for which the upper bound E R (σ E ) in Eq. ( 163) coincides with an achievable rate for one-way entanglement distillation. These "distillable channels" are those for which we may write</p>
        <p>where D 1 (σ E ) is the distillable entanglement of the Choi matrix σ E via one-way (forward or backward) CC. This quantity is also suitably extended to asymptotic Choi matrices in the case of bosonic channels.</p>
        <p>The equality in Eq. ( 172) is a remarkable coincidence for three reasons:</p>
        <p>1. Since D 1 (σ E ) is a lower bound to D 2 (E), all the two-way capacities of these channels coincide (D 2 = Q 2 = K = P 2 ) and are fully established as</p>
        <p>2. The two-way capacities are achieved by means of rounds of one-way CC, so that adaptiveness is not needed and the amount of CC is limited.</p>
        <p>3. Because of the hashing inequality, we have</p>
        <p>where I C and I RC are the coherent [573,574] and reverse coherent [34,385] information of the Choi matrix. Such quantities (and their asymptotic versions) are easily computable and may be used to show the coincidence in Eq. (173).</p>
        <p>In this way we can write simple formulas for the twoway capacities of fundamental quantum channels, such as the pure-loss channel, the quantum-limited amplifier, the dephasing and erasure channels (all distillable channels).</p>
        <p>In particular, for a bosonic pure-loss channel E η with transmissivity η, one has the PLOB bound [33,Eq. (19)]</p>
        <p>The secret-key capacity K(η) determines the maximum rate achievable by any QKD protocol in the presence of a lossy communication line (see also Fig. 11). Note that the PLOB bound can be extended to a multiband lossy channel, for which we write C =i log 2 (1η i ), where η i are the transmissivities of the various bands or frequency components. For instance, for a multimode telecom fibre with constant transmissivity η and bandwidth W , we have</p>
        <p>Now consider the other distillable channels. For a quantum-limited amplifier E g with gain g &gt; 1 (and zero thermal noise n = 0), one finds [33, Eq. ( 28)]</p>
        <p>In particular, this proves that Q 2 (g) coincides with the unassisted quantum capacity Q(g) [619,620]. For a qubit dephasing channel E deph p with dephasing probability p, one finds [33,Eq. (39)]</p>
        <p>where H 2 is the binary Shannon entropy. Note that this also proves</p>
        <p>), where the latter was derived in ref. [621]. Eq. ( 178) can be extended to arbitrary dimension d, so that [33, Eq. ( 41)]</p>
        <p>where H is the Shannon entropy and P i is the probability of i phase flips. Finally, for the qudit erasure channel E erase p,d with erasure probability p, one finds [33, Eq. ( 44)]</p>
        <p>For this channel, only Q 2 was previously known [622], while [33,623] co-established K.</p>
        <p>There are a number of open questions that are currently subject of theoretical investigation. While the secret key capacity has been established for a number of important channels, there are others for which the gap between best-known lower bound and best-known upper bound is still open. This is the case for the thermalloss channel, the noisy quantum amplifier, the additivenoise Gaussian channel, the depolarizing channel, and the amplitude damping channel. For most of these channels, an improvement may come from refined calculations (e.g., including non-Gaussian states in the optimization of the REE, or by employing the regularized REE). As we already mentioned before, for the amplitude damping channel the problem is also its LOCC simulation, which is not good enough to provide a tight upper bound. Recently this simulation has been improved in the setting of DVs by resorting to the convex optimization of programmable quantum processors [624,625], e.g., based on the port-based teleportation protocol [592,596].</p>
        <p>For the thermal-loss channel, we also know that the lower bound to the secret key capacity given by the RCI is not tight. There are in fact QKD protocols with trustednoise in the detectors whose rates may beat the RCI, as shown in Refs. [34,387]. Similarly, for the noisy amplifier, we know [388] trusted-noise protocols that are able to beat the CI of the channel, which is therefore not tight. The non-tightness of the CI (and RCI) is also a feature in the computation of energy-constrained quantum capacities of bosonic Gaussian channels [626]. An interesting approach to bound the quantum capacities of these channels has been recently pursued in Refs. [627][628][629] by using the Gottesman-Preskill-Kitaev (GKP) states [630], realizable with various technologies [631][632][633][634][635].</p>
        <p>A. Overview</p>
        <p>In order to overcome the fundamental rate-loss scaling of QKD, one needs to design a multi-hop network which exploits the assistance of quantum repeaters. In an information-theoretic sense, a quantum repeater or quantum relay is any type of middle node between Alice and Bob which helps their quantum communication by breaking down their original quantum channel into sub-channels. It does not matter what technology the node is employing, e.g., it may or may not have quantum memories. A repeater actually repeats only when it is able to beat the performance of any pointto-point QKD protocol, i.e., the PLOB bound. We may call these "effective repeaters". Example of noneffective repeaters are MDI-nodes simply based on Bell detections [176,177,182] while examples of effective repeaters are MDI-nodes exploiting phase-randomization, such as TF-QKD [183,184] and the related protocols of PM-QKD [185], SNS-QKD [187][188][189][190], and NPPTF-QKD [191][192][193][194][195]. According to our definitions above, the proof-of-concept experiment in Ref. [202] represents the first effective repeater ever implemented. See Fig. 11 for an overview of the ideal performances of these relayassisted protocols.</p>
        <p>While the violation of the PLOB bound provides a simple criterion for benchmarking the quality of quantum repeaters, one also needs to understand what optimal performance an ideal repeater may achieve. In other words, how much key rate can be generated by a chain of quantum repeaters or by a more general multi-hop quantum network? In the information-theoretic setting and considering the general case of adaptive protocols, upper bounds on this key rate have been studied in Refs. [39,40] and later in a series of other papers [41][42][43][44][45][46]. Here we report the tightest-known bounds that establish the end-toend capacities in chains and networks connected by fundamental channels (subsections XII B and XII C). This has been developed in Refs. [39,40] which extended the channel simulation methods from point-to-point to repeater-assisted quantum communications. In the second part of the section (subsection XII D), we will then discuss practical aspects and designs of quantum repeaters.</p>
        <p>Consider a linear chain of N quantum repeaters, labeled by r 1 , . . . , r N . This is characterized by an ensemble of N + 1 quantum channels {E i } describing the sequence of transmissions i = 0, . . . , N between the two end-points Alice a := r 0 and Bob b := r N +1 (see Fig. 16). Assume the most general adaptive protocol P, where the generation of the secret key between Alice and Bob is assisted by adaptive LOCCs involving all the parties in the chain. After n uses of the chain, Alice and Bob will share an output state ρ n ab which depends on P. By taking the limit of large n and optimization over the protocols P, we may define the repeater-assisted secret key capacity K({E i }). This quantity satisfies the bound</p>
        <p>where the REE E R is defined in Eq. ( 139) and, more weakly, in Eq. ( 141) for asymptotic states. In order to bound this capacity, let us perform a cut "i" which disconnects channel E i between r i and r i+1 . We may then simulate channel E i with a resource state σ i , either exactly as in Eq. ( 143) or asymptotically as in Eq. (144). By stretching the protocol with respect to E i , we may decompose Alice and Bob's output state as ρ n ab = Λi σ ⊗n i for a trace-preserving LOCC Λi , which is local between "super-Alice" (i.e., all the repeaters with ≤ i) and the "super-Bob" (i.e., all the others with ≥ i+1). This decomposition may be asymptotic for bosonic channels, as specified in Eq. ( 160).</p>
        <p>If we now compute the REE on the output state, we find E R (ρ n ab ) ≤ nE R (σ i ) for any i and protocol P. By replacing this inequality in Eq. ( 181), we establish the single-letter bound [39,40]</p>
        <p>Consider now a chain of teleportation-covariant channels {E i }, so that each quantum channel satisfies the condition in Eq. (148). These channels {E i } can all be simulated by their (possibly-asymptotic) Choi matrices {σ Ei }. Therefore, Eq. ( 182) takes the form</p>
        <p>Furthermore, if the quantum channels are distillable, i.e., E R (σ Ei ) = D 1 (σ Ei ) as in Eq. ( 172), then we have E R (σ Ei ) = K(E i ) and Eq. ( 183) becomes K({E i }) ≤ min i K(E i ). Remarkably, this upper bound coincides with a simple lower bound, where each pair of neighbor repeaters, r i and r i+1 , exchange a key at their channel capacity K(E i ) and one-time pad is applied to all the keys to generate an end-to-end key at the minimum rate min i K(E i ). As a result, for distillable chains, we have an exact result for their secret key capacity [39,40]</p>
        <p>Thanks to the result in Eq. ( 184), we know the repeater-assisted secret key capacities of chains composed of fundamental channels, such as bosonic pure-loss channels, quantum-limited amplifiers, dephasing and erasure channels. In particular, for a chain of repeaters connected by pure-loss channels with transmissivities {η i }, we may write the secret key capacity [39,40]</p>
        <p>which is fully determined by the minimum transmissivity in the chain. In particular, consider an optical fiber with transmissivity η which is split into N + 1 parts by inserting N equidistant repeaters, so that each part has transmissivity N +1 √ η. Then, we write the capacity</p>
        <p>In a chain connected by quantum-limited amplifiers with gains {g i }, we may write [39,40]</p>
        <p>For a chain connected by dephasing channel E i with probability p i ≤ 1/2, we find [39,40]</p>
        <p>where H 2 is the binary Shannon entropy. Finally, for a chain of erasure channels K erase = 1max i p i [39,40].</p>
        <p>The results for repeater chains can be generalized to arbitrary quantum networks by combining methods of channel simulation with powerful results from the classical network theory. Here we do not present the details of this methodology but only an introduction to the main notions and the specific results for pure-loss channels. The reader interested in further details may consult Refs. [39,40] where they can find a comprehensive treatment and general results for arbitrary quantum channels.</p>
        <p>We may represent a quantum communication network as an undirected finite graph N = (P, E), where P is the set of points and E is the set of edges. Each point p has a local set of quantum systems and two points, p i and p j , are logically connected by an edge (p i , p j ) ∈ E if and only if they are physically connected by a quantum channel E ij := E pipj . Between the two end-points, Alice a and Bob b, there is an ensemble of possible routes Ω = {1, . . . , ω, . . .}. Here the generic route ω is an undirected path between a and b, and is associated to a sequence of quantum channels {E ω 0 , . . . , E ω k . . .}. Then, a cut C is a bipartition (A, B) of the points P such that a ∈ A and b ∈ B. Correspondingly, the cut-set C of C is the set of edges with one end-point in each subset of the bipartition, i.e., C = {(x, y) ∈ E : x ∈ A, y ∈ B}. Given these notions we may define two type of network protocols, which are based either on sequential or parallel routing of the quantum systems.</p>
        <p>In a sequential protocol P seq , the network N is initialized by a network LOCCs, where each point classically communicates with all the others (via unlimited two-way CCs) and each point adaptively performs LOs on its local quantum systems on the basis of the information exchanged. Then, Alice connects to some point p i by exchanging a quantum system (with forward or backward transmission depending on the physical direction of the quantum channel). This is followed by a second network LOCC. Then, point p i connects to another point p j by exchanging another quantum system, which is followed by a third network LOCC and so on. Finally, Bob is reached via some route ω, which completes the first sequential use of N . For the second use, a different route may be chosen. After n uses of N , Alice and Bob's output state ρ n ab is ε-close to a private state with nR ε n secret bits. Optimizing their rate over P seq and taking the limit for large n and small ε (weak converse), one may define the single-path (secret key capacity) capacity of the network K(N ).</p>
        <p>Following Refs. [39,40], a general upper bound may be written for K(N ), which is particularly simple for networks of teleportation-covariant channels. For networks of distillable channels, the formula for K(N ) can exactly be found. In particular, consider an optical network, so that two arbitrary points x and y are either disconnected or connected by a pure-loss channel with transmissivity η xy . The single-path capacity of the lossy network N loss is determined by [39,40]</p>
        <p>where η is found by computing the maximum transmissivity along a cut, and then minimizing over the cuts.</p>
        <p>This result can be formulated in an equivalent way. In fact, for any route ω of pure-loss channels with transmissivities {η ω i }, we may compute the end-to-end transmissivity of the route as η ω := min i η ω i . Then the singlepath capacity is determined by the route with maximum transmissivity [39,40]</p>
        <p>Finding the optimal route ω corresponds to solving the widest path problem [636]. Adopting the modified Dijkstra's shortest path algorithm [637], this is possible in time O(|E| log 2 |P |), where |E| is the number of edges and |P | is the number of points. Consider now a parallel protocol, where multiple routes between the end-points are used simultaneously. More precisely, after the initialization of the network N , Alice exchanges quantum systems with all her neighbor points (i.e., all points she share a quantum channel with). This multipoint communication is followed by a network LOCC. Then, each receiving point exchanges quantum systems with other neighbor points and so on. This is done in such a way that these subsequent multipoint communications are interleaved by network LOCCs and they do not overlap with each other, so that no edge of the network is used twice. The latter condition is achieved by imposing that receiving points only choose unused edges for their subsequent transmissions. This routing strategy is known as "flooding" [638]. Eventually, Bob is reached as an end-point, which completes the first parallel use of N . The next parallel uses of N may involve different choices by the intermediate nodes. After n uses, Alice and Bob share a private state with nR ε n secret bits. By optimizing over the flooding protocols and taking the limit for many uses (n → ∞) and the weak converse limit (ε → 0), one defines the multi-path capacity of the network K m (N ).</p>
        <p>Again, a general upper bound may be written for K m (N ), which simplifies for network of teleportationcovariant channels and even more for distillable channels for which K m (N ) is completely established. As an example, consider again a network N loss composed of pure-loss channels, so that each edge (x, y) has transmissivity η xy . For any cut C, define its total loss as l(C) := (x,y)∈ C (1η xy ). By maximizing l(C) over all cuts we define the total loss of the network, i.e., l(N loss ) := max C l(C). The multi-path (secret key capacity) capacity of N loss is therefore given by [39,40] K m (N loss ) =log 2 l(N loss ). (191) The optimal multi-path routing of is provided by the solution of the maximum flow problem, which can be found in O(|P | × |E|) time by using Orlin's algorithm [639]. As one may expect, the multi-path capacity K m (N loss ) generally outperforms the single-path version K(N loss ).</p>
        <p>One of the key features of future quantum communications networks is the ability to transfer quantum states reliably from one point to another. As basic as it sounds, this is one of the most challenging implementation tasks that quantum technologies face. There are two main approaches to solving this problem. One relies on using teleportation techniques, which themselves rely on one of the pillars of quantum information science, i.e., entanglement. In this scenario, the state transfer problem reduces to how we can efficiently distribute entanglement across a network [35,37,640,641]. The second solution relies on using quantum error correction techniques to overcome loss and operation errors [642][643][644][645][646][647]. This is similar to what we have in data communications networks where by adding some redundancy to our message we can correct some of the errors that might be added by the channel. In the quantum case, not only we have to correct the bit flip errors, but also phase flip and erasure errors in possibly a fault-tolerant way. This approach will then require advanced quantum computing modules. Both above solutions are considered to be part of an underlying platform that enables quantum networks to operate at any distance, i.e., the platform of quantum repeaters.</p>
        <p>Original proposals on quantum repeaters rely on the use of entanglement swapping in a nested way. Suppose you have distributed and stored a Bell state between nodes A and B at distance L 0 in a network. Suppose node B also shares a Bell state with node C farther apart by L 0 . Then, by performing a Bell-state measurement (BSM) on the two subsystems in node B, we can entangle the systems in node A and C. That means that if we can distribute entanglement over distance L 0 , by using entanglement swapping, we can extend it to 2L 0 . By using this technique n times, in a nested way, we can then in principle cover entanglement over a distance L = 2 n L 0 , where n would be the nesting level for our repeater system; see Fig. 17. Looking at this from a different angle, what we have basically done is that in order to distribute entanglement over distance L, we have divided the entire distance into 2 n segments, distributed and stored entanglement over elementary links with distance L 0 , and then have applied BSMs on the middle nodes to extend the entanglement over distance L.</p>
        <p>The key advantage of the above nested way for entanglement distribution is its efficiency. Distributing entanglement over an elementary L 0 -long link often requires the transmission and detection of single-photonlevel light across the channel, which would only succeed with a probability on the order of exp(-αL 0 ), where α is proportional to the channel attenuation parameter. Note that using a similar technique over the total distance L would be exponentially worse as now the success rate scales with exp(-αL). That implies that entanglement distribution over elementary links must be repeated until it succeeds. The distributed entanglement should also be stored somewhere until entanglement is also distributed over neighboring links. That is why quantum storage will be needed for such probabilistic entanglement distribution techniques. But, entanglement distribution over elementary links can be attempted in parallel, and, although they do not necessarily succeed all at the same time, sooner or later we are in a position to perform BSMs on the middle nodes. The entanglement distribution rate over distance L would then scale with exp(-αL 0 ).</p>
        <p>The above discussion makes some idealistic assumptions on the system components. In practice, we should also account for the imperfections in the setup. For instance, the distributed state over elementary links may not be a maximally entangled states, in which case, BSM1 operations extend the entanglement over 2L0. BSM2 would then extend it further to 4L0. Note that if BSM operations are probabilistic, BSM2 should not be done until the middle node learns about the success of BSM1 operations. This requirement slows down the process and makes the coherence time requirements on the memories more demanding. Reproduced from Ref. [650] under permission of the IOPP.</p>
        <p>by every BSM, we deviate further from the ideal state. The measurement operations may also not be error free or deterministic to begin with. These issues require us to apply certain entanglement distillation techniques to improve the quality of distributed entangled states [585,648]. But, that would add to the quantum computational cost of the system and makes its implementation even more challenging. Depending on the state of the art on quantum computing, we can then envisage several different stages of development for quantum repeaters [649,650]. In the following, we review three such classes, or generations [651], of quantum repeaters.</p>
        <p>Since the introduction of quantum repeaters in 1998 [35], experimentalists have been looking for practical ways to implement the underlying ideas. The original repeater protocol requires distribution, storage, swapping, and distillation of entanglement. A lot of research has therefore been directed into devising quantum memory units that can interact efficiently with light and can store quantum states for a sufficiently long time. The interaction with light is necessary for such devices as it would allow us to use photonic systems for both distribution and swapping of entanglement. Photon-based systems are, however, fragile against loss and that could result in probabilistic operations, which, in turn, require us to repeat a certain procedure until it succeeds. Probabilistic quantum repeaters are those that rely on probabilistic techniques for entanglement distribution and entangle-FIG. 18. A probabilistic quantum repeater with multiple memories per node. In each round, entanglement distribution is attempted on all available elementary links. BSMs, at different nesting levels, will also be performed by matching as many entangled pairs as possible [658] Reproduced from Ref. [650] under permission of the IOPP.</p>
        <p>ment swapping. This class of repeaters has been at the center of experimental attention in the past 20 years.</p>
        <p>There are different ways of distributing entangled states between quantum memories of an elementary link. In some proposals [640], entangled photons are generated at the middle of the link and sent toward quantum memories located at the two end of the elementary link. If these photons survive the path loss and can be stored in the memories in a heralding way we can then assume that the two memories are entangled. This technique requires us to have a verification technique by which we can tell if the storing procedure has been successful. Alternatively, in some other proposals, we start with entangling a photon with the memory and either send it to the other side for a similar operation or swap entanglement in the middle between two such memories. The most famous proposal of this type is that of Duan, Lukin, Cirac, and Zoller [37], known as DLCZ, whose many variants [641] have been proposed and partly demonstrated in practice [652,653].</p>
        <p>The BSM operation in probabilistic quantum repeaters is typically done by first converting the state of quantum memories back into photonic states and then use linear optics modules to perform the BSM. Such linear optics modules can, however, be inefficient and face certain limitations in offering a full BSM [654]. There are certain tricks [655][656][657] by which their performance can be improved, but, in the end, the chance of success in most practical settings would remain below one. An implication of a probabilistic BSM is that we cannot perform BSMs in a certain nesting level until we have learned about the results of the BSMs in the previous nesting level. That requires exchanging data between intermediate nodes, which can not be done faster than the transmission delay between such nodes. This would result in requiring long coherence time and a low entanglement generation rate for probabilistic repeaters.</p>
        <p>One remedy to the above problems is the multiplememory configuration in Fig. 18. In this setup, instead of one QM in each site, we use a bank of N memories. In each round of duration T 0 = L 0 /c, with c being the speed of light in the classical channel, we attempt to entangle as many elementary links as possible. We then mix and match entangled pairs across two neighboring links and perform as many BSM operations as possible. As we continue doing informed BSMs and, at the same time, refilling available elementary links with fresh entangled states, we get to a steady state that in every period we roughly generate N P S P n M entangled states, for N ≫ 1, between the far two ends of the network [658]. Here, P S is the success probability for the employed entanglement distribution scheme for elementary links and P M is the success probability for the BSM operation. Moreover, it roughly takes T = L/c to generate an entangled pair, which minimizes the requirements on the memory coherence time. Multi-mode structures for quantum memories have also been proposed and implemented to improve the performance in repeater setups [659][660][661].</p>
        <p>Probabilistic repeaters are perhaps the simplest repeater technology to be implemented in practice. In fact, even the simplest setup, when there is only one repeater node in the middle, can offer certain advantages for QKD applications. These setups, known as memory-assisted QKD [662,663], can soon offer better rate-versus-distance scaling than most conventional QKD systems in operation by using existing quantum memory technologies [664][665][666][667][668][669]. Over long distances, however, probabilistic repeater would suffer from a low rate, or require a large number of memories to perform well [670][671][672]. Part of the reason for such low key rates is the use of probabilistic BSM modules. We next see what can be achieved if we have a deterministic BSM unit.</p>
        <p>Unlike our previous scheme, the original proposal for quantum repeaters relies on deterministic, but possibly erroneous, gates for BSM, or similar, operations [35]. Proposed in 1998, the authors assume that the initial entanglement distribution and storage have already taken place, and now we need to manipulate a bunch of entangled quantum memories in such a way that we end up with a high quality entangled states between nodes A and B. In Sec. XII D 1, although we assumed that the BSM operation may succeed probabilistically, we did not account for possible errors that may be caused by BSM modules. Further, we assumed that the initial entanglement over the elementary links was of the ideal form of a maximally entangled state, e.g., Bell states. The proposed work in [35] looks at the latter two issues by assuming that BSMs can directly be applied to QMs in a deterministic way. The immediate advantage is that P M would become 1, which increases the rate and also reduces the waiting time caused by the probabilistic events and their corresponding transmission delays. Once one accounts for errors, however, other problems arise.</p>
        <p>In reality, it is very challenging to generate and distribute truly maximally entangled states. In practice, we should often allow for deviations from this ideal case, which can be measured in different ways. For instance, for two pairs of entangled states in a Werner state with parameter p, a BSM on the middle memories would leave the remote memories in a Werner state with parameter 2p [35]; that is, the error, or the deviation from the ideal state, has been doubled. In a quantum repeater link as in Fig. 17(a), such an error will get doubled, even if we have perfect deterministic BSM gates, for every nesting level. The danger is that after a certain number of nesting levels the quality of the resulting entangled states is so low that it may not be of any use for quantum applications. If we include the possible errors in the gates, the situation would become even worse.</p>
        <p>The solution suggested in [35] is based on the use of purification, or, entanglement distillation, techniques. In short, the idea is that if we are given M pairs of nonideal entangled states, we can use some LOCCs to come up with N &lt; M entangled states of higher quality, for instance, higher fidelity. Depending on the type of distillation techniques used, we may end up with different rate behaviors. Original distillation schemes relied on performing CNOT gates on pairs of memories [673] and then measuring one of them. The result should have been compared with that of a similar measurement at the other end of the link, and success was dependent on whether the two results, for instance, matched or not. In essence, you could not tell without classical communication between the nodes, if the distillation succeeds or not, despite the fact that deterministic gates are being used throughout. This, in effect, would have turned a deterministic repeater setup to a probabilistic one, suffering to some extent from the same impediments we mentioned in the previous section.</p>
        <p>The alternative solution is to use quantum error correction schemes to distil entanglement [674,675]. In essence, we can think of the M non-ideal entangled states that we wish to distil to have been obtained by hypothetically starting with N ideal entangled states, adding M -N redundant states to this batch, and sending all M pairs through an error-prone channel. In such a setting, one can, in principle, use error correction techniques to get the original N pairs back. This can be done with a high probability if the ratio N/M is chosen properly with respect to the expected amount of error in our system. It turns out that if we want to do this in an error resilient way, we need quantum gates with error rates on the order of 0.001-0.01 or below. Such error correction can also alleviate some of the errors caused by the memory decoherence once we are waiting to learn about the success of the initial entanglement distribution.</p>
        <p>Using the above techniques, we can design quantum repeaters with a modestly high key rate. The limitation is mainly from the original requirement for entangling elementary links, which is still probabilistic, and the tradeoff between having more nesting levels, and, therefore, higher P S , versus fewer nesting levels, hence less accumulated error and distillation. Next we show that if we allow for sophisticated quantum operations to be used in quantum repeaters, we can further improve the rate by relaxing the requirement on entangling elementary links.</p>
        <p>The most advanced protocols for quantum repeaters leave as little as possible to probabilistic schemes. In such schemes, loss-resilient error correction techniques are used to make sure that the quantum information carried by photonic systems can be retrieved at each intermediate node. This can be achieved in different ways. The common feature of all these schemes is that we no longer need quantum memories for storage purposes, although we may still need them for quantum processing. That is why they are sometime called memory-less quantum repeaters.</p>
        <p>Here, we explain one example that relies on quantum error correction for loss resilience. This idea was first proposed in [643] and then further work followed up to also account for not only the loss in the channel, but also possible errors in the system [645,646]. In [643], a quantum state α|0 + β|1 is encoded as</p>
        <p>where n is the number of logical qubits and m is the number of physical qubits in each logical qubit. Here, |± (m) = |0 ⊗m ± |1 ⊗m . This encoding has the property that the original quantum state can be recovered provided that at least (1) one photon survives in each logical qubit, and (2) one logical qubit, with all its m constituent photons, is fully received. The authors show that for sufficiently short channels one can find appropriate values of m and n such that a high key rate on the order of tens of MHz can, in principle, be achieved. The requirements are, however, beyond the reach of current technologies.</p>
        <p>Such memory-less quantum repeaters, while offering a substantial improvement in the key rate, require a set of demanding properties for their required elements. In particular, we need operation errors as low as 10 -4 -10 -3 , large cluster states of photons, whose generation may require a series of other advanced technologies (e.g. highrate efficient single-photon sources), and a large number of intermediate nodes. The latter may cause compatibility problems with existing optical communications infrastructure, in which, at the core of the network, nodes are rather sparsely located. That said, such advanced technologies for quantum repeaters would perhaps be one of the latest generations of such systems, by which time sufficient improvement in our quantum computing capabilities as well as other required devices and technologies may have already happened. For such an era memoryless repeaters offer a solution that is of an appropriate quality for the technologies that rely on the quantum internet [676,677].</p>
        <p>QKD is commonly defined under the assumption that a potential eavesdropper have access to unlimited technology. For example, the eavesdropper (Eve) may have a universal quantum computer with unlimited computational power, as well as a perfect quantum memory of unbounded capacity and ideal detectors. While these strong assumptions put QKD on a solid theoretical ground, they may be considered unrealistic given the present stage of development of quantum technologies. Such strong assumptions create a disproportion between the technology that will be deployed in a foreseeable future and what is assumed that is already available to Eve.</p>
        <p>One different security scenario is defined by assuming that a potential eavesdropper has only access to limited quantum technologies. Here we consider QKD under two similar though different assumptions about the technological capability of Eve. First we review the Bounded Quantum Storage Model (BQSM), in which Eve is assumed to be able to store only a limited number of qubits. Furthermore, this number is assumed to grow only sublinearly with the number of bits exchanged between Alice and Bob. Second we consider the effect of Quantum Data Locking (QDL) and its application to QKD and secure communication under the assumption that Eve can store unlimited number of qubits but only for a finite time. In both cases, equivalent constraints are imposed on the trusted users Alice and Bob. Furthermore we assume that Eve, unlike Alice and Bob, has access to a universal quantum computer with unbounded computational power and can perform ideal quantum measurements. Entropic uncertainty relations, which are briefly reviewed in the next section, play a major role in security proofs against an eavesdropper with constrained quantum memory.</p>
        <p>It is of utmost importance to remark that QDL yields composable security given the above assumption that Eve is forced to make a measurement (for example because she has no quantum memory or a quantum memory with finite and known storage time). Under this assumption one consistently obtain composable security [678,679]. Otherwise, QDL does not guarantee composable security against an eavesdropper with access to perfect and unbounded quantum resources [65].</p>
        <p>For the sake of self-consistency, we briefly recall the entropic uncertainty relations (EURs) [505,680], already discussed in Section IX but here adapted to the notation of the present problem. Consider a collection of k measurements M = {M j } j=1,...k . On a given state ρ, the j-th measurement produces a random variable M j (ρ) with output x j and associated probability p Mj (ρ) (x j ). An EUR is expressed by an inequality of the form</p>
        <p>where H[M j (ρ)] =xj p Mj (ρ) (x j ) log 2 p Mj (ρ) (x j ) is the Shannon entropy of M j (ρ) and c M is a constant that only depends on the set of measurements M. By convexity, it is sufficient to restrict on pure states.</p>
        <p>As an example, consider the case of a d-dimensional Hilbert space and a pair of projective measurements A and B. Each measurement is defined by a corresponding collection of d orthonormal vectors, A ≡ {|a 1 , . . . , |a d } and B ≡ {|b 1 , . . . , |b d }. Then the Maassen-Uffink EUR [501] states that</p>
        <p>where</p>
        <p>In particular, if the two observables are mutually unbiased, then max k,h | a k |b h | = d -1/2 and we obtain</p>
        <p>Given a collection of k observables, one can always find a state ρ such that H[M j (ρ)] = 0 for a given j. Therefore the constant c M in Eq. (193) is at least larger than 1 -1 k log 2 d. An EUR that saturates this bound is said to be maximally strong. An almost maximally strong EUR is obtained for a maximal choice of k = d + 1 mutually unbiased observables, in which case the constant c M in Eq. ( 193) equals log 2 d+1 2 [681]. Maximally strong EURs can be obtained for multiple measurements in a high dimensional space. Ref. [682] showed that a random choice of k random observables (distributed according to the unitary invariant measure) satisfies a maximally strong EUR with probability arbitrary close to 1, provided that d is large enough and k grows at least logarithmically in d (see also Refs. [683,684]). Recently, Ref. [685] showed that this property holds for large d at any fixed value of k.</p>
        <p>Uncertainty relations can be expressed not only in terms of the Shannon entropy. For example, fidelity uncertainty relations have been defined in Ref. [686], and metric uncertainty relations have been introduced in Ref. [684]. These are stronger forms of uncertainty relations, in the sense that they always imply an EUR, while the contrary does no necessarily hold.</p>
        <p>In this section we briefly review some basic notions regarding the BQSM, Our presentation will mostly follow Ref. [687] (see also Ref. [688]). To make things more concrete, we consider a one-way protocol in which the sender Alice encodes a variable X into a d-dimensional Hilbert space, with |X| = d. The protocol is specified by a collection of k different orthogonal bases. Alice randomly selects one of the bases and then encodes the classical random variable X by using the d mutually orthogonal vectors in the chosen basis. On the receiver side, Bob independently selects one of the k bases at random and applies the corresponding projective measurement. The protocol is indeed analogous to a d-dimensional version of BB84 with k different bases. After the quantum part of the protocol, in which n states are prepared, transmitted, and measured, the users proceed with the sifting phase, in which they select only the signal transmissions for which they have made the same choice of bases. The protocol then concludes with error reconciliation and privacy amplification. The difference with standard QKD is that in the BQSM the eavesdropper Eve is assumed to be only capable of storing a finite amount of quantum information. More specifically, it is assumed that Eve has kept no more than q qubits in her quantum memory after n quantum signal transmissions and before sifting. Therefore, all remaining quantum states intercepted by Eve have been already measured before the sifting phase takes place.</p>
        <p>A fundamental estimate of the number of secret bits (excluding sifting) that can be extracted from such a protocol is given by (for direct reconciliation):</p>
        <p>where ǫ is a security parameter, H ǫ min (X n |ZE) is the smooth min-entropy [74,438] conditioned on Eve's side information for n signal transmissions, and H max (C) is the number of bits publicly exchanged for error reconciliation. Under the assumptions of the BQSM, here Eve's side information comprises a quantum part E and a classical part Z. Furthermore, since Eve's quantum memory has capacity below q qubits, we have</p>
        <p>It remains to bound the (classical) conditional smooth min-entropy H ǫ min (X n |Z). It has been shown in Ref. [687] that if the set of k bases employed in the protocol satisfies an EUR as in Eq. (193), then for any λ ∈ (0, 1/2)</p>
        <p>with</p>
        <p>For example, using two mutually unbiased bases we can apply the Maassen-Uffink EUR in Eq. (197) and obtain, for sufficiently small λ H ǫ min (X n |Z)</p>
        <p>In general, the assumptions of BQSM allow us to increase the resilience to noise of a QKD protocol, but the rate is not expected to improve dramatically compared to an unbounded quantum-capable eavesdropper. We conclude by noting that the number of secret bits in Eq. (198) must be multiplied by a factor 1/k to account for the probability that Alice and Bob chose the same basis.</p>
        <p>The phenomenon of QDL can be exploited to obtain efficient high-dimensional QKD protocols within the assumption that Eve has access to a quantum memory of unlimited capacity but that can store quantum information only for finite time. This assumption implies that she is forced to measure her share of the quantum system within a given time after having obtained it. When the memory time goes to zero, we obtain as a limiting case the setting of individual attacks, where Eve is forced to measure the signals as soon as she receives them.</p>
        <p>The first QDL protocol was discussed in Ref. [689]. Such a protocol is analogous to BB84, with the fundamental difference that now Alice and Bob share 1 secret bit at the beginning of the protocol [689]. While in BB84 Alice and Bob randomly select their local basis, and only later reconcile their choice in the sifting phase, in QDL they use the 1 bit of information they secretly share to agree on the choice of the basis in which encode (and decode) information. Therefore, according to this secret bit, Alice encodes n bits into n qubits, using either the computational or the diagonal basis, and Bob measures the received qubits in the same basis. We follow the original presentation of Ref. [689] and assume a noiseless channel from Alice and Bob. Suppose that Eve intercepts the n signal qubits. As she is forced to measure them (either instantaneously or after a given time) the amount of information that she can obtain about the message can be quantified by the accessible information.</p>
        <p>Consider the joint state representing the classical nbits sent by Alice together with the quantum state intercepted by Eve. Such a classical-quantum state reads</p>
        <p>where X denote the classical variable sent by Alice, U 0 is the identity transformation and U 1 is the unitary that maps the computational basis into the diagonal one. Notice that this expression reflects the fact that Eve does not know which basis has been used for the encoding.</p>
        <p>For such a state the accessible information is</p>
        <p>where the maximum is over all possible measurements M E→Z performed by Eve on n qubits. A straightforward calculation yields [689] I acc (X :</p>
        <p>≤ n + max</p>
        <p>Notice that the last term on the right hand side is bounded by an EUR. In particular, here we can apply Maassen-Uffink EUR [501] and obtain</p>
        <p>In summary, being ignorant of one single bit of information, Eve is able to access only n/2 bits of information about the n bits of information communicated from Alice to Bob. This holds for all values of n.</p>
        <p>We remark that QDL violates a fundamental property, know as total proportionality, that is natural property of any well-behaved information quantifier [689]. In fact given a mutual information I(X : Z) we expect that</p>
        <p>that is, the knowledge of the variable K can increase the mutual information by no more than its entropy. As a matter of fact this property is fulfilled by the classical mutual information as well as by the quantum mutual information. Interestingly enough, QDL shows that this is not the case for the accessible information. After the seminal work by DiVincenzo et al. [689], other works have introduced QDL protocols that presents an even stronger violation of total proportionality. From a broader perspective, a QDL protocol is defined by a set of k ≪ d different bases in a Hilbert space of dimensions d. For an eavesdropper that does not have which-basis information (i.e., log 2 k bits) the accessible information is smaller than δ. Therefore, EURs for k bases in a d-dimensional space can be applied to obtain a corresponding QDL protocol. Ref. [682] has shown that a random choice of the k = (log 2 d) 3 bases (sampling according to the distribution induced by the Haar measure) in a d-dimensional Hilbert space will yield a QDL protocol with δ = ǫ log 2 d + O(1), as long as d is large enough. The probability that a random choice of bases yield a QDL protocol with these feature is bounded away from 1 if log 2 d &gt; 16 C ′′ ǫ ln 20 ǫ , with C ′′ = (1760 ln 2) -1 . As log 2 d grows faster than linearly in 1/ǫ, this implies that QDL is obtained only for asymptotically large values of d. For example, putting ǫ = 10 -1 one gets the condition log 2 d 10 6 . A typicality argument shows that as long as k is sufficiently smaller than d, these bases are with high probability approximate mutually unbiased [684]. Interestingly enough, a collection of (exact) mutually unbiased bases does not necessarily yield QDL [680].</p>
        <p>A major advance in QDL was provided by the work of Fawzi et al. [684], which has introduced the notion of metric uncertainty relations. Exploiting this powerful tool they have been able to obtain strong QDL protocols with δ = ǫ log 2 d and log 2 k = 4 log 2 (1/ǫ) + O(log 2 log 2 (1/ǫ)), for any ǫ &gt; 0 and for d large enough. While these protocols are for random unitaries (which cannot be simulated efficiently), they also demonstrated QDL with a set of unitaries that can be simulated efficiently on a quantum computer. We remark that these results still require asymptotically large values of d. The QDL protocols of Ref. [684] were the first to allow for an arbitrary small accessible information. As for Ref. [682], the protocols succeed only for asymptotically large values of d.</p>
        <p>Whereas QDL was historically introduced in terms of the accessible information, it can also be expressed in terms of stronger security quantifiers, e.g., the total variation distance via Pinsker inequality [690]. As additional examples, the metric uncertainty relations of Ref. [684] and the fidelity uncertainty relations of Ref. [686] also yield QDL with a stronger security quantifier.</p>
        <p>E. Quantum data locking for communication: the quantum enigma machine QDL was considered for the first time in a communication scenario in Refs. [691,692]. The authors of Ref. [692] considered a noisy communication channel from Alice to Bob (notice that previous works only considered a noiseless channel). Two scenarios were analyzed: in strong QDL Eve is able to access the input of the channel; in weak QDL she has access to the output of the complementary channel from Alice to Bob. Notice that weak QDL is analogous to the familiar wiretap channel model. Strong QDL is instead closer to the original formulation of QDL. The notion of weak and strong QDL capacities were introduced and in part characterized. In analogy to the notion of private capacity of quantum channel, the (weak and strong) QDL capacities are defined as the maximum asymptotic rate at which Alice and Bob can communicate through the quantum channel with the guarantee that Eve has no information about the exchanged messages. The difference with the notion of private capacity is that to achieve the QDL capacities we assume that Eve is forced to make a measurement as soon as she obtains a train of n signals (then n is made arbitrary large to obtain an asymptotic rate).</p>
        <p>Since it is defined accordingly to a weaker security definition, the weak QDL capacity is never smaller than the private capacity. A consequence of the results of Ref. [684] is that the identity qubit channel has unit strong QDL capacity. Entanglement breaking channels and Hadamard channels are instead shown having vanishing weak QDL capacity [692]. Ref. [693] provided explicit examples of quantum channels with a large gap between the private capacity and the weak QDL capacity.</p>
        <p>A quantum optics device that exploits QDL for secure communication was dubbed a quantum enigma machine (QEM) by Lloyd [691]. In fact, the protocol of QDL can be seen as a quantum generalization of poly-alphabetic ciphers, among which one of the most famous examples was the Enigma machine. Ref. [691] put forward two architectures for a QEM, using either unary encoding of a single photon over n modes (this would be a direct application of the QDL protocols in Refs. [682,684]) or using encoding in coherent states. Ref. [692] showed that a weak QDL protocol with coherent state cannot surpass the private capacity by more than log 2 e ≃ 1.44 bits per bosonic mode, and an almost matching lower bound was obtained in Ref. [694].</p>
        <p>The QDL protocols of Refs. [682,684] require coherent control over large (actually asymptotically large) Hilbert space. For this reason there is little hope that these protocols may be ever realized experimentally, not even as a proof-of-principle demonstration. In order to make an experimental realization of QDL feasible, one needs to solve two problems: 1) to design QDL protocols that require control over Hilbert space of reasonably small dimensions; 2) to design protocols that are robust in the presence of a noisy channel from Alice to Bob. Step forwards towards the solution of these two problems were made in Ref. [695]. The authors of this work considered a collection of n d-dimensional systems, where d is supposed to be a small integer and n is asymptotically large. Instead of considering random unitaries in a large Hilbert space, they considered local random unitaries in the small d-dimensional systems. This model can be physically realized by a train of n photons, each living in the space defined by a discrete collection of d bosonic modes (spanning, for example, spatial, temporal, frequency, or angular momentum degrees of freedom).</p>
        <p>Unlike other QDL protocols that exploit EURs, QDL with local unitaries is obtained from a different upper bound on the accessible information, i.e.,</p>
        <p>where</p>
        <p>and</p>
        <p>The quantity min φ H[Q(Φ)] is then bounded by exploiting the fact that Q x n (φ) typically concentrates around 1/d n (a similar approach was used in Ref. [696] to obtain QDL with a set of commuting unitaries). Exploiting this approach, Ref. [695] demonstrated strong QDL protocols for QKD through generic memoryless qudit channels, and Ref. [697] obtained weak QDL protocols for direct secret communication. The price to pay to deploy QDL with local unitaries is that the amount of pre-shared secret key bits is no-longer exponentially smaller than the message but grows linearly with the number of channel uses, with an asymptotic rate of 1 bit per use of the channel. This implies that non-zero rates can only be obtained for d &gt; 2, yet any value of d equal or larger than 3 can yield a non-zero rate of QKD or direct communication.</p>
        <p>The first experimental demonstrations of QDL appeared in 2016. Ref. [698] realized the original QDL protocol [689] with encoding in heralded single photon polarization. They also implemented error correction to counteract loss and verified a violation of the total proportionality inequality of Eq. ( 210). Ref. [699] realized the QDL protocol of Ref. [695] using pulse-position modulation (PPM). In Ref. [699] a lens was used to implement a Fourier transform and an array of 128 × 128 spatial light modulators (SLM) was applied to generate random phase shifts. This transformation provides QDL given that at the receiver end a trusted user applies the inverse phase shift and inverse Fourier transform to decode [695]. Finally, Ref. [700] presented an on-chip array of programmable ring resonators that can be naturally applied to QDL with encoding in time of arrival degree of freedom.</p>
        <p>Generating random numbers is an important task: most cryptographic protocols rely on them, they are used in simulations, in lotteries, in games and numerous other places. However, in spite of their usefulness, random number generators (RNGs) are difficult to construct and the use of poor-quality random numbers can be detrimental in applications. For instance, in Ref. [701] public RSA keys were collected from the web and a significant number were found to share a prime factor, posing problems for the security of those running the algorithm. In general, problems can arise whenever something that is assumed to be chosen randomly is in fact not [702].</p>
        <p>A typical way to make random numbers is to use a pseudo random number generator, in which a short random seed is expanded into a longer string. The idea is that this string is sufficiently random for the application it will be used in. However, a pseudo random number generator is a deterministic algorithm, so, in spite of its length, the output contains no more randomness than the input. It must therefore contain subtle correlations that in principle could be detected and exploited. Given a powerful enough computer, a long enough output sequence could be used to find the seed and hence all of the remaining purportedly random numbers.</p>
        <p>Since classical physics is deterministic, RNGs based on classical effects can never be fundamentally random. Instead classical RNGs rely on a lack of knowledge making the numbers appear random. Whether this is good enough for a particular application is a matter of faith, and an undesirable property of such RNGs is that it can be difficult to detect if they are functioning badly. Indeed, while statistical tests are able to attest (beyond reasonable doubt) to particular shortcomings of a candidate RNG, there is no set of tests that can take the output from a candidate RNG and eliminate all shortcomings.</p>
        <p>To understand this, it is helpful to define what we mean when we say that a particular string is random. Note that, although the string S will always be classical, we want it to appear random even to an adversary holding quantum information and hence the definition is phrased in terms of quantum states. This definition is related to the definition of a secure key (cf. Section II D). If a random number generation protocol outputs an n bit string S, we would like it to be uniform and unknown to any other party, i.e., independent of any side information E held. Mathematically, for S to be a high quality random string we would like that</p>
        <p>is small and we say that a protocol is secure if</p>
        <p>is small, where p( ⊥) is the probability that the protocol does not abort (note the similarity with the secrecy error, ε secr , from Section II D). As before, this means that whenever there is a high probability of not aborting, the output is close to perfect randomness, i.e., ρ SE ≈ 1 n 1 1 n ⊗ ρ E . Unlike in key distribution, there is no second string that the first one needs to be perfectly correlated with, so there is no analogue of the correctness error.</p>
        <p>From this definition, it is evident that no amount of statistical testing on the output can verify that S is a high quality random string: statistical tests on S can only increase confidence that ρ S ≈ 1 n 1 1 n , but cannot say anything about whether ρ SE ≈ 1 n 1 1 n ⊗ ρ E , i.e., whether another party could already know the string S. (For some applications, it may not be a problem for another party to know the string, provided that it is statistically random; here we focus on the stronger form of randomness.) Whether a string is random or not is ultimately not a property of the string itself, but on how it is generated.</p>
        <p>Like in the case of QKD, we can divide quantum random number generators (QRNGs) into two types depending on whether or not the users trust the apparatus they use (there are also hybrids, not discussed here, in which certain features are trusted and others not, e.g., semi-device-independent QRNGs [703]). Both types work by exploiting the fundamental randomness of certain quantum processes, but with trusted devices, it is more straightforward to do so. We briefly mention one example here. A simple trusted-device QRNG can be based on a 50:50 beamsplitter and two detectors, one for the reflected arm and the other for the transmitted arm. If a single photon is incident on the beamsplitter, then with probability half it will go to one detector and with probability half the other. In principle this is a source of quantum random numbers.</p>
        <p>However, building such a QRNG is not as straightforward as it sounds. Generation and detection of single photons is challenging, and it is difficult to ensure that the beamsplitter is perfect. Furthermore, correlations may be brought into the string by other factors such as fluctuations in the power supply, asymmetries in the detector responses and dead times. The standard way to account for such difficulties is to try to quantify these effects, estimate the min-entropy of the outputs and then use a classical extractor to compress the imperfect raw string into arbitrarily good randomness.</p>
        <p>One issue that needs to be considered when doing this is that extraction of randomness typically requires a seed, i.e., an independent random string. Fortunately, this seed can act catalytically if a strong extractor is used, i.e., the seed randomness remains random and virtually independent of the output randomness so is not consumed in the process. Nevertheless, the need for this seed means that QRNG protocols should more accurately be described as quantum randomness expansion (QRE) protocols. In order to have a good rate of expansion, randomness extractors requiring a short seed should be used. Note also that to have full security guarantees, quantum-proof randomness extractors should be used.</p>
        <p>For the type of QRNG mentioned above the security relies on the accuracy of the model used to describe it. Like in the case of QKD, various additional advantages can be gained by moving to device-independent protocols (see Section IV A). These shift reliance away from the model: that the output string is random is checked on-the-fly and relies on the correctness and completeness of physical laws (note that correctness and completeness of quantum theory are related [704,705]). The idea has been described earlier in the review where DI-QKD was introduced (see Section IV B). In essence, if we have some number of separate systems whose correlations violate a Bell inequality, then their outcomes must contain some min-entropy, even conditioning on an adversary holding arbitrary side information (for instance a quantum system entangled with those being measured). This min-entropy can be lower bounded and an extractor applied leading to arbitrarily good randomness output.</p>
        <p>To use this idea, some initial randomness is required, so we need to ensure that the protocol outputs more randomness than it requires giving genuine expansion. This can be achieved using a protocol analogous to the spotchecking CHSH QKD protocol from Section IV D 2. The setup is different from that for DI-QKD because there is only one honest party (Alice) in this protocol, and, because the protocol is for randomness expansion, we do not give an unlimited supply of random numbers to Alice. These are the assumptions:</p>
        <p>1. Alice has a secure laboratory and control over all channels connecting her laboratory with the outside world. For any devices in her labs, Alice can prevent unwanted information flow between it and any other devices.</p>
        <p>2. Alice has a reliable way to perform classical information processing.</p>
        <p>3. Alice has an initial seed of perfectly random (and private) bits, known only to her.</p>
        <p>Like for DI-QKD, security is proven in a composable way (cf. Section II D) allowing the protocol's output to be used in an arbitrary application. The remarks made in the last paragraph of Section IV D 1 all apply to QRE as well. However, mitigating the device-reuse problem is easier for QRE than in QKD because QRE does not involve public communication during the protocol [162].</p>
        <p>There are many possible types of protocol; we will describe a specific protocol here, based on the CHSH game with spot-checking. The protocol has parameters α</p>
        <p>)), which are to be chosen by the users before it commences.</p>
        <p>1. Alice uses her initial random string to generate an n-bit string of random bits T i , where T i = 0 with probability 1α and T i = 1 with probability α.</p>
        <p>2. Alice uses a preparation device to generate an entangled pair. She sends one half to one measurement device and the other half to another such device. (As in the case of DI-QKD, although this step refers to the generation of an entangled state, security does not rely on this taking place correctly.)</p>
        <p>3. If T i = 0 (corresponding to no test) then Alice makes fixed inputs into each measurement device, A i = 0 and B i = 0 and records the outcomes, X i and Y i . These inputs are made at spacelike separation and each device only learns its own input.</p>
        <p>If T i = 1 (corresponding to a test) then Alice uses her initial random string to independently pick uniformly random inputs A i ∈ {0, 1} and B i ∈ {0, 1} to her devices and records the outcomes, X i and Y i .</p>
        <p>4. Steps 2 and 3 are repeated n times, increasing i each time.</p>
        <p>5. For all the rounds with T i = 1, Alice computes the average CHSH value (assigning +1 if A.B = X ⊕ Y and -1 otherwise). If this value is below βδ, she aborts the protocol.</p>
        <p>6. If the protocol does not abort, for the rounds with T i = 0 the outputs X i are fed into a randomness extractor whose seed is chosen using Alice's initial random string. The EAT can be used to compute how much randomness can be extracted, depending on the value of β.</p>
        <p>The ideal implementation of this protocol is as for the CHSH QKD protocol in Section IV D 2 (except that B i = 2 is not needed) and the intuition for its operation is the same. The completeness error is again exponentially small in n. By taking n sufficiently large, this protocol can output at a rate arbitrarily close to H(X|E) from (63) (see Section IV C). This rate is the amount of randomness output per entangled pair shared. We make a few remarks about the protocol.</p>
        <p>1. The protocol aims for randomness expansion, so it is important to use as little randomness as possible to implement it. Since each test round consumes two bits of randomness, we would like α to be chosen to be small. This also helps reduce the amount of randomness required to choose the test rounds, since generating a string of n bits with bias α requires roughly nh 2 (α) bits of uniform randomness from Alice's initial random string, where h 2 is the binary entropy which drops away steeply for small α. The value of α can be chosen such that in the large n limit, the randomness required to choose it is negligible.</p>
        <p>2. If a strong extractor is used in the last step then randomness is not consumed for this. Nevertheless, it is helpful to use an extractor with a small seed, e.g., Trevisan's extractor, so as to reduce the randomness required to initiate the expansion.</p>
        <p>3. In the case of the CHSH QKD protocol the aim is to generate an identical key shared by Alice and Bob.</p>
        <p>Here the aim is to generate randomness, so there is no need for the ideal implementation to lead to the same outcomes for both devices in the case of no test. This allows randomness expansion rates that go beyond that of the QRE protocol given above, while still using maximally entangled qubit pairs (see [161] for a robust protocol giving up to two bits of randomness per entangled pair). Like in the case of DI-QKD, finding tight bounds on the minentropy in terms of the observed correlations for general protocols is an open problem.</p>
        <p>4. As the number of rounds, n, increases the classical computation required by the protocol (e.g., to perform the randomness extraction) may become prohibitively slow.</p>
        <p>The use of non-local correlations for expanding randomness without trusting the devices used goes back to Ref. [706] and the ideas there were developed in Ref. [707]. The idea was developed experimentally in Ref. [708] and security proofs against classical adversaries were presented in Refs. [709,710]. The first work covering quantum adversaries was Ref. [711], although this lacked tolerance to noise. Quantum security with error tolerance was proven in Ref. [168] and improved in Ref. [712], where it was shown that any Bell violation can be used to generate randomness.</p>
        <p>Most recently, using the EAT [157] the expansion rate was improved [156] so as to be asymptotically optimal and a recent experiment has been performed based on these recent techniques [713].</p>
        <p>Note that several review articles devoted to the topic of (quantum) random number generation have appeared in the last few years [714][715][716]. These go beyond the scope of the present review and provide a useful resource for further reading on the topic.</p>
        <p>DI-QRE suffers from some of the same drawbacks as DI-QKD, the most significant being the difficulty of performing a Bell experiment while closing the detection loophole. For DI-QRE this is slightly easier to do because there is no need for the two measurement devices to be distant from one another. Instead, they only need to be far enough apart to enable sufficiently shielding to ensure they cannot communicate during the protocol. (In particular, each device should make its output independently of the input of the other device on each round of the protocol.) Nevertheless, it remains challenging to do this. While the first DI-QRE experiment ran at a very low rate [708], recent state-of-the-art experiments achieve reasonable rates [713] and even close the locality loophole as well as the detection loophole. Such a demonstration could be turned into a future randomness beacon, but is still far from being built reliably into a small scale device that could reasonably be included in a desktop computer or mobile phone.</p>
        <p>Because of this, for the next few years or so DI-QRE is unlikely to be used in commercial products. One possibility is to use RNGs that rely on a detailed model of how the device operates (see, e.g., Ref. [717]). To ensure such RNGs work as intended it will be important to make increasingly sophisticated models of them and to diagnose and patch any weaknesses as and when they are identified. Furthermore, the performance of a RNG may change with time and if and when it degrades, it is important that this is noticed before the purportedly random outputs are used. A problem such as this can be mitigated by combining the outputs of several random number generators (in an appropriate way) to give the random string that will be used.</p>
        <p>As we saw in the last section, in order to generate randomness in a device-independent way we require some seed randomness to start the process. This is necessary: to constrain a device based only on its input-output behavior we use the violation of a Bell inequality, and random numbers are needed to choose the inputs when verifying such a violation. However, while random numbers are required for this task, the protocol given above assumes these are perfectly random. The task of randomness amplification concerns whether a source of imperfect randomness can be used to generate perfect randomness. (This should not be confused with the related task of randomness extraction, where an additional perfect seed is available.) Like randomness expansion, this task is impossible classically in the following sense: given a particular type of imperfect source of randomness, a Santha-Vazirani source [718], and no other source of randomness, there is no classical protocol can generate perfectly random bits [718].</p>
        <p>A Santha-Vazirani source is a way of modeling a source of bad randomness. It has the property that each bit given out can be biased towards either 0 or 1 within some limits which are specified by a parameter ε ∈ [0, 1/2]. More precisely, call the outputs S i , and let W i be a random variable representing arbitrary additional information available that could not be caused by S i . The sequence of bits S i in a Santha-Vazirani source with parameter ε if</p>
        <p>In other words, even given the entire prior sequence and any other information that could not be caused by S i , the probability of 0 and 1 each lie between 1/2ε and 1/2 + ε. It turns out that such a source of randomness can be amplified with a quantum protocol. The first proof of this appeared in Ref. [719] where the task was introduced. There it was shown that for ε ≤ 0.058 a single source of εfree bits can be used to generate bits that are arbitrarily close to uniform. Subsequently it was shown that this bound on ε could be extended to cover all ε &lt; 1/2, i.e., any source of partially random bits can be amplified, no matter how small the randomness [720]. These initial protocols gave important proofs of principle, but were impractical due to low noise tolerance or the need for large numbers of devices, a problem addressed in [721]. The current state of the art can be found in [722], which includes a protocol with two devices that tolerates noise and works for all ε &lt; 1/2.</p>
        <p>Further works considered other types of imperfect randomness, in particular, min-entropy sources which take as input a single string with an assumed lower bound on its min-entropy conditioned on arbitrary side information, and no further assumptions about the structure of the randomness. A security proof in this scenario is given in [723].</p>
        <p>It is worth noting that while all of the above works prove security of randomness amplification against quantum adversaries, several also show security against a post-quantum adversary whose power is only limited by the impossibility of signalling. Protocols that work against arbitrary no-signalling adversaries tend to lack efficiency. One reason for this is the difficulty of extracting randomness against a no-signalling adversary [724,725].</p>
        <p>Another noteworthy property of many of the above protocols (all except the protocol of [721]) is that they can work using a public source of randomness as a seed. This is relevant in the context of randomness beacons (for example that of NIST). If a user suspects that the output of the beacon is imperfect in some specified way, they may be able to use a randomness amplification protocol to increase their trust in the output randomness.</p>
        <p>Digital signature is a cryptographic primitive that ensures that a digital message was (i) created by the claimed sender (authenticity), (ii) that the message was not altered (integrity) and (iii) that the sender cannot deny having sent this message (non-repudiation). It is the digital analogue of handwritten signatures but comes with a higher level of security guaranteed by cryptographic means. Digital signatures play a very different role than encryption in modern communications, but this role is of no less importance. Ronald Rivest, one of the inventors of public-key cryptography, stated in 1990 that "the notion of digital signature may prove to be one of the most fundamental and useful inventions of modern cryptography". This prediction has been fulfilled, since nowadays it is a necessary tool for a huge range of applications, from software distribution, financial transac-tions, emails to cryptocurrencies and e-voting.</p>
        <p>Here we review the research on quantum digital signatures (QDS) that demonstrate how using simple quantum communications we can achieve digital signature schemes that are more secure than most of the commonly used digital signatures algorithms. We start in Section XV B with definitions and security properties of digital signatures and motivate the use of quantum means in Sections XV C and XV D. We present the seminal Gottesman-Chuang scheme, and identify the practical limitations it has in Section XV E. In Section XV F we describe how one-by-one these restrictions were lifted, making QDS a currently realizable quantum technology. In Section XV G we describe a generic practical QDS protocol. A reader interested in quickly catching-up with the current state-of-the-art for QDS, could read this section directly after the introduction. In Section XV H we give theoretical and in Section XV I experimental recent developments. Finally, in Section XV J we give a (fully classical) alternative to QDS that requires point-to-point secret keys (potentially obtained via QKD) and then we conclude in Section XV K.</p>
        <p>A QDS scheme involves multiple parties: one sender and (potentially many) receivers. It consists of three phases each described by a corresponding algorithm Gen, Sign, V er.</p>
        <p>(Gen) Key generation algorithm. This sets and distributes the "keys" to be used in the subsequent interactions. (It is also known as the "distribution phase".) A private key (sk) that is given to the sender, and (possible multiple) public key(s) (pk) given to the receivers are selected. In protocols where the public key of different receivers is not the same, a subscript will indicate which receiver refers to e.g. pk i .</p>
        <p>(Sign) Signing algorithm. The sender chooses a message m and uses her private key sk to generate a signature σ = Sign(m) and then send the pair (m, Sign(m)) to the desired receiver.</p>
        <p>(V er) Verifying algorithm. A receiver has as input a message-signature pair (m, σ) and the public key pk and checks whether to accept the message as originating from the claimed sender or not. In certain types of signatures (including the QDS), there are multiple levels of "accepting" a message, depending on what confidence the receiver has that this message would also be accepted if forwarded to other receivers.</p>
        <p>An important property of digital signatures schemes is that after the Gen phase, the actions of the parties are determined without further (classical or quantum) communication, i.e. they sign and decide to accept or reject a message-signature pair, based solely on the keys sk and pk respectively, that were distributed during the Gen phase. This is precisely how hand-written signatures are used, where one signs and accepts/reject a signature "locally". Let us define the correctness and security notions for a digital signature scheme:</p>
        <p>• A digital signature scheme is correct if a messagesignature pair signed with Sign algorithm using the correct private key sk is accepted by the V er algorithm with unit probability.</p>
        <p>• A digital signature scheme is secure if no adversary without access to the private key sk can generate a signature that is accepted by the V er algorithm with non-negligible probability.</p>
        <p>These definitions, along with the guarantee that the private key sk is not leaked and that all parties share the same (correct) public key pk, lead to three important properties: unforgeability, non-repudiation and transferability. We will see that ensuring parties received the same and correct public key becomes a non-trivial task when the keys are quantum. Instead of using the above security definitions, for analyzing QDS schemes, we will instead aim to ensure that the following three properties are satisfied:</p>
        <p>1. Unforgeability: A dishonest party cannot send a message pretending to be someone else.</p>
        <p>2. Non-repudiation: A sender cannot deny that she signed a message.</p>
        <p>3. Transferability: If a receiver accepts a signature, he should be confident that any other receiver (or judge) would also accept the signature.</p>
        <p>Firstly, we need to clarify how the words "cannot" and "confident" are used. The meaning is that, for any adversary allowed (which, depending on the setting, may or may not have restrictions in his computational power), the probability of the protocol failing can be made arbitrarily small with suitable choices of parameters. The exact magnitude of how small is determined by the level of security requested by the use of the given scheme, and is characterized by a small positive number ǫ. In other words, formally we should write ǫ-unforgeability, etc. Secondly, we note that non-repudiation and transferability are very closely related. Not being able to deny a signature typically depends on the way one resolves a dispute, i.e., if Alice refuses that she signed a contract, who will decide whether the contract had her signature or not. In most cases this is the same as asking if a signature accepted by one receiver would also be accepted by a judge or other receivers, and this is exactly the transferability property. Here we will identify non-repudiation with transferability, while keeping in mind that this may not be the most general treatment, if one chooses a different (less natural) "dispute-resolution" mechanism.</p>
        <p>For simplicity, in the following we will refer to the sender as Alice, the received as Bob and when a second receiver is required (e.g. for transferability of messages), he will be referred to as Charlie.</p>
        <p>C. What is a quantum digital signature scheme and why it is useful?</p>
        <p>There are various things that one could call QDS, but in this review we present the research that started with Gottesman's and Chuang's seminal work [726] and deals with: signing a classical message and using quantum communication (and computation) in order to provide information-theoretic security (ITS), so that the signatures generated are "one-time" in the sense that when a message is signed the corresponding private/public keys cannot be reused for signing other messages. Other uses of the term include: signing a quantum message, "blind" quantum signatures, arbitrated quantum signatures, classical signatures secure against quantum computers [727], quantum tokens for signatures [728], etc.</p>
        <p>The most common digital signature schemes are RSAbased, DSA and ECDSA and ElGamal. The security of all these schemes is based on the assumption that the adversaries have limited computational power and that, in particular, it is hard for them to solve the discrete logarithm or factoring problems. While these problems are still believed to be hard for classical computers, since Shor's algorithm [729] we know that an efficient quantum algorithm exists. In other words, if a large quantum computer is built, then it could solve these problems efficiently and break the security of all these signature schemes. This provides a compelling argument in favor of solutions that provide ITS, which is the strongest type of security, holding irrespectively of the computational resources that an adversary has.</p>
        <p>Here it is important to stress that while the most commonly used classical digital signatures schemes (mentioned above) would break, this is not the case for all classical digital signature schemes. There exist many (less practical) classical signature schemes, that appear to remain secure against quantum computers (post-quantum secure), possibly after small modifications in the security parameters (e.g. by doubling the key-lengths). Examples of such schemes are the Lamport [730], Merkle [731], Ring-Learning-With-Errors [732], CFS [733], etc.</p>
        <p>Having said that, there is another strong argument for ITS (and thus QDS). The research in quantum algorithms is not as mature as in classical algorithms, therefore the confidence we have on the hardness of problems still changes. For example, in a recent result [734] one of the best candidates for post-quantum cryptography, the learning-with-errors (LWE) problem, was proven to be equivalent to the dihedral-coset problem, for which there is a sub-exponential quantum algorithm. While this algorithm still would not fully break the security of LWE, it certainly weakens its security and one may wonder whether we should base the security of our communications on such computational assumptions.</p>
        <p>D. The Lamport one-time signature scheme QDS schemes were inspired by Lamport's one-time signatures [730] and for this reason we present here a highlevel description of this scheme. Assume that we have a (classical) one-way function f . For such a function, it is simple to evaluate f (x) given x. However, given f (x) = y it is hard to find the pre-image, i.e. invert the function to get the value x. Of course, we can already see that this definition (hardness of inverting) assumes (i) limited computational resources (otherwise one could "brute-force" by trying all x's until he finds the pre-image or a collision) and (ii) the function is such that it is not efficiently invertible. In other words any scheme based solely on the above cannot offer ITS.</p>
        <p>Alice chooses two random inputs x 0 , x 1 and evaluates f (x 0 ), f (x 1 ). She then publicly broadcasts the pairs (0, f (x 0 )) and (1, f (x 1 )) which will be the public keys pk, while she keeps the values x 0 , x 1 secretly stored (private key sk). This completes the Gen algorithm. Then to Sign, Alice simply sends the message b along with her stored corresponding secret key x b . The receivers, to accept/reject (V er algorithm) they evaluate f (x b ) and check if it agrees with their public key in order to accept.</p>
        <p>The intuition why this is secure comes from the fact that the function is hard to invert. Therefore an adversary with access only to the public keys (images) cannot find the secret key (pre-image) for any message, in order to provide a valid (forged) signature. At the same time, if anyone receives a valid signature (with respect to the publicly available public key), they are convinced that it came from Alice (non-repudiation), even if she claims it does not, because nobody else could have generated such signature.</p>
        <p>Finally, at the end of such scheme, all used and unused keys are discarded (thus one-time signatures). Such protocol has been modified using Merkle trees [731] to allow the signing multiple messages.</p>
        <p>In 2001, Gottesman and Chuang [726] proposed the first QDS protocol, that we may briefly call GC-QDS. The central idea was to use the fact that non-orthogonal states cannot be distinguished perfectly so as to realize a "quantum one-way function", where the inability to invert is not based on computational assumptions but guaranteed by the laws of quantum mechanics. The basic idea is that if we have a quantum state |f (x) , where f (x) represents the classical description of the state, and the set of possible states are non-orthogonal, no-one should be able to determine the classical description of the state, with high probability, unless they already know it (otherwise they could also copy/clone the state). Moreover, the amount of information obtained is bounded by the Holevo theorem [735]. In other words, we have the classical description of the state to play the role of the secret key sk, while the quantum state itself is the public key |pk . Such "one-way function", by construction, cannot be broken even if one has unlimited computational power.</p>
        <p>A function f is chosen and is made public. This function takes input x and returns f (x) that is the classical description of a quantum state. For example, x can be a two-bit string and f (x) denotes one of the four BB84 states. There is no need for this function to be one-way, since what replaces the one-wayness of classical protocols is that one cannot obtain the classical description of a quantum state with certainty. In GC-QDS some choices of functions were made, but this is not crucial for the general description. Let us analyze the various steps.</p>
        <p>a. Key generation. For the private key, Alice chooses pairs of bit-string {x i 0 , x i 1 }, where 1 ≤ i ≤ L. The x 0 's will be used to sign the message 0 and the x 1 's to sign the message 1. The number of pairs L is determined by the security level requested.</p>
        <p>For the public key Alice generates multiple copies of the state {|f (x i 0 ) , |f (x i 1 ) }. Since only Alice knows the secret keys, and unknown quantum states cannot be copied, she generates all the copies. Then she distributes to each potential receiver the corresponding states, along with the label for which message they correspond.</p>
        <p>In a digital signature scheme, all parties may be dishonest (not simultaneously though). When the public key is classical, parties could easily check that they have the same public keys. This is far from trivial in our case. Gottesman and Chuang proposed to use multiple copies (of each public key for each party) and they interact by performing SWAP tests (see Fig. 19). This is a test that gives always affirmative answer without disturbing the state, when two states are identical, while fails probabilistically otherwise. This comes with considerable cost, since each copy of the public key (quantum state) circulated makes easier the task for an adversary to recover the classical description (secret key) and therefore to forge a message. Finally, all receivers store the public key into a quantum memory until they receive a signed message.</p>
        <p>b. Signing. To sign a message, Alice simply chooses the message value b ∈ {0, 1} and sends (b, x i b ) to the desired receiver. This is a completely classical phase. c. Verification. In order to confirm whether the message-signature pair is valid, the receiver uses the classical description: for each x i b he generates the corresponding quantum state |f (x i b ) and checks if it is consistent with his stored public key. Then he counts the fraction of incorrect keys s t (out of the L keys). At this point QDS deviates from standard digital signature schemes. The verification algorithm takes three answers (rather than the usual two accept/reject). The receiver can return REJ when convinced that the message-signature pair is not valid, can return 0-ACC if he is certain that is valid but is uncertain if this signature would also be accepted by other receivers when forwarded (or by a judge), and return 1-ACC if he is certain that is valid and will also be accepted by other receivers or judges. The reason for this modification is subtle and is explained below in the section on the intuition of the security. Depending on the details of the protocol, there are two parameters 0 &lt; s a &lt; s v &lt; 1 that determine what V er outputs. If s t &gt; s v the receiver REJ. If s v &gt; s t &gt; s a the receiver 0-ACC and if s t &lt; s a the receiver 1-ACC.</p>
        <p>Unforgeability is guaranteed by the fact that, given an unknown quantum state, one cannot guess its classical description with certainty, even if the state is from within a known (non-orthogonal) set. A potential forger has in his disposal all the copies of the quantum public keys, and, if colluding with other receiver, may even have extra copies. We assume that the forger performs a minimum-error (or minimum-cost in general) quantum measurement to obtain his best guess, with an associated probability p f of failure. Provided that this probability is higher than an accepting threshold p f &gt; s v , a forger cannot mimic a valid signature, at least not with probability higher than a decreasing exponential e -c(p f -sv ) 2 L for some constant c. This argument is similar in all QDS protocols, where calculating p f and c varies on the details (number of copies circulated, form of the quantum states sent, method to measure/identify errors in the key, etc).</p>
        <p>To prove non-repudiation is even more subtle. Alice is not forced to send identical quantum public keys to Bob and Charlie. As outlined above, they communicate quantumly and perform a number of SWAP tests on copies of the public keys. The result of these tests succeeds probabilistically. If there was a single verification threshold s v , then Alice could tune the public key she sends to Bob and Charlie to have (expected) s v L errors. Since the number of errors is determined by a normal probability distribution with mean at s v L, the probability that one of them finds more than s v L errors is exactly 1/2. This means that with probability 1/4 one of them will practically detect more than s v L errors while the other less than s v L errors, and therefore they would disagree on whether this signature is valid or not. This is why Gottesman and Chuang introduced a second threshold s a and used both s a and s v . Now to repudiate, Alice needs to generate a signature that the first receiver accepts as message that can be forwarded while the second receiver completely rejects. In other words we need the errors of Bob to be below s a L while those of Charlie to be above s v L. We can see that, similarly with the forging case, this probability decays exponentially if s a &lt; s v with a rate e -c ′ (sa-sv ) 2 L .</p>
        <p>Finally, in any realistic setting, even an honest run would result to certain errors due to the noise and imperfections in the quantum communication and quantum memory. This could lead to honest signatures being rejected, which again is undesirable. (This is known as correctness, soundness or robustness in different places in the literature.) We denote the fraction of those honest errors as p e and once again we see that the protocol does not reject honest signatures if p e &lt; s a , so that the probability of honest rejection decays as e -c ′′ (pe-sa) 2 L .</p>
        <p>To summarize, we have 0 &lt; p e &lt; s a &lt; s v &lt; p f . The parameter p e is determined by the system, noise, losses, etc, while p f is theoretically computed as the best guess/attack. The two parameters s a , s v should be suitably chosen within the gap g = p fp e , and approximately in equal distances so that we have minimum probability that something undesirable (forging, repudiation, honest-reject) happens.</p>
        <p>Let us note that exact calculation of the above parameters for GC-QDS was not done since there were many practical limitations to actually implement such protocol. It served more as an inspiration for later works.</p>
        <p>Then note that this protocol involves multiple parties (at least when considering transferability/nonrepudiation) and any one of them could be malicious. This is one of the most crucial differences compared to QKD. The adversaries in QDS are legitimate parties in the (honest) protocol (while Eve in QKD is an external party). This means that even when we are guaranteed that all quantum communications are done as the sender wishes, there are still potential attacks. It is exactly this type of attacks that we have so-far considered. Receivers using their legitimate quantum public key to make a guess of the private key and forge; or a sender sending different quantum public key to each receiver in order to repudiate.</p>
        <p>In [726] and in the first few works on QDS, to simplify the security analysis, it was assumed that these are essentially the only possible attacks. This formally was described as having an authenticated quantum channel between the parties. However, to actually have such a channel (or to have quantum-message-authenticationcodes [736]), there is a considerable cost. Subsequent works lifted this assumption.</p>
        <p>Finally, while we have described QDS as a public-key cryptosystem, strictly speaking this is not quite precise. The "public key" is a quantum state, thus it cannot be copied or broadcasted as classical keys. Therefore to properly ensure that the public key is the same, point-topoint (quantum) communication is required, while parties that have not participated in the Gen phase, cannot enter later (i.e., it lacks the "universal verifiability" of classical public key cryptosystems). Whether these issues are crucial or not, it depends on the use/application that the digital signatures are required (e.g., how important is the security) and the efficiency of the QDS protocol after having taken into account the above issues.</p>
        <p>The GC-QDS scheme highlighted the possibility of a beyond-QKD quantum cryptographic primitive, but it did not trigger a wide research burst immediately. The reason that it took more than 10 years to have the wider research community following these steps was, mainly, because the original protocol was highly impractical to be actually implemented and used. The three major practical restrictions were:</p>
        <p>1. The quantum public key is a quantum state received during the Gen phase and then later used again during the V er phase. However, in normal practise, the acts of establishing the possibility of digital signatures and actually signing and even later verifying (or forwarding) a signature can be separated by long periods of time (days or even months). Storing quantum information for even seconds is hard and is one of the major restrictions in building scalable quantum computers.</p>
        <p>2. In order to test that receivers obtained the same quantum public key, they need to communicate and have multiple copies of the key, then test whether they are the same using a comparing mechanism such as the SWAP test, send copies to other parties and re-use the SWAP test between their public key and the one received from other parties. This involves extra quantum communication and, more importantly, using ancillae and controlled SWAP gates on each qubit. These operations are operations sufficient for a universal quantum computation and adding the quantum memory requirement, it appears that all parties should have a full universal quantum computer to participate in GC-QDS. This is in sharp contrast with QKD, that requires minimal quantum technologies, for example preparing and measuring single qubits.</p>
        <p>3. In the analysis of GC-QDS we have assumed that the quantum states that parties want to send, arrive to the desired party correctly, i.e., they have an authenticated quantum channel. While quantummessage-authentication-codes do exist [736], they bring extra cost. Alternatively, one could modify a QDS protocol to be secure even when there is no guarantee about the quantum channel(s) used.</p>
        <p>F. Practical QDS: Lifting the limitations Since the appearance of the GC-QDS protocol there were four major developments, which we outline here. These lifted all the aforementioned limitations transforming QDS from a theoretical idea to a practical quantum communication primitive, technologically as mature as QKD. Further improvements (in the security proofs/guarantees, performance and realizations) will be summarized in the subsequent sections.</p>
        <p>Provided that the quantum public key of a QDS protocol consists of coherent states, this practical test can replace the SWAP-test in both its uses. First to ensure that the quantum public keys are identical and thus Alice is not attempting to repudiate. Second, to check the validity of a signature by checking that a quantum public key matches its classical description (given when a signed message is received). In Ref. [737], the quantum public key consists of two states (b = 0 for signing message 0 and b = 1 for message 1) whose form |ψ b pk corresponds to a string of coherent states ||α|e iθ with the same (known) amplitude |α| and phase chosen randomly from the angles θ ∈ {2π 1 N , 2π 2 N , . . . , 2π N -1 N }, for suitable N . The classical description of this string (the choice of phase for each coherent state in the string) is the private key sk.</p>
        <p>The main idea of the coherent-state quantum comparison is depicted in Fig. 20, where we can see that the "null-ports" measure the phase difference between the two incoming coherent states (and is the vacuum when they are identical). Note, that this comparison is very simple technologically, since all that is needed is beam splitters, mirrors and photon detectors. This is why this set-up is a considerable advancement compared to the SWAP-test used in GC-QDS.</p>
        <p>Since this comparison should be performed for the quantum public keys that receivers (Bob and Charlie) have, the multiport of Fig. 20 locations (Bob's and Charlie's labs). This has two consequences, one practical and one theoretical. The practical is that being in a distance, ensuring path lengths are identical is not trivial, while extra losses occur, since not only the quantum public key needs to go from Alice to Bob/Charlie, but then it needs to go through this comparison process. The theoretical issue is that Alice, in principle, could also tamper the quantum states communicated between Bob and Charlie, something that complicates the (full) security proof. Such proof was only completed for some modified protocols much later.</p>
        <p>To sign a message Alice sends the corresponding message b along with the string of phases corresponding to ψ b pk . Bob (Charlie) to accept, reconstruct the state |ψ b pk and use state-comparison with their stored state. They count the number of positions in the string that the nullport clicks and compare the fraction with the thresholds (s a , s v ) and decide to accept as original (1-ACC), as forwarded (0-ACC) or to reject the message.</p>
        <p>As we have already stressed, in GC-QDS the public key is a quantum state and one needs to store it until the V er phase, something that makes impractical such scheme. Dunjko et al. [738] constructed a QDS protocol that does not require a quantum memory. The central idea is to replace the quantum public key (which needs to be stored coherently) with a classical "verification key", which is no longer the same for all receivers.</p>
        <p>The protocol builds on Refs. [737,739] and starts with Alice distributing a "quantum public key" being two strings of coherent states, where for simplicity, the possible phases of each state are two, i.e., the strings are of the type |α |α |α • • • |α (if Alice is honest). Bob and Charlie use the multiport scheme of Fig. 20 to ensure that Alice was (mostly) honest. Then they directly measure each coherent state pulse, using unambiguous state discrimination (USD) [740][741][742]. With this measurement, Bob and Charlie know with certainty the classical description of some positions in the string(s) of coherent states that Alice sent, while they have no information about other positions.</p>
        <p>This information (position in string and value measured) are stored by Bob and Charlie and will be their verification key. (Note that the verification key of Bob and Charlie is different, even in the honest case. This is because for which positions a USD gives conclusive outcome is probabilistic and happens independently for the copy that Bob and Charlie have.) When Alice sends a signature, she needs to return the classical description for all the string corresponding to the message b she wants to sign. Bob and Charlie count the fraction of mismatches that the string that Alice has with their stored verification key(s) s t and they reject, 0-ACC or 1-ACC comparing these mismatches with the thresholds s v an s a .</p>
        <p>The important detail that makes such scheme secure, is that Alice does not know for which positions Bob and Charlie know the state and for which they do not. It is therefore impossible for her to send a classical description that agrees with all the possible verification keys unless she sends the honest private key.</p>
        <p>Note that, to achieve ITS encryption, one uses quantum communication (QKD) to achieve a shared secret key and then uses the fully classical one-time-pad protocol to encrypt a message. Similarly, here, we use quantum communication to achieve correlations between the classical information of the parties involved in the signature scheme (their private/verification keys). Then after establishing these correlations, a fully classical signing and verifying algorithm follows and achieves the digital signature functionality.</p>
        <p>After removing the quantum memory requirement, the only remaining difficulty making QDS harder than QKD is the mechanism to ensure that the same quantum public key was sent to different receivers (ensuring nonrepudiation), whether this mechanism is the SWAP-test or the much simpler coherent-state comparison (using a spatially separated multiport).</p>
        <p>A crucial observation is that both the SWAP-test and the coherent-state comparison accept symmetric states. In other words, if the states compared are in the global state 1 √ 2 (|ψ |φ +|φ |ψ ), both tests would always accept. While this may appear as a problem, it turns out that Alice is unable to repudiate by sending such symmetric states. In fact, since the state is symmetric, Alice is unable to make Bob accept (with the lower error threshold s a ) and in the same time make Charlie rejects (with the higher error threshold s v used for forwarded messages). It is the symmetry of the state and the gap g = (s vs a ) that ensures non-repudiation.</p>
        <p>Starting from this observation, Wallden et al. [743] replaced the comparison test with a "symmetrizing" step and proposed three protocols. This extra step ensures that, even if Alice did not distribute identical quantum public keys, the classical verification keys that Bob and Charlie store will be symmetric and thus Alice is unable to make them disagree. All protocols given in [743] can be performed with BB84 states. Here we outline one of these protocols to demonstrate these ideas.</p>
        <p>Alice selects two strings of BB84 states (one for each future message b), and she generates two copies of these strings and send them to Bob and Charlie. For each qubit, Bob (Charlie) either forwards it to Charlie (Bob) or keeps it and measures it in either {|0 , |1 } or {|+ , |-} basis. Similarly, he measures the forwarded qubit that he received from Charlie (Bob). Depending on the result, he rules-out one of the possible states. For example if for the nth qubit he obtains the outcome "+", Bob stores that the nth qubit is not |-(something he can know with certainty). Bob (Charlie) stores the sequence of eliminated states, the position in the string, and whether he received it directly from Alice or as forwarded from Charlie (Bob). This classical information will be Bob's (Charlie's) verification key.</p>
        <p>As usual, Alice to sign sends the message and the classical description of the corresponding string of qubits. Bob checks for positions that the declaration of Alice contradicts his stored verification key (i.e. places that Alice sends the state that Bob has ruled-out). Then the fraction of this mismatches is compared to the two thresholds s a , s v and Bob rejects or 0-ACC or 1-ACC.</p>
        <p>One major assumption made so far was that the quantum channels used were authenticated, i.e., the quantum states sent during the quantum communication part of the protocol were the same as the one received. While there are general (costly) methods to achieve this, an intuition why this may not be necessary was already given. One can imagine "sacrificing" part of the communicated qubits to test (and bound) the tampering that third parties performed. This is exactly what parameter estimation in QKD achieves. In Refs. [744,745] the authors made this intuition precise. As part of the interaction that leads to a private key for Alice and (partial information) for Bob (Charlie), they included a parameter estimation phase. As far as the experiment is concerned, it is now a normal QKD protocol, that stops before error correction and privacy amplification. The way to bound forging and repudiation is very different and depends on the specific protocol.</p>
        <p>In Ref. [744] there was another change. The quantum states (quantum public key) that Alice sends to Bob and Charlie were no longer the same. Since the only condition that secures Bob and Charlie against repudiation is the symmetrization procedure, whether Alice sends initially the same or different states makes no essential difference. The only practical difference is that Alice's private key is now composed from the classical description of both the different strings sent to Bob and Charlie. On the other hand, by sending different quantum states, Alice limits the potential forging attacks, since forgers have no longer copies of the full legitimate quantum public key.</p>
        <p>Finally, a very interesting observation is that the (channel) error rates for which QDS was possible in [744] were higher than those for QKD. This means that by using this QDS scheme, one may be able to perform QDS in a setting where QKD is not experimentally feasible.</p>
        <p>G. A generic modern QDS protocol</p>
        <p>We can now give a description of a generic modern QDS protocol, i.e., one that does not require quantum memory, that can be realized with the same technology as QKD and that makes no assumption on the quantum channels used. The description below is restricted to three parties, but can be generalized to more parties.</p>
        <p>a. Key generation. We start with (any) QKD system as basis. Alice performs the first part of a QKD protocol (separately) twice with Bob and twice with Charlie. The QKD protocol is completed up to obtaining the raw key (i.e., before error correction and privacy amplification). As result, Alice has four bit strings A B 0 , A B 1 , A C 0 , A C 1 , Bob has two strings K B 0 , K B 1 and Charlie has K C 0 , K C 1 . By the properties of a (non-aborted) QKD protocol, the correlation between, say, A B 0 and K B 0 is greater than the correlation of A B 0 and a string that any other party can produce. The private key sk that Alice uses to sign a message in the future is the concatenation of the two corresponding strings sk = (A B 0 ||A C 0 , A B 1 ||A C 1 ). During this process, the error rates of the channels are estimated, and values for s a , s v are chosen such that 0 &lt; p e &lt; s a &lt; s v &lt; p f &lt; 1, and s a , s v are "placed" equally separated within the gap p fp e . Here, p e is the estimated ("honest") error rate between Alice-Bob using their quantum channel, while p f is the minimum error rate that Eve makes trying to guess Alice's string.</p>
        <p>Bob and Charlie perform a symmetrization by exchanging secretly half of their strings (e.g., using another full QKD link). The new strings for Bob S B 0 , S B 1 (and similarly for Charlie S C 0 , S C 1 ) are each composed from half of the string initially sent to Bob and half of that to Charlie, but which part from Bob's initial string and which part from Charlie's is unknown to Alice (since the symmetrization was performed secretly). c. Verification. To accept a message coming directly from Alice, Bob checks the mismatches rate p B t between the signature received A B m ||A C m and his stored verification key S B m , for each part of the signature separately (i.e. mismatches in the part he obtained directly from Alice and mismatches in the part he obtained from Charlie during the symmetrization). If p B t &lt; s a he accepts for both cases, i.e. 1-ACC. Charlie receives a message with Alice's signature, but from Bob. He checks the mismatches rate p C t similarly to Bob, and if p C t &lt; s v for both parts, he accepts the message as coming originally from Alice.</p>
        <p>Forging is not possible because any potential forger, even a legitimate party (e.g. Charlie), cannot guess the part of the Alice's private key that was not directly send to him, at least not with any probability significantly better than p f . His forging probability actually scales at best as e -c(p f -sa) 2 L which vanishes for sufficiently large length of string L. Similarly, non-repudiation is guaranteed by the fact that Alice is ignorant on which part of K B m , K C m is in S B m and which is in S C m , she is therefore unable to make Bob accept and Charlie to reject, and her probability of succeeding in this scales as e -c ′ (sv -sa) 2 L . Finally, an honest abort is unlikely, since we chose s a &gt; p e which leads to the honest abort occurring with probability at most e -c ′′ (pe-sa) 2 L .</p>
        <p>A QDS protocol performance is judged by the time taken to distribute the verification key(s) among the parties, but also the distance that the parties could be separated. (The signing algorithm and verification algorithm are both assumed to be much quicker and thus we judge the protocols, essentially, on the time required for the key generation.) In most cases, we consider single-bit message and assume linear scaling, however there may exist more efficient ways to sign longer messages (e.g. [746] for a classical ITS scheme). The time taken to distribute the verification key(s) depends on the clock-rates (how many pulses are sent per second) and on how long strings L are required to achieve a desired level of security. In other words, what L and other choices should be made, so that the probability of something going wrong (forging, repudiation, honest-abort) is below ǫ -the desired level of security.</p>
        <p>To jointly minimize the probabilities of forging, repudiation and honest-abort, we first need to determine the values p e , p f . The estimated honest-error rate p e is obtained from the specific channel/experimental set-up used, and can be thought as a practical constraint. It is easy to see that p e increases with the distance between parties, therefore there is a trade-off between speed of distributing verification key(s) and distance. We should keep this in mind when comparing different implementations. The best forging error attempt p f is theoretically evaluated for example by considering the minimum-cost quantum measurement that adversaries can perform. Once these two are given, optimal choices for s a , s v are calculated to jointly minimize the probabilities of forging, repudiation and honest abort. Typically we require equal separation between the intervals (s ap e ), (s vs a ), (p fs v ), since they all appear in similar form in the exponential decay of the expressions of honest-abort, repudiation and forging, respectively. The QDS schemes we presented considered the case of three parties, the smallest number sufficient to illustrate the transferability property. In that setting, only one party at a time can be an adversary. In real practise however, multiple parties would be involved as potential receivers.</p>
        <p>A potentially-important disadvantage of QDS compared with classical schemes is the way the communication required in the Gen phase scales as a function of the number of parties involved. For most QDS protocols, a quadratic number of communication channels is required. Moreover, when multiple parties are involved, the issue of colluding parties (including sender colluding with some receivers) should be considered, while also the issue of multiple transfers of a signed message (and the corresponding honest parties fraction thresholds) need to be considered. In Ref. [747] the general framework for multiple-party QDS, certain generic properties, and the concept of multiple levels of transferability (and verification) were introduced, along with a multi-party generalization of one protocol. In Ref. [748] the three-party protocol of [744] was also extended to multiple parties.</p>
        <p>Most of the research on QDS is focused on signing single-bit messages, and it is usually stated that a simple iteration can be used for longer messages. While this is mostly true, there are two issues that require attention. First, as analyzed in Ref [749], there are attacks on longer messages impossible to be addressed from single-bit signatures, e.g. tampering with the order of the bits. The second issue is that of efficiency. In classical schemes, using hash functions one can reduce the extra cost from being linear in the size of the message (as in simple iterations) to being logarithmic [746]. It is worth exploring QDS schemes that could improve the scaling with the message size.</p>
        <p>As with QKD, many QDS protocols are vulnerable to side-channel attacks [750], with the best known sidechannel attacks exploiting measurement-device/detector vulnerabilities (e.g. the "blinding attack"). For this reason, MDI protocols for QDS where first introduced in Ref. [751]. The analysis follow closely that of QKD and of Ref. [744] and we omit further details. One interesting thing to note is that the extra security guarantee (against some side-channel attacks) comes at no (or low) cost in terms of practicality, unlike the fully device-independent protocols. Moreover, the MDI setting that contains untrusted mediating parties is suitable for QDS (where there are multiple parties and each party can be adversarial). It allows us to consider optimization of routing of quantum information in quantum networks, i.e. consider different (or even flexible) connectivity of parties to optimize the multiparty versions of QDS schemes.</p>
        <p>Since 2012, a number of experiments implementing QDS protocols has been performed, and from the first proof-of-principle experiments we now have fully secure, long-distance QDS implementations on existing quantum networks, suitable for real life applications. As mentioned in Section XV G and similarly to QKD, there is a trade-off between the distance that parties can be separated and the speed that verification keys for fixed length messages are distributed. The distances mentioned below are the maximum distances that QDS could run, while it is understood that for smaller distances the "rate"/performance would improve.</p>
        <p>The first QDS experiment by Clarke et al. [739] was based on the QDS protocol outlined in Ref. [737], where the coherent-state comparison (see Fig. 20) was introduced in order to replace the SWAP-test [726]. The simplest case of three-parties was implemented, where each coherent-state pulse |α = ||α| exp(2πiφ) had its phase randomly chosen from eight possible choices (φ = k/8 for k ∈ {0, 7}). Different mean-photon numbers |α| 2 were examined. As explained in the end of Section XV G, one needs to jointly minimize the forging, repudiation and honest-abort probabilities. Too high |α| makes p f small (and forging simple since the states approach classical states and can be copied), while too low |α| makes p e large (dark counts are a larger fraction of detections, making honest-abort more likely) so an optimal value for |α| should be sought.</p>
        <p>The experiment was meant to be a proof of principle. Firstly, the parties were all located within small distance (same lab). Secondly, the signing and verifying happened immediately (no quantum state stored). In particular, instead of Bob regenerating the quantum state of the signature from Alice's signature (classical description), and then compare it with his stored states, Bob obtained directly the sequence of the qubits from Alice (that used a beam-splitter before sending the quantum public key) and compared it with the hypothetically stored quantum public key.</p>
        <p>A second QDS experiment was performed by Collins et al. [752], based on the QDS protocol of Ref. [738] that does not require quantum memory. Because of this property, the only unrealistic assumption was the separation of the parties (still within the same lab), while the signing and verifying happened in arbitrary later time. The protocol used a generalization of the unambiguous discrimination measurement, namely unambiguous elimination measurement. Again it involved three parties, sharing strings of phase-encoded coherent states, where this time the possible phases were four N = 4.</p>
        <p>2. Kilometer-range and fully-secure QDS Subsequently, based on the idea that one can replace the state comparison with symmetrization [743], two experiments [753,754] were performed that had parties able to be separated by a distance of the order of kilometer. Callum et al. [754] was also the first QDS protocol that used continuous variables (heterodyne detection measurements) and the first experiment to be performed through a free-space noisy 1.6 km channel (in Erlangen).</p>
        <p>Following [744,745], the last unrealistic assumption was removed, i.e., authenticated quantum channels. The use of decoy states, and other theoretical but also technical improvements, resulted in protocols with far superior performance, having the parties separated by tens to hundred kilometers [755,756]. This brings QDS in par with QKD in terms of practicality. Finally, MDI-QDS protocols, addressing measurement-device side-channel attacks, have been implemented over a metropolitan network [757] and at high rates by using a laser seeding technique together with a novel treatment of the finite-size effects [758].</p>
        <p>The type of digital signatures that are achieved by QDS offer ITS, but are one-time (cannot be reused) and require a fixed number of parties all participating during the key generation phase. Only those parties can sign and verify in the future messages and, if one wanted to extend the participating parties, new interactions would be required between (many) parties. In contrast, classical public-key signatures can be verified by anyone with access to the public key (that can be obtained later than the Key Generation phase).</p>
        <p>This specific type of signatures that QDS achieve, was actually first considered by Chaum and Roijakkers [759] and were termed unconditionally secure digital signatures (USS). In order to achieve USS, all parties needed to share (long) secret key pairwise, while another assumption was also necessary (an authenticated broadcast channel or anonymous channels). Only a few papers followed this work [760][761][762][763]. The main reason for the limited interest was probably because such protocols were seen as impractical, specifically because they require point-to-point shared secret keys. Then, the extra security offered (information theoretic) was not viewed as necessary. Both of these issues have been revisited with the recent advances in quantum technologies since: (i) sharing long secret keys can be achieved with QKD, and (ii) advances in quantum computers make realistic the prospect of large scale quantum computers that could break existing cryptosystems in the medium term. Therefore, it appears likely that interest for this type of protocols could increase.</p>
        <p>In a parallel direction, inspired by QDS, a classical USS protocol was proposed in Ref. [743], where only pairwise secret keys were required. This scheme was generalized to multiple parties in Ref. [747]. Subsequently, in Ref. [746], a USS protocol that scales much better for longer messages was obtained using universal hashing (it requires key-sizes that scale logarithmically with the message length). All these protocols require only pointto-point secret keys and neither authenticated broadcast channel nor anonymous channels or trusted third parties were assumed. Because no further assumptions were made, these protocols prove a "reduction" of the task of USS to that of point-to-point secret keys and thus to standard QKD.</p>
        <p>QDS is a type of digital signatures that offers information theoretic security, a very attractive feature, that the progress in building quantum computers has made even more timely. The "trade-off" is that this type of digital signatures that QDS achieve is missing some of the elements that made digital signatures such an important functionality (e.g. the universal verifiability).</p>
        <p>In this review we described the research that transformed QDS from a theoretical interesting observation to a practical possibility. In Sections XV E and XV F we presented the developments and choices made in a historical order, while in Section XV G we gave a description and brief analysis of a generic modern QDS protocol. Latest state-of-the-art developments were subsequently mentioned briefly, referring the reader to the original works for further details.</p>
        <p>Possibly the biggest challenge for QDS is how do they compare with the classical digital signature schemes that offer ITS. In Section XV J we presented those classical protocols and noted that all of them require point-topoint (long) secret keys between the participants. Indeed, it appears that the classical scheme given in Ref. [746] (inspired by QDS) offers similar guarantees and cost with QDS while being more efficient for long messages, i.e., exponentially better with respect to the size of the message signed.</p>
        <p>However, there are at least three directions (and reasons) that further research in QDS is still very promising.</p>
        <p>1. Firstly, it is likely that a QDS protocol with better scaling for long messages can be developed. So far, the majority of research in QDS focused on the single-bit message case and the possibility of better scaling for longer messages has not been sufficiently examined.</p>
        <p>2. Secondly, classical protocols require communication between all parties, i.e., quadratic in the number of participants and number of communication channels. In contrast, with QDS it is possible to achieve linear scaling with respect to the quantum channels. The QDS scheme given in Ref. [745] is an example that offers such feature. This particular protocol would not scale so well with more parties for different reasons (sensitive in forging probability), but it demonstrates the possibility of using quantum resources to reduce the communication channels.</p>
        <p>3. Thirdly, in Ref. [744] a QDS protocol was given that could be secure even when the noise in the channels was too high for QKD, again demonstrating the possibility that fundamentally quantum protocols are possible when the "classical" ones (that in any case require QKD) are impossible.</p>
        <p>Finally, the so-called "classical" ITS protocols, such as the one given in Ref. [746], require point-to-point secret keys, and those keys can only be practically achieved using QKD. In this sense we can view even these schemes as quantum digital signature schemes. While the theory of classical ITS protocols involves little or no new quantum research, their development makes stronger the case for building a quantum communication infrastructure and thus increases the impact of quantum cryptography by offering further functionalities.</p>
        <p>In particular, digital signatures are useful when they involve many (potential) parties, which means that QDS could be useful for real applications only if the corresponding infrastructure is in place, i.e., a large quantum network. While this infrastructure is not currently available, the possibility of QDS (including the USS protocols given above) offers greater value to quantum networks and thus makes the argument for developing such infrastructure more compelling.</p>
        <p>In this review we have presented basic notions and recent advances in the field of quantum cryptography. We have focused most of the discussion on QKD, but also presented some developments which goes beyond the standard setting of key distribution. As a matter of fact, quantum cryptography is today a big umbrella name which includes various areas, some of which have not been treated in this review. For instance, other topics of interest are cryptographic primitives such as oblivious transfer and bit commitment, or topics of secure computing, including blind, verifiable quantum computing, and secure function evaluation. Post-quantum cryptography (e.g., lattice-based cryptography) is an interesting area that may offer a temporary solution to security. Then, a number of protocols have not been treated and worth mentioning such as quantum fingerprinting, quantum secret sharing, quantum Byzantine agreement, and quantum e-voting.</p>
        <p>While quantum cryptography is certainly the most mature quantum technology so far, a number of challenges and open questions are facing both theoretical and experimental work. There is still the need to develop and implement more robust QKD protocols, which are able to achieve long distances at reasonably high rates. This seems to be matter of developing a QKD network based on practical quantum repeaters. An even more ideal task would be to realize the end-to-end principle in such a QKD network, so that the middle nodes may generally be unreliable and untrusted. Today, this idea seems only to be connected to the exploitation of EPR-like correlations, either in a direct way (i.e., assuming that middle nodes produce maximally-entangled states) or in a reverse fashion (i.e., assuming that the nodes apply projections onto maximally-entangled states, i.e., Bell detections).</p>
        <p>Theoretically, there are efforts directed at establishing the fully-composable finite-size security of a number of QKD protocols, both in DV and CV settings. It is then an open question to determine the secret key capacity of several fundamental quantum channels, such as the thermal-loss channel and the amplitude damping channel. While the recently-developed simulation techniques have been successful in many cases, the two-way assisted capacities of these channels may need the development of a completely new and different approach.</p>
        <p>Experimentally, the current efforts are going towards many directions, from photonic integrated circuits to satellite quantum communications, from more robust point-to-point protocols to implementations in trustednode quantum networks, from qubit-based approaches to higher dimensions and continuous variable systems. While optical and telecom frequencies are by far the more natural for quantum communications, longer wavelengths such as THz and microwaves may have non-trivial shortrange applications which are currently under-developed.</p>
        <p>A number of loopholes need to be carefully considered before QKD can be considered to have become an fullysecure quantum technology. Practical threats are coming from side-channel attacks, for which countermeasures are currently being studied and developed for some of the most dangerous quantum hacks. Weakness may come from things like imperfections in detectors or the random number generators. Quantum hacking and countermeasures is therefore an important and growing area.</p>
        <p>In general, for a technological deployment of quantum cryptography and QKD, we will need to consider its integration with the current classical infrastructure and develop layers of security, depending on the degree of confidentiality to be reached which, in turn, depends on the stakeholder and the type of business involved. Protocols based on bounded-memories and quantum data locking provide a temporary low-level of quantum secu-rity that may be suitable for private personal communications. Standard QKD protocols provide higher levels of security that may be suitable for financial transactions. Within QKD, different secret key rates might be considered, for instance, with respect to individual, collective or fully-coherent attacks. The choice of these rates may also be associated with a specific sub-level of security to be reached. Higher level of security, for applications such as political or strategic decisions, may involve the use of DI-QKD, which is more robust to both conventional and side-channel attacks. These aspects will become clearer and clearer as quantum cryptography will progressively become a wider technological product.</p>
        <p>the following commutation relation The coordinate transformations x′ =Sx that preserve the above commutation relations form the symplectic group, i.e. the group of real matrices such that SΩS T = Ω. There are essentially two standard ways of grouping the quadrature operators, and the definition of Ω changes accordingly. These are x := (q 1 , . . . , qn , p1 , . . . , pn ) T , Ω := 0 1</p>
        <p>where 1 1 is the n × n identity matrix, or</p>
        <p>x := (q 1 , p1 , . . . , qn , pn ) T , Ω :=</p>
        <p>All the formulae that we review here are independent of this choice, provided that the grouping x and matrix Ω are chosen consistently. Any multimode bosonic state ρ can be described using phase-space methods by means of the Wigner characteristic function χ(ξ) = Tr[ρe ix T Ωξ ]. The state ρ is called Gaussian when χ(ξ) is Gaussian [6]. For a Gaussian state, the density operator ρ has a one-to-one correspondence with the first-and second-order statistical moments of the state. These are the mean value x := x ρ = Tr(xρ) ∈ R 2n and the covariance matrix (CM) V , with generic element</p>
        <p>where {, } is the anticommutator. According to Williamson's theorem, there exists a symplectic matrix S such that [6] V = S(D ⊙ D)S T , D = diag(v 1 , . . . , v n ), (A6)</p>
        <p>where the v j 's are called symplectic eigenvalues and satisfy v j ≥ (2κ) -1 . When v j = (2κ) -1 for all j the state is pure. With the canonical choice κ = 1 this means that a pure state is defined by v j = 1/2 for all j, while with the choice κ = 1/2 a pure state has v j = 1 for all j. The dot operator ⊙ in Eq. (A6) has been introduced to make the notation uniform depending on the different grouping rules of Eqs. (A3) and (A4). When Eq. (A3) is employed the dot operator is defined as D ⊙ D := D ⊕ D = (v 1 , . . . , v n , v 1 , . . . , v n ), while when Eq. (A4) is employed the dot operator is defined as D ⊙ D := (v 1 , v 1 , . . . , v n , v n ). Although the Wigner function formalism is a popular approach for describing Gaussian quantum states [6], quantities normally appearing in quantum information theory can often be computed more straightforwardly using an algebraic approach [765]. Any multi-mode Gaussian state ρ(V, x) parameterized by the first-and secondmoments x and V can be written in the operator exponential form [765] (see also [766,767])</p>
        <p>where</p>
        <p>and the Gibbs matrix G is related to the CM V by</p>
        <p>(A9) The above relations are basis independent and allow the direct calculation of G from V without the need of the symplectic diagonalization (A6). This is a consequence of the "symplectic action" formalism that is discussed in the next section. From the operator exponential form, we then show how to compute quantities like the fidelity between Gaussian states, the von Neumann entropy, the quantum relative entropy and its variance.</p>
        <p>Given a function f : R → R we can extend f to map Hermitian operators to Hermitian operators in the following way: let M = U xU † be the spectral decomposition of a Hermitian operator M , then f (M ) := U f (x)U † where f (x) is a vector whose j-th element is f (x j ). For more general operators M that admit a decomposition M = U xU -1 , with a possibly non-unitary U , we define an operator function as f (M ) := U f (x)U -1 .</p>
        <p>The symplectic action was introduced in Ref. [774] to extend a function f to any operator with symplectic structure. More precisely, for a given matrix V with symplectic diagonalization as in Eq. (A6), the symplectic action f * on V is defined by</p>
        <p>where f (D) = diag[f (v 1 ), f (v 2 ), . . . , f (v n )] acts as a standard matrix function. In Ref. [765] it was proven that, for any odd function f (-x) = -f (x), the symplectic action can be explicitly written as</p>
        <p>where f (ViΩ) is a matrix function.</p>
        <p>Matrix functions are part of most numerical libraries and symbolic computer algebra systems, so their computation, either numerical or analytical, can be easily done on a computer. This is an advantage especially for symbolic calculations [33,765]. On the other hand, for a</p>
        <p>This work has been supported by the EPSRC via the 'UK Quantum Communications Hub' (EP/M013472/1) and the First Grant EP/P016588/1; the European Union via the project 'Continuous Variable Quantum Communications' (CiViQ, no 820466), the project UNIQORN (no 820474), and the H2020 Marie Sklodowska Curie Project 675662 (QCALL); the Danish National Research Foundation bigQ (DNRF142); the Czech Science Foundation (project No 19-23739S); the Czech Ministry of Education via the INTER-COST grant No LTC17086; the Air Force Office of Scientific Research program FA9550-16-1-0391 (supervised by Gernot Pomrenke) and the Office of Naval Research CONQUEST program. Authors are indebted to Marco Lucamarini for his help, comments and suggestions, and for providing the file for the rate of the TF-QKD protocol, plotted in Figs. 3 and11. A special thank also goes to Xiongfeng Ma, Pei Zeng, Xiang-Bing Wang, Zhen-Qiang Yin, and Federico Grasselli for having provided files and data points for the rates plotted in Fig. 11. Authors also thank Wolfgang Dür, Zeng-Bing Chen, Hua-Lei Yin, and Yichen Zhang for feedback.</p>
        <p>Appendix A: Formulas for Gaussian states Consider n bosonic modes described by the creation and annihilation operators â † j , âj with j = 1, . . . , n and define the quadrature operators as qj = (â j + â † j )/ √ 2κ, pj = -i(â jâ † j )/ √ 2κ, (A1)</p>
        <p>where the factor κ is introduced to consistently describe different notations used in the literature (see also Ref. [764]). The canonical choice is κ = 1 (vacuum noise equal to 1/2) where we recover the canonical commutation relations [q k , pj ] = iδ kj , while a popular alternative in quantum information is κ = 1/2 (vacuum noise equal to 1). For any general κ, the quadrature operator can be grouped into a vector x with 2n components that satisfies full symplectic diagonalization, the practical problem is not the computation of the symplectic spectrum but the derivation of the symplectic matrix S performing the diagonalization SVS T into the Williamson's form [6]. For this matrix S, we know closed formulas only for specific types of two-mode Gaussian states [768] which appear in problems of quantum sensing [601], such as quantum illumination [603] and quantum reading [604].</p>
        <p>The Gibbs exponential form (A7) can be proven by first noting that a single mode thermal state with diagonal CM V = v ⊙ v can be written as an operator exponential</p>
        <p>with g = 2 coth -1 (2κv) and extending the result to multimode, possibly non-thermal states, via the symplectic action. Indeed, since ρ ∝ e -gâ † â, we may write</p>
        <p>Following the same construction of Ref. [765], which was done for κ = 1, we get the final result of Eq. (A7).</p>
        <p>The fidelity F (ρ 1 , ρ 2 ) quantifies the degree of similarity between two quantum states ρ 1 and ρ 2 . It is a central tool is many areas of quantum information, especially for quantum state discrimination which is a fundamental process in any decoding process. For pure states, it is defined as</p>
        <p>A general closed-form for the fidelity between two arbitrary multi-mode Gaussian states was derived in Ref. [765], thus generalizing partial results known for single-mode states [770][771][772], two-mode states [773], pure [774] or thermal states [775].</p>
        <p>Given two arbitrary multi-mode states with CMs V i and first moments xi , the fidelity F can be written as [765]</p>
        <p>A15) where δ := x2 -x1 , while the term F tot only depends on V 1 and V 2 and is easily computable from the auxiliary matrix</p>
        <p>as</p>
        <p>(A17) The general solution (A15) has been derived thanks to the operator exponential form (A7) that makes straightforward the calculation of the operator square roots in the fidelity (A14). Indeed, using the Gibbs matrices G i of the two Gaussian states, it was found in [765] that</p>
        <p>where</p>
        <p>The final form (A15) is then obtained by expressing the above matrix functions in terms of CMs. Note that the asymmetry of V aux upon exchanging the two states is only apparent and comes from the apparent asymmetry in the definition of Eq. (A14). One can check that the eigenvalues of V aux Ω, and thus the determinant in Eqs. (A17), are invariant under such exchange.</p>
        <p>As already mentioned, an efficient computation of the quantum fidelity is crucial for solving problems of quantum state discrimination [91,92,601], where two multi-mode Gaussian states must be optimally distinguished. Consider N copies of two multimode Gaussian states, ρ ⊗N 1 and ρ ⊗N 2 , with the same a priori probability. The minimum error probability p err (N ) in their statistical discrimination is provided by the Helstrom bound [776], for which there is no closed form for Gaussian states. Nonetheless, we may write a fidelity-based bound [765,777] as</p>
        <p>(A20) The fidelity can be expressed [778] as a minimization over POVMs E x of the overlap between two classical probability distributions</p>
        <p>Calling Ẽx the optimal POVM that achieves the minimum of the above quantity, we see that the fidelity can be measured with a single POVM without state tomography. As such we may write</p>
        <p>where Ẽx is optimal for the bound, in the sense that any other POVM provides a larger upper bound. Recently [779], it has been shown that such optimal POVM can be explicitly computed between any two multi-mode Gaussian states. Indeed, it was found that the optimal POVM is formed by the eigenbasis of the operator [779] M</p>
        <p>where D is a displacement and v M = 0 when x1 = x2 , while the general case is provided in [779]. On the other hand, the matrix G M is given by e iΩGM = e -iΩG1/2 e iΩG1/2 e iΩG2 e iΩG1/2 e -iΩG1/2 . (A24) Based of this general multi-mode solution, it was found in [779] that, for single-mode Gaussian states, there are only three possible kinds of optimal measurements, depending on ρ 1 and ρ 2 : number-resolving detection, quadrature detection, or a projection onto the eigenbasis of operator q p + pq.</p>
        <p>Entropic quantities are widespread in quantum information theory, and are employed to bound the performances of QKD protocols, entanglement sharing and data compression, to name a few examples. Here we provide some simple formula for the von Neumann entropy of a Gaussian state and for the relative entropy between two arbitrary Gaussian states ρ 1 (x 1 , V 1 ) and ρ 2 (x 2 , V 2 ) directly in terms of their first moments xj and covariance matrices V j . The following results first appeared in [33], where the operator exponential form (A7) was employed to explicitly evaluate operator logarithms.</p>
        <p>Consider two arbitrary multimode Gaussian states, ρ 1 (x 1 , V 1 ) and ρ 2 (x 2 , V 2 ). Then, the entropic functional</p>
        <p>where δ := x2 -x1 and G j are the Gibbs matrices, obtained from the covariance matrices V j from Eq. (A9).</p>
        <p>From the above entropic functional, we may compute both the von Neumann entropy and the quantum relative entropy. Indeed, from (A26), the von Neumann entropy of a Gaussian state ρ(x, V) is equal to</p>
        <p>The functional Σ(V, V, 0) is a symplectic invariant, namely Σ(SVS T , SVS T , 0) = Σ(V, V, 0). As such, from the Williamson decomposition (A6) we find that S(ρ)</p>
        <p>only depends on the symplectic eigenvalues v j of V, that can be written as</p>
        <p>where nj are the mean number of photons in each mode. The von Neumann entropy of an m-mode Gaussian state can then be expressed as [766] S(ρ)</p>
        <p>where h(x) := (x + 1) log 2 (x + 1)x log 2 x.</p>
        <p>The entropic functional of Eq. (A25) also provides a tool for writing the relative entropy between two arbitrary Gaussian states ρ 1 (x 1 , V 1 ) and ρ 2 (x 2 , V 2 ), in terms of their statistical moments. Indeed, we may write [33] S(ρ</p>
        <p>It is worth mentioning that the final result Eq. ( A30) is expressed directly in terms of the statistical moments of the two Gaussian states. There is no need of resorting to full symplectic diagonalizations (A6) as in previous formulations [780,781]. This is an advantage because, while the computation of the symplectic spectrum needed for the von Neumann entropy is easy to get, the symplectic matrix S performing such a symplectic diagonalization is known only in a few cases as for specific types of twomode Gaussian states [768]. On the other hand, the invariant matrix formulation shown Eq. (A30) allows one to bypass such complicate diagonalization and directly compute the quantum relative entropy. Finally, we consider the quantum relative entropy variance V S (ρ 1 ρ 2 ) = Tr ρ 1 (log 2 ρ 1log 2 ρ 2 -S(ρ 1 ρ 2 ))</p>
        <p>2 .</p>
        <p>(A31) The relative entropy variance was introduced in Ref. [782,783] to bound the capacity of quantum channels and quantum hypothesis testing. Using the operator exponential form (A7) and the definitions (A9), one can show that, for any two Gaussian states ρ 1 and ρ 2 , the variance V S (ρ 1 ρ 2 ) can be written in terms of the states' first and second moments as</p>
        <p>The above formula was first derived in Ref. [784] for κ = 1. It was then easily generalized to arbitrary κ in Ref. [611], where an alternative simplified proof was presented by exploiting a trace formula from Ref. [785].</p>
    </text>
</tei>
