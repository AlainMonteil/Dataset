<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.0" ident="GROBID" when="2024-05-09T13:41+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>HAL is a multi-disciplinary open access archive for the deposit and dissemination of scientific research documents, whether they are published or not. The documents may come from teaching and research institutions in France or abroad, or from public or private research centers. L'archive ouverte pluridisciplinaire HAL, est destinée au dépôt et à la diffusion de documents scientifiques de niveau recherche, publiés ou non, émanant des établissements d'enseignement et de recherche français ou étrangers, des laboratoires publics ou privés.HAL is a multi-disciplinary open access archive for the deposit and dissemination of scientific research documents, whether they are published or not. The documents may come from teaching and research institutions in France or abroad, or from public or private research centers. L'archive ouverte pluridisciplinaire HAL, est destinée au dépôt et à la diffusion de documents scientifiques de niveau recherche, publiés ou non, émanant des établissements d'enseignement et de recherche français ou étrangers, des laboratoires publics ou privés.</p>
        <p>solution 8 , self assembly 9,10 , interfacial properties of small particles [11][12][13][14] , droplets in liquids 15,16 , biological membranes [17][18][19][20][21] or structuration of materials [22][23][24] . Numerous models [25][26][27][28][29][30] have been developed to interpret experimental data and in particular angular distribution and polarization dependence of the second harmonic scattered light. The understanding of such variation allows the recovery of important properties about the symmetry 31 , the organization 9 and/or the correlation [5][6][7] of the nano-objects probed. Some of these models have also been implemented in software to compute the SHS intensity, in particular in the 
            <rs type="software">NLS_simulate</rs> software 32,33 or 
            <rs type="software">HRS_Computing</rs> software 34 . The 
            <rs type="software">NLS_simulate</rs> software computes the SHS angular dependence using the Nonlinear Rayleigh Gans Debye approximation 33,35 . Those simulations are limited to spherical objects. In the 
            <rs type="software">HRS_computing</rs> software, the program computes the polarization resolved SHS intensity for any supramolecular structure build as a sum of correlated individual molecules. This second software is restricted to the assumption that the correlation length is small in regards to the incident wavelength.
        </p>
        <p>In this article, a new free python based program named 
            <rs type="software">PySHS</rs> 36 is presented. First, it integrates in the same package the two kind of calculation discussed above: both angular and polarization dependance SHS. Moreover, it generalizes the computational possibility to any system dimensions as no assumption about the size of the nano-object is required thank to the calculation strategy. Indeed, 
            <rs type="software">PySHS</rs> has been developed in order to compute SHS of different class of nano-objects: i) uncorrelated molecules in solution in the HRS module, ii) supramolecular assemblies in the SHS module, iii) Second Harmonic Light scattered by the surface of colloidal spheres in the SPHERE module. All the calculations can be done in different experimental configurations: polarization resolved at a fixed scattered angle or angular distribution for different polarization configurations. This article presents the equation implemented in the 
            <rs type="software">PySHS</rs> software, and gives some computational examples useful to interpret experimental data concerning the assembly of molecular dye intercalated inside liposomes.
        </p>
        <p>2) The 
            <rs type="software">PySHS</rs> program
        </p>
        <p>This first part will review the different calculation implemented in the SHS module and sphere module of the 
            <rs type="software">PySHS package</rs> and the notation used are described in Figure 1.
        </p>
        <p>The fundamental light at the frequency is defined by its wave vector and its polarization direction . The input polarization angle is equal to the angle between ( ). The second harmonic scattered light at the 2 frequency is defined by its wave vector and the angle ( ) defines the scattered angle The polarization of the second harmonic scattered light is defined by and the output polarization angle is equal to the angle between ( ). For simplicity, we referred as V out polarization state and as H out polarization state. In the laboratory frame, we have the following relations:The fundamental light at the frequency is defined by its wave vector and its polarization direction . The input polarization angle is equal to the angle between ( ). The second harmonic scattered light at the 2 frequency is defined by its wave vector and the angle ( ) defines the scattered angle The polarization of the second harmonic scattered light is defined by and the output polarization angle is equal to the angle between ( ). For simplicity, we referred as V out polarization state and as H out polarization state. In the laboratory frame, we have the following relations:</p>
        <p>(1-a,b,c)(1-a,b,c)</p>
        <p>The scattered wave vector is defined as follow:The scattered wave vector is defined as follow:</p>
        <p>2.2) Calculation for N fully correlated molecules in a supramolecular assembly: SHS module2.2) Calculation for N fully correlated molecules in a supramolecular assembly: SHS module</p>
        <p>The Second Harmonic Scattering of N fully correlated molecules in solution can be expressed asThe Second Harmonic Scattering of N fully correlated molecules in solution can be expressed as</p>
        <p>with the vector defined as:with the vector defined as:</p>
        <p>This vector is determined by the total hyperpolarizability tensor of the N molecules assembly expressed in the laboratory frame which can be itself be expressed in a mesoscopic frame as depicted in Figure 2.This vector is determined by the total hyperpolarizability tensor of the N molecules assembly expressed in the laboratory frame which can be itself be expressed in a mesoscopic frame as depicted in Figure 2.</p>
        <p>((</p>
        <p>Here is the second order hyperpolarisability of the molecule j located at the position expressed in the mesoscopic frame. The hyperpolarisability tensor components in the different frames are linked according:Here is the second order hyperpolarisability of the molecule j located at the position expressed in the mesoscopic frame. The hyperpolarisability tensor components in the different frames are linked according:</p>
        <p>The transformation matrix is:The transformation matrix is:</p>
        <p>Finally, the bracket in formula (3) means the average over all the orientation of the scattered molecule and is implemented by a numerical integration in the 
            <rs type="software">PySHS</rs> program.
        </p>
        <p>((</p>
        <p>To perform the I SHS calculation, the user needs to specify the position and orientation ( of each molecule in the mesoscopic frame. Two ways are implemented to perform the I SHS calculation: the first way implemented in the SHS program of 
            <rs type="software">PySHS package</rs> explicitly computes I SHS according to equations (3-9). The second way implemented in the 
            <rs type="software">SHSlinear</rs> program, uses the approach detailed in these references 6,23,31 and in the 
            <rs type="software">HRS_Computing</rs> software 34 , approximates the exponential term in equation ( 5) by: (10) This last calculation is only valid in the domain where is small compared to 1, ie if the characteristic size of the molecular assembly is small compared to the incident wavelength.
        </p>
        <p>Taking the molecular hyperpolarizability, the position and orientation of each molecule in the supramolecular assembly as input parameters, the SHS and SHSlinear programs can compute the polarization resolved plot or the scattered angle plot. For the polarization plot, the outputs of the program are the coefficients , , and , defined in this reference 31 . Indeed, the SHS intensity exhibits the equivalent following dependencies with the input polarization angle :Taking the molecular hyperpolarizability, the position and orientation of each molecule in the supramolecular assembly as input parameters, the SHS and SHSlinear programs can compute the polarization resolved plot or the scattered angle plot. For the polarization plot, the outputs of the program are the coefficients , , and , defined in this reference 31 . Indeed, the SHS intensity exhibits the equivalent following dependencies with the input polarization angle :</p>
        <p>The link between these two descriptions are given by:The link between these two descriptions are given by:</p>
        <p>The full expression of the , , coefficients are given in SI. For an angular dependency study, the output of the program is the dependency for different combination of polarization state ( ): ( °); (9 °); ( °); (9 °).The full expression of the , , coefficients are given in SI. For an angular dependency study, the output of the program is the dependency for different combination of polarization state ( ): ( °); (9 °); ( °); (9 °).</p>
        <p>
            <rs type="software">PySHS</rs> package offers the possibility to compute the SHS intensity of homogeneous spheres in solution. To perform this calculation, an effective nonlinear susceptibility 25 is introduced, which represents the nonlinear response of the entire sphere surface: (16) where is the surface second order nonlinear susceptibility of the sphere. Using the same formalism as above, The SHS intensity is expressed with the same equation (3) where is now expressed as:
        </p>
        <p>The 
            <rs type="software">SPHERE</rs> program in the 
            <rs type="software">PySHS</rs> package takes the surface second order nonlinear susceptibility and the radius of the sphere as input parameters and computes the same quantities as define above in equations (11-14) 3) Results and discussion section Some results illustrating the possibilities given by the 
            <rs type="software">PySHS package</rs> are presented and compared with experimental data. This part focuses on the SHS polarization plot in the right angle direction for spherical supramolecular assemblies in order to interpret experimental results concerning the organization of molecular dyes inclusion into the membrane of liposomes. The Figure 3 shows the polarization plot computed with the 
            <rs type="software">programs</rs> implemented in 
            <rs type="software">PySHS</rs> package a 50 nm radius sphere. An file containing the position and orientation of 100 molecules equally spaced onto the sphere surface and radially oriented was generated by the 
            <rs type="software">script</rs> provided in the package. The other input parameters of the calculations are the refractive index set to 1.33, the incident wavelength set to 800 nm and the hyperpolarizability of the molecule which is assumed to have only the component to be no zero. The simulations b) and c) give exactly the same results at the 3rd digit after the decimal point although the two approaches are not the same. It just shows that 100 dipoles equally spaced onto a sphere is equivalent to an homogenous sphere. We have also tested the case of few dipoles spaced onto a sphere, and we found the same results as given in this previous work 31 concerning the evolution of I 2 and I 4 parameters with the number of dipoles onto the sphere. When this number N is superior to 10, these quantities reach the asymptote of the homogeneous sphere given by the sphere program. To reproduce the experimental data presented in Figure 4, a microscopic model taking into account both the effect of the order/disorder of the assembly onto the colloidal object and the shape of the colloidal object is implemented. Some 
            <rs type="software">scripts</rs> provided in the 
            <rs type="software">PySHS</rs> package generates randomly the position and orientation of the molecules with a normal distribution characterized by its standard deviation  around the radial direction, for spheroid objects characterized by radius a and c. These different configurations are used as a PySHS input and the computed polarization plot, ie both the Hout and Vout polar plots are compared with the experimental data concerning dye organization onto liposome membrane. The molecular dye, is the trans-4-[4-(Dibutylamino)styryl]-1-methylpyridinium iodide simply referred as DIA-4 in the following. This dye has been brought together with a solution of 55 +/-5 nm radius DOPG liposomes in PBS buffer and the SHS polarization plots are presented in Figure 4. All the experimental details concerning the sample preparation are given in SI. The SHS experimental setup has been described elsewhere 2,37 , and the experimental data has been treated as follow: the incoherent contribution of the liposomes solution, i.e. the HRS contribution has been removed, so that the experimental point can be directly compared with the computational model. The best fit is obtained for a spheroid arrangement characterized with radius a=70 nm and c=50 nm and with a disorder characterized by standard deviation =12°.
        </p>
        <p>Other simulations with different disorders and shapes are given in SI. usefulness of its package, the polarization plot for different supramolecular organizations onto a sphere or spheroid object are presented in this publication. Especially, the numerical results are compared with experimental results concerning dye inclusion inside liposome bilayer. This comparison shows that both the disorder parameter and the deviation from the spherical geometry have to be taken into account to explain the experimental data. We hope that this work will stimulate the SHS community, will encourage the reader to try 
            <rs type="software">PySHS</rs> package, and help the experimenter to interpret their SHS results. ASSOCIATED CONTENT Supporting Information. Additional information are given about the full expression of the coefficients, about the comparison of the 
            <rs type="software">PySHS</rs> computation versus other softwares, about additional 
            <rs type="software">PySHS</rs> output simulation and about the sample preparation of the dye inclusion inside the liposome membrane. The following files are available free of charge.
        </p>
        <p>The authors declare no competing financial interest. The 
            <rs type="software">PySHS</rs> package is available here: 
            <rs type="url">https://www.researchgate.net/profile/Pierre-Marie_Gassin/publication/342742567_PySHS_V11_A_Python_Open_Source_Software_For_Se</rs> cond_Harmonic_Scattering/data/5f72fe6d458515b7cf565a6d/
            <rs type="software">PySHS</rs>-V1-1.zip Funding Sources.
        </p>
    </text>
</tei>
