<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T12:20+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>This paper presents a grid-forming control (GFC) scheme for two-stage photovoltaic (PV) systems that maintains power reserves by operating below the maximum power point (MPP). The PV plant in GFC mode behaves like a voltage source that supports the grid during disturbances in full or limited gridforming mode as per the reserve availability. This is a model-free method that avoids the estimation of MPP power in real-time commonly done in the literature, which makes it simpler and more reliable. The proposed control also features an enhanced current limitation scheme that guarantees containment of the current overshoots during faults, which is not trivial in voltage-sourced GFC inverters. A thorough investigation is done, exploring various generation mixtures of synchronous machines (SM), GFC and grid-following (GFL) inverters, and all common disturbances, e.g., load change, faults and irradiance transients. The results show very favorable dynamic performance by the GFC inverters, far superior to GFL inverters and directly comparable to SMs. It is found that replacing SMs with GFC inverters may improve the frequency profile and terminal voltage during disturbances, despite losing out in the mechanical inertia and the strict inverter overcurrent limits.</p>
        <p>and synchronous machines (SMs) in terms of frequency stability [12]- [13] and short-term voltage stability [14]. In addition, GFC is necessary for islanded operation and black start services, functions that will be critical in a high-IBR future power system [8]. GFC is the only way for a power system with 100% IBRs and a promising method for high-RESs penetration [10]- [11].</p>
        <p>Although GFC has been used for years in standalone systems, such as isolated microgrids and uninterruptible power supply (UPS) [15], its scope has been extended recently to the entire power system [16]. There are a few variants of GFC implementation depending on how the reference voltage is generated [12], [16], such as droop control [12]- [17], virtual synchronous machine (VSM) control [13], [17][18], matching control [13], [17], [19], and virtual oscillator based control (VOC) [13], [20]. All these alternatives can be tuned for a similar steady-state response, but they differ during transient conditions as per their characteristics [13], [8]. Out of these, droop control is the most mature and widely used [8].</p>
        <p>The majority of studies in the literature on GFC assumes an ideal source or battery on the input side [12]- [20]. However, the primary source of RESs, such as PV plants, is stochastic and non-dispatchable and should not be treated as such. There are mainly two methods of providing ancillary services from PV plants: either by hybridizing with energy storage, or by maintaining reserves with a curtailed operation (below the maximum power point (MPP)) ( [2], [8], [21]- [25], [26]). The former option provides maximum flexibility (e.g., nigh-time operation), but comes with additional installation and maintenance costs. The curtailed (or deloaded or power reserves or power headroom) operation under-utilizes the installed PV capacity and is only available during the day-time, but it is simpler and does not involve additional equipment and costs ( [2], [26]). With the increasing share of renewable sources into the grid, there is a growing consensus for utilization of large-size utility-scale PV plants to provide grid reliability services in the grid-forming mode without using energy storage ( [8], [21]- [25]). This is the focus of this paper.</p>
        <p>A big challenge in this approach is monitoring the maximum power during curtailed operation as it changes with time. Estimation-based approaches for the PV grid-forming operation has been explored in [21]- [25] to monitor the MPP at deloaded conditions. In [21], a curtailed PV generator is used as an input source assuming real-time MPP estimation, but no detailed model is given. [22]- [25] focus on maintaining the power reserves and not on grid support during disturbances. [21], [22], [24] have tested the GFC strategy only for load change disturbance, while [25] for voltage sags; none of them have tested the control performance for all types of common disturbances such as load change, irradiance change, and especially network faults.</p>
        <p>Furthermore, real-time MPP estimation adopted in all aforementioned studies comes with many challenges, such as parameter uncertainty, estimation accuracy, poor performance during a sudden change in irradiance, etc., [27]- [28]. For example, abrupt changes in irradiance may occur due to cloud movement, with recorded transients of up to 150-200 Wm -2 s -1 in some cases [26], [29]. For this reason, the GFC proposed in this paper is model-free and does not employ any MPP estimation.</p>
        <p>Furthermore, all available GFC studies for PV plants assume single-stage systems, i.e., there is only a single DC/AC conversion stage [22]- [25]. However, two-stage PV systems comprising both a DC-DC converter and an inverter are increasingly more common in the network. They are also better candidates for GFC due to a wider operational range from nearzero to 100% of the available PV power [30]; this contrasts with the single-stage systems that struggle to operate at very low power outputs due to DC link voltage limitations. This paper aims to cover this gap by proposing a GFC control scheme designed for two-stage PV systems that is missing from the literature.</p>
        <p>Another important consideration in GFC is the limited overcurrent capacity of power converters, which, if exceeded during transients, may result in catastrophic failure of the power switches. Adhering to this limitation is particularly challenging in GFC, due to the voltage-source nature of the converter as opposed to the current-source-behaved GFL. Available current limitation methods in the literature involve either virtual impedance schemes or reference current saturation [31]- [33]. The former approach emulates the effect of a virtual impedance connected at the output of the inverter, whose value is adjusted during overloads to contain the current overshoots. This method, however, may struggle to limit the current during the first few cycles and may result in oscillatory behavior [32], [33]. In the reference current saturation scheme, the voltage controllers' output, i.e., the reference current, is saturated to contain the overcurrent, usually employing an anti-wind-up mechanism. A relevant implementation is studied in the MIGRATE project [31], concluding that during the saturation the controller input remains unregulated and some initial current overshoots are still apparent [31], [32]. In MIGRATE, a hybrid combination of the two aforementioned approaches is proposed [31], which however seems too complex to parametrize and tune in large systems. This paper presents a modified reference current saturation strategy that successfully contains the initial overcurrent and guarantees a non-oscillatory response. Highlights of the proposed technique are an antiwind-up scheme that accounts for the feedforward signals, rate limiters at the controller's outputs and adjustable saturation bounds.</p>
        <p>This paper proposes, for the first time, a model-free GFC strategy with a current limitation mechanism for two-stage PV systems with power reserves. The key contribution points of this research are:</p>
        <p>• A model-free method that does not need to estimate the MPP, in contrast to the available literature • Designed for two-stage PV systems without energy storage for the first time • Utilizing the limited reserves optimally by operating in two modes: full and limited grid-forming • A new current limitation scheme based on a modified reference current saturation that contains overshoots</p>
        <p>• Validating the new control at all common major disturbances (load, irradiance, faults), usually missing from relevant studies • Validation at various generation mixtures of machines, GFC and GFL inverters at the WSCC 9-bus testbench. The remainder of the paper is organized as follows. In Section II, the proposed control scheme is described in detail. Section III covers the controller tuning method, Section IV focuses on modeling details of the simulated system, followed by the results in 
            <rs type="software">MATLAB</rs>/
            <rs type="software">Simulink</rs> in Section V. Section VI concludes the paper.
        </p>
        <p>The GFC inverter acts as a controllable voltage source in the network, whose power output is determined by the loading conditions in the grid, rather than the primary source availability like in GFL inverters. This entails that during disturbances, GFC resources will remain strongly coupled to the grid and inherently supply the required active and reactive power. This contrasts with GFL inverters that need to sense the disturbance and employ additional dedicated control loops for grid support, such as frequency response or dynamic voltage support.</p>
        <p>The overall GFC scheme for a two-stage grid-connected PV system is shown in Fig. 1. Fig. 1(a) depicts the system topology. Fig. 1(b) shows the DC-DC Converter Control and the outer inverter control loop (Grid Forming Strategy block) that generates the reference voltage and frequency to be tracked by the inner inverter loops in Fig. 1 (c). Fig. 1(c) involves the voltage control loop featuring a current limitation mechanism and the inner current control loop that produces the inverter modulation signals fed into a PWM generator.</p>
        <p>In the conventional GFL mode, the DC-DC converter determines the extracted power from the PV array, and the inverter follows by transferring that power to the grid. However, in GFC, these roles are reversed: the inverter adjusts its output autonomously based on the grid conditions, while the DC-DC converter follows by matching that power demand.</p>
        <p>It is worth noting that a PLL is not required during the normal operation of a grid-forming inverter. It may be used, however, temporarily for synchronization purposes when the system is first connected to the grid [34]- [35], [8], deactivated thereafter during normal operation.</p>
        <p>The proposed GFC strategy has two modes of operation: full grid-forming (GF) when the inverter output is within the capacity of the PV array and limited grid-forming (LGF) when it exceeds the maximum available PV power. In GF mode, the inverter feeds in power based on a droop equation, and the DC-DC converter regulates the dc-link; in LGF mode, the inverter performs the dc-link regulation instead, while the DC-DC converter reverts to maximum power point tracking (MPPT) operation.</p>
        <p>Fig. 2 illustrates the complete control diagram, some parts being active only in one of the two modes. Fig. 2(a) shows a simple closed-loop voltage control that regulates the terminal voltage 𝑣 = √𝑣 𝑑 2 + 𝑣 𝑑 2 to the reference Vt * and determines the inverter reference voltage V * . Fig. 2(b) depicts the powerfrequency (p-f) droop scheme that generates the inverter frequency ω and angle θ based on a modified droop equation:</p>
        <p>where ω0 is the nominal frequency, dω the droop coefficient, p * the power setpoint and pLPF the low-pass filtered measurement of the output power p (ωc is the cutoff frequency). Δω is a frequency adjustment produced by a PI controller that regulates the dc-link voltage Vdc to its reference Vdc ref and is active only in LGF mode. The purpose of this additional loop is to bring the power output back within the PV capacity in LGF mode. The DC-DC converter control shown in Fig. 2(c) comprises two branches, only one being active at a time, depending on the mode. In normal GF mode, a PI controller regulates the dc-link voltage; in LGF mode, an MPPT algorithm is executed instead to extract the maximum available power from the PV array.</p>
        <p>To allow for both up-and down-regulation of its power output depending on the disturbance, the PV system operates in a deloaded manner (i.e., curtails power, keeps power reserves, maintains a power headroom, dispatchable operation), as shown in Fig. 3(a). The power setpoint and reserve power will be decided by the power system operator according to the forecasts-based scheduling and encouraging market mechanism for grid support from renewable sources. The power setpoint is an input coming from the system operator in the proposed control scheme. For any setpoint p * below the MPP, there are two possible operating points on either side of the P-V curve.</p>
        <p>Here the operating point is kept in the right-hand side of the MPP, which allows operation at the entire power range (0-100% of the MPP power) and results in higher PV voltage and DC-side efficiency [30].</p>
        <p>Given a disturbance, e.g., a load decrement, the output power drawn from the inverter will lower, thus mobilizing the droop control (Fig. 2(b)) to adjust the frequency ω according to the characteristic of Fig. 3(b), and the DC-DC converter control (upper branch in Fig. 2(c)) to shift the operating point towards the right (blue arrow in Fig. 3(a)). If the load increases, the controller responds in the opposite direction, shifting the operating point to the left (black arrow in Fig. 3(a)).</p>
        <p>If the disturbance is too large, it may be possible that the operating point overtakes the MPP and lands on the left-hand side of the curve. If no action is taken, the DC-DC converter will drive the operating point further to the left by increasing the duty ratio trying to meet the power target, which will lead to instability. For this reason, the control is switched to LGF mode once the operating point overtakes the MPP.</p>
        <p>In LGF mode, the DC-DC converter switches to MPPT operation (lower branch in Fig. 2(c)), and the frequency adjustment branch in the droop scheme is activated (lower branch in Fig. 2(b)). By reducing the frequency ω, the inverter output is brought back within capacity, i.e., at maximum power minus losses. During this mode, the inverter can still support down-regulation of the output but not up-regulation, and thus it is denoted as limited grid-forming.</p>
        <p>It is worth highlighting that with this approach, a conventional model-free MPP tracking algorithm is employed (Perturb and Observe algorithm), which is simple and agnostic of the system structure and parameters [36]. This is in contrast to existing alternatives that adopt real-time MPP estimation methods [24], [26], [30] that are based on mathematical models and are prone to accuracy and convergence issues.</p>
        <p>The mode transition from GF to LGF and vice versa is illustrated in the flowchart of Fig. 4(a), explained below in detail using the examples in Fig. 4(b).</p>
        <p>Under normal conditions in GF mode, the setpoint p * in Fig. 4(b) is met by the system, Δω in Fig. 2(b) is zero, and the dclink is regulated by the DC-DC converter. If a disturbance causes a power deficit (e.g., load increase, generation outage, or irradiance drop), the dc-link voltage will start dropping, mobilising the DC-DC converter to increase the duty cycle and shift the operating point to the left (Phase 1 in Fig 4(b)). As long as the new equilibrium lies in the right-hand-side of the MPP, operation continues in GF mode as normal.</p>
        <p>However, if the disturbance is so large that the power balance cannot be met, the linear action of the controller will drive the operating point to the left side, overtaking the MPP (Phase 2). This will further increase the power gap, moving to lower voltages and risking instability if the mode is not changed to LGF. The inability to meet the power balance is reflected in the dc-link voltage, which keeps falling; when it falls below a threshold Vdcmin, the flowchart of Fig. 4(a) changes the mode to LGF, thus reverting to MPPT operation in the DC-DC converter (Phase 3) and activating the frequency adjustment branch in the inverter control to limit the inverter power injection.</p>
        <p>While being in LGF mode, the dc-link is managed by the inverter by means of the frequency adjustment Δω and the DC-DC converter tracks the MPP (Phase 4). If the drawn power from the inverter gets back within PV capacity (e.g., disturbance ends), the power surplus in the dc-link will result in increasing Δω (negative value) till it gets zero. When this happens, the system is again fully capable of supporting the grid, and the mode is changed back to GF (flowchart in Fig. 4(a)). This way, the DC-DC converter undertakes the dc-link regulation once again, shifting the operating point to the righthand side (Phase 5), and everything returns to normal GF operation.</p>
        <p>The details of the voltage control with current limitation (see Fig. 1) are given in Fig. 5. It comprises two PI controllers that regulate the inverter voltages vq and vd to their reference values vq * and vd * by adjusting the active and reactive reference currents iq * and id * . They also involve the standard feedforward signals: grid currents igq and igd, and the capacitor currents of the grid-side filter ωCfvd and ωCfvq.</p>
        <p>To avoid current overshoots during transients, the controllers' outputs are saturated within [0, Iq,lim] for the active and [-k1In, k1In] for the reactive current. For these limits, it is assumed that the inverter can withstand a transient current of up to k times the rated value In (e.g., k=1.414); this margin is deployed primarily for reactive current (reactive current priority) up to k1 times the nominal In (e.g., k1=1.2), and what + -</p>
        <p>( )</p>
        <p>Fig. 5. The proposed current limitation scheme. remains determines the active current limit iq,lim (lower branch of Fig. 5). In addition, two rate limiters at id * and Iq,lim do not allow very high changes and contribute to minimizing the initial current overshoot and damping any oscillations. This scheme mitigates the main weakness of the reference current saturation scheme examined in MIGRATE project [31], i.e., initial peak current exceeding the limit at the onset of the fault. By applying adjustable saturation limits for the real and reactive current and rate limiters to damp very fast changes, the proposed scheme manages to contain the initial overshoot more effectively and avoid any undesirable oscillations.</p>
        <p>In addition, an enhanced anti-wind-up scheme takes into full consideration the feedforward paths of the controllers to ensure smooth return to normal operation when the disturbance ends. In Fig. 5, the anti-windup method conditionally prevents error accumulation in the integrators. This is managed by the switches SW1 and SW2 that effectively freeze the integrators by feeding them a zero signal during the saturation. This happens when the input and output of the saturation blocks differ (|𝑖 𝑞 that indicates saturation and undesirable error accumulation. This clamping anti-windup method is referred to as conditional integration in the literature, as it prevents error accumulation in one particular direction. The proposed current limitation scheme contains the overshoot reliably and autonomously, without additional functions like fault detection or control switching seen in the literature, which simplifies tuning and implementation.</p>
        <p>This section briefly discusses the tuning and stability aspects of the controllers involved in the proposed scheme. The inner inverter control loops, i.e. voltage control loop and current control loop, and the terminal voltage control are well studied in the literature [40]. Furthermore, frequency adjustment controllers similar to the one proposed in Fig. 2(b) are available in the literature [21]- [25]. Therefore, in this section we focus only on the newly introduced PI controller of the Boost converter (Fig. 2(c)). The tuned parameters of all controllers are given in the appendix. The Boost converter control scheme of Fig. 2(c) employs the same PI controller for both full GF and LGF operation. Therefore, the controller should be tuned for both modes: the PI gains are first tuned for the LGF mode and then it is shown to have favorable operation in the GF mode as well.</p>
        <p>In LGF mode, the boost converter operates in MPPT and the DC link is regulated by the inverter. The equivalent circuit of Fig. 6 treats the PV generator as current source linearized around the operating point and the DC link as a constant voltage source [41]. The state-space model is given by ( 2) and (3) [41]:</p>
        <p>( )</p>
        <p> Here, 𝑖L represents the incremental inductor current, 𝑣 ̂pv the incremental PV voltage, 𝑑 ̂ the incremental duty ratio, L and rL the inductance and resistance of the inductor, Cpv the PV array capacitor, rpv the equivalent linearized PV array resistance, VD the forward diode voltage, and Vdc the nominal DC-link voltage. The PV array is modeled as a voltage-dependent current source through the PV array voltage vpv and the resistance rpv. The equivalent resistance rpv, i.e., the slope of voltage-current characteristic, changes with the PV operating point and irradiance and temperature conditions [41].</p>
        <p>The PI controller gains tuned using Bode plots [41] yield Kp = 0.1 and Ki = 2 values and result in infinite gain margin and phase margin of 99 o at STC. Fig. 7 illustrates the closed-loop poles for varying irradiance and temperature, proving that the system remains stable at all operating conditions.</p>
        <p>1949-3029 (c) 2021 IEEE. Personal use is permitted, but republication/redistribution requires IEEE permission. See http://www.ieee.org/publications_standards/publications/rights/index.html for more information. In GF mode, the Boost converter regulates the DC link while the inverter transfers power independently. Extending the previous approach, the equivalent model of Fig. 8 treats now the inverter as a current source modeled through the DC-link voltage vdc and resistance rdc. The resistance rdc changes with the operating point, i.e., the power injected by the inverter. The following state-space model involves now an additional state, i.e. the incremental DC-link voltage 𝑣 ̂dc, and the DC-link capacitance Cdc.</p>
        <p>( )</p>
        <p>The previously selected PI controller parameters yield a gain margin of 50 dB and a phase margin of 57 o at STC and 30% reserves in GF mode. Fig. 9 depicts the closed-loop system poles at various reserve levels, indicating stability at all conditions. This investigation confirms that the selected controller gains are suitable at all conditions for both GF and LGF operating modes.</p>
        <p>The WSCC 9-bus testbench [37]- [38] is considered in this paper to validate the proposed control scheme for different generation mixtures. First, the original version with SMs as generators is used as a benchmark (All SM case). Then, a PV plant employing the proposed GFC strategy replaces the generator at bus 3, as shown in Fig. 10 (SM GFC case); this refers to a near-future scenario where SMs still dominate the power system, and the PV plant has to coordinate with the slow- acting machines to avoid overloading, thus limiting its full potential. Thirdly, all generators are replaced by GFC inverters (All GFC case), with a PV array as input at bus 3 and ideal sources elsewhere; this represents a future inverter-dominated power system, where fast-acting inverters can deploy their full potential. Furthermore, to assess and compare the performance of grid-following sources, the SM GFC and All GFC cases are then modified to replace some generators with inverters running in GFL mode with grid-support capability. The respective SM GFL and GFC GFL cases are examined to explore the limitations of today's grid-following approach for IBRs. The system dynamics are examined in these cases at various disturbances, namely, load change, irradiance transient, and line fault, as shown in Fig. 10.</p>
        <p>The simulations are carried out in electromagnetic transient (EMT) mode in 
            <rs type="software">MATLAB</rs>/
            <rs type="software">Simulink</rs>. The detailed seventh order model of the SM is used, employing IEEE type DC1A exciter and voltage regulator with a two lead-lag stage power system stabilizer (PSS). Usually, the droop coefficient in SMs varies between 2% and 5%; here, the minimum value of 2% with the standard TGOV1 governor model is considered. The inverter droop coefficient can be much lower, here assumed at 1%. The transmission lines are modeled by the distributed parameter model and loads by constant impedances. The parameters of the test system are taken from [37]- [38].
        </p>
        <p>The PV plant of 105 MW nominal capacity is scheduled at 75 MW prior to the disturbance, keeping 30 MW of reserves. An aggregate model for the PV plant is used here to reduce the computational burden, as commonly done in system-level studies. The PV park is represented by a structure-preserving aggregate model of the VSC [39], extended to the DC-DC converter as well. A 25 kVA unit that includes a DC-DC converter and an inverter is used as building block to connect several such units in parallel for the required plant size. The AC output voltage across the filter capacitor is 400 V and the nominal DC-link capacitor voltage is 750 V. The inverter output voltage is stepped up to 11 kV and further to 230 kV using the step-up transformers. It is worth noting that the proposed control strategy works perfectly fine with other converter sizes and voltage levels, as long as it is a two-stage system. The simulations are based on the average-value converter models, as commonly done in dynamic simulations of power system studies. The parameters of the PV system are given in the appendix.</p>
        <p>In this scenario, it is examined how the PV GFC system can support the grid during load changes and faults, as well as what the impact of the varying PV generation on the system is.</p>
        <p>A load of 47.25 MW (15% of total system load) is switched ON at t = 1 s and switched off at t = 11 s at bus 6 as shown in Fig. 10. The system dynamics are given in Fig. 11. The PV GFC (yellow lines) exhibits a similar response to that of the SMs, except that it shares a larger portion of the load due to lower droop settings. Furthermore, the near-zero time-constants of PV GFC entail faster response and power injection to the disturbance compared to the SMs, which results in more rapid drop of the PV GFC frequency f3 in Fig. 11 at the first few cycles. Still, as the system remains in synchronism, the power imbalance is met quickly this way and the nadir of the common frequency in the network is higher than what it would be with All SM.</p>
        <p>The performance of the proposed control strategy is given in Fig. 12. The additional power drawn from the inverter results in PV power increase by deploying the maintained reserves up to the MPP. Still, this is not enough, with the operating point overtaking the MPP and the dc-link voltage dropping till the threshold 720 V (Vdc plot in Fig. 12) that triggers switching to LGF mode (see annotations in Fig. 12). In LGF mode, the Δω frequency adjustment contains the inverter output power while extracting maximum power from the PV array (Delta-w and Ppv plot in Fig. 12), which allows the dc-link voltage to return back to normal. Since this is a transient overload condition and the steady-state inverter output is within the PV capacity, Δω is gradually zeroed, and the mode switches back to GF at about t = 3.6 s ( Fig 12). When the load is switched OFF at t = 11 sec, the control works smoothly in opposite direction as well: the inverter reduces its output and brings the operating point back at the initial levels.</p>
        <p>It is worth noting that with this approach, the power imbalance and mode change is perceived by the voltage drop in the DC link. This inevitably entails a short delay the response in the order of milliseconds and requires a sufficient voltage range for this sag (here 30 V). Still, these values are perfectly acceptable and guarantee detection of the power imbalance, which may fail with other MPP-estimation-based approaches.</p>
        <p>A three-phase fault is applied on the line 6-9 at t = 0.1 s, with a fault resistance Rf = 1 Ω (Fig. 10). The fault is cleared after five cycles by tripping the line 6-9. The system response is given in Fig. 13 and Fig. 14. Fig. 13 shows the variation of terminal voltage and reactive power injection. When the fault occurs, the SMs inject reactive currents up to three to six times their pre-fault values, whereas the inverter current is limited to k = 1.414 p.u. (Qinj plot in Fig. 13) Hence, the terminal voltage of the PV plant is lower than those of the SMs (Vt plot in Fig. 13). The oscillations in the injected currents by the SMs are due to inherent electromechanical machine dynamics, which are not apparent in the PV inverter.</p>
        <p>Fig. 14 shows the variation of the active and reactive components (Iinv plot) and magnitude (Imag plot) of the inverter current. The real part of the current, iq, shoots up for the initial period of around a cycle, while the reactive part of the current, Fig. 14. dq components and magnitude of the inverter current, and magnitude of the VSC reference voltage in the SM GFC case subject to a three-phase fault.</p>
        <p>id, takes around a cycle to reach the limit of 1.2 p.u. due to the rate limiter. Hence, the terminal voltage dips for a period of around a cycle just after the fault occurs before reaching a steady value (see yellow line of Vt plot in Fig. 13). The proposed current limitation scheme performs fine, and the current magnitude is largely kept within the 1.414 p.u. limit, as seen in the Imag plot of Fig. 14. The injected currents, reactive power, and terminal voltages are all restored after the fault is cleared, featuring only limited oscillations in the post-fault currents. The inverter reference voltage does not oscillate and remains within limits, as shown in the Eref plot in Fig. 14. It is worth noting that the mode remains GF thought the disturbance since the inverter active power output does not hit the MPP limit.</p>
        <p>In this scenario, the PV system is subject to an irradiance change from 1000 to 500 W/m 2 and back in a few seconds, with the results in Fig. 15 and Fig. 16. This corresponds to very steep irradiance transients of 200 W/m 2 per second, which is among the highest rates recorded and may be caused by moving clouds [39].</p>
        <p>In the first few seconds of the irradiance drop, the PV system output is not affected since the irradiance change is reflected only in the reduction of the MPP power and maintained reserves (see Ppv in Fig. 16). Once the MPP is reached (vertical red dashed lines in figures), the dc-link voltage falls to the minimum threshold value of 720 V triggering a mode switch to LGF. In this mode, the frequency adjustment ∆ω (Fig. 16) contains the inverter output (yellow line in Pinj plot of Fig. 15) and brings the dc-link voltage back to normal (Vdc plot in Fig. 16). This power deficit is reflected as an under-frequency in the power system, balanced by the remaining generators (Fig. 15).</p>
        <p>When the irradiance returns back to normal, the PV-side power increases (see Ppv plot in Fig. 16), and the power-sharing among the generators is redistributed (Fig. 15). This change is again reflected in the frequency due to the very steep irradiance rate. When the power to be supplied by the inverter gets back within the capacity of the PV array, Δω becomes zero, and the mode changes back to normal GF.</p>
        <p>This case study explores the full GFC potential when the entire generation in the power system is inverter-based.</p>
        <p>The same load disturbance at bus 6 is applied here as well, with the frequency and power injection graphs shown in Fig. 17. Clearly, the frequency drop is substantially smaller, the settling time shorter, and the profile much smoother compared to Fig. 11 of the SM GFC case. This is the outcome of having only fast-acting inverter-based generation with very low droop coefficients (0.17% here for all inverters) that can respond promptly to the disturbance and do not suffer from the electromechanical oscillations of the machines, as clearly shown in Pinj plots in Fig. 17.</p>
        <p>It is worth noting that such low droop settings are permissible here because all generation is inverter-based; this is in contrast to the previous SM GFC scenario, where the PV plant needs to coordinate with the slow-acting machines and low droop values result in overloading of the PV plant and oscillations in the power system. In the All GFC case, however, neither of the generators is overloaded, as they all equally and quickly share the additional load. This improved load sharing is the reason that the PV GFC plan does not enter in LGF mode here, in contrast to the SM GFC case illustrated in Fig. 12. These results also show that an 100% inverter-based system with small droop settings does not need any mechanical inertia to operate. This confirms the observation in [42], [8] that GF converters have inherent "electrical inertia" and do not really need emulated or mechanical inertia in the system.</p>
        <p>This test case examines the impact of the same fault in line 6-9 when all generation is inverter-based. Here the current limit is set to k = 1.414 p.u. for all three inverters. The resulting terminal voltage profile and reactive power injections are shown in Fig. 18. The minimum voltage level reached is again about 0.6 p.u., the same as in Fig. 13 of the SM GFC case, but now it is found in node 1 instead of node 3. Apparently, the voltage sag in bus 1 is worse, in bus 2 is much better, and in bus 3 slightly improved compared to the SM GFC case. These changes in the voltage profile are due to different power flows resulting from the inverter's current limitation. This can be easily seen by comparing the reactive power profiles in Fig. 18 and Fig. 13, which exhibit substantially different values during the fault, especially G1 (blue lines). The apparent oscillations in the post-fault reactive power injections are expected, as the fault excites all the system modes and the topology changes due to line tripping. Similar oscillations are present in the case of SMs as well (see Qinj plot in Fig. 13). However, it is worth noting that these oscillations are properly damped within approximately one second after the disturbance (see Fig. 18).</p>
        <p>Here, the load disturbance is examined assuming that the PV system runs in the conventional GFL mode with frequency support function [29], [43], rather than in GFC mode. The droop coefficient is 1%, as in the SM GFC case.</p>
        <p>The same load disturbance (15% of the system load) is applied, albeit at different times, with the resulting frequency and active power plots given in Fig. 19. Under such severe disturbances, the PLL may malfunction and extract a distorted frequency for the PV system, as depicted in the frequency plot of Fig. 19. As a result, the power injection of the PV system is not as it should, here featuring a delay and a power dip at the onset of the disturbance (see zoom-box at the power plot in Fig. 19). Such peculiarities are known to be directly related to the PLL, which introduces measurement delays and is prone to errors during severe disturbances. Here this malfunction is not escalated further, but generally such issues become more prevalent at weak and low-inertia grids, as further explored in the following section.</p>
        <p>In this case, two GFL inverters with frequency support [29], [43] are connected to bus 1 and 2, and a PV GFC to bus 3. The droop coefficient of the PV GFC remains at 1%, but it is increased to 2% for the GFL inverters, since lower values result in instability.</p>
        <p>The same load disturbance yields the plots of Fig. 20. Like the SM GFL case, the poor PLL performance during the load switching is reflected in the power injection of the two GFL resources. Here these oscillations are clearly more severe due to the reduced grid strength and lower system inertia, as compared to the previous SM GFL case. It is worth comparing these results to Fig. 17 of the ALL GFC case to observe how different the dynamics are even though both systems are purely converter-based. The main conclusion from this investigation is that a GFC resource is superior to a GFL in terms of stability, and that there should be at least a few of the former in inverterdominated power systems. The identification of the right mixture is not straightforward and is left as future work.</p>
        <p>This section performs a comparative assessment on all five test cases (All SM, SM GFC, All GFC, SM GFL and GFC GFL) by means of modal analysis and dynamic response to a load increment and a three-phase fault.</p>
        <p>The modal analysis is carried out using fundamental frequency equivalent RMS models of the test cases as a complement to the EMT simulation results. Modal analysis is generally carried out to study the dynamic interactions in the power system; here, it is employed to assess how the smallsignal stability of the power system is affected by replacing synchronous machines with GFC inverters. The low-frequency dominant eigenvalues of the three main cases (All SM, SM GFC, and All GFC) are shown in Fig. 21. Displacing one SM by an inverter operating in GFC mode affects the low-frequency dominant modes only slightly (red star and blue circle markers in Fig. 21). These low-frequency modes are the root of oscillations found in Fig. 11 and 13 in the previous sections, as well as in the frequency plot of Fig. 22 in the following paragraph. On the contrary, the All GFC case does not feature any oscillatory low-frequency modes; hence the frequency profile during load changes is much smoother and non-oscillatory, as shown in Fig. 17 and Fig. 22. These results show that substituting SMs with GFC inverters neither improves nor worsens the small-signal stability of the system, except when all generation becomes inverter-based, which then exhibits substantially superior performance.</p>
        <p>The big picture on the frequency variation in all five cases for the same load increment (47.25 MW) is shown in Fig. 22. The inverters allow for lower droop settings and respond much faster to the load disturbance than the SMs irrespective of the mode of operation, i.e., either GFL or GFC. Therefore, the frequency profile is better in all inverter cases (All GFC, GFC GFL) as compared to the combination of two SMs and an inverter (SM GFL, SM GFC), the latter being in turn superior to All SM. The SM GFL and SM GFC cases are somewhat similar, being governed mainly by the two SMs inertia and electromechanical dynamics. There is only a PLL-induced frequency spike at the onset of the disturbance in the SM GFL, as discussed in Section V.C.</p>
        <p>Between the two purely inverter-based systems, the GFC GFL case exhibits noteworthy post-disturbance oscillations induced by the PLL, which may pose a stability risk and do not allow for very small droop coefficients. This is why the nadir and settling frequency is lower than in ALL GFC that permits even smaller droop coefficients and yields smoother frequency profile. In fact, the main conclusion from this investigation is that replacing SMs with GFL inverters has an limit; for higher inverter penetration, they should operate in GFC mode instead. The right balance between GFC and GFL resources remains to this day an open question in the literature [8].</p>
        <p>The terminal voltage of bus 3 in all three cases during a threephase fault followed by line tripping is shown in Fig. 23. Bus 3 is of particular interest, as it is the connection point of the PV system. In general, the terminal voltage is similar during the fault in the three cases, with the lowest value of approximately 0.6 p.u. However, the post-fault voltage recovery is faster, although a bit underdamped, when a PV plant is connected to bus 3 in place of an SM (yellow and red lines). These findings show once again that replacing SMs with GFC inverters does not impede the system dynamics during faults, despite the very limited overcurrent capacity of inverters.</p>
        <p>Two widely used current limitation methods [31]- [33] are compared with the proposed method, namely the virtual impedance method from [32] and an implementation of the reference current saturation method based on [31], referred here as MIGRATE Iref. The results are given in Fig. 24. A three-phase to ground fault occurs at t = 0.05 sec and is cleared after five cycles. The virtual impedance-based method suffers from the initial current overshoot and an oscillatory response during the fault. The MIGRATE Iref method also results in an initial nonoscillatory overcurrent. On the contrary, the proposed method successfully suppresses the initial overshoot thanks to the rate limiters and adjustable saturation limits, which also do not allow for any oscillations in the injected current. This case study confirms the superior performance of the proposed method as opposed to other standard approaches and validates the modifications adopted in the reference current limitation scheme.</p>
        <p>This paper introduces a new GFC scheme for PV systems that do not employ real-time estimation of the MPP and make optimal use of the limited power reserves. By operating in full or limited grid-forming mode, the PV plant preserves its voltage source nature and manages to assist the grid during disturbances similarly or even better than synchronous machines. The modified current saturation scheme performs smoothly, without any need for fault detection or control switching.</p>
        <p>Replacing SMs with PV GFC results in improved frequency profile during load disturbances due to faster response from the PV plant, and comparable terminal voltage profiles during faults despite the strict inverter overcurrent limits. However, the PV GFC introduces source of disturbances to the power system resulting from irradiance transients during cloud movement.</p>
        <p>Inverters in GFL mode with ancillary services can support the grid during disturbances, but the contribution becomes limited as the system strength decreases. The GFC mode of inverter operation is the way forward for the renewables-rich and inverter-dominated power systems of the future.</p>
        <p>Future work involves a complete investigation of the dynamic interactions between GFC and GFL inverters and the rest of the power system at various sizes and generation mixtures. Similarly, a methodology to determine the appropriate ratio of GFC and GFL resources would be very useful in converter-dominated power systems. Furthermore, the proposed method is designed for uniform illumination, which is the common assumption for utility-scale PV systems; an extension of the method to partial shading would improve its credibility and reliability at all possible conditions. APPENDIX</p>
        <p>Authorized licensed use limited to: INDIAN INSTITUTE OF TECHNOLOGY KANPUR. Downloaded on April 21,2021 at 06:59:16 UTC from IEEE Xplore. Restrictions apply.</p>
        <p>Bandopant Pawar (S'15) received the M.Tech. degree from Indian Institute of Technology Roorkee, Roorkee, India in 2015. Currently, he is pursuing his Ph.D. from Indian Institute of Technology Kanpur, Kanpur, India. His research interests include grid integration of renewable energy sources, power system dynamics, stability and control of power systems with large penetration of renewable sources.</p>
    </text>
</tei>
