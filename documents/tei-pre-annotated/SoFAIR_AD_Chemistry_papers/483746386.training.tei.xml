<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T10:14+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>We give an overview of the molecular response to an external magnetic field perturbing quantum mechanical systems. We present state-of-the-art methods for calculating magnetically-induced currentdensity susceptibilities. We discuss the essence and properties of current-density susceptibilities and how molecular magnetic properties can be calculated from them. We also review the theory of spincurrent densities, how relativity affects current densities and magnetic properties. An overview of the magnetic ring-current criterion for aromaticity is given, which has implications on theoretical and experimental research. The recently reported theory of antiaromaticity and how molecular symmetry affects the magnetic response are discussed and applied to closed-shell paramagnetic molecules. The topology of magnetically induced current densities and its consequences for molecular magnetic properties are also presented with twisted and toroidal molecules as examples.</p>
        <p>Earth's magnetic field is too weak to detectably affect molecular properties. There are though other reasons why a proper understanding of the molecular magnetic response is essential in chemistry, since magnetic fields of dozens of tesla can be created on Earth. Such strong magnetic fields perturb the electronic structure of molecules and lead to splittings of energy levels that can be spectroscopically detected. The interaction of these magnetic fields are still weak as compared to electrostatic forces implying that the theoretical treatment of molecular magnetic interactions can be based on perturbation theory. NMR spectroscopy, which is unarguably the most prolific analytical method of chemical characterisation, is based on the magnetic response of electrons and nuclei in molecules. The probability current density, j(r), is the central physical quantity of the magnetic response of the electrons.</p>
        <p>It can be used for assessing molecular aromaticity, electron delocalisation and used for expressing and computing many molecular magnetic properties. Independently of the central role that j(r) is playing in theoretical magneto chemistry, the probability current density is an interesting quantum mechanical entity on its own rights. This is apparent, for example, in relativistic quantum mechanics, where the current density is a physically well-defined quantity.</p>
        <p>This feature article will provide a short overview of the current state of the art of the theoretical description of current densities and molecular magnetic properties. By no means, can we claim to give an exhaustive overview of all branches of this field that is under active research.</p>
        <p>2 Theoretical background</p>
        <p>The interactions between electrons and nuclei in atoms and molecules are described by the Hamiltonian operator containing kinetic-energy and potential-energy terms. Exposing atoms and molecules to a magnetic field gives rise to additional terms in the Hamiltonian. [1][2][3] The kinetic energy comprises the linear momentum and the magnetic interaction. The canonical kinetic (mechanical) momentum operator, p, is introduced, which for an electron takes the form</p>
        <p>where i is the imaginary unit, h is the Dirac constant, r is the vector differential operator, e is the electronic charge and A is the magnetic vector potential, the curl of which gives the magnetic flux, B, also known as the magnetic field strength, B = r Â A.</p>
        <p>(2)</p>
        <p>Eqn (2) suggests that the magnetic flux can be defined by any magnetic vector potential fulfilling</p>
        <p>where f is a continuous differentiable function with a vanishing curl.</p>
        <p>The magnetic vector potential of a uniform magnetic field at point r can be given by</p>
        <p>where r O = r À O is the distance from r to a gauge origin O.</p>
        <p>In quantum chemistry, divergence-free vector potentials are used (rÁA = 0) in order to reduce the number of terms in the Hamiltonian.</p>
        <p>The Hamiltonian is derived by substituting the linear momentum operator in the field-free Hamiltonian, H ˆ(0) , with the kinetic momentum operator in eqn (1), which yields terms of different powers of the magnetic vector potential,</p>
        <p>For closed-shell molecules, the first-order dependence on the magnetic field becomes</p>
        <p>where m e is the electron mass. The expression for the orbital angular momentum operator, L ˆO, around O is</p>
        <p>where p is the momentum operator. The expression for the first-order interaction between the spin angular momentum, S ˆ, and the magnetic field resembles the one for the orbital angular momentum,</p>
        <p>The terms H ˆ(1) and H ˆ(1) S can either increase or decrease the total energy. In contrast, the quadratic dependence on the magnetic field strength in H ˆ(2) can only increase the energy. It is given by</p>
        <p>The physical properties of a quantum mechanical system in a magnetic field are independent of the origin of the magnetic vector potential. Thus, the vector potential can be chosen arbitrarily. This is a fundamental property at the core of the standard model giving the freedom to choose any vector potential up to a scalar gauge function with a vanishing curl. 4 When the magnetic vector potential in eqn ( 4) is used, one can freely choose the origin of the coordinate system, transform A(r) between different coordinate systems or equivalently, shifting the origin O of the A(r) potential, which can be seen by setting</p>
        <p>ðO Â BÞ Á r in eqn (3).</p>
        <p>The Hamiltonian is a Hermitian operator that remains gauge-invariant, meaning that it does not change as a consequence of gauge transformations, i.e., when shifting the gauge origin, O. However, the wave function acquires a complex exponential prefactor upon gauge transformations. When adding a scalar gauge function to the magnetic vector potential as in eqn (3), the change in the wave function is 5 c 0 ðrÞ ¼ exp À ie hc f ðrÞ cðrÞ: (10) where c is the speed of light. Hence for a given magnetic field there is no unique form of the magnetic vector potential,</p>
        <p>Formally one deals with a type of symmetry which is sometimes called gauge symmetry, gauge freedom or, emphasising the arbitrariness of the functional expression, it is also called the gauge problem. The latter point of view becomes relevant in numerical computations where the choice of the gauge, though formally irrelevant, has a substantial, sometimes huge effects on the numerical accuracy of the results. The former point of view is important for theoretical considerations where one enjoys the freedom to choose the form of the vector potential that transforms the equations into convenient expressions. 6 An alternative symmetric Coulomb (s.C.) gauge for a homogeneous magnetic field parallel to the z axis of the coordinate system can be constructed as</p>
        <p>fulfilling the r Â A s.C. = B and rÁA s.C. = 0 conditions. The same holds for</p>
        <p>which is not of the symmetric Coulomb type and cannot be expressed as a single cross product. Magnetic vector potentials of the A s.C. type or gauge-including atomic orbitals (GIAO), also known as London orbitals, 7-10 have mainly been employed in quantum chemical calculations of molecular magnetic properties. Magnetic properties have though also been calculated with the Landau gauge. 11 GIAOs can be constructed to resemble the magnetic response of the wave function in eqn (10). They contain the magnetic vector potential, A B K , of the external magnetic field, B, with the gauge origin at nucleus K as an exponential prefactor to an ordinary basis function, w K (r),</p>
        <p>Many studies have shown their importance in calculations of molecular magnetic properties, [7][8][9][10] since GIAOs consider the magnetic response to first order for any choice of the gauge origin leading to a rapid basis-set convergence as compared to calculations employing ordinary basis functions. The magnetic response of ordinary basis functions are correct only to zeroth order. 12 We also employ GIAOs in calculations of current-density susceptibilities with the gauge-including magnetically induced current method (GIMIC), as discussed in Section 2.9.</p>
        <p>Since the magnetically induced current density J B , is a vector field, one can compute it using a different origin of the vector potential for every point in space. This scheme called the continuous set of gauge transformation (CSGT) was introduced by Keith and Bader, 13 while Lazzeretti et al. called it the continuous transformation of the origin of the current density (CTOCD) [14][15][16] approach. The gauge origin of the vector potential seems then to have the form of a function O(r). However, this is misleading since one cannot employ a single gauge transformation, since in general</p>
        <p>holds. Instead, it should be seen as using a continuous set of equations to be evaluated separately for each point in space. The first exploited CTOCD scheme was the so called CTOCDdiamagnetic-component-to-zero (CTOCD-DZ) approach, where each evaluation point is its own gauge origin,</p>
        <p>The CTOCD-DZ approach was later called the ipsocentric method. [13][14][15]17,18 2.4 Current density</p>
        <p>The continuity equation ensuring charge conservation can be derived using the hydrodynamical representation of the Schro ¨dinger equation, 19,20 @ðc Ã cÞ @t ¼ Àr Á jðrÞ:</p>
        <p>The probability current density or the current density, j(r), is then given by</p>
        <p>The current density is a subobservable, meaning that it is formally the expectation value of a quantum mechanical operator, and hence experimentally measurable if a suitable instrument were available. 21 Multiplying j(r) by the electron charge yields the charge current density, J(r) = Àej(r). The electronic current density can be expressed as the expectation value of the anticommutator of the kinetic momentum and the electron-density operator r(r),</p>
        <p>The electron-density operator is given by r(r) = d(r À r 0 ) with the Dirac delta function d.</p>
        <p>The magnetically induced current density can be obtained to first order by expanding the wave function in series according to the Rayleigh-Schro ¨dinger perturbation theory, 22,23</p>
        <p>where C (1) 0 is the first-order magnetically perturbed wave function that can formally be obtained by introducing the angular momentum operator, L ˆO, as the perturbation, C</p>
        <p>E (0) 0 and E (0) I in the denominator of eqn (21) are the energies of the ground and the Ith excited state, respectively, which are obtained in the absence of the external magnetic field.</p>
        <p>The current-density expression can be obtained by inserting C (1) 0 in eqn (21) into eqn (20), which is then use in eqn (19). The quadratic and higher-order terms in B are omitted. The current density induced by a magnetic field can be formally separated into a diamagnetic term, J B dia , and a paramagnetic term, J B para . However, this is a purely mathematical formality based on the fact that J B dia resembles the classical Larmor current density. Yet, only the sum of the Larmor and non-Larmor terms has a physical meaning.</p>
        <p>When an N-atomic molecule is exposed to an external magnetic field, the magnetic vector potential is</p>
        <p>where A B (r) is the vector potential of the external magnetic field and A mK (r) is the vector potential of the nuclear magnetic dipole moment m K of nucleus K. To the first order, the magnetically perturbed wave function takes the form</p>
        <p>where C B is the change in the wave function due to the external magnetic field and C mK is the wave-function response due to the nuclear magnetic moment m K .</p>
        <p>The relativistic current density based on the solution of Dirac's time-independent relativistic wave equation is</p>
        <p>where a and b are the standard Dirac matrices, 24 j is the relativistic four-component wave function, and E is the energy eigenvalue. The current density is then given by</p>
        <p>where ca is the relativistic velocity operator. Thus, j 4c (r) can be interpreted as a velocity density discussed in Section 2.6. For many-electron systems, the expression for the relativistic current density can be recast in terms of the Gordon decomposition 25,26 as</p>
        <p>where j i are four-component Dirac orbitals and I denotes imaginary part. R ¼ r 0 0 r is the spin operator. An additional term accounting for the spin contribution to the exchange correlation potential appears at the Dirac-Kohn-Sham (DKS) level of theory. 27</p>
        <p>Using atomic units but keeping the rest mass of the electron, m e , (i.e. h = e = a 0 = 1) eqn ( 18) yields the electron current density, j(r), which can be interpreted as the real part of the velocity density † originating from the velocity operator p/m e ,</p>
        <p>where &lt; and I denote the real and imaginary part, respectively. This expression can be extended to the case of a non-vanishing external magnetic field by replacing the momentum operator, p, in eqn (28) with the mechanical momentum operator p given by eqn (1), which is called minimal coupling. Substituting pp = p + A yields</p>
        <p>which is equivalent to eqn (22). To consider the spin of the electron, we can follow the derivation by Dyall and Faegri 24 and replace p with r(rÁp) in eqn (29), where r is a three-dimensional vector of the Pauli spin matrices. ‡ 24 Replacing the onecomponent wave function, c, with the two-component Pauli spinors, j, yields</p>
        <p>which is identical to the expression for the current density derived by Landau from the Pauli-Schro ¨dinger equation by variation of the differential of the Hamilton function. 28 This expression cannot be derived from the Pauli-Schro ¨dinger equation alone without considering the extremality condition of the Hamilton function. 29 In four-component relativistic theory, the current density and its reformulation in terms of the Gordon decomposition 25,26 is</p>
        <p>The Gordon decomposition of the four-component relativistic current density eqn (33) is in the two-component limit equal to eqn (31).</p>
        <p>The spin of the electron was introduced into the Schro ¨dinger equation by Pauli to fit experimental observations. 1,2 In the presence of an external magnetic field, the Schro ¨dinger equation becomes a two-component equation, whose components are coupled by the external magnetic field. [30][31][32] The spin of the † This velocity density should not be confused with the local velocity (see Section 2.13), nor with the classical or quasi-classical velocity density v defined via vq = j with the electron density r. ‡ Dyall and Faegri started the derivation from the classical Hamiltonian by replacing (p) 2 -(rÁp) 2 and obtained the Pauli-Schro ¨dinger Hamiltonian after quantisation. The same expression up to a factor of 3I 2 is obtained by substituting pr(rÁp). I 2 is the two-dimensional identity matrix. 24 electron is introduced in a natural way by using the relativistic Dirac equation or the Le ´vy-Leblond equation, 3,33 which is a non-relativistic four-component equation with eigenenergies and eigenfunctions that are identical to the ones obtained by solving the Schro ¨dinger equation. 29 The spin-dependent term in the probability current is j spin ðrÞ ¼ h 2m e r Â ðc y rcÞ:</p>
        <p>An elegant way to introduce the spin into the current-density expression is to use the variation principle outlined, for example, in the textbook of Landau and Lifshitz 28 that yields the spincurrent density as a contribution to the charge current density without further assumptions.</p>
        <p>Following an argument from Greiner 34 , this additional current-density term can be interpreted in analogy with classical electrodynamics as a magnetisation current density, J M , describing a magnetisation density M induced by the current density of a particle with charge q,</p>
        <p>For electrons, M is obtained by multiplying the spin density</p>
        <p>, retaining its interpretation as the magnetisation density that arises from the spatial distribution of the spin which is the magnetic moment. The spin-current density appears then as an additional term to the total current density. 29 As j spin (r) is divergence-free, it does not contribute to the charge-conservation equation in eqn (17). However, there are theoretical and experimental evidences that j spin (r) is a measurable component of the probability current density of spin-1 2 particles and not a mere virtual term that completes the magnetisation density with the spin contribution. 29</p>
        <p>The current density is a vector with its components in the three Cartesian directions. Expanding the current density in a Taylor series with respect to an external magnetic field results in the zero-field current density, j 0 (r), which vanishes for closed-shell quantum systems. The second term consists of the first derivative of J B (r), called the current-density susceptibility tensor, multiplied by the respective component of the magnetic field,</p>
        <p>Higher-order terms can generally be omitted, since magnetic interactions under terrestrial conditions are weak in comparison to Coulomb forces. The current-density susceptibility tensor element in the a Cartesian direction for the magnetic field in the b Cartesian direction is</p>
        <p>where a; b 2 fx; y; zg:</p>
        <p>The current density scales almost linearly with the strength of the external magnetic field when field is weak. In stronger magnetic fields, non-linear effects become significant. 31,[35][36][37][38][39] The non-linearity is difficult to detect, since experimental chemical shifts are measured with respect to a reference, whose magnetic shielding constant also have a non-linear component at strong magnetic fields. Small deviations from linearity were recently found in measurements of 59 Co NMR chemical shifts using a 28T NMR spectrometer. 40 2.9 The gauge-including magnetically induced current method An expression for the current-density susceptibility can be obtained by combining the expression for calculating nuclear magnetic shielding tensors using analytical derivative theory with the corresponding Biot-Savart expression. [41][42][43][44] The final expression for calculating current-density susceptibilities contains the one-electron density matrix in the atomic-orbital (basis-function) basis, D mn , and the magnetically perturbed one-electron density matrices, @D mn @B b . Gauge-origin independence and a fast basis-set convergence are achieved by employing gauge-including atomic orbitals defined in eqn ( 14).</p>
        <p>The tensor elements of the current-density susceptibility can be obtained as</p>
        <p>where e abd is the Levi-Civita pseudotensor with a, b, d A {x, y, z}. 45 The actual interaction with the magnetic field is described by the operators</p>
        <p>and</p>
        <p>where R K are the nuclear coordinates. The same singularity |r À R K | À3 appearing in all terms of the current-density susceptibility expression cancel and can be omitted, even though the expression in eqn (38) seems to depend on the gauge origin and the nuclear coordinates. The current-density susceptibility depends, though, implicitly on the nuclear positions. Equivalent expressions can be derived for the current-density susceptibility contributions of the spin-up and spin-down electrons of open-shell molecules. 42</p>
        <p>The CTOCD method was introduced in 1993 primarily for improving the numerical accuracy of current-density calculations. In 2001 Steiner and Fowler discovered the symmetry rules for the diamagnetic and paramagnetic response using molecular-orbital (MO) based first-order perturbation theory and the CTOCD-DZ ansatz. 46 They found that the paramagnetic response is determined by rotational occupied-virtual transition matrix elements,</p>
        <p>where | ji and |ai denote occupied and unoccupied orbitals, respectively, and e j and e a are their energies, l ˆO is the oneparticle angular momentum operator with respect to the origin, O. The diamagnetic response is determined by translational occupied-virtual transition matrix elements,</p>
        <p>where p is the one-particle linear momentum operator. Similar expressions are obtained for the many-electron case, where | ji and |ai denote the ground and excited states, respectively. Hence, the selection rules for diamagnetic and paramagnetic contributions can be obtained using group theory. Virtual transitions from the ground state to excited states belonging to the same irreducible representations as infinitesimal rotations around the axis parallel to B yield paramagnetic contributions, whereas the diamagnetic contributions originate from dipole-allowed transitions perpendicular to B with the same irreducible representations as translations in the given point group. Using the momentum/position off-diagonal hypervirial theorem, 47,48 the diamagnetic contribution can be shown to be equal to the diamagnetic term obtained with the commongauge-origin (CGO) ansatz in the limit of complete basis set. The CTOCD-DZ method is widely used due to its high numerical accuracy compared to other CTOCD ansa ¨tze. In particular, the zero-divergence condition is fulfilled with high accuracy for regions of small electron density already when employing relatively small basis sets. Variants of the CTODZ-DZ method such as shifting the gauge origin in core regions with high electron density closer to the nuclei (CTOCD-DZ2) have been proposed. 49 CTOCD-paramagnetic-component-to-zero (CTOCD-PZ) is the antipodal ansatz, where the gauge-origin distribution O(r) is chosen such that the induced current density is given by</p>
        <p>where r(r) = |C (0) 0 | 2 is the electron density. The CTOCD-PZ implies that the paramagnetic current-density contributions originating from excited states vanish. The theoretically exact condition for the gauge-orgin distribution O(r) of the CTOCD-PZ ansatz in the complete basis set limit is</p>
        <p>where C L 0 0 is defined in eqn (21). A series of approaches closely related to CTOCD-DZ and CTOCD-PZ is implemented in the 
            <rs type="software">SYSMOIC</rs> package. 50 Recently an origin-distribution scheme was proposed that leads to vanishing divergence of the diamagnetic current-density contribution, rÁJ B dia (r) = 0. The origin-distribution function is then of the form
        </p>
        <p>which can be used when F(r) is a well-behaved real scalar function. 51 The diamagnetic contribution to the current density,</p>
        <p>then inherits the topology of the origin-distribution function F(r). § In points r 0 where rF(r 0 ) = 0 holds, J B dia (r) has stagnation points. F(r) functions that can be expressed as a function of the electron density are of particular interest, since a natural connection is then obtained between the topology of Bader-type bond critical points and stagnation points of the current density.</p>
        <p>The orbital contribution to the spin-current-density susceptibility can be calculated at non-relativistic levels of theory using the gauge-including magnetically induced current (GIMIC) method 42 described in Section 2.9 or by using the continuous transformation of the origin of the current density (CTOCD-DZ) scheme described in Section 2.10. 52 The spin-current-density susceptibility of the spin-up and spin-down electrons are obtained with the same expression as used for closed-shell molecules. For open-shell molecules, one needs density matrices of the spin-up (a) and spin-down (b) electrons that can be obtained in electronic structure calculations on open-shell molecules. The GIMIC method needs magnetically perturbed spin-density matrices that are obtained by performing a calculation of the orbital contribution to the NMR shieldings of open-shell molecule. The spin-current-density susceptibility is the difference between the current-density susceptibilities of the a and b electrons and the current-density susceptibility is the sum of the two. 53 The spin-current density can be used in an integral expression for calculating the elements of the nuclear hyperfine § The original work 51 contains a flaw in the derivation of the functional form of J B dia (r), which led to a formulation equivalent to</p>
        <p>which is only a necessary but not a sufficient condition for the correct functional form (eqn (46)). This error has consequences for one of the main results of the study. The correct conclusion is that there is no inherent connection between the topologies of the unperturbed electron density and any divergence-free diamagnetic current contribution, arising from the zero-divergence constraint. An erratum is under preparation.</p>
        <p>coupling tensor and the density of hyperfine coupling, which is a function containing its spatial origin. 52 2.12 Current-density susceptibility at relativistic levels For closed-shell molecules, the largest purely relativistic contribution to the current density arises from a non-vanishing spin density, r B,SOC spin , which is a second-order perturbation induced by the spin-orbit coupling (SOC) interaction in the presence of an external magnetic field. 54 The spin-orbit coupling results in a contribution to the total current density via a spin-current-density-like term</p>
        <p>where the second expression can be identified when comparing the expression to eqn (27).</p>
        <p>Due to the SOC mechanism, r B,SOC spin (r) is primarily located near the nuclei of heavy elements and less pronounced but still significant at the nuclei of lighter atoms that are directly bonded to heavy atoms. The latter case is especially pronounced when the bond is s-dominated, since then a Fermicontact coupling between heavy and light atoms can occur. This is the heavy atom-light atom (HALA) effect. 55 The spin density at a covalently bonded hydrogen atom has the shape of an s orbital whose amplitude quickly decreases with the distance from the nucleus of the hydrogen atom leading to a spincurrent density with a small but sharp vortex as for HgH 2 shown in Fig. 1.</p>
        <p>Magnetically induced current densities can be calculated at fully relativistic four-component (4C) density functional theory (DFT) levels of theory with the ReSpect 54,56-59 and Dirac [60][61][62][63] programs. The 
            <rs type="software">ReSpect</rs> program can be used in studies of closed-shell and open-shell systems. Perturbation-free current densities of open-shell systems as well as current densities induced by nuclear magnetic moments can be calculated and visualised with 
            <rs type="software">ReSpect</rs>. 27 The two codes employ GIAOs in calculations of magnetic properties and magnetically induced current densities. In 4C-DFT calculations of magnetically induced current densities, restricted kinetically and magnetically balanced basis sets are used. These basis sets in combination with GIAOs ensure numerical stability and a rapid convergence of magnetic properties with respect to the size of the basis set.
        </p>
        <p>Topology analysis of molecular electron densities that was introduced by Bader 64-66 led to the development of the quantum theory of atoms in molecules (QTAIM), 67 which is a means of partitioning the electron density, er(r), and molecular properties into chemically meaningful atomic domains. The current-density field can analogously be divided into atomic or chemically relevant domains. Such topology analyses provide valuable insights about the current-density distribution and the origin of molecular magnetic properties.</p>
        <p>Dirac 68 and later Hirschfelder et al. [69][70][71] developed the theory of quantised vortices of the probability current-density flux around the nodal regions of complex wave functions, c = c r + ic i . The vortices originate from wave interference and, hence, have no classical interpretation. The local velocity, v(r), of the probability current density, j(r), in eqn ( 18) is given by the flux divided by the probability density, r(r) = |c(r)| 2 , vðrÞ ¼ jðrÞ rðrÞ :</p>
        <p>The local velocity can be integrated over a closed path, which is defined up to an integer multiplier, i.e., it is quantised,</p>
        <p>where the circulation number n is an integer, L is a closed path, and m is the mass of the particle. The circulation is the same for all loops of the same nodal regions of c(r).</p>
        <p>The linear relation between the probability current density j(r) and the velocity v(r) allows investigations of the currentdensity field with methods developed for classical hydrodynamics studies. 16,72,73</p>
        <p>where t is any coordinate along the trajectory. The time arrow gives the direction of j(r). The velocity vector field can be investigated numerically using the Runge-Kutta method in order to obtain the next step of the trajectory. 74,75 The result can be visualised as streamlines in three dimensions (3D) and the tropicity of the vortex can be determined from the circulation direction. Diatropic current-density vortices circulate in the classical direction, while the opposite direction defines a paratropic flow.</p>
        <p>A magnetic field gives rise to an imaginary component of the wave function which depends linearly on the magnetic field strength. The intersections between the nodal surfaces of the real and imaginary parts of the wave function create axes or loops around which axial or toroidal vortices arise. Hirschfelder 71 showed that axial vortices have an orbital angularmomentum dipole moment. When a nodal line forms a closed loop, a toroidal vortex arises, such that it flows concentrically around the nodal line. The angular-momentum dipole moment vanishes for toroidal vortices but instead they possess orbital angular-momentum quadrupole moments. Toroidal vortices can interact with the gradient of the magnetic field but not with homogeneous magnetic fields. 71 Axial and toroidal vortices are the only kinds of vortices associated with one-particle wave functions. 71 The analysis of the nodal lines of N-electron wave functions can either be done in a 3N-dimensional space, or in 3D after splitting the wave function into natural orbital components which, however, do not necessarily fulfill the continuity equation. 76 The magnetically induced current density is a 3D vector field that can be analysed by evaluating its singular points. An expansion of the current density into a Taylor series at the singular point r 0 shows that it is to first order related to the Jacobian matrix D(r) = [rJ(r)] r0 , as</p>
        <p>The singular points of the current-density field can be analysed using the Jacobian matrix that can be efficiently obtained by numerical differentiating the expression for the current-density susceptibility in eqn (38) or by differentiating it analytically. The number of non-zero eigenvalues of the D(r) tensor gives the rank of the singular point, r, while the difference between the number of eigenvalues with a positive and with a negative real part defines the signature of the singular point, s. Singular points of the current density are classified according to their Euler index (r, s), 16,[76][77][78] which is analogous to the topological treatment of the electronic density of molecules. 67 An isolated singular point is a local maximum in two dimensions but a minimum in the third one. Such points are defined as (3, AE1), where the + and À sign correspond to a sink and a source, respectively. Points lying on stagnation lines are denoted by (2, 0), meaning that two of the eigenvalues of D(r) are of the same size but with opposite sign and the third eigenvalue is zero. When the three eigenvalues of the Jacobian vanish, the stagnation lines may split. The behaviour of the vector field around a stagnation line is characterised either by an index +1 when there is a vortical flux around the line, or by the index À1 when the singular point is a saddle point. The eigenvalues of D(r) are real for a saddle point and imaginary for a vortex. Streamline representations are shown in Fig. 2.</p>
        <p>Stagnation lines are open lines for axial vortices and they can branch into N new lines at critical points as long as the total index (AE1) is conserved, 76</p>
        <p>A streamline may not cross a reflection plane of the pointgroup symmetry. 16 The properties of stagnation lines differ from those of the nodal lines of the wave function, since a stagnation line can be associated not only with a vortical flow but they can also form a set of saddle points. 76 The set of asymptotic lines connecting two singular points forming a surface is called a separatrix, which serves as the boundary between the vortices of the current-density field. Separatices may never cross due to charge conservation. Plotting all the stagnation lines of the field gives its stagnation graph. Gomes proved that there is one and only one vortical line extending to infinity. 76 It corresponds to a vortex that covers the whole molecule and vanishes far away from it. The global domain is associated with a dominating stagnation line parallel to the magnetic field. The main stagnation line can branch in the vicinity of the atoms where the electron density is large and may give rise to both vortical and saddle stagnation lines resulting in many smaller vortices inside the global current-density domain.</p>
        <p>The stagnation graph of the molecule are useful since one can visually identify domains of the current density associated with chemical bonds, such as in Fig. 3, or with ring currents as shown in Fig. 4. One can also identify atomic vortices in the vicinity of the nuclei. In the centre of molecular rings there is typically a vortex as seen in blue in Fig. 5. In polycyclic molecules with fused rings, current-density pathways may trace the perimeter of some rings but avoid others, i.e., forming semilocal vortices. Heteroatoms often give rise to complicated and sometimes unpredictable current-density pathways. 79 The current-density flux affects the nuclear magnetic shielding constants as discussed in Section 2.15.</p>
        <p>By placing the magnetic field in the z direction, the negatively charged electrons flow in the clockwise direction when looking towards the negative z axis according to classical electrodynamics. However, the quantum-mechanical response of the molecular electron density to the magnetic field can also give rise to an induced current density in the counter-clockwise direction. Thus, the direction of the current-density flux inside a vortex is either clockwise or counter-clockwise for a given direction of the external magnetic field.</p>
        <p>The magnetic interaction energy can be expressed as the scalar product of the magnetically induced current density J B (r) with the vector potential A B (r) of the external magnetic field, B, 16,80-86 The elements of the magnetic susceptibility tensor, w ab with a, b A {x, y, z}, are defined as the second derivative of E BB with respect to B,</p>
        <p>Magnetisabilities are generally calculated using analytic gradient theory, which is also known as response theory. 10,[87][88][89] Closed-shell molecules are, with a few exceptions, diamagnetic with a negative magnetisability, [90][91][92][93][94][95][96][97] whereas molecules having a positive magnetisability are paramagnetic. In open-shell systems, paramagnetism is due to the spin of the unpaired electrons, whereas closed-shell paramagnetic molecules discussed in Section 2.18 are rare.</p>
        <p>The second half of eqn (56) shows that the magnetisability can also be calculated by differentiating the magnetic interaction energy in eqn (55). 16,[80][81][82][83][84][85][86][87][98][99][100][101] The elements of the magnetisability tensor can then be expressed as</p>
        <p>where r w ab (r) is the magnetisability density given by r w ab ðrÞ ¼</p>
        <p>where e adg is the Levi-Civita symbol, a, b, g, d, r d A {x, y, z}. The integral expression renders numerical integration approaches feasible when the current-density susceptibility is available.</p>
        <p>The magnetisability density provides information about the spatial origin of the magnetisability, which is not possible when using analytic gradient theory. The magnetisability density is gauge dependent, since one can choose an arbitrary gauge origin in eqn (4) due to the charge conservation of the current-density susceptibility, 102 ð J</p>
        <p>However, the obvious and most likely the correct choice is O = 0, because otherwise, for example, symmetry-related atoms would contribute differently to the magnetisability when the chosen gauge-origin of the magnetisability operator differs from zero. Since the current-density susceptibility can be obtained from calculations of nuclear magnetic shieldings, gauge-origin independent magnetisabilities are easily obtained using the integration approach. 86 Calculations of magnetic properties using functionals at the meta-generalised gradient approximation (mGGA) require extensions of the functional to ensure gauge-origin independence 103,104 since in the presence of a magnetic field the ordinary kinetic density, t p |rj| 2 , depends the gauge origin (O). 105,106 Recent benchmark calculations have shown that the widely used extension proposed by Maximoff and Scuseria leads to unphysical paramagnetic contributions to the NMR shielding constants of atoms. 106,107 Such problems do not appear when using the extension proposed by Dobson, 103 which is used when studying molecules in explicit magnetic fields at mGGA levels of theory 36,38,108,109 and has also been used in some other applications. 105,110,111 The unphysical effects are relatively small in calculations of NMR shielding constants using many mGGA functionals, 106 whereas gradienttheory calculations of magnetisabilities lead to significant deviations from reference data. 86,112 The magnetisabilities are more accurate when performing numerical integration using current-density susceptibilities obtained in magnetic shielding calculations. 86,112</p>
        <p>Atomic nuclei with non-zero spin give rise to a magnetic vector potential, A m K nuc ,</p>
        <p>since they possess their own magnetic moment, m K . The combined magnetic vector potential of the external magnetic field and the magnetic moments of the nuclei becomes</p>
        <p>where m 0 is the vacuum permeability, r iO is the distance between the position of electron i, r i , and the gauge origin, the index K spans all nuclei, m K is the magnetic moment of nucleus K, and r iK is the distance between electron i and nucleus K.</p>
        <p>The external magnetic field interacts with the nuclear magnetic moments that experience a slightly weaker or stronger magnetic field than the external one due to the magnetically induced current density of the surrounding electrons which shields or deshields the nucleus. The local contribution to the effective magnetic field at the nucleus, B loc , can be expressed using the Biot-Savart law as</p>
        <p>The local change in the external field can be combined into the shielding constant, s K , for nucleus K,</p>
        <p>The isotropic shielding constant is the trace of the shielding tensor, which is a 3 Â 3 tensor with elements for each pair of the three Cartesian directions, a and b, for each nucleus, s K ab . Nuclear shielding constants can be probed experimentally in nuclear magnetic resonance spectroscopy (NMR) by comparing the response of the nuclei of the investigated molecule to the nuclei of a standard. Even though the strength of the magnetically induced current density cannot be measured directly, NMR chemical shifts provide an indirect means of evaluating them experimentally.</p>
        <p>The molecular energy associated with the magnetic interaction between a nuclear magnetic moment and the external magnetic field can be expressed via the magnetic vector potential and the current density as</p>
        <p>The nuclear magnetic shielding is the mixed second derivative of E mKB with respect to the m K and B,</p>
        <p>where a, b A {x, y, z}. Alternatively, the shielding tensor can be obtained from the Biot-Savart expression, which is the second part of eqn (65). 14,16,80,81,85,113,114 The expression for the magnetic shielding tensor elements then becomes</p>
        <p>g ðrÞ is the magnetically-induced current-density susceptibility, a, b, g, d A {x, y, z}, e adg is the Levi-Civita symbol, |r À R K | is the distance from nucleus K. Fig. 5 The integration plane shown in gray for calculating the strength of the ring-current strengths of ring-shaped molecules, such as [C 6 I 6 ] 2+ here. The ring current is dominated by the diatropic contribution at the carbon ring and outside the iodine atoms. The paratropic ring current inside the ring is shown in blue. 131 The integrand in eqn ( 66) is a scalar function known as the nuclear magnetic shielding density 80,81,115 whose spatial distribution provides detailed information about the origin of the elements of the nuclear magnetic shielding tensor. 114,[116][117][118][119][120][121][122] Positive and negative contributions to the magnetic shielding density yield the spatial origin of the shielding and deshielding contributions, respectively. They provide a rigorous physical basis for interpreting nuclear magnetic resonance (NMR) chemical shifts. Visualisation of the shielding density, s(r), showed that it is not the tropicity but the relative direction of the current-density susceptibility with respect to the nuclear magnetic moment vector individually at each point that determines the magnetic shielding or deshielding of the nucleus. 114 Information about spatial contributions to the magnetisability and magnetic shielding densities of the individual canonical orbitals can be obtained without any orbital-localisation scheme. 16,46,115,[117][118][119][120][121][122][123][124][125] The total magnetisability and nuclear magnetic shielding tensor of a given molecule are independent of the partitioning of the current-density susceptibility into orbital contributions, whereas the individual orbital contributions depend on the chosen orbital representation as also when using local-orbital approaches such as the canonical-molecularorbital nuclear-chemical-shielding (CMO-NCS) method. 126</p>
        <p>Ring-shaped molecules sustaining a non-zero net ring current when exposed to an external magnetic field perpendicular to the ring are aromatic or antiaromatic depending on the direction of the ring current. Aromatic molecular rings sustain a net diatropic ring current, that is, a ring current in the classical direction, whereas antiaromatic molecules sustain a net ring current in the non-classical (paratropic) direction. 130 Ring currents can be detected indirectly by measuring 1 H NMR chemical shifts or the anisotropy of the magnetic susceptibility, 7,[127][128][129] which are important experimental indicators for aromaticity. Computationally, the aromatic character can be assessed by calculating the magnetically induced ringcurrent susceptibility.</p>
        <p>The degree of aromaticity and the aromatic pathways can be obtained by integrating the current-density flux through a plane parallel to the magnetic field direction and perpendicular to the molecular ring. One of the vertical edges of the plane lies along the axis of the current-density vortex and crosses a selected chemical bond. The other vertical edge of the plane extends far out where the current density vanishes. Likewise, the horizontal edges of the plane extend until the current density vanishes above and below the molecule, as shown in Fig. 5. The strength of the current-density flux passing through the plane, I, is obtained by numerical integration, 41</p>
        <p>The tensor elements of the current-density susceptibility, Ĵ B b ðrÞ, in eqn (67) are contracted with the three components of a specified direction of the external magnetic field, B b , normalised to one. The vector n ˆis the normal of the integration plane. The SI unit for the current-density susceptibility is nA T À1 m À2 . The integration yields the strength of ringcurrent susceptibilities in nA T À1 .</p>
        <p>The exact position where the integration plane crosses the bond is not important because the ring-current susceptibility strength should be the same for all points along the bond due to charge conservation. Small deviations may appear due to the use of finite basis sets, i.e., charge is not fully conserved. Larger uncertainties are introduced for asymmetric molecular rings where the vortex axis of the current-density susceptibility is not always vertical but shifted from the geometrical centre and bent with respect to the normal vector of the ring. Inaccuracies becomes more prominent when passing through atoms as the core orbitals sustain a larger current density.</p>
        <p>The sign of the current-density susceptibility passing through the integration plane can be used for assigning its tropicity. By convention, diatropic current density is assigned as positive and paratropic current density gets a negative sign. However, since tropicity is a global property, this assignment must be considered with care, because the simple sign approach cannot distinguish between diatropic current densities and returning paratropic current densities and vice versa.</p>
        <p>The assignment of diatropic and paratropic ring-current susceptibilities of polycyclic molecules is difficult, since the flux of the diatropic and returning paratropic ring currents through the plane can be superimposed. 132,133 To resolve this problem, one has to identify diatropic and paratropic currentdensity fluxes and investigate them separately. Even though the tropicity can be unambiguously determined by following the trajectories of the current-density susceptibility, a thorough visual inspection also provides a clear notion about the tropicity of the current density.</p>
        <p>Calculations have shown that the strength of the ringcurrent susceptibility of small aromatic molecules correlates with the stabilisation energy due to electron delocalisation in the conjugated chemical bonds. [134][135][136] The correlation between the strength of the ring-current susceptibility and the aromatic stabilisation energy suggests that the ring-current criterion can be used for determining the degree of aromaticity of molecular rings. There is a similar correlation between the strength of the current-density vortex of hydrogen bonds and the strength of the hydrogen bond. 137 Calculations of ring-current susceptibilities support Hu ¨ckel's p-electron counting rule which states that molecular rings with (4n + 2) p electrons are aromatic and that antiaromatic molecules have 4n p electrons. [138][139][140][141] The aromaticity concept has been extended to molecules with open shells and excited states, 38,42,[142][143][144][145] as well as to non-planar molecules. 44,131, The net ring-current susceptibility of non-aromatic molecules vanishes, since they sustain diatropic and paratropic ring currents of the same strength. For example, in 1,4-cyclohexadiene, the current density is diatropic outside the CQC bond. The paratropic current density inside the ring is of about the same strength. The current density passing the CH moieties is paratropic inside the ring and diatropic on the outside of the carbon journal is © The Royal of Chemistry 2021</p>
        <p>Commun., 2021, 57, 12362-12378 | 12373 atom. Calculation of the diatropic and paratropic contributions to the ring-current susceptibility reveals that there is a currentdensity vortex at the centre of the CQC bond. 167</p>
        <p>Antiaromaticity, defined as the co-existence of a paratropic ring current, symmetry breaking or structural distortion, and a small Fermi gap 168,169 can be understood in terms of a general underlying symmetry principle as pointed out by Berger and Viel: 170 Molecules belonging to certain point groups with a (near-)degenerate wave function, sustain a magnetically induced paratropic ring current and have the possibility of a (pseudo-)Jahn-Teller distortion. More specifically, let G be a point group among C n , C nv , C nd , D n , D nv , D nd , S 2(nÀ1) with n 4 2 but not belonging to the tetrahedral, T * , octahedral, O * and icosahedral, I * , point groups. Any symmetry-induced two-fold degeneracies (in G) are then necessarily connected with the irreducible representation of the angular momentum operator, l ˆz, around the main symmetry axis, which is unique for these point groups. If the wave function is degenerate, having irreducible representations of e type (the only occurring type of degeneracy in these point groups), the paramagneticity and the symmetry-induced (first-order) Jahn-Teller distortions Q, occur together, which Berger and Viel called the Symmetry Principle of Antiaromaticity (SPA). 170 The SPA can also be applied to closed-shell states that are non-degenerate but nearly two-fold-degenerate. The magnetically induced paratropic ring current then appears together with a symmetry-induced (second-order) pseudo Jahn-Teller distortion, Q. A schematic representation in terms of energy level diagrams for both cases is given in Fig. 6.</p>
        <p>Such near-degenerate electronic states are typically the ground state of antiaromatic molecules. For example, calculations on cyclobutadiene at the multiconfiguration self-consistent field (MC-SCF) level of theory in the D 4h point group 171 showed that the electronic 1 B 1g ground state (S 0 ) and the close lying 1 B 2g state (S 2 ) are paramagnetically coupled in the presence of a magnetic field. The angular momentum operator parallel to the main symmetry axis belongs to the a 2g irreducible representation. Since the product of the irreducible representations of the two states comprises the irreducible representation of the angular momentum operator (b 2g # b 1g = a 2g ), the corresponding transition matrix element of the angular momentum operator does not vanish, implying that a magnetically induced paratropic ring current is expected. A second-order Jahn-Teller effect along a distortional or vibrational normal mode Q of the b 1g irreducible representation also leads to a distorted structure belonging to the D 2h point group because the b 1g mode couples the 1 B 1g ground state with the close-lying 1 A 1g state (S 1 ).</p>
        <p>The spatial symmetries of the three singlet states (S 0 , S 1 , S 2 ) and the first triplet T 1 ( 3 A 2g ) state are related as they span a twodimensional subspace of the E g irreducible representation of the D 4h point group via A 1g " A 2g " B 1g " B 2g = E g # E g . After the structural distortion, the degenerate representation splits but the paramagnetic response remains symmetry allowed as seen by applying branching representation theory. This example can be verified using a simple model of two electrons in two orbitals based on MC-SCF calculations. However, the principle is independent of any orbital frameworks and can be generalised using the natural-orbital degeneracy of the wave function. The present IUPAC definition of aromaticity and antiaromaticity, going back to Minkin 168,169 is in agreement with the SPA, but it is not explicitly taken into account.</p>
        <p>Hu ¨ckel-antiaromatic molecules have often a broken 4-or 8fold symmetry. The irreducible representations of the ground state and the lowest excited state or even the irreducible representations of the highest-occupied molecular orbital (HOMO) and the lowest-unoccupied molecular orbital (LUMO) are related via a 901 rotation around the highest symmetry axis of the point group. Antiaromatic molecules become stable with respect to a (secondorder) pseudo-Jahn-Teller distortion by exerting this distortion and thereby breaking the point-group symmetry of the ring. Too large distortions result in a weaker paramagnetic response, since the rotational relation between the ground and the excited state or in many cases between the HOMO and LUMO is weakened leading to a wider energy gap and a smaller angular momentum transition integral. Consequently, antiaromaticity can be observed only when there is a balance between the two effects (distortion for stability and symmetry relation for paramagneticity). Berger and Viel suggested that antiaromaticity can be defined via the SPA as the presence of such a balance. 170</p>
        <p>The magnetisability can be written as a sum-over-state expression where it is formally divided into gauge-dependent negative diamagnetic (w dia ) and paramagnetic (w para ) contributions. 16,97,101,172,173 The magnetisability is then given by</p>
        <p>The first term in eqn ( 68) is the diamagnetic contribution, which is always negative and depends only on the ground-state wave function. The second term is the paramagnetic contribution, which can be positive or negative depending on the direction of the flux of the magnetically induced current density susceptibility. Paratropic current densities result in positive contributions to the magnetisability. The diamagnetic contribution generally dominates, leading to a negative total magnetisability that scales nearly linearly with the size of the molecule, which is known as Pascal's rule. 174 Ring-shaped molecules with a strong paratropic ring current whose radius is large may have a large contribution to the magnetisability leading to an overall positive magnetisability and paramagnetism. [90][91][92][93][94]96,97,175,176 Calculations on antiaromatic porphyrinoids showed that they are closed-shell paramagnetic molecules when the strength of the paratropic ring-current susceptibility exceeds about À20 nA T À1 . 97 The same condition holds for molecules consisting of several fused porphyrin rings. The paratropic current density must be large as in strongly antiromatic molecules in order to yield a paramagnetic contribution to the magnetisability that is larger in absolute value than the diamagnetic contribution, which increases nearly linearly with the number of atoms. 174 Furthermore, the external magnetic field induces ring currents only when it has a vector component perpendicular to the ring, whereas experimental magnetisabilities, which are obtained as the trace of the magnetisability tensor, have contributions for all directions of the external magnetic field. Alternatively, significant positive paramagnetic contributions to the magnetisability can be obtained for ring-shaped molecules with a large radius such as expanded porphyrins and porphyrin nanowheels, when they sustain a paratropic ring-current susceptibility in the presence of an external magnetic field. 96,97</p>
        <p>Calculations at the Hu ¨ckel level of theory suggest that singly Mo ¨bius-twisted conjugated molecular rings with 4n p electrons are aromatic closed-shell molecules. 146 Singly twisted molecular rings with (4n + 2) p electrons are analogously expected to be antiaromatic. The Hu ¨ckel Hamiltonian for arbitrary number of half-twists shows that the aromaticity and antiaromaticity rules can be extended to molecules with multiple twists around the molecular ring. 177 Details about the aromatic character of twisted molecules can be determined by performing calculations at DFT and ab initio levels of theory. 147,148,178 Twisted molecular rings are characterised by their linking number, L k , consisting of twist, T w , and writhe, W r . The twist is a local property of the molecular skeleton that is obtained by integrating all the local rotation angles around the ring. The writhe is the deformation of the molecule as a whole in 3D. It tells how deformation of the ring can reduce the local twisting. L k and W r are non-local properties which can be obtained by a double path integration around the ring. 148,[179][180][181][182] For a closed loop, it holds that L k = T w + W r . A singly twisted molecular ring has an L k value of AE1p, where p is often omitted for simplicity. The trans-C 40 H 40 structures in Fig. 7(a andb) are constructed using L k = 0 and T w = ÀW r where T w = 0 and T w = 1.5, respectively. The L k value can be positive or negative. Molecular rings with the same absolute value of L k have the same structure but their chirality differs. Molecular rings with odd L k values are one-sided, whereas those with even L k values including zero have two sides. For all rings with even L k values, the aromatic character follows Hu ¨ckel's (4n + 2) p-electron counting rule, and with 4n p electrons, the ring is antiaromatic. 141,183 The opposite rules hold for all rings with odd L k values.</p>
        <p>The external magnetic field in the calculations of the magnetically induced ring current in the trans-C 40 H 40 structures was set to be perpendicular to the maximum projection of the molecular ring, as the induced flux of J B is expected to be strongest in that orientation. The calculations showed that the largest ring current is obtained for rings with T w = L k and W r = 0, 162 even though rings with the smallest T w value are expected to have the largest p-electron delocalisation. 148 Molecular rings with large W r values have, though, a small projection area perpendicularly to any orientation of the external magnetic field, leading to a weaker ring current. When the magnetic field is perpendicular to the trans-C 40 H 40 ring in Fig. 7(b), it does not sustain any ring current due to the conflicting situation of the ring currents of the two loops, whereas with the magnetic field oriented from above in Fig. 7(b), the elliptical cross section of the ring is much smaller than in Fig. 7(a). 162 The aromaticity rules of twisted molecules also hold for more complicated molecules like expanded porphyrinoids. [184][185][186][187][188][189][190] Singly twisted hexaphyrins were shown to be aromatic, formally with 4n p electrons, and antiaromatic with (4n + 2) p electrons. 184,191 Analogously, doubly twisted hexaphyrins obey the ordinary Hu ¨ckel rule for aromaticity and antiaromaticity. 158,184,[191][192][193] The general aromaticity rules for closed-shell molecular rings state that evenly twisted molecular ring are aromatic when they have 4n + 2 p electrons and antiaromatic when the number of p electrons is 4n. For oddly twisted closed-shell molecular rings, the opposite aromaticity rules holds. For openshell molecules in the triplet state, the aromaticity rules are again reversed. 143</p>
        <p>Toroidal molecules are a topological object with one hole. Thus, according to Euler's law they have genus 1. 164,194,195 A torus can be described by two radii, the big radius, R T , of the hole in the middle of the torus, and the small radius, r T , of the cross-section of the torus. A toroidal molecule can be constructed formally by twisting a carbon nanotube (CNT), so that its two ends meet, [196][197][198] or the molecular structure can be more sparse. 164,199,200 In some cases, the molecular structure of toroidal molecules is helical, leading to chirality, since the helix can be left-or right-handed.</p>
        <p>An external magnetic field along the main axis of a chiral toroidal molecule may induce a current density that has a flux component along the ring of the tube (characterised by R T ) and another component around the small radius of the tube, leading to an induced magnetic field inside the tube of the torus without a north and a south pole. Due to the helical structure of molecule, the current density around the tube flows in opposite directions for the two enantiomers, leading to opposite directions of the induced magnetic field along the centerline of the tube. The corresponding anapole moment (toroidal dipole moment) also points in opposite directions along the symmetry axis. [199][200][201][202][203][204][205][206][207][208][209] The difference in the magnetically induced current densities and the induced magnetic fields can also affect the properties of the two enantiomers in different ways when they are exposed to magnetic fields. For example, in a non-uniform magnetic field, the magnetically induced anapole moment can lead to an energy difference between the two enantiomers. 209 For a nonuniform external magnetic field, the magnetic contribution to the molecular energy as a function of the magnetic field strength and the spatial changes in the strength of the magnetic field is</p>
        <p>where B is a uniform contribution to the magnetic field, C = r Â B NU is the curl of the non-uniform contribution to the magnetic field, a is the anapole moment, v is the magnetisability (magnetic susceptibility) tensor, M is the mixed anapole susceptibility tensor, and A is the anapole susceptibility tensor. 209 The magnetic dipole moment, l O , at the gauge origin O is obtained from the probability current density, j(r), as</p>
        <p>where r O = r À O. The non-uniform magnetic field can be parameterised as 209</p>
        <p>where b is a 3 Â 3 tensor whose elements contain the magnetic field gradients, r h = r À h is the spatial position relative to the reference point h. By setting the symmetric part of b to zero, B total (r) and the corresponding vector potential can be written as</p>
        <p>and</p>
        <p>The magnetic field given in eqn ( 72) is the curl of the vector potential in eqn (73).</p>
        <p>The current density expression for the anapole moment at the reference point h is 209</p>
        <p>Alternative expressions for calculating the anapole moment can be found in ref. 204 and 206. This is still a rather unexplored research area where the topology of toroidal and chiral molecules might lead to unusual properties and even cause energy differences between enantiomers when the molecules are exposed to non-uniform magnetic fields.</p>
        <p>The magnetically induced current density is the fingerprint of the molecular magnetic response. It is as fundamental as the electron density, providing contributions to magnetic properties such as nuclear magnetic resonance (NMR) shieldings, magnetisabilities etc. Numerical integration of magnetic property densities in atomic domains yields the atomic contributions to these properties. Spatial contributions from individual canonical orbitals to magnetic properties can also be obtained by scrutinising orbital magnetic property densities. The approach can be extended to spin-current densities, enabling similar studies of electronic paramagnetic resonance (EPR) spectroscopy parameters and other spin-current-density dependent molecular properties. Spatial contributions to spin-orbit coupling effects in heavy-element compounds can be obtained by performing current-density calculations at relativistic levels of theory. The numerical integration approach also opens the avenue towards calculations of novel magnetic properties that are difficult to compute using analytic gradient theory. The degree of molecular aromaticity, the ring-current pathways and the extent of electron delocalisation can be determined by integrating the strength of the magnetically induced currentdensity susceptibility passing selected chemical bonds. Qualitative information about the current-density flux can be obtained using advanced methods of visualisation of current densities and magnetic property densities. Additional information about the journal is © The Royal Society Chemistry 2021 current-density flux can be obtained by separating diatropic and paratropic current densities and analysing them separately. The tropicity of the current density in each point in space can be identified only by following the closed loops of the flux, i.e., streamlines.</p>
        <p>Calculation and interpretation of magnetically induced current densities is an active research field with lots of new possibilities to obtain information about molecular magnetic properties and to understand the molecular behaviour in the presence of magnetic fields. Qualitative information can be obtained from the topology of the current density. Grouptheoretical considerations provide suggestions about the origin of the diamagnetic and the paramagnetic response in symmetric molecules. An exact qualitative and an approximate quantitative relation between the topology of the electron density and the topology of the magnetically induced current density might exist and is being investigated. The symmetry principle of antiaromaticity might be generalised to aromatic compounds and extended to a fully relativistic treatment.</p>
        <p>This journal is © The Royal Society of Chemistry 2021</p>
        <p>This work has been supported by the Academy of Finland through project number 314821, by the Magnus Ehrnrooth Foundation, the Finnish Cultural Foundation, the Swedish Cultural Foundation in Finland and by the DFG (German Research Foundation) in the Priority Program SPP1807 ''Control of LD in molecular chemistry'', BE4632/2-2. We acknowledge computational resources from the Finnish Grid and Cloud Infrastructure (persistent identifier urn:nbn:fi:research-infras-2016072533) and the CSC -IT Center for Science, Finland. The authors thank Dr Stanislav Komorovsky (Slovak Academy of Sciences/Bratislava) for discussions.</p>
        <p>There are no conflicts to declare.</p>
    </text>
</tei>
