<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-14T07:01+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>There is an increasing interest and research effort focused on the analysis, design and implementation of distributed control systems for AC, DC and hybrid AC/DC microgrids. It is claimed that distributed controllers have several advantages over centralised control schemes, e.g., improved reliability, flexibility, controllability, black start operation, robustness to failure in the communication links, etc. In this work, an overview of the state-of-the-art of distributed cooperative control systems for isolated microgrids is presented. Protocols for cooperative control such as linear consensus, heterogeneous consensus and finitetime consensus are discussed and reviewed in this paper. Distributed cooperative algorithms for primary and secondary control systems, including (among others issues) virtual impedance, synthetic inertia, droopfree control, stability analysis, imbalance sharing, total harmonic distortion regulation, are also reviewed and discussed in this survey. Tertiary control systems, e.g., for economic dispatch of electric energy, based on cooperative control approaches, are also addressed in this work. This review also highlights existing issues, research challenges and future trends in distributed cooperative control of microgrids and their future applications.There is an increasing interest and research effort focused on the analysis, design and implementation of distributed control systems for AC, DC and hybrid AC/DC microgrids. It is claimed that distributed controllers have several advantages over centralised control schemes, e.g., improved reliability, flexibility, controllability, black start operation, robustness to failure in the communication links, etc. In this work, an overview of the state-of-the-art of distributed cooperative control systems for isolated microgrids is presented. Protocols for cooperative control such as linear consensus, heterogeneous consensus and finitetime consensus are discussed and reviewed in this paper. Distributed cooperative algorithms for primary and secondary control systems, including (among others issues) virtual impedance, synthetic inertia, droopfree control, stability analysis, imbalance sharing, total harmonic distortion regulation, are also reviewed and discussed in this survey. Tertiary control systems, e.g., for economic dispatch of electric energy, based on cooperative control approaches, are also addressed in this work. This review also highlights existing issues, research challenges and future trends in distributed cooperative control of microgrids and their future applications.</p>
        <p>A MicroGrid (MG) (consisting of small-scale emerging generators, loads, energy storage elements and a control unit) is a controlled small-scale power system that can be operated in an islanded and/or grid-connected mode in a defined area to facilitate the provision of supplementary power and/or maintain a standard service (see [1]). MGs are becoming increasingly popular considering their efficiency, reliability, flexibility and expandability [2]- [4]. They could use alternate or direct current energy (i.e., AC or DC) or even a hybrid topology where power sources and loads of both AC and DC nature could be considered. The MG topologies considered in this work are shown in Figs. 123.A MicroGrid (MG) (consisting of small-scale emerging generators, loads, energy storage elements and a control unit) is a controlled small-scale power system that can be operated in an islanded and/or grid-connected mode in a defined area to facilitate the provision of supplementary power and/or maintain a standard service (see [1]). MGs are becoming increasingly popular considering their efficiency, reliability, flexibility and expandability [2]- [4]. They could use alternate or direct current energy (i.e., AC or DC) or even a hybrid topology where power sources and loads of both AC and DC nature could be considered. The MG topologies considered in this work are shown in Figs. 123.</p>
        <p>In the initial development stages, most of the research was focused on AC-MGs [5], which still are the most important topologies. However, DC-MGs have been recently proposed considering that a significant fraction of modern loads is of DC nature rather than AC, e.g., power electronics, heating, variable speed drives, etc. (see [6]- [9]). Therefore, forming DC-MGs could be more efficient in some cases because a reduced number of conversion stages is required. As reported in [10], depending on the number of power conversion stages, conversion losses could represent as much as 5%-15% of the total power generation. Additionally, issues related to synchronisation, harmonic distortion, reactive power, etc., are eliminated or alleviated when DC-MGs are used.In the initial development stages, most of the research was focused on AC-MGs [5], which still are the most important topologies. However, DC-MGs have been recently proposed considering that a significant fraction of modern loads is of DC nature rather than AC, e.g., power electronics, heating, variable speed drives, etc. (see [6]- [9]). Therefore, forming DC-MGs could be more efficient in some cases because a reduced number of conversion stages is required. As reported in [10], depending on the number of power conversion stages, conversion losses could represent as much as 5%-15% of the total power generation. Additionally, issues related to synchronisation, harmonic distortion, reactive power, etc., are eliminated or alleviated when DC-MGs are used.</p>
        <p>In recent years, several surveys have been presented in the literature, addressing the main characteristics of MGs. In this work, some of these recent reviews are briefly discussed, and the main differences with this survey are highlighted. Finally, Table 1 presents a summary of the reviewed papers.In recent years, several surveys have been presented in the literature, addressing the main characteristics of MGs. In this work, some of these recent reviews are briefly discussed, and the main differences with this survey are highlighted. Finally, Table 1 presents a summary of the reviewed papers.</p>
        <p>In [11], the authors extensively discuss the control systems usually used to implement the inner control loops, analysing the typical controllers utilised for the control of power-converter based distributed energy resources (i.e., PIs, resonant controllers, repetitive controllers, etc.). The primary control systems based on communication-less approaches are also discussed in [11]; however, an extensive discussion of consensus-based control for MGs and distributed control systems are not considered in this paper. The work presented in [12] is similar to that discussed in [11]. The focus of the work is mainly on the inner control and primary control systems, with some discussion of tertiary control algorithms. Neither distributed cooperative control nor consensus theory is addressed in [11], [12].In [11], the authors extensively discuss the control systems usually used to implement the inner control loops, analysing the typical controllers utilised for the control of power-converter based distributed energy resources (i.e., PIs, resonant controllers, repetitive controllers, etc.). The primary control systems based on communication-less approaches are also discussed in [11]; however, an extensive discussion of consensus-based control for MGs and distributed control systems are not considered in this paper. The work presented in [12] is similar to that discussed in [11]. The focus of the work is mainly on the inner control and primary control systems, with some discussion of tertiary control algorithms. Neither distributed cooperative control nor consensus theory is addressed in [11], [12].</p>
        <p>The work presented in [13] extensively discusses hierarchical control systems for MGs installed in buildings. The paper barely addresses distributed control systems, and consensus theory is not formally presented. Moreover, there are some features of MG for buildings, e.g. to utilise (typically) only one energy storage system, which makes difficult to generalise the conclusions obtained in that paper to, for instance, a DC-MG and/or a hybrid AC/DC-MG.The work presented in [13] extensively discusses hierarchical control systems for MGs installed in buildings. The paper barely addresses distributed control systems, and consensus theory is not formally presented. Moreover, there are some features of MG for buildings, e.g. to utilise (typically) only one energy storage system, which makes difficult to generalise the conclusions obtained in that paper to, for instance, a DC-MG and/or a hybrid AC/DC-MG.</p>
        <p>In [14], the problems produced in MGs by the low inertia of power converters are extensively discussed, and several solutions are proposed. Between the solutions analysed are inertia emulation (synthetic inertia), inducverter, Synchronverter, Virtual synchronous machines, inertia emulation for wind turbines, etc. Nevertheless, most of the control diagrams are implemented in a decentralised manner, and no distributed multi-agent control is discussed in that paper.In [14], the problems produced in MGs by the low inertia of power converters are extensively discussed, and several solutions are proposed. Between the solutions analysed are inertia emulation (synthetic inertia), inducverter, Synchronverter, Virtual synchronous machines, inertia emulation for wind turbines, etc. Nevertheless, most of the control diagrams are implemented in a decentralised manner, and no distributed multi-agent control is discussed in that paper.</p>
        <p>Distributed control overviews have been presented in the literature [15]- [17]. A survey of distributed control algorithms is presented in [15] and [16], where the benefits of the distributed control approach are highlighted, and the most recent research efforts are illustrated. However, these works do not cover important topics such as virtual impedance or synthetic inertia. On the other hand, in [17], a comprehensive overview of multi-agent based distributed control systems applied to MGs and MG clusters (MGCs) is presented. In this work, a summary of the mathematical models and the topology models for Multi-Agent Systems (MAS) is depicted. The authors develop a revision of MAS-based consensus protocols, including the strategies utilised to compensate for communication delay issues. Nevertheless, none of these works address the implementation of distributed control schemes for DC-MGs or hybrid AC/DC-MGs, since they only focus on distributed control strategies for AC-MGs.Distributed control overviews have been presented in the literature [15]- [17]. A survey of distributed control algorithms is presented in [15] and [16], where the benefits of the distributed control approach are highlighted, and the most recent research efforts are illustrated. However, these works do not cover important topics such as virtual impedance or synthetic inertia. On the other hand, in [17], a comprehensive overview of multi-agent based distributed control systems applied to MGs and MG clusters (MGCs) is presented. In this work, a summary of the mathematical models and the topology models for Multi-Agent Systems (MAS) is depicted. The authors develop a revision of MAS-based consensus protocols, including the strategies utilised to compensate for communication delay issues. Nevertheless, none of these works address the implementation of distributed control schemes for DC-MGs or hybrid AC/DC-MGs, since they only focus on distributed control strategies for AC-MGs.</p>
        <p>In [18] and [19], the authors review several papers addressing tertiary control in MGs. In [18], a literature survey of MG supervisory controllers (MGSC) and Energy Management Systems (EMS) are presented, discussing centralised and decentralised approaches. However, distributed tertiary control approaches are not considered. In [19], a discussion of the control layers typically used for AC-MGs is presented. However, distributed control methodologies for economic dispatch are neither presented nor analysed in [19]. On the other hand, distribute control methods for economic dispatch of electrical energy in MGs are discussed in Section V of this work.In [18] and [19], the authors review several papers addressing tertiary control in MGs. In [18], a literature survey of MG supervisory controllers (MGSC) and Energy Management Systems (EMS) are presented, discussing centralised and decentralised approaches. However, distributed tertiary control approaches are not considered. In [19], a discussion of the control layers typically used for AC-MGs is presented. However, distributed control methodologies for economic dispatch are neither presented nor analysed in [19]. On the other hand, distribute control methods for economic dispatch of electrical energy in MGs are discussed in Section V of this work.</p>
        <p>In [20], an overview of the main decentralised control schemes for improving power quality and managing energy storage systems in MGs is reported. However, this work neither discusses distributed control approaches nor consensus theory. Recently, in [21], [22], overviews of control strategies for improving the power quality in AC/DC-MGs by coordinating power converters from distributed energy resources are presented. However, these papers are mainly focused on the primary control level. On the other hand, in this paper, primary and secondary distributed control of power quality issues are discussed in Section III and IV.In [20], an overview of the main decentralised control schemes for improving power quality and managing energy storage systems in MGs is reported. However, this work neither discusses distributed control approaches nor consensus theory. Recently, in [21], [22], overviews of control strategies for improving the power quality in AC/DC-MGs by coordinating power converters from distributed energy resources are presented. However, these papers are mainly focused on the primary control level. On the other hand, in this paper, primary and secondary distributed control of power quality issues are discussed in Section III and IV.</p>
        <p>The authors in [23] review the utilisation of virtual impedances for active damping, power flow control (active and reactive power); compensation of harmonics and imbalance; and fault control. The paper discusses several applications, as for instance, control of the inrush current of transformers, non-linear and unbalanced load sharing, etc. However, consensus control of virtual impedances is barely addressed. On the other hand, this issue is discussed in this paper in Section III.B.The authors in [23] review the utilisation of virtual impedances for active damping, power flow control (active and reactive power); compensation of harmonics and imbalance; and fault control. The paper discusses several applications, as for instance, control of the inrush current of transformers, non-linear and unbalanced load sharing, etc. However, consensus control of virtual impedances is barely addressed. On the other hand, this issue is discussed in this paper in Section III.B.</p>
        <p>Concerning DC-MGs, in [24], [25], an overall description of stability analysis and different topologies of control strategies is realised. Regarding the control strategies, both reviews distinguished between decentralised, centralised and distributed control systems. In [24], relevant conclusions are made for the performance of reported stability analyses and stabilisation techniques. The review presented in [25] focuses on a wider range of topics related to DC-MGs, such as protection systems, plug and play issues and MG topologies (including multimicrogrid DC clusters). Another review, the work in [26], presents an overview of control strategies for DC-MGs and DC multi-microgrid clusters. This paper reviews communication issues in the controllers used for voltage restoration and power management. Particularly, delay compensation techniques for distributed control are discussed. Although these reviews [24]- [26] cover the main distributed control proposals for DC-MGs published in the literature, they do not discuss recent proposals, such as distributed virtual impedance controllers, finite-time control and robust consensus protocols.Concerning DC-MGs, in [24], [25], an overall description of stability analysis and different topologies of control strategies is realised. Regarding the control strategies, both reviews distinguished between decentralised, centralised and distributed control systems. In [24], relevant conclusions are made for the performance of reported stability analyses and stabilisation techniques. The review presented in [25] focuses on a wider range of topics related to DC-MGs, such as protection systems, plug and play issues and MG topologies (including multimicrogrid DC clusters). Another review, the work in [26], presents an overview of control strategies for DC-MGs and DC multi-microgrid clusters. This paper reviews communication issues in the controllers used for voltage restoration and power management. Particularly, delay compensation techniques for distributed control are discussed. Although these reviews [24]- [26] cover the main distributed control proposals for DC-MGs published in the literature, they do not discuss recent proposals, such as distributed virtual impedance controllers, finite-time control and robust consensus protocols.</p>
        <p>The review in [27] brings a comprehensive summary of primary and secondary control techniques applied to DC-MGs. The authors show a detailed comparison between distributed secondary control proposals, including consensus strategies to regulate average voltage, average current and state of charge in energy storage systems. Nonetheless, this paper does not describe consensus protocol improvements nor communication robustness techniques. Tertiary control systems are not discussed in [27].The review in [27] brings a comprehensive summary of primary and secondary control techniques applied to DC-MGs. The authors show a detailed comparison between distributed secondary control proposals, including consensus strategies to regulate average voltage, average current and state of charge in energy storage systems. Nonetheless, this paper does not describe consensus protocol improvements nor communication robustness techniques. Tertiary control systems are not discussed in [27].</p>
        <p>In [28], a review of recent literature about distributed control systems applied to DC-MGs is presented. In particular, the authors discuss asymptotic and finite-time consensus protocols. Also, communication problems and their corresponding solutions are addressed. However, [28] does not analyse stability and distributed control algorithms to achieve economic dispatch of electrical energy in MGs are barely mentioned.In [28], a review of recent literature about distributed control systems applied to DC-MGs is presented. In particular, the authors discuss asymptotic and finite-time consensus protocols. Also, communication problems and their corresponding solutions are addressed. However, [28] does not analyse stability and distributed control algorithms to achieve economic dispatch of electrical energy in MGs are barely mentioned.</p>
        <p>A review of control strategies applied to hybrid AC/DC-MGs is presented in [29] and [30]. However, the authors in [29] only address the power management strategies for this kind of MG, and the secondary control is out of the scope of [29]; moreover, distributed control approaches are not considered in this publication.A review of control strategies applied to hybrid AC/DC-MGs is presented in [29] and [30]. However, the authors in [29] only address the power management strategies for this kind of MG, and the secondary control is out of the scope of [29]; moreover, distributed control approaches are not considered in this publication.</p>
        <p>The review in [31] presents a survey of small-signal stability methods in the AC distribution grid, using impedancebased models, implemented in a synchronous reference frame. A comparative analysis of different stability techniques in the time domain is shown. In the same subject, in [32], a review on the small-signal stability of MGs is analysed. In [33], a different approach is shown, where the stability of MGs is examined, presenting a review of Large Signal Lyapunov-Based Stability. However, in these reviews, the stability analysis considering distributed controllers in the MG model is not included. Meanwhile, in this survey, a stability analysis and performance evaluation of MGs under distributed control are included in Section VI.The review in [31] presents a survey of small-signal stability methods in the AC distribution grid, using impedancebased models, implemented in a synchronous reference frame. A comparative analysis of different stability techniques in the time domain is shown. In the same subject, in [32], a review on the small-signal stability of MGs is analysed. In [33], a different approach is shown, where the stability of MGs is examined, presenting a review of Large Signal Lyapunov-Based Stability. However, in these reviews, the stability analysis considering distributed controllers in the MG model is not included. Meanwhile, in this survey, a stability analysis and performance evaluation of MGs under distributed control are included in Section VI.</p>
        <p>In [34], the communications requirements for the operation of MGs are discussed considering the primary, secondary and tertiary control levels. It was noted that the communication network affects more the performance of the secondary level as the design of bandwidth is strongly related to the required transitory response. This work does not consider the detailed description and analysis of distributed control methods nor their stability issues.In [34], the communications requirements for the operation of MGs are discussed considering the primary, secondary and tertiary control levels. It was noted that the communication network affects more the performance of the secondary level as the design of bandwidth is strongly related to the required transitory response. This work does not consider the detailed description and analysis of distributed control methods nor their stability issues.</p>
        <p>A summary of the reviewed works is presented in Table 1 for quick reference. In the present survey, the authors have addressed all the research issues from i to xi (see the definition of these labels at the bottom of Table 1). To the best of our knowledge, this is the first survey where all these issues are reviewed and comprehensively discussed in a single paper.A summary of the reviewed works is presented in Table 1 for quick reference. In the present survey, the authors have addressed all the research issues from i to xi (see the definition of these labels at the bottom of Table 1). To the best of our knowledge, this is the first survey where all these issues are reviewed and comprehensively discussed in a single paper.</p>
        <p>Fig. 1 shows the typical topology for an AC-MG. In this case, the MG is composed of AC-sources and AC-loads interfaced with the MG using power converters if required (e.g. for wind power generation units). DC-sources and DCloads can also be connected to the AC-MG using additional power electronics interfaces, but this, as discussed in [10], may increase the power losses.Fig. 1 shows the typical topology for an AC-MG. In this case, the MG is composed of AC-sources and AC-loads interfaced with the MG using power converters if required (e.g. for wind power generation units). DC-sources and DCloads can also be connected to the AC-MG using additional power electronics interfaces, but this, as discussed in [10], may increase the power losses.</p>
        <p>The operating mode of an AC-MG depends on the status of the Main Breaker (MB) connecting both the AC-bus of the AC-MG and the main grid (see Fig. 1). Therefore, the AC-MG can be operating in the grid-tied (MB closed) or isolated/islanded mode (MB open) from the main grid. During grid-tied mode, the power sources of the AC-MG need to regulate neither the amplitude nor the frequency of the voltage, because the main grid is usually strong enough to maintain these variables controlled (in that case the main grid could be considered as a slack-bus). On the other hand, during islanded-mode, the distributed power sources of the MG require to regulate both the voltage amplitude and frequency, considering both steady-state and transient operations [35].The operating mode of an AC-MG depends on the status of the Main Breaker (MB) connecting both the AC-bus of the AC-MG and the main grid (see Fig. 1). Therefore, the AC-MG can be operating in the grid-tied (MB closed) or isolated/islanded mode (MB open) from the main grid. During grid-tied mode, the power sources of the AC-MG need to regulate neither the amplitude nor the frequency of the voltage, because the main grid is usually strong enough to maintain these variables controlled (in that case the main grid could be considered as a slack-bus). On the other hand, during islanded-mode, the distributed power sources of the MG require to regulate both the voltage amplitude and frequency, considering both steady-state and transient operations [35].</p>
        <p>Fig. 2 shows the typical topology for a DC-MG. In this case, DC-load and DC-generation units are interfaced with the MG using power converters when required. As discussed in several publications [10], [35], [36], DC-MGs are becoming increasingly popular considering, among other reasons, the reduction in the cost of solar panels. Additionally, in a DC-MG, it is possible to connect AC-loads and AC-sources using additional power electronic interfaces.Fig. 2 shows the typical topology for a DC-MG. In this case, DC-load and DC-generation units are interfaced with the MG using power converters when required. As discussed in several publications [10], [35], [36], DC-MGs are becoming increasingly popular considering, among other reasons, the reduction in the cost of solar panels. Additionally, in a DC-MG, it is possible to connect AC-loads and AC-sources using additional power electronic interfaces.</p>
        <p>Finally, a hybrid MG is depicted in Fig. 3. The hybrid MG is composed of DC and AC sub-MGs, and, if a grid is available, a grid interface to seamlessly connect or disconnect the utility to the rest of the system (notice that an AC/DC grid interface could also be located at the DC-MG side). One or several Interlinking converter (ILC) are used for the bidirectional exchange of energy between the AC-DC MGs [29], [37].Finally, a hybrid MG is depicted in Fig. 3. The hybrid MG is composed of DC and AC sub-MGs, and, if a grid is available, a grid interface to seamlessly connect or disconnect the utility to the rest of the system (notice that an AC/DC grid interface could also be located at the DC-MG side). One or several Interlinking converter (ILC) are used for the bidirectional exchange of energy between the AC-DC MGs [29], [37].</p>
        <p>The control system of an AC-MG usually realise three critical functions: (i) control of Distributed Generators, also called Distributed Energy Resources (DERs), (ii) energy management, and (iii) protections of the MG [38]. Although it is possible to operate a MG at medium-voltage levels, its application in low-voltage distribution systems is undoubtedly more common [2], [5], [39], [40]. The hierarchical control system depicted in Fig. 4 is typically utilised to control and manage an AC-MG [2], [41]- [43].The control system of an AC-MG usually realise three critical functions: (i) control of Distributed Generators, also called Distributed Energy Resources (DERs), (ii) energy management, and (iii) protections of the MG [38]. Although it is possible to operate a MG at medium-voltage levels, its application in low-voltage distribution systems is undoubtedly more common [2], [5], [39], [40]. The hierarchical control system depicted in Fig. 4 is typically utilised to control and manage an AC-MG [2], [41]- [43].</p>
        <p>In the hierarchical structure, the control system is split into three main layers: primary, secondary and tertiary control loops (see Fig. 4). The primary control loop is typically implemented using a droop control scheme, which emulates the behaviour of a synchronous machine. The secondary control loop aims to restore secondary variables (e.g. the voltage and frequency) to their nominal values. Finally, in the tertiary control loop, typically, the EMS is implemented with the purpose of achieving optimal operation in the MG as well as congestion management [44]. Additionally, at the lowest level, an internal (inner) control loop is usually implemented to regulate the currents and voltages at the input/output of the power converters located along with the MG [45]- [47]. The latter is usually called zero control level, and it is typically implemented using resonant controllers [48]- [51], controllers implemented in a synchronous rotating d-q frame [52], [53], predictive controllers [54], [55], etc.In the hierarchical structure, the control system is split into three main layers: primary, secondary and tertiary control loops (see Fig. 4). The primary control loop is typically implemented using a droop control scheme, which emulates the behaviour of a synchronous machine. The secondary control loop aims to restore secondary variables (e.g. the voltage and frequency) to their nominal values. Finally, in the tertiary control loop, typically, the EMS is implemented with the purpose of achieving optimal operation in the MG as well as congestion management [44]. Additionally, at the lowest level, an internal (inner) control loop is usually implemented to regulate the currents and voltages at the input/output of the power converters located along with the MG [45]- [47]. The latter is usually called zero control level, and it is typically implemented using resonant controllers [48]- [51], controllers implemented in a synchronous rotating d-q frame [52], [53], predictive controllers [54], [55], etc.</p>
        <p>Notice that the hierarchical control system depicted in Fig. 4 is also applicable to a DC-MG (or even a hybrid-MG) by eliminating/adding control goals in each layer (e.g. removing frequency control in a DC-MG).Notice that the hierarchical control system depicted in Fig. 4 is also applicable to a DC-MG (or even a hybrid-MG) by eliminating/adding control goals in each layer (e.g. removing frequency control in a DC-MG).</p>
        <p>Regarding the implementation of each control layer (see Fig. 4), for any of the MG topologies discussed in this work (which are shown in Figs. 123), three implementation methodologies could be applied. These are based on centralised, distributed and decentralised (see Fig. 5) topologies. A brief discussion of each implementation methodology is shown below:Regarding the implementation of each control layer (see Fig. 4), for any of the MG topologies discussed in this work (which are shown in Figs. 123), three implementation methodologies could be applied. These are based on centralised, distributed and decentralised (see Fig. 5) topologies. A brief discussion of each implementation methodology is shown below:</p>
        <p>• Centralised Control: In this case, the MG requires a central controller that communicates with all the DERs in the MG [see Fig. 5(a)]. The central controller has to have the capacity to process all the information transmitted from the other elements in the MG. Centralised controllers are not considered very robust [2], [5], [17], [35], [56] and this is further discussed in the next section. • Distributed Control: In this case, the centralised controller is not necessary [see Fig. 5(b)] because the control effort is distributed along with the MG, with autonomous "agents" operating in a cooperative way to obtain global objectives [56]- [58]. Distributed control systems enhance the scalability of the MG, improving the robustness of the system to single-point faults [17], [59]. • Decentralised Control: In this case, the control system of each DER unit (agent) is implemented utilising local measurements only (see Fig. 5(c)). The control methodologies are usually based on V -Q and f -P droops [41], [59], [60]. By using droop controllers, the MG load is shared between the Distributed Generation (DG) units according to their power capabilities through a physical link [59]. Notice that this methodology lacks communication channels [see Fig 5(c)], and this certainly makes challenging to implement secondary and tertiary control systems. However, some approaches, as the utilisation of high-pass "wash-out" filters have been proposed in the literature [61], [62].• Centralised Control: In this case, the MG requires a central controller that communicates with all the DERs in the MG [see Fig. 5(a)]. The central controller has to have the capacity to process all the information transmitted from the other elements in the MG. Centralised controllers are not considered very robust [2], [5], [17], [35], [56] and this is further discussed in the next section. • Distributed Control: In this case, the centralised controller is not necessary [see Fig. 5(b)] because the control effort is distributed along with the MG, with autonomous "agents" operating in a cooperative way to obtain global objectives [56]- [58]. Distributed control systems enhance the scalability of the MG, improving the robustness of the system to single-point faults [17], [59]. • Decentralised Control: In this case, the control system of each DER unit (agent) is implemented utilising local measurements only (see Fig. 5(c)). The control methodologies are usually based on V -Q and f -P droops [41], [59], [60]. By using droop controllers, the MG load is shared between the Distributed Generation (DG) units according to their power capabilities through a physical link [59]. Notice that this methodology lacks communication channels [see Fig 5(c)], and this certainly makes challenging to implement secondary and tertiary control systems. However, some approaches, as the utilisation of high-pass "wash-out" filters have been proposed in the literature [61], [62].</p>
        <p>It is claimed that the distributed control approach has several advantages over the other two methods [15], [56], [63]- [65]. These advantages are further discussed in the next section. The rest of this paper is organised as follows: in Section II, a brief review of distributed control approaches is presented as well as a comparison of the performance of distributed control systems with that obtained from other approaches. In Section III, the implementation of the primary control layer using methodologies based on distributed control systems is discussed. Notice that, in Sections III-V, the proposals are classified according to the type of MG studied, i.e., AC, DC and hybrid MGs. Section IV presents some distributed control schemes proposed for the secondary con-trol level. In Section V, distributed control schemes for the tertiary control level are reported and discussed. Section VI discussed stability issues including small signal analysis. In Section VII future trends, in the field of distributed control schemes for MGs, are presented. Finally, Section VIII provides the conclusions of this paper.It is claimed that the distributed control approach has several advantages over the other two methods [15], [56], [63]- [65]. These advantages are further discussed in the next section. The rest of this paper is organised as follows: in Section II, a brief review of distributed control approaches is presented as well as a comparison of the performance of distributed control systems with that obtained from other approaches. In Section III, the implementation of the primary control layer using methodologies based on distributed control systems is discussed. Notice that, in Sections III-V, the proposals are classified according to the type of MG studied, i.e., AC, DC and hybrid MGs. Section IV presents some distributed control schemes proposed for the secondary con-trol level. In Section V, distributed control schemes for the tertiary control level are reported and discussed. Section VI discussed stability issues including small signal analysis. In Section VII future trends, in the field of distributed control schemes for MGs, are presented. Finally, Section VIII provides the conclusions of this paper.</p>
        <p>Typically, secondary and tertiary control levels of MGs have been implemented using centralised topologies (see Fig. 5.a) because they require measurements of all DERs in the MG to achieve the control goals [2] [43]. However, recent advances in distributed control theory have made possible implementing these control layers with higher levels of reliability and security [15]. Besides, the distributed communication archi- tecture is sparse and based on local controllers, which fulfils an essential part in the control and coordination of DERs to achieve global goals during MG operation. The main advantages of distributed control systems for MG applications can be summarised as follows:Typically, secondary and tertiary control levels of MGs have been implemented using centralised topologies (see Fig. 5.a) because they require measurements of all DERs in the MG to achieve the control goals [2] [43]. However, recent advances in distributed control theory have made possible implementing these control layers with higher levels of reliability and security [15]. Besides, the distributed communication archi- tecture is sparse and based on local controllers, which fulfils an essential part in the control and coordination of DERs to achieve global goals during MG operation. The main advantages of distributed control systems for MG applications can be summarised as follows:</p>
        <p>• Robustness: If a fault is produced (e.g. in a controller or communication link), it is not going to produce a catastrophic failure in the MG. On the other hand, in the centralised approach, the central controller is a common point of failure. [15], [66]. • Scalability: It is a flexible control approach. Therefore it is simpler to realise changes in the MG, for instance, adding DERs, Battery Energy Storage Systems (BESS), loads, without affecting much the operation of the other elements of the MGs [66]. • It allows plug-and-play operation of DERs, which is an attractive feature for MGs [66].• Robustness: If a fault is produced (e.g. in a controller or communication link), it is not going to produce a catastrophic failure in the MG. On the other hand, in the centralised approach, the central controller is a common point of failure. [15], [66]. • Scalability: It is a flexible control approach. Therefore it is simpler to realise changes in the MG, for instance, adding DERs, Battery Energy Storage Systems (BESS), loads, without affecting much the operation of the other elements of the MGs [66]. • It allows plug-and-play operation of DERs, which is an attractive feature for MGs [66].</p>
        <p>The application on MGs of distributed control algorithms was first suggested in the middle of the 2000s [67], [68]. In [67], possible developments of agent control for energy markets were discussed, whereas, in [68], the authors developed a strategy combining a centralised controller with the actions of distributed local controllers. Since then, there is a discussion about what type of control strategy -centralised or distributed-is more appropriate for MG applications. A comparative summary of the characteristics of centralised and distributed control topologies are presented in Table 2 (see [15], [17], [66], [69]- [71]). Based on information depicted in this table, it can be concluded that the distributed approach has the following advantages over the centralised one: It improves reliability and robustness, allows flexibility and scalability, including plug-and-play operation.The application on MGs of distributed control algorithms was first suggested in the middle of the 2000s [67], [68]. In [67], possible developments of agent control for energy markets were discussed, whereas, in [68], the authors developed a strategy combining a centralised controller with the actions of distributed local controllers. Since then, there is a discussion about what type of control strategy -centralised or distributed-is more appropriate for MG applications. A comparative summary of the characteristics of centralised and distributed control topologies are presented in Table 2 (see [15], [17], [66], [69]- [71]). Based on information depicted in this table, it can be concluded that the distributed approach has the following advantages over the centralised one: It improves reliability and robustness, allows flexibility and scalability, including plug-and-play operation.</p>
        <p>As mentioned earlier, communication between units is the key to distributed control and a vital component of smartgrids development [73]. Further details about communication between units are discussed in the next subsections.As mentioned earlier, communication between units is the key to distributed control and a vital component of smartgrids development [73]. Further details about communication between units are discussed in the next subsections.</p>
        <p>The communication links between units (e.g. DERs) could be regarded as a graph [74]- [76]. The graph can be expressed as G = (V, E, A), where V = {v 1 , v 2 , . . . , v n } represent the agents or nodes; E = {(v i , v j )} /(i, j ∈ V ) denotes the communications links; A = [a ij ] n×n is the adjacency matrix whose entry a ij stands for a connection weight. The relationship (v i , v j ) ∈ E ⇔ a ij &gt; 0 implies that nodes "i" and "j" have a communication path between them; otherwise, a ij = 0. The set of neighbours of the i-th node is given by N i = {v j / (j ∈ V ) ∧ ((i, j) ∈ E)} where j represents communicated agents. For instance, the graph and its adjacency matrix for four agents are presented in Fig. 6.The communication links between units (e.g. DERs) could be regarded as a graph [74]- [76]. The graph can be expressed as G = (V, E, A), where V = {v 1 , v 2 , . . . , v n } represent the agents or nodes; E = {(v i , v j )} /(i, j ∈ V ) denotes the communications links; A = [a ij ] n×n is the adjacency matrix whose entry a ij stands for a connection weight. The relationship (v i , v j ) ∈ E ⇔ a ij &gt; 0 implies that nodes "i" and "j" have a communication path between them; otherwise, a ij = 0. The set of neighbours of the i-th node is given by N i = {v j / (j ∈ V ) ∧ ((i, j) ∈ E)} where j represents communicated agents. For instance, the graph and its adjacency matrix for four agents are presented in Fig. 6.</p>
        <p>The adjacency matrix is useful for analysing the communication topology; its weights coefficients, a ij , could be utilised to assess the stability of the MG. Furthermore, techniques have been developed based on the adaptive adjustment of the adjacency matrix to improve the convergence and stability of the graph [77]. To analyse the graphs, a matrix known as a Laplacian matrix is utilised. This matrix is defined asThe adjacency matrix is useful for analysing the communication topology; its weights coefficients, a ij , could be utilised to assess the stability of the MG. Furthermore, techniques have been developed based on the adaptive adjustment of the adjacency matrix to improve the convergence and stability of the graph [77]. To analyse the graphs, a matrix known as a Laplacian matrix is utilised. This matrix is defined as</p>
        <p>The sum of the elements located in each row of L is equal to zero and, when the graph has a bidirectional flow of information between agents (i.e. G is balanced), the addition of all the elements located in each column of L is equal to zero.The sum of the elements located in each row of L is equal to zero and, when the graph has a bidirectional flow of information between agents (i.e. G is balanced), the addition of all the elements located in each column of L is equal to zero.</p>
        <p>A necessary condition for stability is that the A matrix The distributed optimal dispatch requires long computational does not require solving an times, to solve the optimisation optimisation problem [72]. problem.A necessary condition for stability is that the A matrix The distributed optimal dispatch requires long computational does not require solving an times, to solve the optimisation optimisation problem [72]. problem.</p>
        <p>Complex algorithms Easy and straightforward to design and implement as it only handles local information has to have a spanning tree, i.e., there is a path from any single node to any other one in the communication graph. The convergence speed of the states is related to the eigenvalues of the Laplacian matrix and depends, at the same time, on the algorithms (or protocols) used by each agent [75], [76]. The next subsection will introduce some basic concepts related to the algorithms typically used to achieve convergence in distributed control systems.Complex algorithms Easy and straightforward to design and implement as it only handles local information has to have a spanning tree, i.e., there is a path from any single node to any other one in the communication graph. The convergence speed of the states is related to the eigenvalues of the Laplacian matrix and depends, at the same time, on the algorithms (or protocols) used by each agent [75], [76]. The next subsection will introduce some basic concepts related to the algorithms typically used to achieve convergence in distributed control systems.</p>
        <p>The research over distributed control theory has developed three main approaches [15], [16], [30], [78]: Cooperative Control, which is based on the consensus theory (or synchronisation) of Multi-Agent System (MAS) with defined dynamics [74], [75], [79], [80]. Distributed Optimisation, also known as part of the Decomposition-Based Techniques, which shares information between units to solve local optimisation problems [69], and (Intelligent) Agent Control, which consists of autonomous local agents that perform control actions based on local goals and information from neighbours and environment, usually involving Machine-Learning techniques [81]- [83]. The focus of this paper is MG applications of cooperative and distributed control systems based on MAS theory. Because of simplicity, we are using the generic name of Distributed Control in the rest of this work.The research over distributed control theory has developed three main approaches [15], [16], [30], [78]: Cooperative Control, which is based on the consensus theory (or synchronisation) of Multi-Agent System (MAS) with defined dynamics [74], [75], [79], [80]. Distributed Optimisation, also known as part of the Decomposition-Based Techniques, which shares information between units to solve local optimisation problems [69], and (Intelligent) Agent Control, which consists of autonomous local agents that perform control actions based on local goals and information from neighbours and environment, usually involving Machine-Learning techniques [81]- [83]. The focus of this paper is MG applications of cooperative and distributed control systems based on MAS theory. Because of simplicity, we are using the generic name of Distributed Control in the rest of this work.</p>
        <p>Regarding cooperative control, asymptotic consensus pro-tocols are the defining element for cooperation in MAS.Regarding cooperative control, asymptotic consensus pro-tocols are the defining element for cooperation in MAS.</p>
        <p>They are also the basis on which other techniques and improvements for convergence speed and stability are being developed. Protocols depend on the dynamic model of the system (or process). The most used ones are the first-order and second-order linear models [75], [84]. The application of other types of consensus protocols has also been discussed in the literature [85]- [88], such as second-order consensus [89]- [91], adaptive consensus [92]- [94], consensus with constraints [95], [96], event-triggered consensus [97], [98], finite-time consensus [99], [100], delay-robust consensus, linear consensus protocol [101], [102],heterogeneous consensus [103], [104], non-linear consensus [79], [105]- [107], etc. In Table 3, a summary of some of the protocols discussed in the next sections is presented.They are also the basis on which other techniques and improvements for convergence speed and stability are being developed. Protocols depend on the dynamic model of the system (or process). The most used ones are the first-order and second-order linear models [75], [84]. The application of other types of consensus protocols has also been discussed in the literature [85]- [88], such as second-order consensus [89]- [91], adaptive consensus [92]- [94], consensus with constraints [95], [96], event-triggered consensus [97], [98], finite-time consensus [99], [100], delay-robust consensus, linear consensus protocol [101], [102],heterogeneous consensus [103], [104], non-linear consensus [79], [105]- [107], etc. In Table 3, a summary of some of the protocols discussed in the next sections is presented.</p>
        <p>The conventional first-order linearised consensus can be described as follows: Considering a system in the form ẋ(t) = u(t), with output y = x(t), let x i ∈ R denote the value of some quantity of interest at node i. It is said that the variables x i achieve consensus if x i (t) -x j (t) → 0 as t → ∞. Therefore, the consensus can be achieved via a feedback loop by applying the protocol u i [79] meaning that it is distributed according to the configuration of the communication links. The obtained consensus value is given by the average of initial states x i (0). Conversely to the conventional single-integrator dynamics, [101], [102] formulate the agent dynamics as dependant on the control input u i and the state x i . Matrix representation of such generalised system is given byThe conventional first-order linearised consensus can be described as follows: Considering a system in the form ẋ(t) = u(t), with output y = x(t), let x i ∈ R denote the value of some quantity of interest at node i. It is said that the variables x i achieve consensus if x i (t) -x j (t) → 0 as t → ∞. Therefore, the consensus can be achieved via a feedback loop by applying the protocol u i [79] meaning that it is distributed according to the configuration of the communication links. The obtained consensus value is given by the average of initial states x i (0). Conversely to the conventional single-integrator dynamics, [101], [102] formulate the agent dynamics as dependant on the control input u i and the state x i . Matrix representation of such generalised system is given by</p>
        <p>where X i , U i and Y i are vectors of the state variables, control inputs and control outputs of the i-th agent, respectively. Matrices A, B and C are assumed stabilisable and detectable. Authors in [101] claimed that this generalisation is useful for modelling dynamic systems, performing a dynamic consensus as a linear combination of individual inputs. For instance, by considering a one-dimensional MAS and by following the methodology discussed in [102], authors can construct the following observer-based consensus protocol:where X i , U i and Y i are vectors of the state variables, control inputs and control outputs of the i-th agent, respectively. Matrices A, B and C are assumed stabilisable and detectable. Authors in [101] claimed that this generalisation is useful for modelling dynamic systems, performing a dynamic consensus as a linear combination of individual inputs. For instance, by considering a one-dimensional MAS and by following the methodology discussed in [102], authors can construct the following observer-based consensus protocol:</p>
        <p>where xi and xj are estimated average values. This kind of protocol allows the state to be estimated using only neighbouring measurements. In the literature (see [58], [108]- [110]), authors have applied (2) to depict average voltage observers in MGs (e.g. see Fig. 12). Observers have also been applied to active power [111], incremental cost [112] and State of Charge (SoC) of batteries [113], in distributed control strategies of MGs.where xi and xj are estimated average values. This kind of protocol allows the state to be estimated using only neighbouring measurements. In the literature (see [58], [108]- [110]), authors have applied (2) to depict average voltage observers in MGs (e.g. see Fig. 12). Observers have also been applied to active power [111], incremental cost [112] and State of Charge (SoC) of batteries [113], in distributed control strategies of MGs.</p>
        <p>Heterogeneous consensus is applied in systems where the agents have different dynamics and/or are synchronised utilising different consensus protocols (see [103], [104]). In some publications, this definition is further restricted; for instance, in [103], a heterogeneous multi-agent system is defined as a system composed of agents of first and secondorder consensus protocols, ensuring synchronisation even when the agent dynamics are different. Heterogeneous consensus has been applied to DC-MGs [114] and AC-MGs [115]- [117]. As shown in Table 3, and to the best of the authors' knowledge, a relatively low number of works have applied heterogeneous consensus algorithms for the distributed control of MGs.Heterogeneous consensus is applied in systems where the agents have different dynamics and/or are synchronised utilising different consensus protocols (see [103], [104]). In some publications, this definition is further restricted; for instance, in [103], a heterogeneous multi-agent system is defined as a system composed of agents of first and secondorder consensus protocols, ensuring synchronisation even when the agent dynamics are different. Heterogeneous consensus has been applied to DC-MGs [114] and AC-MGs [115]- [117]. As shown in Table 3, and to the best of the authors' knowledge, a relatively low number of works have applied heterogeneous consensus algorithms for the distributed control of MGs.</p>
        <p>Real MASs have non-linearities that can negatively interfere with linear controller performance. The main sources of nonlinearity in MASs come from the saturation of non-ideal actuators and communication channels [118]. However, in some low voltage applications of MGs, non-linear loads typically based on rectifier diodes, power electronics systems, etc. [119], [120] could introduce the same non-linear effects as harmonic distortion in the voltages and currents.Real MASs have non-linearities that can negatively interfere with linear controller performance. The main sources of nonlinearity in MASs come from the saturation of non-ideal actuators and communication channels [118]. However, in some low voltage applications of MGs, non-linear loads typically based on rectifier diodes, power electronics systems, etc. [119], [120] could introduce the same non-linear effects as harmonic distortion in the voltages and currents.</p>
        <p>In the case of saturation, when using (1), severe overshoots may be produced, which depends on the coupling gains [121]. For that reason, saturation schemes are introduced into the consensus protocols; In applications like MGs, such saturation is introduced over the currents and voltages supplied by the converters. Regarding the effect of non-linear loads, in the literature, it is usually proposed to share the distortion produced by the non-linear loads among the distributed generators in the MG (see [120]). Another solution is to utilise active filtering [122], but this is usually considered a highcost solution. Other sources of non-linearities are related to the communication channels; for instance, some effects related to noise and loss of packets.In the case of saturation, when using (1), severe overshoots may be produced, which depends on the coupling gains [121]. For that reason, saturation schemes are introduced into the consensus protocols; In applications like MGs, such saturation is introduced over the currents and voltages supplied by the converters. Regarding the effect of non-linear loads, in the literature, it is usually proposed to share the distortion produced by the non-linear loads among the distributed generators in the MG (see [120]). Another solution is to utilise active filtering [122], but this is usually considered a highcost solution. Other sources of non-linearities are related to the communication channels; for instance, some effects related to noise and loss of packets.</p>
        <p>To improve the dynamic response of the MAS -i.e., improvements in convergence time, over-oscillations, and robustness to disturbances-modifications to the consensus protocol depicted in (1) are used within the so-called nonlinear consensus protocols. A generic non-linear protocol is formulated as follows; let the system be in the formTo improve the dynamic response of the MAS -i.e., improvements in convergence time, over-oscillations, and robustness to disturbances-modifications to the consensus protocol depicted in (1) are used within the so-called nonlinear consensus protocols. A generic non-linear protocol is formulated as follows; let the system be in the form</p>
        <p>where f (•) and g(•) are non-linear functions, and w i is a bounded disturbance. The control input u i can be formulated as:where f (•) and g(•) are non-linear functions, and w i is a bounded disturbance. The control input u i can be formulated as:</p>
        <p>where the ψ function must meet some requirements to ensure convergence, such as be an odd, continuous and locally Lipschitz function [79], [105]- [107]. Note that the ψ function could be represented, for instance, aswhere the ψ function must meet some requirements to ensure convergence, such as be an odd, continuous and locally Lipschitz function [79], [105]- [107]. Note that the ψ function could be represented, for instance, as</p>
        <p>where sign(•) is the signum function and 0 &lt; α &lt; 1 is a convergence parameter. The consensus protocols that use the signum function are characterised by having finite-time convergence.where sign(•) is the signum function and 0 &lt; α &lt; 1 is a convergence parameter. The consensus protocols that use the signum function are characterised by having finite-time convergence.</p>
        <p>Regarding finite-time consensus, this technique allows achieving convergence in a finite number of steps [99], [100], while rejecting disturbances and dealing with uncertainties [161]. Its application on MAS was introduced in [162]. Since then, the application of finite-time protocols over MGs have been extensively reported [146], [147], [149], [163], [164]. For complementing the algorithms described above, the ψ function of (4) can be saturated in magnitude avoiding performance problems [107], [151]. Some strategies include saturation to state-variation, i.e., they approximate the sign function to other smooth functions, such as hyperbolic tangent [151].Regarding finite-time consensus, this technique allows achieving convergence in a finite number of steps [99], [100], while rejecting disturbances and dealing with uncertainties [161]. Its application on MAS was introduced in [162]. Since then, the application of finite-time protocols over MGs have been extensively reported [146], [147], [149], [163], [164]. For complementing the algorithms described above, the ψ function of (4) can be saturated in magnitude avoiding performance problems [107], [151]. Some strategies include saturation to state-variation, i.e., they approximate the sign function to other smooth functions, such as hyperbolic tangent [151].</p>
        <p>Finally, the last group of non-linear consensus algorithms is referenced, which is called robust consensus protocols [105], [165]- [167]. In these protocols, the bounded disturbance w i is compensated employing a ψ function that uses a weighted upper-bound estimation signed according to a sliding surface.Finally, the last group of non-linear consensus algorithms is referenced, which is called robust consensus protocols [105], [165]- [167]. In these protocols, the bounded disturbance w i is compensated employing a ψ function that uses a weighted upper-bound estimation signed according to a sliding surface.</p>
        <p>Linear They have the typical advantages and characteristics associated with linear system, i.e., they obey the superposition principle, they are described by linear differential equations, and they can be analysed and designed using linear control tools as frequency response analysis, Nyquist diagrams, Z-transform, eigenvalue positions, etc. They could have sub-optimal performance when applied to non-linear systems.Linear They have the typical advantages and characteristics associated with linear system, i.e., they obey the superposition principle, they are described by linear differential equations, and they can be analysed and designed using linear control tools as frequency response analysis, Nyquist diagrams, Z-transform, eigenvalue positions, etc. They could have sub-optimal performance when applied to non-linear systems.</p>
        <p>DC Power-sharing [57], [58], [123]- [127] [63], [108], [111], [128], [129] Energy storage [130], [131] Economic dispatch [71], [112], [132]-[135] ACDC Power-sharing [57], [58], [123]- [127] [63], [108], [111], [128], [129] Energy storage [130], [131] Economic dispatch [71], [112], [132]-[135] AC</p>
        <p>Power quality [109], [119], [120], [136] Energy storage [113], [137] Economic dispatch [44], [70], [138]- [140] FinitePower quality [109], [119], [120], [136] Energy storage [113], [137] Economic dispatch [44], [70], [138]- [140] Finite</p>
        <p>According to the definition stated in [103], in a heterogeneous system, agents of different dynamic are considered. A more stringent definition states that an heterogeneous microgrid is composed of agents of first and second-order consensus protocols, which ensure synchronisation even when the agent dynamics are different.According to the definition stated in [103], in a heterogeneous system, agents of different dynamic are considered. A more stringent definition states that an heterogeneous microgrid is composed of agents of first and second-order consensus protocols, which ensure synchronisation even when the agent dynamics are different.</p>
        <p>DC [114] AC [115]- [117] For MGs, robust distributed controllers are mainly based on the incorporation of sliding mode control algorithms; some examples can be referred in [152], [154]- [156], [159], [168].DC [114] AC [115]- [117] For MGs, robust distributed controllers are mainly based on the incorporation of sliding mode control algorithms; some examples can be referred in [152], [154]- [156], [159], [168].</p>
        <p>A more detailed explanation of the general methodology for applying consensus algorithms to MGs is presented in the following subsection.A more detailed explanation of the general methodology for applying consensus algorithms to MGs is presented in the following subsection.</p>
        <p>Distributed control strategies have been used for several applications, for instance, to achieve optimal dispatch [169], to enhance active and reactive power sharing [121], for restoring frequency and voltage [63], to share imbalances and harmonics among power converters [120], etc.Distributed control strategies have been used for several applications, for instance, to achieve optimal dispatch [169], to enhance active and reactive power sharing [121], for restoring frequency and voltage [63], to share imbalances and harmonics among power converters [120], etc.</p>
        <p>The application concept of distributed control in MGs is further explained using Fig. 7. At the bottom of this graphic is the physical layer (using the definition of [108]), which is usually composed of power converters and power filters. From bottom to top, for each DER, there is an inner control loop, the distribute primary control systems, secondary control systems, etc. At the top of Fig. 7 is the "cyberlayer" (as defined in [57], [108]), which is, among other things, providing a communication channel for all the DERs, interlinking converters, dispatchable load, etc., available in the MG. Some applications of distributed control over the primary, secondary and tertiary systems, shown in Fig. 4, are presented and discussed in the next Sections.The application concept of distributed control in MGs is further explained using Fig. 7. At the bottom of this graphic is the physical layer (using the definition of [108]), which is usually composed of power converters and power filters. From bottom to top, for each DER, there is an inner control loop, the distribute primary control systems, secondary control systems, etc. At the top of Fig. 7 is the "cyberlayer" (as defined in [57], [108]), which is, among other things, providing a communication channel for all the DERs, interlinking converters, dispatchable load, etc., available in the MG. Some applications of distributed control over the primary, secondary and tertiary systems, shown in Fig. 4, are presented and discussed in the next Sections.</p>
        <p>Based on the hierarchical control structure introduced in the previous section (see Figure 4), it is concluded that the first stage for the control of parallel converters in a MG involves sharing the power among the DERs [43], [109], [170]. Typically this is achieved using droop control [109], [171], however, there are alternatives available in the literature to enhance the process. For completeness, a brief discussion of droop control and the application of virtual impedances and primary control algorithms is realised in the next sections.Based on the hierarchical control structure introduced in the previous section (see Figure 4), it is concluded that the first stage for the control of parallel converters in a MG involves sharing the power among the DERs [43], [109], [170]. Typically this is achieved using droop control [109], [171], however, there are alternatives available in the literature to enhance the process. For completeness, a brief discussion of droop control and the application of virtual impedances and primary control algorithms is realised in the next sections.</p>
        <p>The droop control algorithm consists of a decentralised algebraic relationship between power, obtained by local measurements, and the controlled variable of the converter, e.g., voltage magnitude. Conventional relationships are linear and given by:The droop control algorithm consists of a decentralised algebraic relationship between power, obtained by local measurements, and the controlled variable of the converter, e.g., voltage magnitude. Conventional relationships are linear and given by:</p>
        <p>for AC MG where n, m and r are the droop coefficients and P * , Q * , and I * are usually predefined constants [2]. The application of droop control algorithms produces deviations in the voltage and frequency of an AC-MG, which is represented in Fig. 8.for AC MG where n, m and r are the droop coefficients and P * , Q * , and I * are usually predefined constants [2]. The application of droop control algorithms produces deviations in the voltage and frequency of an AC-MG, which is represented in Fig. 8.</p>
        <p>The DC-MG voltage deviation is similar to that originated in the AC-MG (see the left-side graphic in Fig. 8) when ( 6) is utilised.The DC-MG voltage deviation is similar to that originated in the AC-MG (see the left-side graphic in Fig. 8) when ( 6) is utilised.</p>
        <p>The main advantage of droop control is that a communication link is not required to achieve power-sharing [35], giving flexibility and autonomy. Additionally, for the AC MG, the droop curves in (5) allow the interconnection of traditional machine-based DERs and converter-based DERs [35], [78].The main advantage of droop control is that a communication link is not required to achieve power-sharing [35], giving flexibility and autonomy. Additionally, for the AC MG, the droop curves in (5) allow the interconnection of traditional machine-based DERs and converter-based DERs [35], [78].</p>
        <p>Among disadvantages of conventional droop control, some of the most relevant are [2], [35], [78], [109], [172]- [174]:Among disadvantages of conventional droop control, some of the most relevant are [2], [35], [78], [109], [172]- [174]:</p>
        <p>• Frequency and voltage are deviated from nominal values, which have to be compensated by secondary controllers (this is discussed in the next section). These deviations could be more noticeable in low inertia MGs dominated by converter-based DERs. • The transient performance is slow, which could induce instability, depending on the difference between droop coefficients of DERs. • The reactive and active powers in the AC-MG are coupled, which depends on the relation R/X (resistance over inductive impedance) of the lines and impedances interfacing DERs with the MG. Droop control algorithms are typically augmented using virtual impedance loops. For the interested reader, a thorough discussion of this subject is realised in [23]. In this work, for the sake of completeness, a brief introduction to the concept of virtual impedance loops is realised in the next subsection.• Frequency and voltage are deviated from nominal values, which have to be compensated by secondary controllers (this is discussed in the next section). These deviations could be more noticeable in low inertia MGs dominated by converter-based DERs. • The transient performance is slow, which could induce instability, depending on the difference between droop coefficients of DERs. • The reactive and active powers in the AC-MG are coupled, which depends on the relation R/X (resistance over inductive impedance) of the lines and impedances interfacing DERs with the MG. Droop control algorithms are typically augmented using virtual impedance loops. For the interested reader, a thorough discussion of this subject is realised in [23]. In this work, for the sake of completeness, a brief introduction to the concept of virtual impedance loops is realised in the next subsection.</p>
        <p>Virtual impedances are typically utilised to change the dynamic profile of power converters using loss-less software implemented impedances. According to [23], one of the first papers proposing the concept of virtual impedance is [175]. In that reference, this control loop was implemented to provide active damping in a current control loop.Virtual impedances are typically utilised to change the dynamic profile of power converters using loss-less software implemented impedances. According to [23], one of the first papers proposing the concept of virtual impedance is [175]. In that reference, this control loop was implemented to provide active damping in a current control loop.</p>
        <p>The application of virtual impedances has been extensively used in MG and distributed generation systems for stability purposes [176], [177], sharing of harmonic distortion and imbalances, [119], [120], [178], [179], Fault-Ride-Through control [180], etc. Another application where virtual impedances have been utilised is for the decoupling of the active and reactive powers supplied by power converters [136], [181]. As it is well-known, the equations for droop control in AC-MGs [depicted in (5)] assume that the lines and impedances interfacing the DERs with the loads are strongly inductive. However, in the low-voltage AC-MG context, this consideration may not be fulfilled. In this regard, a "virtual inductance" loop could be used [119], [182], [183] to force an inductive coupling in AC-MGs. Moreover, the virtual impedance concept can also be applied even when the system impedances are strongly inductive and reactive power is poorly shared between the converters because the magnitude of the output inductance is dissimilar. A similar concept could be used in DC-MGs to improve the sharing of active power [184].The application of virtual impedances has been extensively used in MG and distributed generation systems for stability purposes [176], [177], sharing of harmonic distortion and imbalances, [119], [120], [178], [179], Fault-Ride-Through control [180], etc. Another application where virtual impedances have been utilised is for the decoupling of the active and reactive powers supplied by power converters [136], [181]. As it is well-known, the equations for droop control in AC-MGs [depicted in (5)] assume that the lines and impedances interfacing the DERs with the loads are strongly inductive. However, in the low-voltage AC-MG context, this consideration may not be fulfilled. In this regard, a "virtual inductance" loop could be used [119], [182], [183] to force an inductive coupling in AC-MGs. Moreover, the virtual impedance concept can also be applied even when the system impedances are strongly inductive and reactive power is poorly shared between the converters because the magnitude of the output inductance is dissimilar. A similar concept could be used in DC-MGs to improve the sharing of active power [184].</p>
        <p>Fig. 9 illustrates the implementation of the virtual impedance loop. In that figure, it is assumed that the control scheme is implemented in the abc reference frame, and it is used for controlling a 4-leg power converter. As depicted in this graphic, nested control loops are used. The external loop is for regulating the voltage in the capacitor of the LC or LCL power filter. Meanwhile, the internal control loop is regulating the current in the inductance L i . As discussed in [23], virtual impedances can be classified as "inner," which are directly applied to the Pulse Width Modulation (PWM) modulator, and outer virtual impedance. In the example shown in Fig. 9(b), the inner virtual resistance R di is providing active damping to the power converter topology of Fig. 9(a). Notice that three outer virtual impedance loops are depicted in Fig. 9(b), two of them are implemented using both the negative sequence component and the zero sequence component of the output current i i . Using these two virtual impedance loops, it is possible, for instance, to improve the sharing of negative sequence and neutral currents between the power converters of a MG (see [119], [120] for further details). Finally, an additional outer virtual impedance loop is provided (see at the top of Fig. 9(b)), which could provide (for instance) a virtual inductance to improve the sharing of reactive power. Equation ( 7) represents the equivalent Thévenin model (in the Laplace domain) of the closed-loop system of Fig. 9. As shown in (7), the virtual impedance loops are equivalent to output impedances where voltage drops are produced by the circulation of positive, negative and zero sequence current components. The positive sequence impedance is controlled through R + i and L + i , and it is used for achieving the decoupling between active and reactive powers and also for stability purposes [182], [183]. Meanwhile, both the negative sequence impedance and the zero sequence impedance are controlled by R - i and L - i and by R 0 i and L 0 i , respectively. These are used for improving the sharing of unbalanced currents in the MG [119], [120], [185], for compensating the unbalanced voltage at some point of the MG [182], [183], [186] or for simultaneously fulfilling a combination of the two previous objectives [109], [136], [187].Fig. 9 illustrates the implementation of the virtual impedance loop. In that figure, it is assumed that the control scheme is implemented in the abc reference frame, and it is used for controlling a 4-leg power converter. As depicted in this graphic, nested control loops are used. The external loop is for regulating the voltage in the capacitor of the LC or LCL power filter. Meanwhile, the internal control loop is regulating the current in the inductance L i . As discussed in [23], virtual impedances can be classified as "inner," which are directly applied to the Pulse Width Modulation (PWM) modulator, and outer virtual impedance. In the example shown in Fig. 9(b), the inner virtual resistance R di is providing active damping to the power converter topology of Fig. 9(a). Notice that three outer virtual impedance loops are depicted in Fig. 9(b), two of them are implemented using both the negative sequence component and the zero sequence component of the output current i i . Using these two virtual impedance loops, it is possible, for instance, to improve the sharing of negative sequence and neutral currents between the power converters of a MG (see [119], [120] for further details). Finally, an additional outer virtual impedance loop is provided (see at the top of Fig. 9(b)), which could provide (for instance) a virtual inductance to improve the sharing of reactive power. Equation ( 7) represents the equivalent Thévenin model (in the Laplace domain) of the closed-loop system of Fig. 9. As shown in (7), the virtual impedance loops are equivalent to output impedances where voltage drops are produced by the circulation of positive, negative and zero sequence current components. The positive sequence impedance is controlled through R + i and L + i , and it is used for achieving the decoupling between active and reactive powers and also for stability purposes [182], [183]. Meanwhile, both the negative sequence impedance and the zero sequence impedance are controlled by R - i and L - i and by R 0 i and L 0 i , respectively. These are used for improving the sharing of unbalanced currents in the MG [119], [120], [185], for compensating the unbalanced voltage at some point of the MG [182], [183], [186] or for simultaneously fulfilling a combination of the two previous objectives [109], [136], [187].</p>
        <p>In addition to the virtual impedance loops depicted in Fig. 9, additional ones could be added for controlling harmonics in distorted MGs. The main control objectives of the virtual impedance loop, in this type of MG, are: (i) the improvement in the sharing of a particular harmonic current [119], [120], and (ii) harmonics-current sharing, but considering an additional term in the consensus algorithm to realise a trade-off between harmonic-current sharing and unacceptably high total harmonic distortion (THD) of the voltage at some point of the MG. [136], [187]. It should be pointed out that in these works, the third and fifth-order harmonics are usually considered if the MG is a 4-wire system. In contrast, if the MG is a 3-wire system, the usual procedure (and depending on the computational capacity of The concept of virtual impedance loop can also be used in DC-MGs. In this type of MGs, this control loop is generally used to improve the DC current sharing among the DC-power converters that belong to the DC-MG [188]- [190]. Moreover, it is used to enhance the damping of MGs with constant power loads [191], [192]. Another interesting application is its use when the MG has some energy storage system. In this context, in [193], [194] virtual impedances are used to control the transient power-sharing among paralleled supercapacitors banks, which are part of a MG. Also, in [137], virtual impedances are implemented to equalise the SoC among battery banks present in a MG.In addition to the virtual impedance loops depicted in Fig. 9, additional ones could be added for controlling harmonics in distorted MGs. The main control objectives of the virtual impedance loop, in this type of MG, are: (i) the improvement in the sharing of a particular harmonic current [119], [120], and (ii) harmonics-current sharing, but considering an additional term in the consensus algorithm to realise a trade-off between harmonic-current sharing and unacceptably high total harmonic distortion (THD) of the voltage at some point of the MG. [136], [187]. It should be pointed out that in these works, the third and fifth-order harmonics are usually considered if the MG is a 4-wire system. In contrast, if the MG is a 3-wire system, the usual procedure (and depending on the computational capacity of The concept of virtual impedance loop can also be used in DC-MGs. In this type of MGs, this control loop is generally used to improve the DC current sharing among the DC-power converters that belong to the DC-MG [188]- [190]. Moreover, it is used to enhance the damping of MGs with constant power loads [191], [192]. Another interesting application is its use when the MG has some energy storage system. In this context, in [193], [194] virtual impedances are used to control the transient power-sharing among paralleled supercapacitors banks, which are part of a MG. Also, in [137], virtual impedances are implemented to equalise the SoC among battery banks present in a MG.</p>
        <p>One of the main challenges for the utilisation of virtual impedance loops is the design of these software implemented impedances considering the changes typically produced, during the operation of a MG, on the equivalent Thévenin impedance at the output of each DER. For compensating these variations, adaptive virtual impedance loops have been proposed in the literature, which modifies (on-line) the values of the virtual resistances and inductances. For instance, to decouple the active and reactive power supply in MGs, which are not strongly inductive, adaptive distributed approaches have been proposed in [120], [195]- [197].One of the main challenges for the utilisation of virtual impedance loops is the design of these software implemented impedances considering the changes typically produced, during the operation of a MG, on the equivalent Thévenin impedance at the output of each DER. For compensating these variations, adaptive virtual impedance loops have been proposed in the literature, which modifies (on-line) the values of the virtual resistances and inductances. For instance, to decouple the active and reactive power supply in MGs, which are not strongly inductive, adaptive distributed approaches have been proposed in [120], [195]- [197].</p>
        <p>Reference [195] applies the consensus theory for the adjustment of a preset virtual impedance. The virtual impedance correction term is obtained by the action of a Proportional-Integral (PI) controller over the consensus of reactive power mismatches between DERs. In [196], a similar approach is used to correct the virtual impedance value adaptively.Reference [195] applies the consensus theory for the adjustment of a preset virtual impedance. The virtual impedance correction term is obtained by the action of a Proportional-Integral (PI) controller over the consensus of reactive power mismatches between DERs. In [196], a similar approach is used to correct the virtual impedance value adaptively.</p>
        <p>An alternative method, based on the same principle that [195], [196], but using active power, is proposed in [197]. The virtual impedance value is adjusted by a PI controller that regulates the deviation of local active power to achieve power consensus of parallel converters of a modular Uninterruptible Power Source (UPS).An alternative method, based on the same principle that [195], [196], but using active power, is proposed in [197]. The virtual impedance value is adjusted by a PI controller that regulates the deviation of local active power to achieve power consensus of parallel converters of a modular Uninterruptible Power Source (UPS).</p>
        <p>In addition to the virtual impedance methods, additional research efforts have been realised to develop algorithms that cope with the disadvantages, e.g. deviations, caused by decentralised droop. The next subsections analyse distributed strategies for the primary control of MGs, including those referred to as "droop-free" approaches. These strategies could be considered as a mixture of secondary and primary control layers. However, for the effects of this paper, they are deemed to be distributed primary control systems.In addition to the virtual impedance methods, additional research efforts have been realised to develop algorithms that cope with the disadvantages, e.g. deviations, caused by decentralised droop. The next subsections analyse distributed strategies for the primary control of MGs, including those referred to as "droop-free" approaches. These strategies could be considered as a mixture of secondary and primary control layers. However, for the effects of this paper, they are deemed to be distributed primary control systems.</p>
        <p>For the control over MGs, the output voltage of the converters has to be well regulated and close to the nominal value while assuring a good power-sharing. These goals usually required additional control actions over the deviations caused by droop control. The parallel operation of converter-based DERs in AC-MGs requires to regulate the voltages and frequency to follow the reference values while sharing the reactive and active powers between the DERs. Considering communicated AC-MGs, authors have analysed distributed secondary control strategies that cope with the disadvantages of conventional droop control [63], [147], [172], [198] (which will be addressed in detail in Section IV).For the control over MGs, the output voltage of the converters has to be well regulated and close to the nominal value while assuring a good power-sharing. These goals usually required additional control actions over the deviations caused by droop control. The parallel operation of converter-based DERs in AC-MGs requires to regulate the voltages and frequency to follow the reference values while sharing the reactive and active powers between the DERs. Considering communicated AC-MGs, authors have analysed distributed secondary control strategies that cope with the disadvantages of conventional droop control [63], [147], [172], [198] (which will be addressed in detail in Section IV).</p>
        <p>As a result of the advances in secondary control, a new fully distributed approach called droop-free has been proposed [108], [199], [200] for AC-MGs, which rely only on a sparse communication network between neighbouring DER units and can replace a conventional droop scheme.As a result of the advances in secondary control, a new fully distributed approach called droop-free has been proposed [108], [199], [200] for AC-MGs, which rely only on a sparse communication network between neighbouring DER units and can replace a conventional droop scheme.</p>
        <p>In [108], [199], three control loops are introduced: Global average-voltage, reactive power and active power. The global average-voltage controller is proposed in [58] using an observer-topology based on a dynamic consensus (as in ( 2)) with a PI controller; The observer estimates the magnitude of the MG average-voltage by considering the estimated average-voltage from neighbouring units. Then, the observer output is compared with a reference E * to generate a voltage compensation δE 1 i . For its part, the reactive power is controlled by a PI controller whose input is the consensus value of the normalised reactive power measurements; the PI output is then added to the voltage reference as δE 2 i . For the active power regulation, a consensus of normalised active power measurements is used to obtain a deviation of the reference frequency. Frequency deviations are produced during transient operation while average-voltage and reactive power are regulated by PI controllers with zero error in steady-state conditions. The simplified droop-free algorithm for the control of AC MGs (with a leaderless communication scheme) can be represented by the following equations:In [108], [199], three control loops are introduced: Global average-voltage, reactive power and active power. The global average-voltage controller is proposed in [58] using an observer-topology based on a dynamic consensus (as in ( 2)) with a PI controller; The observer estimates the magnitude of the MG average-voltage by considering the estimated average-voltage from neighbouring units. Then, the observer output is compared with a reference E * to generate a voltage compensation δE 1 i . For its part, the reactive power is controlled by a PI controller whose input is the consensus value of the normalised reactive power measurements; the PI output is then added to the voltage reference as δE 2 i . For the active power regulation, a consensus of normalised active power measurements is used to obtain a deviation of the reference frequency. Frequency deviations are produced during transient operation while average-voltage and reactive power are regulated by PI controllers with zero error in steady-state conditions. The simplified droop-free algorithm for the control of AC MGs (with a leaderless communication scheme) can be represented by the following equations:</p>
        <p>Active power regulator (11) In ( 8)- (11), ēi is the voltage-observer output, δE 1 is the output of a PI controller with input (E * -ēi ); δE 2 is the correction provided by a PI whose input is a consensus of reactive power; δω is the transient deviation generated by the consensus of active power. The coupling gains are {c Qi , c P i } &gt; 0. The average-voltage reference E * and frequency reference ω * could be known by all DERs or provided by a tertiary control scheme. The implementation is summarised in Fig. 10, where a d-q control system orientated along with a synchronous rotating frame is utilised to implement the internal loops; G cE (s) and G cQ (s) represent PI controllers. Some of the advantages of the approach presented in [108] are: avoidance of frequency estimations/measurements, and achievement of power-sharing without steady-state deviations in frequency. Its control structure allows the proposal to be presented as a fully distributed primary/secondary control. Furthermore, this primary distributed approach can also be applied to DC-MGs as shown in [58], [201], when the traditional voltage droop is omitted.Active power regulator (11) In ( 8)- (11), ēi is the voltage-observer output, δE 1 is the output of a PI controller with input (E * -ēi ); δE 2 is the correction provided by a PI whose input is a consensus of reactive power; δω is the transient deviation generated by the consensus of active power. The coupling gains are {c Qi , c P i } &gt; 0. The average-voltage reference E * and frequency reference ω * could be known by all DERs or provided by a tertiary control scheme. The implementation is summarised in Fig. 10, where a d-q control system orientated along with a synchronous rotating frame is utilised to implement the internal loops; G cE (s) and G cQ (s) represent PI controllers. Some of the advantages of the approach presented in [108] are: avoidance of frequency estimations/measurements, and achievement of power-sharing without steady-state deviations in frequency. Its control structure allows the proposal to be presented as a fully distributed primary/secondary control. Furthermore, this primary distributed approach can also be applied to DC-MGs as shown in [58], [201], when the traditional voltage droop is omitted.</p>
        <p>Modifications to the droop-free strategy of [108] have been reported in the literature [202]- [207]. An extension to multi-MG control has been reported in [202], focusing on the frequency loop. In this scheme, a consensus-based tertiary control level is introduced to generate transient deviations, depending on the active power of each MG cluster, over the droop-free frequency loop. The paper presents the same advantage in terms of avoiding frequency measurements than previous works [108], [199].Modifications to the droop-free strategy of [108] have been reported in the literature [202]- [207]. An extension to multi-MG control has been reported in [202], focusing on the frequency loop. In this scheme, a consensus-based tertiary control level is introduced to generate transient deviations, depending on the active power of each MG cluster, over the droop-free frequency loop. The paper presents the same advantage in terms of avoiding frequency measurements than previous works [108], [199].</p>
        <p>A detailed analysis of the droop-free frequency loop is performed in [203]. This work studies experimentally the effect of local hardware clock drifts in the dynamic and steady-state performance. It is concluded that the drift causes frequency oscillations. The paper also describes the influence of control parameters over different magnified clock drifts, concluding that adequate tuning can attenuate the oscillations.A detailed analysis of the droop-free frequency loop is performed in [203]. This work studies experimentally the effect of local hardware clock drifts in the dynamic and steady-state performance. It is concluded that the drift causes frequency oscillations. The paper also describes the influence of control parameters over different magnified clock drifts, concluding that adequate tuning can attenuate the oscillations.</p>
        <p>Another analysis of the droop-free framework is realised in [206]. This work analyses the response of the droopfree frequency control when electrical and communication failures occur in an islanded MG. The paper shows that the MG could go to instability due to failures that break the communication topology into two or more partitions or subgraphs (i.e., as a result, the MG does not have a spanningtree). The stability analysis is performed by two Laplacian matrices highlighting the influence of the power filter. Each local controller receives a signal of failure and automatically changes from droop-free to droop operation. The stability analysis under this controller is discussed in [206] along with implementation details.Another analysis of the droop-free framework is realised in [206]. This work analyses the response of the droopfree frequency control when electrical and communication failures occur in an islanded MG. The paper shows that the MG could go to instability due to failures that break the communication topology into two or more partitions or subgraphs (i.e., as a result, the MG does not have a spanningtree). The stability analysis is performed by two Laplacian matrices highlighting the influence of the power filter. Each local controller receives a signal of failure and automatically changes from droop-free to droop operation. The stability analysis under this controller is discussed in [206] along with implementation details.</p>
        <p>An additional regulator to improve the voltage accuracy and stability is presented in [207]. In this work, not only MG global average-voltage is controlled, but also variance (σ 2 ) of the voltage at the output of each DER. If the variance is outside some predefined boundaries, then the reactive power consensus is relaxed to avoid a poor voltage regulation at the output of the ith DER. Simulations results are provided to support the methodology proposed in [207].An additional regulator to improve the voltage accuracy and stability is presented in [207]. In this work, not only MG global average-voltage is controlled, but also variance (σ 2 ) of the voltage at the output of each DER. If the variance is outside some predefined boundaries, then the reactive power consensus is relaxed to avoid a poor voltage regulation at the output of the ith DER. Simulations results are provided to support the methodology proposed in [207].</p>
        <p>Because of the relatively high penetration of renewable energy resources, MGs typically have a reduced value of inertia, [208]. Furthermore, renewable energy is usually strongly dependant on weather conditions, and this produces some de-gree of intermittent and uncertainty [209], placing additional stress on the operation and control of MGs [210]. Moreover, renewable energy is usually interfaced with the MG using a power converter, which electrically decouples them from the MG. As discussed in several publications, where stability issues are addressed (see [173], [209], [211], [212]), the reduction of inertia in a system can severely compromise the frequency stability. Certainly, the rotational inertia is related to both nadir (minimum frequency) and the rate of change of frequency (ROCOF) in a system [211], [213]. In summary, low inertia MGs are prone to unacceptable frequency deviations.Because of the relatively high penetration of renewable energy resources, MGs typically have a reduced value of inertia, [208]. Furthermore, renewable energy is usually strongly dependant on weather conditions, and this produces some de-gree of intermittent and uncertainty [209], placing additional stress on the operation and control of MGs [210]. Moreover, renewable energy is usually interfaced with the MG using a power converter, which electrically decouples them from the MG. As discussed in several publications, where stability issues are addressed (see [173], [209], [211], [212]), the reduction of inertia in a system can severely compromise the frequency stability. Certainly, the rotational inertia is related to both nadir (minimum frequency) and the rate of change of frequency (ROCOF) in a system [211], [213]. In summary, low inertia MGs are prone to unacceptable frequency deviations.</p>
        <p>To increase the inertia of the system, in recent years, several control algorithms for power converters have been proposed for frequency regulation [214], [215]. In the literature, the proposed solutions are usually referred as virtual inertia and/or synthetic inertia emulation. Therefore, there are several control methodologies reported to control DERs, in MGs and electric power systems, to mimic synchronous generators. The generating units controlled using these methodologies are referred to as Virtual Synchronous Generator (VSG) [211], [216], [217] or Synchronverters [215]. However, most of the work related to the design, implementation and control of VSGs are based on centralised approaches, with a reduced number of recent works where consensus-based distributed control of VSGs (including synthetic inertia) are discussed.To increase the inertia of the system, in recent years, several control algorithms for power converters have been proposed for frequency regulation [214], [215]. In the literature, the proposed solutions are usually referred as virtual inertia and/or synthetic inertia emulation. Therefore, there are several control methodologies reported to control DERs, in MGs and electric power systems, to mimic synchronous generators. The generating units controlled using these methodologies are referred to as Virtual Synchronous Generator (VSG) [211], [216], [217] or Synchronverters [215]. However, most of the work related to the design, implementation and control of VSGs are based on centralised approaches, with a reduced number of recent works where consensus-based distributed control of VSGs (including synthetic inertia) are discussed.</p>
        <p>In a synchronous generator, there is an electrical power absorbed/released when the generator changes its rotational speed. This power is obtained as:In a synchronous generator, there is an electrical power absorbed/released when the generator changes its rotational speed. This power is obtained as:</p>
        <p>where E k is the kinetic energy, ω is the rotational speed, ω * e is the nominal frequency, and J is the rotational inertia of the SG. From (12), the angle dynamic or swing equation of conventional synchronous generators could be obtained as [208], [218], [219]:where E k is the kinetic energy, ω is the rotational speed, ω * e is the nominal frequency, and J is the rotational inertia of the SG. From (12), the angle dynamic or swing equation of conventional synchronous generators could be obtained as [208], [218], [219]:</p>
        <p>where D is the friction coefficient. On the right-hand side, P M is the mechanical power (from the driving machine), and P e is the electrical power supplied by the generator. Notice that Fig. 11(a) represents (13).where D is the friction coefficient. On the right-hand side, P M is the mechanical power (from the driving machine), and P e is the electrical power supplied by the generator. Notice that Fig. 11(a) represents (13).</p>
        <p>Using (13) and assuming that sufficient power is available at the power converter input [209], virtual synchronous generators can be implemented by software. The virtual swing equation is shown in (14). Notice that J vi is the virtual inertia, and D pi is the virtual friction coefficient. Using (5), it is concluded that the later is the reciprocal of the droop coefficient m.Using (13) and assuming that sufficient power is available at the power converter input [209], virtual synchronous generators can be implemented by software. The virtual swing equation is shown in (14). Notice that J vi is the virtual inertia, and D pi is the virtual friction coefficient. Using (5), it is concluded that the later is the reciprocal of the droop coefficient m.</p>
        <p>Notice that the subscript i in ( 14) is utilised to represent the i th VSG of the MG. The term p i /D pi in ( 14) is used as an auxiliary variable to drive the frequency ω i to ω * e using a consensus algorithm [220]. As discussed in this publication, the value of ṗi could be calculated, using (15), as: As mentioned before, the proposed control algorithm is based on that reported in [208]. A similar algorithm is proposed in [71] for photo-voltaic panels connected via VSG to a MG. In [218], the control strategy depicted in Fig 11(b) is slightly modified, and the consensus of ( 15) is replaced by an Alternating Direction Multipliers Method (ADMM). It is claimed in that publication, that ADMM is less dependant than consensus-based methods in the structure of the communication network. In [208], [218], the proposed control systems are validated using real-time simulations implemented in OPAL-RT platforms. Another approach presented for cooperative control of VSGs is presented in [216]. In this case, the cooperative algorithm is based on optimal control theory.Notice that the subscript i in ( 14) is utilised to represent the i th VSG of the MG. The term p i /D pi in ( 14) is used as an auxiliary variable to drive the frequency ω i to ω * e using a consensus algorithm [220]. As discussed in this publication, the value of ṗi could be calculated, using (15), as: As mentioned before, the proposed control algorithm is based on that reported in [208]. A similar algorithm is proposed in [71] for photo-voltaic panels connected via VSG to a MG. In [218], the control strategy depicted in Fig 11(b) is slightly modified, and the consensus of ( 15) is replaced by an Alternating Direction Multipliers Method (ADMM). It is claimed in that publication, that ADMM is less dependant than consensus-based methods in the structure of the communication network. In [208], [218], the proposed control systems are validated using real-time simulations implemented in OPAL-RT platforms. Another approach presented for cooperative control of VSGs is presented in [216]. In this case, the cooperative algorithm is based on optimal control theory.</p>
        <p>Regarding DC-MGs, there are very few papers reporting cooperative control of virtual DC generators, including virtual capacitors, which can be used to avoid unacceptable voltage variations. In [217], an analogy between the dynamic of a synchronous generator [see (13)] and the dynamic of a capacitor in parallel with a resistor, is proposed. In this line of work, it is demonstrated in [217] that a virtual capacitor C v is mathematically equivalent to the inertia J of a SG and that conductance is equivalent to the friction coefficient D of the synchronous generator. Therefore, the control system depicted in Fig. 11(b) could be slightly modified to represent the consensus control of a DC-MG, including virtual capacitors in the dc DERs. Cooperative control of virtual generators for dc application is also presented in [221] but using Finite Control-Set Model Predictive Control (FCS-MPC) instead of consensus-based control techniques.Regarding DC-MGs, there are very few papers reporting cooperative control of virtual DC generators, including virtual capacitors, which can be used to avoid unacceptable voltage variations. In [217], an analogy between the dynamic of a synchronous generator [see (13)] and the dynamic of a capacitor in parallel with a resistor, is proposed. In this line of work, it is demonstrated in [217] that a virtual capacitor C v is mathematically equivalent to the inertia J of a SG and that conductance is equivalent to the friction coefficient D of the synchronous generator. Therefore, the control system depicted in Fig. 11(b) could be slightly modified to represent the consensus control of a DC-MG, including virtual capacitors in the dc DERs. Cooperative control of virtual generators for dc application is also presented in [221] but using Finite Control-Set Model Predictive Control (FCS-MPC) instead of consensus-based control techniques.</p>
        <p>In a hierarchical control structure [2], [43], when small-scale MGs are considered, distributed secondary control strategies that rely on communications are an attractive solution so that many works have been reported in this field. The distributed control systems reported in this work have been classified considering the type of MGs studied, i.e. DC-strategies, ACstrategies and hybrid AC/DC-strategies.In a hierarchical control structure [2], [43], when small-scale MGs are considered, distributed secondary control strategies that rely on communications are an attractive solution so that many works have been reported in this field. The distributed control systems reported in this work have been classified considering the type of MGs studied, i.e. DC-strategies, ACstrategies and hybrid AC/DC-strategies.</p>
        <p>In the applications reported in the literature, the distributed secondary control architecture of DC-MGs utilises two control actions over the voltage magnitude reference of the associated converter -similar to the strategy shown in distributed primary control section -. These distributed control actions, based on (6), are shown in (16). They come from control algorithms of Voltage Regulator (VR) and Current Regulator (CR). In ( 16), E * i and r i are the global reference voltage, and the virtual resistance (required for droop control) of the ith converter, respectively.In the applications reported in the literature, the distributed secondary control architecture of DC-MGs utilises two control actions over the voltage magnitude reference of the associated converter -similar to the strategy shown in distributed primary control section -. These distributed control actions, based on (6), are shown in (16). They come from control algorithms of Voltage Regulator (VR) and Current Regulator (CR). In ( 16), E * i and r i are the global reference voltage, and the virtual resistance (required for droop control) of the ith converter, respectively.</p>
        <p>Early work on distributed secondary control strategies applied to DC-MGs is discussed in [222], [223]. The control [see [208] and ( 14)-( 15)].Early work on distributed secondary control strategies applied to DC-MGs is discussed in [222], [223]. The control [see [208] and ( 14)-( 15)].</p>
        <p>systems reported in these works require a strongly connected communication between DERs to share measurements (or estimations) of voltages and currents and thus calculate the reference voltage (E ref isystems reported in these works require a strongly connected communication between DERs to share measurements (or estimations) of voltages and currents and thus calculate the reference voltage (E ref i</p>
        <p>) to be synthesised by the ith DER. Other distributed secondary control approach is proposed in [57], [58]. In [58], the voltage reference E ref i is calculated using droop control (i.e., E i * -r i I i ) and two voltage correction signals, δE 1 i and δE 2 i , which are calculated from control schemes based on an average-voltage observer and a normalised current consensus, respectively. The main objective of this strategy is to regulate the average voltage to the reference value E i * and to improve the power/current sharing among DERs. However, there is a trade-off between voltage regulation and the improvement of power/current sharing among power converters (i.e. this is similar to the problem produced by the Q -E droop control in AC-MGs). For the control system designing, prior information about global parameters of the MG is not required (e.g. the number of DERs in the MG). Thus, the approach is scalable and features plug-and-play capability. The control proposed in [58] is similar to [108]; In its leaderless form, it can be summarised as depicted in Fig. 12.) to be synthesised by the ith DER. Other distributed secondary control approach is proposed in [57], [58]. In [58], the voltage reference E ref i is calculated using droop control (i.e., E i * -r i I i ) and two voltage correction signals, δE 1 i and δE 2 i , which are calculated from control schemes based on an average-voltage observer and a normalised current consensus, respectively. The main objective of this strategy is to regulate the average voltage to the reference value E i * and to improve the power/current sharing among DERs. However, there is a trade-off between voltage regulation and the improvement of power/current sharing among power converters (i.e. this is similar to the problem produced by the Q -E droop control in AC-MGs). For the control system designing, prior information about global parameters of the MG is not required (e.g. the number of DERs in the MG). Thus, the approach is scalable and features plug-and-play capability. The control proposed in [58] is similar to [108]; In its leaderless form, it can be summarised as depicted in Fig. 12.</p>
        <p>In [224], a simplified version of the controller in [58] was developed, and it is shown in (17). Notice that this strategy utilises power-sharing consensus instead of using a currentsharing consensus. This is implemented to avoid the coupling between power and voltage loops:In [224], a simplified version of the controller in [58] was developed, and it is shown in (17). Notice that this strategy utilises power-sharing consensus instead of using a currentsharing consensus. This is implemented to avoid the coupling between power and voltage loops:</p>
        <p>In ( 17), the term k E i &gt; 0 is a control gain which modifies the dynamic response and convergence of the algorithm; E i * is the reference for the average voltage along the MG, E i is the voltage value of the ith DER, and (P i /P * i ) is the normalised power of the ith DER. The coefficient a ij represents the elements of the adjacency matrix, and g i represents the connectivity of leader units that have access to the reference values to be restored. Here, an additional term, γ, is used to regulate the compromise between voltage and power regulation [224]. To calculate δE 1 i , the voltage observer of [58] can be optionally added, as shown in the previous section, where primary control systems are discussed. It is worth noticing that when g i = 1 ∀ i ∈ N , it is assumed that all units know the reference value E i * . Otherwise, leader units have to receive updates of E i * from (for instance) a tertiary control system [57].In ( 17), the term k E i &gt; 0 is a control gain which modifies the dynamic response and convergence of the algorithm; E i * is the reference for the average voltage along the MG, E i is the voltage value of the ith DER, and (P i /P * i ) is the normalised power of the ith DER. The coefficient a ij represents the elements of the adjacency matrix, and g i represents the connectivity of leader units that have access to the reference values to be restored. Here, an additional term, γ, is used to regulate the compromise between voltage and power regulation [224]. To calculate δE 1 i , the voltage observer of [58] can be optionally added, as shown in the previous section, where primary control systems are discussed. It is worth noticing that when g i = 1 ∀ i ∈ N , it is assumed that all units know the reference value E i * . Otherwise, leader units have to receive updates of E i * from (for instance) a tertiary control system [57].</p>
        <p>Other alternatives for distributed secondary controllers have been proposed in the literature. Optimal controllers are discussed in [225] to solve the problem of optimal voltage and power regulation for DC-DERs. Although a full knowledge of the communication network is required for the nonlinear optimal controller, two distributed approaches are suggested, which can be implemented using partial information from neighbours. A distributed secondary control applied for voltage regulation and droop slope correction is discussed in [226]. The controller is utilised to modify the droop slope to alter the output impedance in each converter to achieve load current sharing.Other alternatives for distributed secondary controllers have been proposed in the literature. Optimal controllers are discussed in [225] to solve the problem of optimal voltage and power regulation for DC-DERs. Although a full knowledge of the communication network is required for the nonlinear optimal controller, two distributed approaches are suggested, which can be implemented using partial information from neighbours. A distributed secondary control applied for voltage regulation and droop slope correction is discussed in [226]. The controller is utilised to modify the droop slope to alter the output impedance in each converter to achieve load current sharing.</p>
        <p>A figure of merit called quality index has been proposed in [124]. This index constitutes a weighted average of terms representing the voltage regulation and the power-sharing at each source bus/node, and it is utilised to find the optimal droop coefficients. It is claimed that this methodology re- duces the data transferred between neighbouring units increasing the system reliability. Only the output current is exchanged to guarantee the convergence of the proposed method.A figure of merit called quality index has been proposed in [124]. This index constitutes a weighted average of terms representing the voltage regulation and the power-sharing at each source bus/node, and it is utilised to find the optimal droop coefficients. It is claimed that this methodology re- duces the data transferred between neighbouring units increasing the system reliability. Only the output current is exchanged to guarantee the convergence of the proposed method.</p>
        <p>In [227], a low voltage DC-MG with merged AC and DC characteristics has been utilised to propose an alternative droop scheme for low-voltage DC-MG with both primary power-sharing and secondary voltage regulation merged. Two droop expressions are proposed, the first expression is for regulating the AC frequency and active power generated, while the second one is for relating the DC voltage to the second power term. It is claimed in [227] that better active power-sharing and proper average voltage regulation in the DC-MG, are achieved.In [227], a low voltage DC-MG with merged AC and DC characteristics has been utilised to propose an alternative droop scheme for low-voltage DC-MG with both primary power-sharing and secondary voltage regulation merged. Two droop expressions are proposed, the first expression is for regulating the AC frequency and active power generated, while the second one is for relating the DC voltage to the second power term. It is claimed in [227] that better active power-sharing and proper average voltage regulation in the DC-MG, are achieved.</p>
        <p>1) Distributed control for energy storage systems in DC-MGs DC-MGs are characterised by containing Energy Storage Systems (ESS) (see [228], [229]). As discussed in [230], ESSs have several applications in the MG context, particularly in the case of stand-alone systems [228], [229], [231]. For instance, for power balancing and for providing synthetic inertia to support the transient stability of the system (see [231]), DC-voltage bus regulation, power peak shaving, power smoothing, etc. For each application studied, it is necessary to avoid overcharging or deep discharging of the ESS. Particularly in the case of battery banks, to avoid jeopardising the expected life of energy storage units.1) Distributed control for energy storage systems in DC-MGs DC-MGs are characterised by containing Energy Storage Systems (ESS) (see [228], [229]). As discussed in [230], ESSs have several applications in the MG context, particularly in the case of stand-alone systems [228], [229], [231]. For instance, for power balancing and for providing synthetic inertia to support the transient stability of the system (see [231]), DC-voltage bus regulation, power peak shaving, power smoothing, etc. For each application studied, it is necessary to avoid overcharging or deep discharging of the ESS. Particularly in the case of battery banks, to avoid jeopardising the expected life of energy storage units.</p>
        <p>ESS degradation is a consequence of how the battery cells are operated [e.g., initial and final SoC values within each cycle]. Several research efforts have been reported in the literature to propose distributed secondary control strategies to achieve state-of-charge equalisation among the energy storage units [232], [233]. Besides the typical tasks of the secondary control system (i.e. voltage restoration and powersharing), in [130], the charge/discharge of the batteries is monitored, and the SoCs are equalised, simultaneously, by using a distributed controller which regulates the ESS droop coefficients. Alternatively, adaptive virtual impedances adjusted using distributed control algorithms can be utilised to achieve SoC equalisation among the ESSs located in a MG (see [137]). It is claimed that virtual impedance-based methods are intrinsically more stable because droop variations can affect the stability of AC/DC-MGs [137]. In [131], ultracapacitors are included in the ESS, which posses two time-scales, one for the batteries (slower) and the other for the ultracapacitors (faster). In [141], a feedback linearisation technique is used to obtain a second-order consensus strategy of the voltage applied to equalise the SoC of a BESS.ESS degradation is a consequence of how the battery cells are operated [e.g., initial and final SoC values within each cycle]. Several research efforts have been reported in the literature to propose distributed secondary control strategies to achieve state-of-charge equalisation among the energy storage units [232], [233]. Besides the typical tasks of the secondary control system (i.e. voltage restoration and powersharing), in [130], the charge/discharge of the batteries is monitored, and the SoCs are equalised, simultaneously, by using a distributed controller which regulates the ESS droop coefficients. Alternatively, adaptive virtual impedances adjusted using distributed control algorithms can be utilised to achieve SoC equalisation among the ESSs located in a MG (see [137]). It is claimed that virtual impedance-based methods are intrinsically more stable because droop variations can affect the stability of AC/DC-MGs [137]. In [131], ultracapacitors are included in the ESS, which posses two time-scales, one for the batteries (slower) and the other for the ultracapacitors (faster). In [141], a feedback linearisation technique is used to obtain a second-order consensus strategy of the voltage applied to equalise the SoC of a BESS.</p>
        <p>To improve the convergence speed, in [64], [141], [234] finite-time protocols for consensus applications are investigated. In [64], the finite-time protocol includes an inputsaturation restriction. That strategy is compared against that reported in [58], and it is claimed that the proposed methodology achieves a slightly better response time with less overshoot. In [141], a finite-time controller for average voltage regulation is combined with a second-order consensus of the BESS-SoC. It is claimed that this methodology improves the current sharing within a finite settling time.To improve the convergence speed, in [64], [141], [234] finite-time protocols for consensus applications are investigated. In [64], the finite-time protocol includes an inputsaturation restriction. That strategy is compared against that reported in [58], and it is claimed that the proposed methodology achieves a slightly better response time with less overshoot. In [141], a finite-time controller for average voltage regulation is combined with a second-order consensus of the BESS-SoC. It is claimed that this methodology improves the current sharing within a finite settling time.</p>
        <p>Other strategies to improve consensus are related to optimising communication channel usage. Limiting the rate of shared information required for DC DERs leads to benefits that have been reported in the literature [164], [201], [235]. One of the first works that applied this concept to MGs was [236]. In this work, a self-triggered aperiodic communication is utilised for coordinating the consensus control actions. This aperiodic communication reduces the data transmission rates required among DERs. For the implementation, a point to point communication was considered between neighbouring units and the instant of time where the next transmission of information transmission will occur is precalculated depending on a power error threshold.Other strategies to improve consensus are related to optimising communication channel usage. Limiting the rate of shared information required for DC DERs leads to benefits that have been reported in the literature [164], [201], [235]. One of the first works that applied this concept to MGs was [236]. In this work, a self-triggered aperiodic communication is utilised for coordinating the consensus control actions. This aperiodic communication reduces the data transmission rates required among DERs. For the implementation, a point to point communication was considered between neighbouring units and the instant of time where the next transmission of information transmission will occur is precalculated depending on a power error threshold.</p>
        <p>The effect of delays in the communication network has been studied in distributed secondary control strategies of MGs [126], [141], [174], [220], [237]. Most of these studies focus on AC-MGs due to the frequency stability issues and will be further addressed in the AC-MG subsection. Nonetheless, the analysed techniques and graph conditions for convergence can be extended to study DC-MGs. In [220], small-signal modelling and analysis of the secondary control systems are performed for AC-MGs, and the effect of timedelays is further studied. Later on, this work was expanded in [126] to the DC-MG case. In [141], a linear matrix transformation method is applied to a DC-MG; it is based on Arstein's algebra [238], which allows to derive a delayfree model to be analysed.The effect of delays in the communication network has been studied in distributed secondary control strategies of MGs [126], [141], [174], [220], [237]. Most of these studies focus on AC-MGs due to the frequency stability issues and will be further addressed in the AC-MG subsection. Nonetheless, the analysed techniques and graph conditions for convergence can be extended to study DC-MGs. In [220], small-signal modelling and analysis of the secondary control systems are performed for AC-MGs, and the effect of timedelays is further studied. Later on, this work was expanded in [126] to the DC-MG case. In [141], a linear matrix transformation method is applied to a DC-MG; it is based on Arstein's algebra [238], which allows to derive a delayfree model to be analysed.</p>
        <p>The secondary control loop for AC-MGs is used to restore amplitude and frequency of the voltages to their nominal values. In this sense, it should be highlighted that the frequency is a global parameter of the MG. In contrast, the voltage is not a global variable (i.e., different values of voltages could be obtained, in steady-state, at different points of the MG). Therefore, voltage regulation can be achieved by different criteria, for instance, by (i) regulating the converters' output voltage to values close to the nominal one, (ii) regulating the average voltage of the MG, (iii) regulating the voltage in some specific points of the MG, etc. Several distributed secondary control strategies for MGs have been proposed in the literature. For instance, in [123], [198], it is proposed to utilise the average values of voltage and frequency to enhance the primary droop characteristics. Inspired by techniques from the cooperative control of 
            <rs type="software">MAS</rs>, other works proposed secondary control algorithms that ensure asymptotic convergence of the controlled variables [63], [128], [147], [239], [240].
        </p>
        <p>Works reported in [128], [239] propose a secondary control system based on an input-output feedback linearisation approach [241], with only simulation results being presented in both research efforts. In [239], the proposed methodology allows a non-linear formulation to be solved by conventional asymptotic consensus protocols (first and second-order protocols). The non-linear relationship is developed for the voltage loop based on [242], and the feedback linearisation relies on Lie's algebra [241]. The methods presented by the authors of [239] inspire further developments in secondary control [63], [141], [147].Works reported in [128], [239] propose a secondary control system based on an input-output feedback linearisation approach [241], with only simulation results being presented in both research efforts. In [239], the proposed methodology allows a non-linear formulation to be solved by conventional asymptotic consensus protocols (first and second-order protocols). The non-linear relationship is developed for the voltage loop based on [242], and the feedback linearisation relies on Lie's algebra [241]. The methods presented by the authors of [239] inspire further developments in secondary control [63], [141], [147].</p>
        <p>In [63], the authors proposed a simplified methodology for the application of distributed cooperative secondary control over traditional droop based converter-based MGs. The strategy considers a distributed averaging algorithm to reestablish the frequency and voltage values at the output of each DER and to enhance reactive and active power-sharing. This controller acts over primary droop control schemes by applying an integral control with a consensus protocol referred to as Distributed-Averaging Proportional-Integral (DAPI) controller. The DAPI system is further explained as follows:In [63], the authors proposed a simplified methodology for the application of distributed cooperative secondary control over traditional droop based converter-based MGs. The strategy considers a distributed averaging algorithm to reestablish the frequency and voltage values at the output of each DER and to enhance reactive and active power-sharing. This controller acts over primary droop control schemes by applying an integral control with a consensus protocol referred to as Distributed-Averaging Proportional-Integral (DAPI) controller. The DAPI system is further explained as follows:</p>
        <p>Firstly, the DAPI expressions shown in ( 18)-( 19) are proposed to restore the frequency in the MG (to the nominal value) and to ensure an accurate active power-sharing among DER units.Firstly, the DAPI expressions shown in ( 18)-( 19) are proposed to restore the frequency in the MG (to the nominal value) and to ensure an accurate active power-sharing among DER units.</p>
        <p>where Ω i is utilised to restore the frequency, k ω i &gt;0 is a coefficient utilised to regulate the velocity of the secondary control (i.e. it defines the transient response of the controller), ω i is the frequency and P i is the active power of the ith DER. Equation ( 18) corresponds to the standard droop control augmented with the additional secondary control input Ω i . The integral term in (19) ensures frequency restoration in steady-state since, as aforementioned, the frequency is a global variable (i.e. ω i = ω * ). Additionally, the condition Ω i = Ω j has to be fulfilled for all the DERs ∀i, j ∈ N to guarantee that all droop curves are shifted by the same value. The latter condition ensures that the active power-sharing is maintained [63].where Ω i is utilised to restore the frequency, k ω i &gt;0 is a coefficient utilised to regulate the velocity of the secondary control (i.e. it defines the transient response of the controller), ω i is the frequency and P i is the active power of the ith DER. Equation ( 18) corresponds to the standard droop control augmented with the additional secondary control input Ω i . The integral term in (19) ensures frequency restoration in steady-state since, as aforementioned, the frequency is a global variable (i.e. ω i = ω * ). Additionally, the condition Ω i = Ω j has to be fulfilled for all the DERs ∀i, j ∈ N to guarantee that all droop curves are shifted by the same value. The latter condition ensures that the active power-sharing is maintained [63].</p>
        <p>Secondly, the DAPI voltage controller is proposed in [63] to restore the voltage amplitude in each DER of the MG and to improve the reactive power-sharing among units is given by ( 20)-( 21).Secondly, the DAPI voltage controller is proposed in [63] to restore the voltage amplitude in each DER of the MG and to improve the reactive power-sharing among units is given by ( 20)-( 21).</p>
        <p>where δE i is the secondary control variable, β i and k E i are positive gains which could be used to modify the dynamics. Besides, Q i /Q * i is the normalised reactive power of the ith DER. Equation (20) corresponds to the voltage droop control augmented by the term δE i , while the term β i in (21) allows a trade-off between regulating the voltage E i in the ith DER or achieving a good consensus in the normalised reactive power. This trade-off between control of the voltage and reactive power-sharing is well-known and previously studied in the literature [109]. Fig. 13 shows the DAPI controllers applied to a droop-based converter. Notice that all measurements (blue dotted boxes) are assumed to be referred to a dq rotating frame orientated at θ ref i . The implementation of this distributed control scheme in the ith power converter of a 4wire isolated AC-MG is shown in Fig. 15.where δE i is the secondary control variable, β i and k E i are positive gains which could be used to modify the dynamics. Besides, Q i /Q * i is the normalised reactive power of the ith DER. Equation (20) corresponds to the voltage droop control augmented by the term δE i , while the term β i in (21) allows a trade-off between regulating the voltage E i in the ith DER or achieving a good consensus in the normalised reactive power. This trade-off between control of the voltage and reactive power-sharing is well-known and previously studied in the literature [109]. Fig. 13 shows the DAPI controllers applied to a droop-based converter. Notice that all measurements (blue dotted boxes) are assumed to be referred to a dq rotating frame orientated at θ ref i . The implementation of this distributed control scheme in the ith power converter of a 4wire isolated AC-MG is shown in Fig. 15.</p>
        <p>In low-voltage AC-MG applications, loads are typically unbalanced and also non-linear. Moreover, there is a constant connection/disconnection of single-phase loads to/from the MG. [122]. Typical loads usually connected to low-voltage AC-MGs are computers, lighting ballasts, appliances, battery chargers, etc. A relatively large fraction of these loads may have a non-linear behaviour, generating distorted load currents [243]. Because of that, both imbalance and harmonic distortion issues must be considered to design the control system. In this sense, the distributed secondary control has been extended for improving the power quality in AC-MGs by considering imbalance and harmonics issues. Fig. 14 shows a classification of distributed control schemes in this area. Control schemes can be divided into two groups (see Fig. 14) The first aims to achieve improvement in the sharing of unbalanced and distorted currents sharing among the power converters of the MG. In contrast, the scope of the second one is to compensate voltages at some bus-bars in the MG (bars where critical loads or more sensitive systems are connected). Regarding the first group, the sharing of unbalanced and/or distorted currents can be improved by inducing imbalance and/or harmonics at the converters' output voltage [183] [186]. For the second group, it is assumed that in some bus-bars of the MG, loads that cannot operate with a relatively high level of imbalance and harmonic distortion are connected. Therefore some restrictions have to be implemented in the distributed control algorithm, e.g. to decrease the maximum THD level in a particular bar (see [120]). Alternatively, an active filter could be utilised, but this is typically considered a more expensive solution [120], [122].In low-voltage AC-MG applications, loads are typically unbalanced and also non-linear. Moreover, there is a constant connection/disconnection of single-phase loads to/from the MG. [122]. Typical loads usually connected to low-voltage AC-MGs are computers, lighting ballasts, appliances, battery chargers, etc. A relatively large fraction of these loads may have a non-linear behaviour, generating distorted load currents [243]. Because of that, both imbalance and harmonic distortion issues must be considered to design the control system. In this sense, the distributed secondary control has been extended for improving the power quality in AC-MGs by considering imbalance and harmonics issues. Fig. 14 shows a classification of distributed control schemes in this area. Control schemes can be divided into two groups (see Fig. 14) The first aims to achieve improvement in the sharing of unbalanced and distorted currents sharing among the power converters of the MG. In contrast, the scope of the second one is to compensate voltages at some bus-bars in the MG (bars where critical loads or more sensitive systems are connected). Regarding the first group, the sharing of unbalanced and/or distorted currents can be improved by inducing imbalance and/or harmonics at the converters' output voltage [183] [186]. For the second group, it is assumed that in some bus-bars of the MG, loads that cannot operate with a relatively high level of imbalance and harmonic distortion are connected. Therefore some restrictions have to be implemented in the distributed control algorithm, e.g. to decrease the maximum THD level in a particular bar (see [120]). Alternatively, an active filter could be utilised, but this is typically considered a more expensive solution [120], [122].</p>
        <p>In [109], the authors propose a distributed dynamic consensus algorithm to improve the sharing of negative sequence current components and for enhancing the voltage quality at the PCC. This strategy is based on the symmetrical components theory. Therefore, to share the negative sequence component of the current between the DERs, a negative sequence component of the voltage is included in the reference voltage to be synthesised by the ith DER. This proposal ensures an accurate imbalance sharing. The AC-MG considered in [109] corresponds to two 3-leg converters in parallel configuration feeding an unbalanced load. Experimental results are provided that validate the proposal. However, it is not discussed in [109] how to extend the proposal for a more complex MG configuration. Also, the reported methodology is challenging to implement in a MG with more than two power converters. A more general approach is proposed in [136], where a distributed control algorithm, based on the cooperative consensus theory, is proposed to achieve the sharing of reactive, harmonic, and imbalance powers among 3-leg parallel converters feeding an unbalanced and distorted load. The proposal reported in [136] utilises virtual impedance loops (same as [109]), defining an unbalanced virtual impedance and some harmonic virtual impedances which are required to compensate harmonic distortion. A consensus scheme is proposed for controlling the magnitude of these virtual impedances. The proposal is experimentally validated, showing a good performance. However, the algorithm proposed in [136] does not limit imbalance and voltage distortion at the power converter outputs. This might be considered as a drawback since, in situations where the load has high imbalance level and/or distortion produced by harmonics, the control objectives can be fulfilled, but causing voltage quality problems at the converters' output voltage.In [109], the authors propose a distributed dynamic consensus algorithm to improve the sharing of negative sequence current components and for enhancing the voltage quality at the PCC. This strategy is based on the symmetrical components theory. Therefore, to share the negative sequence component of the current between the DERs, a negative sequence component of the voltage is included in the reference voltage to be synthesised by the ith DER. This proposal ensures an accurate imbalance sharing. The AC-MG considered in [109] corresponds to two 3-leg converters in parallel configuration feeding an unbalanced load. Experimental results are provided that validate the proposal. However, it is not discussed in [109] how to extend the proposal for a more complex MG configuration. Also, the reported methodology is challenging to implement in a MG with more than two power converters. A more general approach is proposed in [136], where a distributed control algorithm, based on the cooperative consensus theory, is proposed to achieve the sharing of reactive, harmonic, and imbalance powers among 3-leg parallel converters feeding an unbalanced and distorted load. The proposal reported in [136] utilises virtual impedance loops (same as [109]), defining an unbalanced virtual impedance and some harmonic virtual impedances which are required to compensate harmonic distortion. A consensus scheme is proposed for controlling the magnitude of these virtual impedances. The proposal is experimentally validated, showing a good performance. However, the algorithm proposed in [136] does not limit imbalance and voltage distortion at the power converter outputs. This might be considered as a drawback since, in situations where the load has high imbalance level and/or distortion produced by harmonics, the control objectives can be fulfilled, but causing voltage quality problems at the converters' output voltage.</p>
        <p>The aforementioned distributed control schemes [109] and [136] are proposed for 3-wire isolated AC-MGs, where paralleled power converters are utilised to feed an unbalanced and/or distorted common load. For this reason, those proposals can manage the sharing of positive and negative sequence components of currents and/or voltages, but not zero sequence components. In this sense, recently in [120], a consensus-based methodology is proposed to enhance the sharing of both imbalance and distortion in 4-wire microgrids. The method proposed in [120] is based on the CPT [119], [122] where it is required to obtain several components of the electrical power defined by the conservative power theory, namely the distorted, balanced, unbalanced and distorted components of currents and powers in the 4-wire MG studied. Therefore, the use of sequence identification algorithms is not necessary as compared to those reported in [109] and [136].The aforementioned distributed control schemes [109] and [136] are proposed for 3-wire isolated AC-MGs, where paralleled power converters are utilised to feed an unbalanced and/or distorted common load. For this reason, those proposals can manage the sharing of positive and negative sequence components of currents and/or voltages, but not zero sequence components. In this sense, recently in [120], a consensus-based methodology is proposed to enhance the sharing of both imbalance and distortion in 4-wire microgrids. The method proposed in [120] is based on the CPT [119], [122] where it is required to obtain several components of the electrical power defined by the conservative power theory, namely the distorted, balanced, unbalanced and distorted components of currents and powers in the 4-wire MG studied. Therefore, the use of sequence identification algorithms is not necessary as compared to those reported in [109] and [136].</p>
        <p>As reported in the literature, sequence identification methods are severely affected by harmonic distortion, measurement noise, sampling period variations, etc. [244], [245]. The distributed control scheme proposed in [120] is based on the concept of virtual impedance loop. Using the CPT, both an unbalanced and a distorted virtual impedance are defined in the a-b-c (stationary) frame. The unbalanced virtual impedance value (in each power converter) is adaptively corrected using the consensus algorithm depicted in (22). Similarly, the magnitude of the distorted virtual impedance (in each power converter) is adaptively calculated using (23). Experimental work is presented in [120] to validate the proposal. Fig. 15 shows the implementation of the distributed control strategy reported in [120]. In this figure, active (P i ), reactive (Q i ), unbalanced (N i ) and distorted (D i ) powers are calculated by the ith power converter using the CPT. Moreover, balanced (i b iabc ), unbalanced (i u iabc ) and distorted (i v iabc ) currents are also calculated. Using P i and Q i , regulation of both frequency and voltage is achieved, respectively, via the consensus algorithms discussed in the previous section [see (18)- (21)]. Based on (N i ) and (D i ), the sharing of imbalance and harmonics is improved, respectively, through (22) and (23) (see Fig. 15). This is achieved by adaptively changing the virtual resistors R i u and R i v [see ( 22)-( 23)].As reported in the literature, sequence identification methods are severely affected by harmonic distortion, measurement noise, sampling period variations, etc. [244], [245]. The distributed control scheme proposed in [120] is based on the concept of virtual impedance loop. Using the CPT, both an unbalanced and a distorted virtual impedance are defined in the a-b-c (stationary) frame. The unbalanced virtual impedance value (in each power converter) is adaptively corrected using the consensus algorithm depicted in (22). Similarly, the magnitude of the distorted virtual impedance (in each power converter) is adaptively calculated using (23). Experimental work is presented in [120] to validate the proposal. Fig. 15 shows the implementation of the distributed control strategy reported in [120]. In this figure, active (P i ), reactive (Q i ), unbalanced (N i ) and distorted (D i ) powers are calculated by the ith power converter using the CPT. Moreover, balanced (i b iabc ), unbalanced (i u iabc ) and distorted (i v iabc ) currents are also calculated. Using P i and Q i , regulation of both frequency and voltage is achieved, respectively, via the consensus algorithms discussed in the previous section [see (18)- (21)]. Based on (N i ) and (D i ), the sharing of imbalance and harmonics is improved, respectively, through (22) and (23) (see Fig. 15). This is achieved by adaptively changing the virtual resistors R i u and R i v [see ( 22)-( 23)].</p>
        <p>It should be highlighted that works reported in [109], [120], [136] utilise virtual impedance loops, which means that negative and/or zero sequence impedances are implemented in the control system of power converters to enable the sharing and/or compensation of imbalance and/or harmonics. In these references, imbalances and/or harmonics are quantified by defining three-phase powers (unbalanced and distorted ones). However, as shown in [179], when AC-MGs are considered, the improvement in three-phase powersharing does not ensure that the single-phase powers are appropriately shared. In this scenario, overloading in some of the DG phases may occur, producing malfunctions in the DG and load shedding, which could affect the overall security and reliability of MG behaviour. In this sense, in [246] a singlephase consensus-based approach for improving the sharing of imbalance in three-phase three-wire MGs is proposed. This approach avoids the use of virtual impedance loops using a novel approach: instead of analysing the grid as a three-phase system, it is analysed as three single-phase subsystems. Experimental results are provided validating the effectiveness of the proposal. Finally, Table 4 summarises the most important features of the proposals reported in [109], [120], [136], [246].It should be highlighted that works reported in [109], [120], [136] utilise virtual impedance loops, which means that negative and/or zero sequence impedances are implemented in the control system of power converters to enable the sharing and/or compensation of imbalance and/or harmonics. In these references, imbalances and/or harmonics are quantified by defining three-phase powers (unbalanced and distorted ones). However, as shown in [179], when AC-MGs are considered, the improvement in three-phase powersharing does not ensure that the single-phase powers are appropriately shared. In this scenario, overloading in some of the DG phases may occur, producing malfunctions in the DG and load shedding, which could affect the overall security and reliability of MG behaviour. In this sense, in [246] a singlephase consensus-based approach for improving the sharing of imbalance in three-phase three-wire MGs is proposed. This approach avoids the use of virtual impedance loops using a novel approach: instead of analysing the grid as a three-phase system, it is analysed as three single-phase subsystems. Experimental results are provided validating the effectiveness of the proposal. Finally, Table 4 summarises the most important features of the proposals reported in [109], [120], [136], [246].</p>
        <p>Some effort has been carried out to improve the stability and reliability of distributed secondary control strategies. The modelling of the DER units and data from neighbouring agents has been considered in [163] to propose an adaptive and distributed control scheme. Additionally, the coupling produced between voltages and frequencies has been addressed, including experimental work. On the other hand, a robust distributed secondary control strategy is proposed in [107] to consider the uncertainty in the communication links (between DERs), through an iterative learning mechanic. The authors claim that the controller proposed in [107] guarantees the control objectives even in the presence of uncertainties, noise and disturbance in the DER and measurements. The latter topic is also addressed in [247]. In [129], dynamic weights are reassigned to reach different targets. It is claimed that the strategy discussed in [129] could enhance the stability of the system, achieving a better dynamic response.Some effort has been carried out to improve the stability and reliability of distributed secondary control strategies. The modelling of the DER units and data from neighbouring agents has been considered in [163] to propose an adaptive and distributed control scheme. Additionally, the coupling produced between voltages and frequencies has been addressed, including experimental work. On the other hand, a robust distributed secondary control strategy is proposed in [107] to consider the uncertainty in the communication links (between DERs), through an iterative learning mechanic. The authors claim that the controller proposed in [107] guarantees the control objectives even in the presence of uncertainties, noise and disturbance in the DER and measurements. The latter topic is also addressed in [247]. In [129], dynamic weights are reassigned to reach different targets. It is claimed that the strategy discussed in [129] could enhance the stability of the system, achieving a better dynamic response.</p>
        <p>Several variations and modifications to the distributed secondary control algorithms have been proposed and studied. For instance, in [248]- [250], techniques of predictive control are utilised to restore the frequency and voltage amplitudes to nominal values. However, the theory behind these controllers outreaches the scope of this review. Another type of modification in the control algorithms is developed in [121], [146], [147], [149], [153], where finite-time consensus control is employed to restore both frequency and voltage in the MG. As explained for the DC-MG case, the proposed algorithms are designed to achieve the restoration of secondary variables (frequency and voltage) in a finite time. It is also claimed that these control strategies increase the convergence speed and the robustness against noise and uncertainties.Several variations and modifications to the distributed secondary control algorithms have been proposed and studied. For instance, in [248]- [250], techniques of predictive control are utilised to restore the frequency and voltage amplitudes to nominal values. However, the theory behind these controllers outreaches the scope of this review. Another type of modification in the control algorithms is developed in [121], [146], [147], [149], [153], where finite-time consensus control is employed to restore both frequency and voltage in the MG. As explained for the DC-MG case, the proposed algorithms are designed to achieve the restoration of secondary variables (frequency and voltage) in a finite time. It is also claimed that these control strategies increase the convergence speed and the robustness against noise and uncertainties.</p>
        <p>MG topology changes are addressed in [251]. It is claimed that seamless transitions during dynamic MG reconfiguration and proper power management among distributed generators are achieved. In [172], a consensus-based distributed secondary control method is discussed. It is claimed that this strategy achieves better voltage regulation and improves the load sharing accuracy of the V-I droop control method based upon the practical assumption of network impedance being resistive.MG topology changes are addressed in [251]. It is claimed that seamless transitions during dynamic MG reconfiguration and proper power management among distributed generators are achieved. In [172], a consensus-based distributed secondary control method is discussed. It is claimed that this strategy achieves better voltage regulation and improves the load sharing accuracy of the V-I droop control method based upon the practical assumption of network impedance being resistive.</p>
        <p>Modifications to the communication network of AC-MGs have also been studied to improve the reliability of the secondary control implementations. For instance, in [252], a distributed secondary control method based on a Controller Area Network (CAN) communication system is proposed for UPS applications. In terms of communication rate efficiency, and similarly to the DC-MG case, distributed eventtriggered approaches for the secondary control layer in AC-MGs have been studied [236], [253]- [256]. It is claimed that the methodologies reported in these works achieve a large reduction in the communication burden. In [253], an eventtriggered control scheme is presented. Utilising estimators and observers (reset and/or updated by events), the variables are updated in the control algorithms. It is reported that the strategy achieves adequate sharing of the active power, and voltage/frequency restoration using information updates just at the event trigger times.Modifications to the communication network of AC-MGs have also been studied to improve the reliability of the secondary control implementations. For instance, in [252], a distributed secondary control method based on a Controller Area Network (CAN) communication system is proposed for UPS applications. In terms of communication rate efficiency, and similarly to the DC-MG case, distributed eventtriggered approaches for the secondary control layer in AC-MGs have been studied [236], [253]- [256]. It is claimed that the methodologies reported in these works achieve a large reduction in the communication burden. In [253], an eventtriggered control scheme is presented. Utilising estimators and observers (reset and/or updated by events), the variables are updated in the control algorithms. It is reported that the strategy achieves adequate sharing of the active power, and voltage/frequency restoration using information updates just at the event trigger times.</p>
        <p>In several works, the effects of time delays in distributed controllers, for secondary control of AC-MGs, have been discussed [63], [126], [140], [141], [174], [220], [237], [257]. In [237], a stability analysis under constant and variable delays of distributed secondary voltage, frequency and reactive power is performed; the authors propose a new Lyapunov-Krasovskii functional construction to analyse the upper bound of non-uniform time-varying delay values accurately. In [63], [257], the effects of delays in the communication network into the distributed secondary control of an AC-MG are addressed. Moreover, in the former paper, a small-signal model is developed to analyse the robustness against delays of the strategy. In contrast, in the latter work, a Lyapunov-Krasovskii based large-signal stability analysis approach is presented to analyse the MG performance under communication delays. The authors in [257] claim that the control strategy is delay-independent. In [174], the authors compare the performance of several secondary controllers based on PI and Model Predictive Control (MPC) techniques. By using eigenvalue analysis, it is concluded that predictive control strategies cope better with large delay values compared with PI controllers augmented with a Smith predictor.In several works, the effects of time delays in distributed controllers, for secondary control of AC-MGs, have been discussed [63], [126], [140], [141], [174], [220], [237], [257]. In [237], a stability analysis under constant and variable delays of distributed secondary voltage, frequency and reactive power is performed; the authors propose a new Lyapunov-Krasovskii functional construction to analyse the upper bound of non-uniform time-varying delay values accurately. In [63], [257], the effects of delays in the communication network into the distributed secondary control of an AC-MG are addressed. Moreover, in the former paper, a small-signal model is developed to analyse the robustness against delays of the strategy. In contrast, in the latter work, a Lyapunov-Krasovskii based large-signal stability analysis approach is presented to analyse the MG performance under communication delays. The authors in [257] claim that the control strategy is delay-independent. In [174], the authors compare the performance of several secondary controllers based on PI and Model Predictive Control (MPC) techniques. By using eigenvalue analysis, it is concluded that predictive control strategies cope better with large delay values compared with PI controllers augmented with a Smith predictor.</p>
        <p>As discussed above, the effect of delays in the performanceAs discussed above, the effect of delays in the performance</p>
        <p>Reference [109] Reference [136] Reference [120] Reference [246] MG studied 3-wire MG of distributed control systems has been investigated in several papers [63], [126], [140], [141], [174], [220], [237], [257]. However, it seems that further research efforts are required to cope with large communication delays issues adequately.Reference [109] Reference [136] Reference [120] Reference [246] MG studied 3-wire MG of distributed control systems has been investigated in several papers [63], [126], [140], [141], [174], [220], [237], [257]. However, it seems that further research efforts are required to cope with large communication delays issues adequately.</p>
        <p>The topology of a typical hybrid MG is shown in Fig. 16.The topology of a typical hybrid MG is shown in Fig. 16.</p>
        <p>On the left-hand side is the AC-MG, and on the right-hand side is the DC-MG. One or several Interlink Converters (ILCs) interface both MGs allowing a bidirectional active power flow between them. The red dotted lines in Fig. 16 represents communication channels between DERs. Notice that, as proposed in [224], the ILCs could also be connected to the communication channels to participate in a distributed control strategy. One of the power electronics topologies proposed to operate as an interlinking converter is shown in Fig. 17. Alternatively, a four-leg converter (at the AC-side) can be utilised to interface with 4-leg MGs.On the left-hand side is the AC-MG, and on the right-hand side is the DC-MG. One or several Interlink Converters (ILCs) interface both MGs allowing a bidirectional active power flow between them. The red dotted lines in Fig. 16 represents communication channels between DERs. Notice that, as proposed in [224], the ILCs could also be connected to the communication channels to participate in a distributed control strategy. One of the power electronics topologies proposed to operate as an interlinking converter is shown in Fig. 17. Alternatively, a four-leg converter (at the AC-side) can be utilised to interface with 4-leg MGs.</p>
        <p>The study of distributed control strategies that integrate the secondary control loop in both sides of a hybrid AC/DC-MG has not been appropriately addressed yet in the literature [30], [224], [258], [259]. The research has been focused on developing separate secondary control loops on each side (AC and DC). This simplifies the decentralised operation of the ILC via normalised droop controllers [260]. However, the power-sharing among both MGs can be affected when the secondary controlled variables are restored to their nominal values.The study of distributed control strategies that integrate the secondary control loop in both sides of a hybrid AC/DC-MG has not been appropriately addressed yet in the literature [30], [224], [258], [259]. The research has been focused on developing separate secondary control loops on each side (AC and DC). This simplifies the decentralised operation of the ILC via normalised droop controllers [260]. However, the power-sharing among both MGs can be affected when the secondary controlled variables are restored to their nominal values.</p>
        <p>A distributed energy storage (DS) control scheme for a three-port hybrid AC/DC/DS MG is introduced in [261]. First, the authors consider decentralised control, using Local Power Sharing (LPS) separately in either the DCor the AC-MGs, Global Power Sharing (GPS) in the AC and DC-MGs, and Storage Power Sharing (SPS) in the storage distributed along the hybrid MG. The system is designed to allow the independent operation of each power module, even in the absence of communication links. Secondly, the amount of power exchanged between AC/DC-MGs is reduced by the implementation of a multilevel control for scheduling LPS, GPS, and SPS. This multilevel power exchange control allows to reduce the losses produced by the unnecessary power FIGURE 17. One of the topologies proposed to operate as an interlinking converter [224]. Notice that a 4-leg converter at the AC-side is also feasible. In addition the ILC could be also connected to a communication link in order to participate in distributed control algorithm.A distributed energy storage (DS) control scheme for a three-port hybrid AC/DC/DS MG is introduced in [261]. First, the authors consider decentralised control, using Local Power Sharing (LPS) separately in either the DCor the AC-MGs, Global Power Sharing (GPS) in the AC and DC-MGs, and Storage Power Sharing (SPS) in the storage distributed along the hybrid MG. The system is designed to allow the independent operation of each power module, even in the absence of communication links. Secondly, the amount of power exchanged between AC/DC-MGs is reduced by the implementation of a multilevel control for scheduling LPS, GPS, and SPS. This multilevel power exchange control allows to reduce the losses produced by the unnecessary power FIGURE 17. One of the topologies proposed to operate as an interlinking converter [224]. Notice that a 4-leg converter at the AC-side is also feasible. In addition the ILC could be also connected to a communication link in order to participate in distributed control algorithm.</p>
        <p>exchange and increases the lifetime of the storage devices.exchange and increases the lifetime of the storage devices.</p>
        <p>In [259], the authors proposed a distributed coordination control strategy for the hybrid AC/DC-MG. It is claimed that this control strategy regulates not only accurate DC current and reactive power-sharing among DERs in ACand DC-MGs but also maintains power-sharing among two MGs and restores the AC frequency and DC voltage to their nominal values. The proposed control strategy is based on a distributed consensus algorithm, which is developed to achieve accurate reactive power-sharing and DC current sharing in ACand DC-MGs. In [259], the proposed strategy is experimentally validated, and it is compared to the conventional virtual impedance method, showing adequate behaviour.In [259], the authors proposed a distributed coordination control strategy for the hybrid AC/DC-MG. It is claimed that this control strategy regulates not only accurate DC current and reactive power-sharing among DERs in ACand DC-MGs but also maintains power-sharing among two MGs and restores the AC frequency and DC voltage to their nominal values. The proposed control strategy is based on a distributed consensus algorithm, which is developed to achieve accurate reactive power-sharing and DC current sharing in ACand DC-MGs. In [259], the proposed strategy is experimentally validated, and it is compared to the conventional virtual impedance method, showing adequate behaviour.</p>
        <p>The integration of a global distributed secondary control strategy in DERs at both sides of the MG has been addressed in [224]. The authors propose a distributed control that ensures the regulation of the frequency (at the AC-side) and the amplitude (at both sides) of the voltages. Additionally, with the proposed strategy, all the DERs achieve an accurate power-sharing. The results obtained using simulation are presented and discussed in [224] to validate the capability of the proposed scheme to transfer power from the DCside to the AC-side (and vice-versa) and its plug-and-play capability. However, in [224], the ILC is not considered in the secondary control strategy.The integration of a global distributed secondary control strategy in DERs at both sides of the MG has been addressed in [224]. The authors propose a distributed control that ensures the regulation of the frequency (at the AC-side) and the amplitude (at both sides) of the voltages. Additionally, with the proposed strategy, all the DERs achieve an accurate power-sharing. The results obtained using simulation are presented and discussed in [224] to validate the capability of the proposed scheme to transfer power from the DCside to the AC-side (and vice-versa) and its plug-and-play capability. However, in [224], the ILC is not considered in the secondary control strategy.</p>
        <p>The tertiary control level typically optimises the operation of an isolated MG by managing the power flow between the dispatchable units. If the MG is working in grid-connected mode, the power flow between the MG and the main grid is optimised.The tertiary control level typically optimises the operation of an isolated MG by managing the power flow between the dispatchable units. If the MG is working in grid-connected mode, the power flow between the MG and the main grid is optimised.</p>
        <p>The optimal-cost operation of a MG could be also achieved by using ED algorithms. The ED solves an optimisation problem where the goal is to achieve the minimum operating cost of the MG, subject to some operating constraints. It is worth to mention that the ED can be implemented using centralised, decentralised [262]- [267] and distributed control approaches [44], [112], [132], [134], [135], [138], [139], [148], [169], [268]- [281].The optimal-cost operation of a MG could be also achieved by using ED algorithms. The ED solves an optimisation problem where the goal is to achieve the minimum operating cost of the MG, subject to some operating constraints. It is worth to mention that the ED can be implemented using centralised, decentralised [262]- [267] and distributed control approaches [44], [112], [132], [134], [135], [138], [139], [148], [169], [268]- [281].</p>
        <p>When ED algorithms are performed using decentralised control approaches, a communication network is not required. In this context, the adaptive droop method is the most common technique used to achieve the minimum operating cost. In [262]- [266], a droop control scheme with dynamic modification is discussed. This scheme maintains all the advantages of the traditional droop technique, with a low generating-cost. A non-linear droop is proposed in [262], [263], [265]. Meanwhile, in [264], a linear droop function is proposed, which is easier to tune and implement to produce a cost reduction. In [267], some constraints, such as voltage, and frequency limits, are included in the optimisation problem. On the other hand, in [262], an adaptive droop has been proposed, with the droop coefficients being based on the maximum generating cost of each DER unit. In all these works, the overall minimum operation cost is not achieved because the power outputs of the DER units are tuned locally, according to their own generating cost, without considering the MG global cost. These issues can be solved by using a distributed approach, where cooperative decisions among the DER units are considered. In this context, the distributed optimal dispatch of isolated MGs has been studied for AC-MG, DC-MG, and hybrid AC/DC-MGs. The main works reported in this area are discussed in the following subsections.When ED algorithms are performed using decentralised control approaches, a communication network is not required. In this context, the adaptive droop method is the most common technique used to achieve the minimum operating cost. In [262]- [266], a droop control scheme with dynamic modification is discussed. This scheme maintains all the advantages of the traditional droop technique, with a low generating-cost. A non-linear droop is proposed in [262], [263], [265]. Meanwhile, in [264], a linear droop function is proposed, which is easier to tune and implement to produce a cost reduction. In [267], some constraints, such as voltage, and frequency limits, are included in the optimisation problem. On the other hand, in [262], an adaptive droop has been proposed, with the droop coefficients being based on the maximum generating cost of each DER unit. In all these works, the overall minimum operation cost is not achieved because the power outputs of the DER units are tuned locally, according to their own generating cost, without considering the MG global cost. These issues can be solved by using a distributed approach, where cooperative decisions among the DER units are considered. In this context, the distributed optimal dispatch of isolated MGs has been studied for AC-MG, DC-MG, and hybrid AC/DC-MGs. The main works reported in this area are discussed in the following subsections.</p>
        <p>The conventional centralised dispatch problem can be solved in a distributed manner. In this sense, it should be highlighted that in contrast to the centralised approach, distributed algorithm achieve the minimum cost by considering the communication between distributed generation units (see Fig. 18).The conventional centralised dispatch problem can be solved in a distributed manner. In this sense, it should be highlighted that in contrast to the centralised approach, distributed algorithm achieve the minimum cost by considering the communication between distributed generation units (see Fig. 18).</p>
        <p>In terms of implementation, to achieve the distributed economic dispatch in MGs, the literature distinguishes between two main approaches, which are classified according to the methodology used to obtain the consensus variables. The first one uses the Incremental Cost Consensus (ICC) concept in which the Incremental Cost (IC) is estimated [148], [269]- [271]. In contrast, the second one employs the Distributed Gradient method [70], [140], [257], [270], which directly calculates a global incremental cost through a consensus algorithm. Both approaches are discussed below.In terms of implementation, to achieve the distributed economic dispatch in MGs, the literature distinguishes between two main approaches, which are classified according to the methodology used to obtain the consensus variables. The first one uses the Incremental Cost Consensus (ICC) concept in which the Incremental Cost (IC) is estimated [148], [269]- [271]. In contrast, the second one employs the Distributed Gradient method [70], [140], [257], [270], which directly calculates a global incremental cost through a consensus algorithm. Both approaches are discussed below.</p>
        <p>The ICC approach is based on a consensus algorithm of incremental costs. The ICC proposed in [148], [269]- [271] is defined in (24), where λ i [k + 1] is the estimation of the IC for each generator; P i is the active power injected by each DER; β i and α i are the values of the quadratic cost function associated to the ith generator; P D,i is the power demand of the system; P D,i [t + 1] is the estimation of the global supplydemand mismatch defined in (24c); and is a positive scalar, which represents the convergence coefficient and controls the convergence speed [138], [269].The ICC approach is based on a consensus algorithm of incremental costs. The ICC proposed in [148], [269]- [271] is defined in (24), where λ i [k + 1] is the estimation of the IC for each generator; P i is the active power injected by each DER; β i and α i are the values of the quadratic cost function associated to the ith generator; P D,i is the power demand of the system; P D,i [t + 1] is the estimation of the global supplydemand mismatch defined in (24c); and is a positive scalar, which represents the convergence coefficient and controls the convergence speed [138], [269].</p>
        <p>In (24a) and (24d), a ij represents the elements of the adjacency matrix (see Section II.1). In (24a), the consensus variable corresponds to the incremental cost λ, whereas in (24d), the estimation of the demand PD,j is the consensus variable. The incremental cost, λ i , in (24a) and (24b) is usually obtained by a constrained optimisation problem. Under optimal operating conditions, the incremental cost of all DER units should be equal to the optimal Lagrange multiplier [148].In (24a) and (24d), a ij represents the elements of the adjacency matrix (see Section II.1). In (24a), the consensus variable corresponds to the incremental cost λ, whereas in (24d), the estimation of the demand PD,j is the consensus variable. The incremental cost, λ i , in (24a) and (24b) is usually obtained by a constrained optimisation problem. Under optimal operating conditions, the incremental cost of all DER units should be equal to the optimal Lagrange multiplier [148].</p>
        <p>The formulation of the optimisation problem assumes that the generating units have a quadratic cost function [see (25a)], where C i (P i ) is the operating cost associated to the ith DER unit; α i , β i and γ i are the coefficients related to the local cost function, P i is the active power injected by the ith DER. The total cost is obtained from (25b) (where n corresponds to the number of generation units in the MG). The power balance constraint is defined by (25c), where P D is the demanded power of the MG. Finally, the IC for the ith DER units is given by (25d) [269].The formulation of the optimisation problem assumes that the generating units have a quadratic cost function [see (25a)], where C i (P i ) is the operating cost associated to the ith DER unit; α i , β i and γ i are the coefficients related to the local cost function, P i is the active power injected by the ith DER. The total cost is obtained from (25b) (where n corresponds to the number of generation units in the MG). The power balance constraint is defined by (25c), where P D is the demanded power of the MG. Finally, the IC for the ith DER units is given by (25d) [269].</p>
        <p>In [269], the ICC algorithm is implemented considering two different communication topologies. In [138], [139], the minimisation cost is achieved by implementing the ICC algorithm utilising multi-agent systems (MASs) in which each DER agent regulates the injected power by using a frequency droop strategy. The implementation of this proposal is shown in Fig. 19a. The convergence analysis considering different values of is also presented in [139].In [269], the ICC algorithm is implemented considering two different communication topologies. In [138], [139], the minimisation cost is achieved by implementing the ICC algorithm utilising multi-agent systems (MASs) in which each DER agent regulates the injected power by using a frequency droop strategy. The implementation of this proposal is shown in Fig. 19a. The convergence analysis considering different values of is also presented in [139].</p>
        <p>The studies described above implement the ICC algorithm to obtain the optimal operating cost of the MG. Nevertheless, these works do not consider power generation limits. To include the inequality constraint (P min i ≤ P i ≤ P max i ), the equation set of ( 26) is included (see [271], [273]- [275]) where P minThe studies described above implement the ICC algorithm to obtain the optimal operating cost of the MG. Nevertheless, these works do not consider power generation limits. To include the inequality constraint (P min i ≤ P i ≤ P max i ), the equation set of ( 26) is included (see [271], [273]- [275]) where P min</p>
        <p>In [271], [274], (24a)-(24d) are used to implement a distributed optimal dispatch scheme, where two controllers are required: an upper controller that corresponds to the ICC, and a lower controller that includes the power limits given by (26).In [271], [274], (24a)-(24d) are used to implement a distributed optimal dispatch scheme, where two controllers are required: an upper controller that corresponds to the ICC, and a lower controller that includes the power limits given by (26).</p>
        <p>Note that in (25), renewable generation units are not included, because these can be considered with zero operating cost. However, in [272], the operating cost of the conventional generator and renewable generation units are considered. To achieve that, the authors define a pseudo renewable generation cost, where the objective of the power dispatch for renewable generation units is to minimise the curtailment of renewable energy (a subgradient algorithm is used). In [272], a two-stage method is presented. In the first stage, a distributed subgradient algorithm (algorithm for minimising a non-differentiable convex function) is utilised to recover the frequency rapidly. However, frequency measurement errors may prevent the first-stage iteration process from achieving steady-state convergence. In the second stage, an average consensus algorithm is applied to solve frequency oscillations caused by measurement errors. Thus, when frequency deviation lies below a certain threshold and lasts for a given period of time, the second stage algorithm will be activated.Note that in (25), renewable generation units are not included, because these can be considered with zero operating cost. However, in [272], the operating cost of the conventional generator and renewable generation units are considered. To achieve that, the authors define a pseudo renewable generation cost, where the objective of the power dispatch for renewable generation units is to minimise the curtailment of renewable energy (a subgradient algorithm is used). In [272], a two-stage method is presented. In the first stage, a distributed subgradient algorithm (algorithm for minimising a non-differentiable convex function) is utilised to recover the frequency rapidly. However, frequency measurement errors may prevent the first-stage iteration process from achieving steady-state convergence. In the second stage, an average consensus algorithm is applied to solve frequency oscillations caused by measurement errors. Thus, when frequency deviation lies below a certain threshold and lasts for a given period of time, the second stage algorithm will be activated.</p>
        <p>In [273], [276], it is included the network topology, transmission losses, and ICC consensus to achieve the optimal power flow inside the MG.In [273], [276], it is included the network topology, transmission losses, and ICC consensus to achieve the optimal power flow inside the MG.</p>
        <p>Unlike ICC, in the distributed gradient approach (see Fig. 19b), λ i is not estimated, it is calculated using (25d) as shown in (27).Unlike ICC, in the distributed gradient approach (see Fig. 19b), λ i is not estimated, it is calculated using (25d) as shown in (27).</p>
        <p>To achieve identical λ i in all the DER units, the consensus algorithm shown in (28) is implemented. In this expression λ i is the gradient for the neighbouring DERs i and j. The value of λ i is calculated, not estimated, therefore the power balance can be defined by (29).To achieve identical λ i in all the DER units, the consensus algorithm shown in (28) is implemented. In this expression λ i is the gradient for the neighbouring DERs i and j. The value of λ i is calculated, not estimated, therefore the power balance can be defined by (29).</p>
        <p>where P L k is the demand of the kth load; d ik = 1 if the load kth is in the neighbourhood of the generator ith; otherwise, d ik = 0. The implementation of a distributed gradient approach is shown in Fig. 19b. The distributed gradient λ i approach is utilised in [70], [140], [257], [270]. In [70], the frequency restoration is implemented to optimise the power-sharing. The same authors published in [270] a distributed control scheme where the active power limits are considered. The proposal has two stages: the first one calculates the optimal unconstrained incremental cost in the same manner as in [70], whereas the second one checks power generation constraint violations: if the constraint is activated, power injected from that DER unit is set to its maximum power limit [see (26)]. On the other hand, the authors in [140] and [257] consider the same approach but analysing the effects of communication delays into the consensus algorithm.where P L k is the demand of the kth load; d ik = 1 if the load kth is in the neighbourhood of the generator ith; otherwise, d ik = 0. The implementation of a distributed gradient approach is shown in Fig. 19b. The distributed gradient λ i approach is utilised in [70], [140], [257], [270]. In [70], the frequency restoration is implemented to optimise the power-sharing. The same authors published in [270] a distributed control scheme where the active power limits are considered. The proposal has two stages: the first one calculates the optimal unconstrained incremental cost in the same manner as in [70], whereas the second one checks power generation constraint violations: if the constraint is activated, power injected from that DER unit is set to its maximum power limit [see (26)]. On the other hand, the authors in [140] and [257] consider the same approach but analysing the effects of communication delays into the consensus algorithm.</p>
        <p>ED based on ICC and distributed gradient algorithms is achieved as long as the congestion in the electrical lines of the MG is not produced. In this context, in [44], the authors propose a distributed control scheme for addressing the problem of optimal dispatch in isolated AC-MGs with congestion in the lines. In this proposal, the frequency regulation, congestion management, and optimal dispatch are achieved at the same time scale. The proposed distributed controller is based on the centralised ED problem, which includes constraints related to line current capacity limits. The distributed ED includes the KKT stationary optimality conditions.ED based on ICC and distributed gradient algorithms is achieved as long as the congestion in the electrical lines of the MG is not produced. In this context, in [44], the authors propose a distributed control scheme for addressing the problem of optimal dispatch in isolated AC-MGs with congestion in the lines. In this proposal, the frequency regulation, congestion management, and optimal dispatch are achieved at the same time scale. The proposed distributed controller is based on the centralised ED problem, which includes constraints related to line current capacity limits. The distributed ED includes the KKT stationary optimality conditions.</p>
        <p>Moreover, it considers the maximum and minimum power outputs of DER units, and line capacity limits (in terms of current). Also, the Lagrange multipliers of the centralised optimal dispatch problem are used for designing the control actions of the proposed distributed controllers. In this proposal, the frequency and voltage restoration are solved at the same time that the ED with management congestion is achieved.Moreover, it considers the maximum and minimum power outputs of DER units, and line capacity limits (in terms of current). Also, the Lagrange multipliers of the centralised optimal dispatch problem are used for designing the control actions of the proposed distributed controllers. In this proposal, the frequency and voltage restoration are solved at the same time that the ED with management congestion is achieved.</p>
        <p>The authors in [277] analyse the convergence of distributed ED algorithms based on a simulation approach. On the other hand, [278] presents a second-order dynamic ED method, which is fully distributed and based on a parallel primal-dual interior-point algorithm with a matrix-splitting technique. In [279], authors prove the convergence of the algorithm using multi-parameter matrix perturbation and graph theory, and it is shown that the convergent values are the optimal solution of the proposed distributed ED control scheme. On the other hand, it is worth to mention that the centralised ED is achieved if the KKT conditions of a linear optimal power flow formulation are satisfied. In this context, in [44], the optimally of the proposal is demonstrated by showing that the KKT conditions are satisfied in the proposed distributed ED scheme.The authors in [277] analyse the convergence of distributed ED algorithms based on a simulation approach. On the other hand, [278] presents a second-order dynamic ED method, which is fully distributed and based on a parallel primal-dual interior-point algorithm with a matrix-splitting technique. In [279], authors prove the convergence of the algorithm using multi-parameter matrix perturbation and graph theory, and it is shown that the convergent values are the optimal solution of the proposed distributed ED control scheme. On the other hand, it is worth to mention that the centralised ED is achieved if the KKT conditions of a linear optimal power flow formulation are satisfied. In this context, in [44], the optimally of the proposal is demonstrated by showing that the KKT conditions are satisfied in the proposed distributed ED scheme.</p>
        <p>The ICC approach for AC-MGs discussed in the previous section can be extended to DC-MGs, where a consensus algorithm is used to achieve equal IC in all the generating units. The distributed ED of DC-MGs, unlike the distributed ED of AC-MG, modifies the voltage droop control scheme. In this context, the ED is solved at the same time that the global average voltage is restored [132], [135].The ICC approach for AC-MGs discussed in the previous section can be extended to DC-MGs, where a consensus algorithm is used to achieve equal IC in all the generating units. The distributed ED of DC-MGs, unlike the distributed ED of AC-MG, modifies the voltage droop control scheme. In this context, the ED is solved at the same time that the global average voltage is restored [132], [135].</p>
        <p>In [132], the ED is achieved by modifying the voltage reference from the droop control for DC-MGs through a PI controller (K p (P * G,i -P G,i ) + K i (P * G,i -P G,i ), which modifies the output power of the ith DER (P G,i ) to be equal to the optimal output power (P * G,i ). P * G,i is obtained using a ICC algorithm similar to that shown in (24). However, this work has some limitations: the power limits for DERs are not considered. Moreover, this strategy only regulates the local output voltage of each DER instead of the global voltage of the MG, not being able to guarantee the optimal operation.In [132], the ED is achieved by modifying the voltage reference from the droop control for DC-MGs through a PI controller (K p (P * G,i -P G,i ) + K i (P * G,i -P G,i ), which modifies the output power of the ith DER (P G,i ) to be equal to the optimal output power (P * G,i ). P * G,i is obtained using a ICC algorithm similar to that shown in (24). However, this work has some limitations: the power limits for DERs are not considered. Moreover, this strategy only regulates the local output voltage of each DER instead of the global voltage of the MG, not being able to guarantee the optimal operation.</p>
        <p>In [135], the global voltage regulation issue is covered, and the distributed consensus technique is used for ED and voltage control of the MG. The voltage reference for the local control is modified by adding the voltage deviations δE i,1 and δE i,2 to the reference voltage. The term δE i,1 is added to achieve the ED of the DC-MG, which is based on an ICC approach (24). The term δE i,2 is obtained from a PI controller, which removes the bus voltage deviation through distributed cooperation with the DER neighbours. Finally, unlike [132], the works reported in [135], [280] include the limits of the active power, as depicted in (26).In [135], the global voltage regulation issue is covered, and the distributed consensus technique is used for ED and voltage control of the MG. The voltage reference for the local control is modified by adding the voltage deviations δE i,1 and δE i,2 to the reference voltage. The term δE i,1 is added to achieve the ED of the DC-MG, which is based on an ICC approach (24). The term δE i,2 is obtained from a PI controller, which removes the bus voltage deviation through distributed cooperation with the DER neighbours. Finally, unlike [132], the works reported in [135], [280] include the limits of the active power, as depicted in (26).</p>
        <p>In [112], a distributed adaptive droop control algorithm is proposed for optimal dispatch and secondary current regulation by applying a consensus algorithm. The droop voltage controller E ref i is obtained by (30); where E nom denotes the global nominal voltage of the DC-MG, m is the droop coefficient, i outi is the ith converter output current, i ref i is the current reference obtained from the distributed ED model, and ∆E i is the voltage correction. The latter term is added to cancel out the effect of line impedances.In [112], a distributed adaptive droop control algorithm is proposed for optimal dispatch and secondary current regulation by applying a consensus algorithm. The droop voltage controller E ref i is obtained by (30); where E nom denotes the global nominal voltage of the DC-MG, m is the droop coefficient, i outi is the ith converter output current, i ref i is the current reference obtained from the distributed ED model, and ∆E i is the voltage correction. The latter term is added to cancel out the effect of line impedances.</p>
        <p>In [112], an ED problem similar to that shown in ( 25) is used to obtain λ considering power losses, where a penalty term is added into the cost function (25), as shown in (31). The transmission losses are approximated by the square of the output power of each generating unit (d i P 2 i ). Although this penalty term is added for considering the transmission losses in the cost function, the power-losses are not modelled.In [112], an ED problem similar to that shown in ( 25) is used to obtain λ considering power losses, where a penalty term is added into the cost function (25), as shown in (31). The transmission losses are approximated by the square of the output power of each generating unit (d i P 2 i ). Although this penalty term is added for considering the transmission losses in the cost function, the power-losses are not modelled.</p>
        <p>Reference [281] solves an ED problem applying the distributed λ approach, to achieve equal incremental cost in all the generating units. The proposal also includes a regulation of the average DER output voltage to take care of the generation-demand. The ED implemented to obtain λ considers an estimation of the total power losses (P loss ), which are assumed constant. Several works include time delay analysis in their proposed consensus algorithms to evaluate their performance in this scenario. As reported in [134], time delays affect the convergence and performance of consensus algorithms. Thus, in [132], [133], [140], the effects of a constant communication delay on the ED problem are studied using simulation work, while in [134], time-varying delays are analysed. Finally, in [134], the effects of the communication delay on the system stability is studied by using a linear matrix inequality.Reference [281] solves an ED problem applying the distributed λ approach, to achieve equal incremental cost in all the generating units. The proposal also includes a regulation of the average DER output voltage to take care of the generation-demand. The ED implemented to obtain λ considers an estimation of the total power losses (P loss ), which are assumed constant. Several works include time delay analysis in their proposed consensus algorithms to evaluate their performance in this scenario. As reported in [134], time delays affect the convergence and performance of consensus algorithms. Thus, in [132], [133], [140], the effects of a constant communication delay on the ED problem are studied using simulation work, while in [134], time-varying delays are analysed. Finally, in [134], the effects of the communication delay on the system stability is studied by using a linear matrix inequality.</p>
        <p>The economic dispatch in hybrid AC/DC-MGs has been typically addressed using a centralised approach, which solves an optimisation problem. The optimisation problem can be solved under market price uncertainties [282], by considering generation and load uncertainties [36] or energy storage losses [283].The economic dispatch in hybrid AC/DC-MGs has been typically addressed using a centralised approach, which solves an optimisation problem. The optimisation problem can be solved under market price uncertainties [282], by considering generation and load uncertainties [36] or energy storage losses [283].</p>
        <p>Although these approaches are viable, it is worth noting that the centralised ED approach has lower reliability under communication link faults and single point of failures. In a decentralised approach, the minimisation cost can be achieved when the distributed generating units have the same incremental cost.Although these approaches are viable, it is worth noting that the centralised ED approach has lower reliability under communication link faults and single point of failures. In a decentralised approach, the minimisation cost can be achieved when the distributed generating units have the same incremental cost.</p>
        <p>In [268], a distributed control architecture is proposed for the economic dispatch of hybrid AC/DC-MGs. The proposal has two levels. In the first one, the ED problem for an AC sub-MG (frequency droop) and ED problem for a DC sub-MG (voltage droop) is solved by using the incremental cost based on a droop approach. The ILC does not need any from the neighbours because the ICs of all DER units are forced to be identical with the synchronisation of the AC frequency (for DC sub-MGs, a similar approach could be used). In the second level, a distributed control canonical form is proposed to eliminate the deviation between AC frequency and DC voltage caused by droop control. However, because the fluctuations in AC frequency and DC voltage are removed, the sub-grid loading conditions are not visible. To extract the loading conditions of the subgrids, the authors propose a Relative Loading Index (RLI). The references of the interlink converter power flow can be defined based on this RLI.In [268], a distributed control architecture is proposed for the economic dispatch of hybrid AC/DC-MGs. The proposal has two levels. In the first one, the ED problem for an AC sub-MG (frequency droop) and ED problem for a DC sub-MG (voltage droop) is solved by using the incremental cost based on a droop approach. The ILC does not need any from the neighbours because the ICs of all DER units are forced to be identical with the synchronisation of the AC frequency (for DC sub-MGs, a similar approach could be used). In the second level, a distributed control canonical form is proposed to eliminate the deviation between AC frequency and DC voltage caused by droop control. However, because the fluctuations in AC frequency and DC voltage are removed, the sub-grid loading conditions are not visible. To extract the loading conditions of the subgrids, the authors propose a Relative Loading Index (RLI). The references of the interlink converter power flow can be defined based on this RLI.</p>
        <p>There are some differences between conventional electric power systems and MGs, which certainly influence stability issues. As defined in [173], [212], a MG is stable when it can recover from a disturbance, reaching a new steady-state operating point which fulfills all the operational constraints. The disturbances correspond to exogenous inputs and could be produced by load impacts, component failures, or sudden variations in set-point adjustments [173].There are some differences between conventional electric power systems and MGs, which certainly influence stability issues. As defined in [173], [212], a MG is stable when it can recover from a disturbance, reaching a new steady-state operating point which fulfills all the operational constraints. The disturbances correspond to exogenous inputs and could be produced by load impacts, component failures, or sudden variations in set-point adjustments [173].</p>
        <p>Therefore, stability issues in MGs are different compared to those of bulk power systems. The most relevant dissimilarity is the following: i) The low inertia which is typically produced by a high number of DERs interfaced to MGs using power converters. Because of this low inertia it is difficult to maintain frequency stability in microgrids , ii) apparently in MGs the inter-area oscillations and voltage collapse, are not produced, or has never been observed, iii) in MGs, instability usually produces oscillations in all system variables [173].Therefore, stability issues in MGs are different compared to those of bulk power systems. The most relevant dissimilarity is the following: i) The low inertia which is typically produced by a high number of DERs interfaced to MGs using power converters. Because of this low inertia it is difficult to maintain frequency stability in microgrids , ii) apparently in MGs the inter-area oscillations and voltage collapse, are not produced, or has never been observed, iii) in MGs, instability usually produces oscillations in all system variables [173].</p>
        <p>In [173], the stability issues in MGs are divided into two main categories: i) Control system stability and ii) Power supply and balance stability. The Power Supply and Balance Stability is related to the capacity of the microgrid to perform power balancing, and simultaneously sharing the load demand among the distributed generators. This type of stability can be sub-categorized into Frequency and Voltage Stability. Control System Stability may be produced by the utilisation of inadequate control schemes and/or incorrect design and tuning of controllers. It is claimed that incorrect tuning of controllers is one of the primary source of instability [212]. This type of stability is related to electric machines, power converter control loops, LCL filters, PLLs, etc. [284], [285].In [173], the stability issues in MGs are divided into two main categories: i) Control system stability and ii) Power supply and balance stability. The Power Supply and Balance Stability is related to the capacity of the microgrid to perform power balancing, and simultaneously sharing the load demand among the distributed generators. This type of stability can be sub-categorized into Frequency and Voltage Stability. Control System Stability may be produced by the utilisation of inadequate control schemes and/or incorrect design and tuning of controllers. It is claimed that incorrect tuning of controllers is one of the primary source of instability [212]. This type of stability is related to electric machines, power converter control loops, LCL filters, PLLs, etc. [284], [285].</p>
        <p>The techniques typically applied for stability analysis of MGs are shown in Fig. 20. Two main stability analysis techniques are presented, large-signal perturbation analysis and small-Signal Perturbation Stability. Large-signal perturbation stability analysis in MGs could be realised utilising three approaches: i) Lyapunov-based analysis [33], [31], ii) timedomain simulations realised using suitable models of MG [284], [286], [287], and iii) Studies using hardware-in-the-Loop (HIL) emulation [173], [288], [289].The techniques typically applied for stability analysis of MGs are shown in Fig. 20. Two main stability analysis techniques are presented, large-signal perturbation analysis and small-Signal Perturbation Stability. Large-signal perturbation stability analysis in MGs could be realised utilising three approaches: i) Lyapunov-based analysis [33], [31], ii) timedomain simulations realised using suitable models of MG [284], [286], [287], and iii) Studies using hardware-in-the-Loop (HIL) emulation [173], [288], [289].</p>
        <p>The small-signal perturbation stability analysis is typically realised using a state-space model and eigenvalue analysis. Modelling of typical MG components has been presented and discussed in several publications, where detailed models of inverters, network models, and dynamic loads [173], [290] have been discussed. A classification of the small-signal stability analysis methods is shown in Fig. 21. The methods include time domain and frequency domain analysis. Indeed the methods consider linear or non-linear analysis. Linear analysis is based on eigenvalues, state-space models, or impedance-based, as depicted in Fig. 21. The non-linear analysis is based on either bifurcation theory or probabilistic analysis methods [32].The small-signal perturbation stability analysis is typically realised using a state-space model and eigenvalue analysis. Modelling of typical MG components has been presented and discussed in several publications, where detailed models of inverters, network models, and dynamic loads [173], [290] have been discussed. A classification of the small-signal stability analysis methods is shown in Fig. 21. The methods include time domain and frequency domain analysis. Indeed the methods consider linear or non-linear analysis. Linear analysis is based on eigenvalues, state-space models, or impedance-based, as depicted in Fig. 21. The non-linear analysis is based on either bifurcation theory or probabilistic analysis methods [32].</p>
        <p>Several research works propose the utilisation of smallsignal stability analysis methods to investigate the dynamic performance of MGs [31], [291]- [294]. For instance, in [292], the dynamic modelling and stability analysis of MGs in islanded operation, are presented. Also, the stability limits are evaluated through eigenvalue analysis, which is based on the quasi-steady-state approach. The same approach is used in [291], where a comprehensive state-space model of a MG considering PQ and VSI inverters is presented, the model is used to analyse the MG stability.Several research works propose the utilisation of smallsignal stability analysis methods to investigate the dynamic performance of MGs [31], [291]- [294]. For instance, in [292], the dynamic modelling and stability analysis of MGs in islanded operation, are presented. Also, the stability limits are evaluated through eigenvalue analysis, which is based on the quasi-steady-state approach. The same approach is used in [291], where a comprehensive state-space model of a MG considering PQ and VSI inverters is presented, the model is used to analyse the MG stability.</p>
        <p>Small-signal models have been applied to the stability evaluation of interconnected multi-inverter MGs. For in- stance, in [295], it is proposed an approximation method to assess the droop gain stability margins of islanded MGs, including passive loads and voltage-source inverters as distributed generation units. It is claimed in this work that the stability could be severely affected by the impedance of the lines interconnecting the clusters.Small-signal models have been applied to the stability evaluation of interconnected multi-inverter MGs. For in- stance, in [295], it is proposed an approximation method to assess the droop gain stability margins of islanded MGs, including passive loads and voltage-source inverters as distributed generation units. It is claimed in this work that the stability could be severely affected by the impedance of the lines interconnecting the clusters.</p>
        <p>On the other hand, low inertia, the high harmonic distortion produced by non-linear loads, severe imbalance and damping ratios in some of the control loop of the power converter, could make the islanded MG susceptible to instability. Therefore, to achieve a stable and good dynamic operation of a MG, mathematical modelling and small-signal stability analysis could be considered for design purposes. For instance, in [296], the modelling and analysis of the control systems for the power converter in a MG operating under harmonic distortion conditions is presented. The dynamic behaviour of the MG is investigated via small-signal analysis. For modelling, the concept of dynamic phasor is used to describe the fundamental and harmonic components of an ac waveform. Also, a virtual impedance control is considered in the droop-control algorithms.On the other hand, low inertia, the high harmonic distortion produced by non-linear loads, severe imbalance and damping ratios in some of the control loop of the power converter, could make the islanded MG susceptible to instability. Therefore, to achieve a stable and good dynamic operation of a MG, mathematical modelling and small-signal stability analysis could be considered for design purposes. For instance, in [296], the modelling and analysis of the control systems for the power converter in a MG operating under harmonic distortion conditions is presented. The dynamic behaviour of the MG is investigated via small-signal analysis. For modelling, the concept of dynamic phasor is used to describe the fundamental and harmonic components of an ac waveform. Also, a virtual impedance control is considered in the droop-control algorithms.</p>
        <p>Regarding the stability analysis of MGs under distributed control, the impact of control parameters on the communication delay margin also has to be considered [297]. In [297], it is claimed that the maximum communication delay achievable is significantly affected by several control parameters utilised in the frequency and voltage distributed controllers. Hence, it is recommended to select the control parameters adequately to ensure a desirable dynamic performance and a good delay margin. Additionally, in [297], a unified dynamic model considering time delays is proposed. The proposal includes DG units considering a primary controller, voltage and frequency distributed secondary controllers, and a detailed model of the network and loads.Regarding the stability analysis of MGs under distributed control, the impact of control parameters on the communication delay margin also has to be considered [297]. In [297], it is claimed that the maximum communication delay achievable is significantly affected by several control parameters utilised in the frequency and voltage distributed controllers. Hence, it is recommended to select the control parameters adequately to ensure a desirable dynamic performance and a good delay margin. Additionally, in [297], a unified dynamic model considering time delays is proposed. The proposal includes DG units considering a primary controller, voltage and frequency distributed secondary controllers, and a detailed model of the network and loads.</p>
        <p>As mentioned before, the stability assessment might be affected by the controller gains. In [298], a distributed cooperative control framework for multiple DC electric springs in a DC-MG is presented. The paper includes the small-signal stability analysis of the system. Moreover, the eigenvalue analysis is presented to show the effects of the communication weights on system stability. In [126] communication delays are considered in the proposed distributed secondary control for DC-MGs. In this work, two stability criteria under different conditions are derived for considering communication time delay, i) delay-dependent stability criterion under constant delay, and ii) time-varying delay-dependent stability criteria by using Linear Matrix Inequality (LMI). It is claimed in [126] that these stability criteria are helpful in guiding the selection of suitable control parameters.As mentioned before, the stability assessment might be affected by the controller gains. In [298], a distributed cooperative control framework for multiple DC electric springs in a DC-MG is presented. The paper includes the small-signal stability analysis of the system. Moreover, the eigenvalue analysis is presented to show the effects of the communication weights on system stability. In [126] communication delays are considered in the proposed distributed secondary control for DC-MGs. In this work, two stability criteria under different conditions are derived for considering communication time delay, i) delay-dependent stability criterion under constant delay, and ii) time-varying delay-dependent stability criteria by using Linear Matrix Inequality (LMI). It is claimed in [126] that these stability criteria are helpful in guiding the selection of suitable control parameters.</p>
        <p>In [293], a methodology for stability analysis and performance evaluation of MGs under distributed control, considering latency and uncertainty in the communication, is presented. The proposed methodology utilises the Laplace domain and the frequency domain to analyse the generators, loads and primary/secondary control loops. The communication latency is also studied using a frequency-domain Regarding the small-signal analysis for a MG with secondary control and communication delays, in [220], it is presented an approach for building a Delay Differential Equation modelling for a MG with a single load bus. This modelling can be utilised for stability studies, considering in the model the primary/secondary control parameters and communications delay.In [293], a methodology for stability analysis and performance evaluation of MGs under distributed control, considering latency and uncertainty in the communication, is presented. The proposed methodology utilises the Laplace domain and the frequency domain to analyse the generators, loads and primary/secondary control loops. The communication latency is also studied using a frequency-domain Regarding the small-signal analysis for a MG with secondary control and communication delays, in [220], it is presented an approach for building a Delay Differential Equation modelling for a MG with a single load bus. This modelling can be utilised for stability studies, considering in the model the primary/secondary control parameters and communications delay.</p>
        <p>The stability analysis for MG clusters is presented in [294]. This work shows a comprehensive stability analysis of a MG cluster (MGC) based on its small-signal dynamic model to study the coupling mechanism among multiple MGs and control interaction between different control layers. The control layers are the following: Primary Control, Distributed Secondary Control, Point of Common Coupling Control and Distributed Quaternary Control. The quaternary control is an additional control level which supervises the entire MGC and controls the critical bus voltage and system frequency to the desired values.The stability analysis for MG clusters is presented in [294]. This work shows a comprehensive stability analysis of a MG cluster (MGC) based on its small-signal dynamic model to study the coupling mechanism among multiple MGs and control interaction between different control layers. The control layers are the following: Primary Control, Distributed Secondary Control, Point of Common Coupling Control and Distributed Quaternary Control. The quaternary control is an additional control level which supervises the entire MGC and controls the critical bus voltage and system frequency to the desired values.</p>
        <p>To the best of the authors' knowledge, the following areas are open-topics in the field of distributed control of MGs:To the best of the authors' knowledge, the following areas are open-topics in the field of distributed control of MGs:</p>
        <p>In hybrid AC/DC-MGs, the integration of the distributed secondary control strategies has not been appropriately addressed. To consider all the devices located in a hybrid AC/DC-MG (including the interlinking converters) for control purposes, it is necessary to improve both the security and the reliability of the MG. Additionally, the performance of the MG in terms of power-sharing and energy management issues can be improved.In hybrid AC/DC-MGs, the integration of the distributed secondary control strategies has not been appropriately addressed. To consider all the devices located in a hybrid AC/DC-MG (including the interlinking converters) for control purposes, it is necessary to improve both the security and the reliability of the MG. Additionally, the performance of the MG in terms of power-sharing and energy management issues can be improved.</p>
        <p>By dividing the distribution system into several MG-like regions, the concept of Multimicrogrid is obtained [299]. Therefore, distributed control algorithms can be applied to this kind of systems in order to both regulate the energy exchange between MGs and implementing and solving the economic dispatch problem.By dividing the distribution system into several MG-like regions, the concept of Multimicrogrid is obtained [299]. Therefore, distributed control algorithms can be applied to this kind of systems in order to both regulate the energy exchange between MGs and implementing and solving the economic dispatch problem.</p>
        <p>The demand-side management problem can be addressed using distributed control algorithms. Hence, the loads can participate in the sparse communication network of DERs, and the stability of the MG can be augmented. This feature is relevant in MGs containing several electric vehicles (EVs) because they can be utilised as generation units as well as controllable loads, maintaining supply continuity and supporting the grid.The demand-side management problem can be addressed using distributed control algorithms. Hence, the loads can participate in the sparse communication network of DERs, and the stability of the MG can be augmented. This feature is relevant in MGs containing several electric vehicles (EVs) because they can be utilised as generation units as well as controllable loads, maintaining supply continuity and supporting the grid.</p>
        <p>The dependency of communication systems on the control of MGs is expected to increase as further control requirements emerge. Additionally, the number of DERs in a typical MG is also expected to increase, causing the communication networks to become more complex. As a result of these trends, efforts in studying and improving issues inherent in data communication, protection against cyber-attacks, time delays, packet losses and disruptions have to be realised more extensively in the future [300]- [303].The dependency of communication systems on the control of MGs is expected to increase as further control requirements emerge. Additionally, the number of DERs in a typical MG is also expected to increase, causing the communication networks to become more complex. As a result of these trends, efforts in studying and improving issues inherent in data communication, protection against cyber-attacks, time delays, packet losses and disruptions have to be realised more extensively in the future [300]- [303].</p>
        <p>Although the economic dispatch problem has been addressed in several papers, it is necessary to improve the proposed algorithms and control techniques, in order to consider the following issues:Although the economic dispatch problem has been addressed in several papers, it is necessary to improve the proposed algorithms and control techniques, in order to consider the following issues:</p>
        <p>-The transmission line losses have to be considered when the ED problem is proposed and solved in distributed control algorithms for MG applications. -Further research efforts have to be realised in order to solve non-convex generating cost functions considering a distributed approach. -The market price signals and future costs of energy could be considered in the economic dispatch problem.-The transmission line losses have to be considered when the ED problem is proposed and solved in distributed control algorithms for MG applications. -Further research efforts have to be realised in order to solve non-convex generating cost functions considering a distributed approach. -The market price signals and future costs of energy could be considered in the economic dispatch problem.</p>
        <p>Further research in the field of compensation and sharing of imbalances and harmonic distortion using a distributed control approach is required. The typical methods for the improvement of the sharing of unbalanced and/or distorted currents are based on the use of virtual impedance loops. Using this approach, negative and/or zero sequence virtual impedances are defined, and harmonic virtual impedances (to the harmonics of interest). This approach had shown being effective; however, it assumes that there is not a coupling between the three sequence components, which may not be accurate in some applications. Besides, sequence separation algorithms are strongly affected by noise, harmonic distortion, variations in the sampling time magnitude, etc. [244] [245], affecting the performance of this approach.Further research in the field of compensation and sharing of imbalances and harmonic distortion using a distributed control approach is required. The typical methods for the improvement of the sharing of unbalanced and/or distorted currents are based on the use of virtual impedance loops. Using this approach, negative and/or zero sequence virtual impedances are defined, and harmonic virtual impedances (to the harmonics of interest). This approach had shown being effective; however, it assumes that there is not a coupling between the three sequence components, which may not be accurate in some applications. Besides, sequence separation algorithms are strongly affected by noise, harmonic distortion, variations in the sampling time magnitude, etc. [244] [245], affecting the performance of this approach.</p>
        <p>The theory behind the stability analysis in MGs is not very well established yet. Large-signal analyses in different MG topologies are still open problems, especially when voltage stability is considered. Apart from demonstrating the convergence of controllers, stability analyses should require to consider the effect of data-loss, delays or errors in data exchange. Moreover, it has to be considered that the weak nature of converter-based MGs affects the overall stability [304]- [306].The theory behind the stability analysis in MGs is not very well established yet. Large-signal analyses in different MG topologies are still open problems, especially when voltage stability is considered. Apart from demonstrating the convergence of controllers, stability analyses should require to consider the effect of data-loss, delays or errors in data exchange. Moreover, it has to be considered that the weak nature of converter-based MGs affects the overall stability [304]- [306].</p>
        <p>The increasing interest in environmental protection and energy sustainability has promoted the integration of distributed energy resources, where the concept of MG has been introduced to facilitate the integration of a large number of microgenerators, energy storage systems and loads. As discussed in this survey, most of the early research work was focused on AC microgrids. However, considering the improvement in efficiency produced when power electronic conversion stages are avoided, DC-microgrids and hybrid microgrids are attracting more attention and research efforts from the scientific community. The distributed cooperative control systems typically utilised for these three microgrid topologies have been extensively discussed in this paper.The increasing interest in environmental protection and energy sustainability has promoted the integration of distributed energy resources, where the concept of MG has been introduced to facilitate the integration of a large number of microgenerators, energy storage systems and loads. As discussed in this survey, most of the early research work was focused on AC microgrids. However, considering the improvement in efficiency produced when power electronic conversion stages are avoided, DC-microgrids and hybrid microgrids are attracting more attention and research efforts from the scientific community. The distributed cooperative control systems typically utilised for these three microgrid topologies have been extensively discussed in this paper.</p>
        <p>The application of distributed cooperative control systems to MGs was first reported in the 2000s. Since its introduction, it has become a very important research topic for the design and implementation of control algorithms for modern microgrids. This paper has reviewed an extensively discussed several issues related to distributed cooperative control, including consensus protocol algorithms such as linear consensus, heterogeneous consensus, finite-time consensus, non-linear consensus, etc. This paper has also presented an overview of current developments on distributed control systems applied to isolated AC, DC and hybrid MGs. For each type of MG, the main distributed control schemes proposed in the literature have been reported and discussed in detail. Those were classified according to the hierarchical control of MGs, i.e., primary, secondary and tertiary control layers. Regarding the primary control level methods such as virtual impedance, droop-free control, virtual generators, and synthetic inertia have been thoroughly reviewed, highlighting the advantages of applying these strategies in a distributed scheme for the regulation of harmonic distortion, imbalances, reactive power and to improve the inertia of the MG, among others issues. Distributed cooperative control for economic dispatch of electrical energy in DC, AC and Hybrid microgrids has also been thoroughly discussed and reviewed in this paper, highlighting two methodologies: those methods based on an incremental cost consensus approach and those based on distributed gradient algorithms.The application of distributed cooperative control systems to MGs was first reported in the 2000s. Since its introduction, it has become a very important research topic for the design and implementation of control algorithms for modern microgrids. This paper has reviewed an extensively discussed several issues related to distributed cooperative control, including consensus protocol algorithms such as linear consensus, heterogeneous consensus, finite-time consensus, non-linear consensus, etc. This paper has also presented an overview of current developments on distributed control systems applied to isolated AC, DC and hybrid MGs. For each type of MG, the main distributed control schemes proposed in the literature have been reported and discussed in detail. Those were classified according to the hierarchical control of MGs, i.e., primary, secondary and tertiary control layers. Regarding the primary control level methods such as virtual impedance, droop-free control, virtual generators, and synthetic inertia have been thoroughly reviewed, highlighting the advantages of applying these strategies in a distributed scheme for the regulation of harmonic distortion, imbalances, reactive power and to improve the inertia of the MG, among others issues. Distributed cooperative control for economic dispatch of electrical energy in DC, AC and Hybrid microgrids has also been thoroughly discussed and reviewed in this paper, highlighting two methodologies: those methods based on an incremental cost consensus approach and those based on distributed gradient algorithms.</p>
        <p>Distributed secondary control strategies have also been extensively reviewed; consensus-based strategies and power quality issues were addressed in detail. Distributed tertiary control schemes applied to the economic dispatch of MGs were also reviewed. Finally, future trends in distributed control MGs have been identified and discussed, which are: (i) HybridAC/DC-MGs, (ii) multi-microgrids, (iii) demand-side management, (iv) communication network, (v) economic dispatch, (vi) power quality, and(vii) stability.Distributed secondary control strategies have also been extensively reviewed; consensus-based strategies and power quality issues were addressed in detail. Distributed tertiary control schemes applied to the economic dispatch of MGs were also reviewed. Finally, future trends in distributed control MGs have been identified and discussed, which are: (i) HybridAC/DC-MGs, (ii) multi-microgrids, (iii) demand-side management, (iv) communication network, (v) economic dispatch, (vi) power quality, and(vii) stability.</p>
        <p>This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/</p>
        <p>This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access Espina et al.: Distributed Control Strategies for Microgrids: An OverviewThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access Espina et al.: Distributed Control Strategies for Microgrids: An Overview</p>
        <p>VOLUME 1, 2016VOLUME 1, 2016</p>
        <p>VOLUME 1, 2016VOLUME 1, 2016</p>
        <p>VOLUME 1, 2016VOLUME 1, 2016</p>
        <p>VOLUME 1, 2016VOLUME 1, 2016</p>
        <p>VOLUME 1, 2016VOLUME 1, 2016</p>
        <p>VOLUME 1, 2016VOLUME 1, 2016</p>
        <p>The authors kindly acknowledge the funding provided by Fondecyt Grants Nr. 1180879, Nr. 1170683, Fondequip Nr. EQM160122, ANID PIA/BASAL AFB180003 and ANID Basal FB0008. The work of E. Espina was supported by CONICYT-PCHA/Doctorado Nacional/2017-21171858. Similarly, M. Martinez was supported by CONICYT-PCHA/Doctorado Nacional/2019-21191757.The authors kindly acknowledge the funding provided by Fondecyt Grants Nr. 1180879, Nr. 1170683, Fondequip Nr. EQM160122, ANID PIA/BASAL AFB180003 and ANID Basal FB0008. The work of E. Espina was supported by CONICYT-PCHA/Doctorado Nacional/2017-21171858. Similarly, M. Martinez was supported by CONICYT-PCHA/Doctorado Nacional/2019-21191757.</p>
        <p>This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access VOLUME 1, 2016This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access VOLUME 1, 2016</p>
        <p>This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access Espina et al.: Distributed Control Strategies for Microgrids: An Overview VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access Espina et al.: Distributed Control Strategies for Microgrids: An Overview VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access Espina et al.: Distributed Control Strategies for Microgrids: An Overview VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE AccessThis work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access Espina et al.: Distributed Control Strategies for Microgrids: An Overview VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access Espina et al.: Distributed Control Strategies for Microgrids: An Overview VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access Espina et al.: Distributed Control Strategies for Microgrids: An Overview VOLUME 1, 2016 This work is licensed under a Creative Commons Attribution 4.0 License. For more information, see https://creativecommons.org/licenses/by/4.0/ This article has been accepted for publication in a future issue of this journal, but has not been fully edited. Content may change prior to final publication. Citation information: DOI 10.1109/ACCESS.2020.3032378, IEEE Access</p>
    </text>
</tei>
