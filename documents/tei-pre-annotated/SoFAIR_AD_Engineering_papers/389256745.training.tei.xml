<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-14T07:03+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>This is a PDF file of an article that has undergone enhancements after acceptance, such as the addition of a cover page and metadata, and formatting for readability, but it is not yet the definitive version of record. This version will undergo additional copyediting, typesetting and review before it is published in its final form, but we are providing this version to give early visibility of the article. Please note that, during the production process, errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.This is a PDF file of an article that has undergone enhancements after acceptance, such as the addition of a cover page and metadata, and formatting for readability, but it is not yet the definitive version of record. This version will undergo additional copyediting, typesetting and review before it is published in its final form, but we are providing this version to give early visibility of the article. Please note that, during the production process, errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.</p>
        <p>To minimise carbon dioxide emissions and thereby meet the Paris Agreement targets [1], energy systems must transition away from being predominantly fossil fuel-based to being based on renewable energy sources (RES). This is a transition away from freely dispatchable production units towards units employing resources that are frequently of a fluctuating and possibly use-it-or-lose-it nature. The robust planning and decision-making of such a transition and the study of the implications of different choices call for advanced tools to handle the increasingly complex nature of the energy system.To minimise carbon dioxide emissions and thereby meet the Paris Agreement targets [1], energy systems must transition away from being predominantly fossil fuel-based to being based on renewable energy sources (RES). This is a transition away from freely dispatchable production units towards units employing resources that are frequently of a fluctuating and possibly use-it-or-lose-it nature. The robust planning and decision-making of such a transition and the study of the implications of different choices call for advanced tools to handle the increasingly complex nature of the energy system.</p>
        <p>Currently, a wide range of computer tools allow users to model and analyse energy systems at the national and regional levels to help design transition pathways [2]. These model are often very different from one another [3], and therefore decision makers and researchers should choose the most suitable energy tool depending on the specific purpose and objectives of their analysis [4].Currently, a wide range of computer tools allow users to model and analyse energy systems at the national and regional levels to help design transition pathways [2]. These model are often very different from one another [3], and therefore decision makers and researchers should choose the most suitable energy tool depending on the specific purpose and objectives of their analysis [4].</p>
        <p>The three most common methodological approaches to energy system modelling are optimisation, simulation and equilibrium tools or models. Optimisation tools include endogenous system design optimisation; simulation tools simulate exogenously defined energy systems, and equilibrium tools include a larger econometric model of the society.The three most common methodological approaches to energy system modelling are optimisation, simulation and equilibrium tools or models. Optimisation tools include endogenous system design optimisation; simulation tools simulate exogenously defined energy systems, and equilibrium tools include a larger econometric model of the society.</p>
        <p>Each approach has strengths as indicated by the main characteristic but also weaknesses. Thus, while optimisation tools are dominant within energy systems analysis [5], their complexity can cause difficulties in interpreting the results and can influence their accuracy [6]. In their systematic analysis investigating power system optimisation models, Priesmann and co-authors even found that the higher model complexity does not guarantee higher accuracy [7].Each approach has strengths as indicated by the main characteristic but also weaknesses. Thus, while optimisation tools are dominant within energy systems analysis [5], their complexity can cause difficulties in interpreting the results and can influence their accuracy [6]. In their systematic analysis investigating power system optimisation models, Priesmann and co-authors even found that the higher model complexity does not guarantee higher accuracy [7].</p>
        <p>Likewise, it has been highlighted that uncertainties and variations in inputs for simulation models for lowcarbon energy systems can have significant impact on the energy system performance [8].Likewise, it has been highlighted that uncertainties and variations in inputs for simulation models for lowcarbon energy systems can have significant impact on the energy system performance [8].</p>
        <p>Lastly, top-down equilibrium models have shown significant sensitivity when analysing the integration of RES and potentially need to be enhanced or be used as a part of integrated mixed models [9].Lastly, top-down equilibrium models have shown significant sensitivity when analysing the integration of RES and potentially need to be enhanced or be used as a part of integrated mixed models [9].</p>
        <p>One example of a widely used simulation tool is the freeware 
            <rs type="software">EnergyPLAN</rs>. This is one of the most commonly used tools for the evaluation of energy systems with high shares of RES [10]. Some authors consider it the most suitable tool to identify a feasible RES integration within an energy system, e.g., in China [11], Denmark [12] and Ireland [13].
        </p>
        <p>Different aspects of EnergyPLAN have been described and communicated in the scientific literature as integrated sections of the many published articles employing it. However, due to the nature and complexity of EnergyPLAN, the individual papers have found neither the space nor the necessity to describe the overall structure and details of the tool, but have typically focused on the parts pertinent to the analyses at hand. For a simulation tool as widely applied as EnergyPLAN, it is a significant gap in the scientific literature that there is no standard reference article describing it. Therefore, the aim of this paper is to provide this description in the hope that it will ease the writing and publication of studies applying EnergyPLAN in the future. More specifically, the goal of the paper is to demonstrate the core principles of EnergyPLAN and to J o u r n a l P r e -p r o o f document how it identifies the optimal operation of the units of the energy systems. This is based on both technical and economic simulation strategies.Different aspects of EnergyPLAN have been described and communicated in the scientific literature as integrated sections of the many published articles employing it. However, due to the nature and complexity of EnergyPLAN, the individual papers have found neither the space nor the necessity to describe the overall structure and details of the tool, but have typically focused on the parts pertinent to the analyses at hand. For a simulation tool as widely applied as EnergyPLAN, it is a significant gap in the scientific literature that there is no standard reference article describing it. Therefore, the aim of this paper is to provide this description in the hope that it will ease the writing and publication of studies applying EnergyPLAN in the future. More specifically, the goal of the paper is to demonstrate the core principles of EnergyPLAN and to J o u r n a l P r e -p r o o f document how it identifies the optimal operation of the units of the energy systems. This is based on both technical and economic simulation strategies.</p>
        <p>The paper first describes the purpose and guiding principles behind the tool along with general characteristics; then it relates the tool to the context and approach of smart energy systems. Subsequently, the structure and essential equations and procedures of its simulation approach are documented and, finally, the main conclusions are drawn.The paper first describes the purpose and guiding principles behind the tool along with general characteristics; then it relates the tool to the context and approach of smart energy systems. Subsequently, the structure and essential equations and procedures of its simulation approach are documented and, finally, the main conclusions are drawn.</p>
        <p>These sections present the main purpose and characteristics of EnergyPLAN along with an overview of typical applications.These sections present the main purpose and characteristics of EnergyPLAN along with an overview of typical applications.</p>
        <p>The main purpose of EnergyPLAN is to assist in the design of national energy planning strategies with technical and economic analyses of the consequences of different choices and investments. As further explained in [14], the purpose of EnergyPLAN is not to provide the basis for prescribing or predicting the future energy system, but rather to form a basis for an informed, transparent and conscious deliberation of potential development pathways for the energy system.The main purpose of EnergyPLAN is to assist in the design of national energy planning strategies with technical and economic analyses of the consequences of different choices and investments. As further explained in [14], the purpose of EnergyPLAN is not to provide the basis for prescribing or predicting the future energy system, but rather to form a basis for an informed, transparent and conscious deliberation of potential development pathways for the energy system.</p>
        <p>While the main motive for the development of EnergyPLAN was the national-scale energy systems, many other geographical scales have set the frame for EnergyPLAN analyses [10].While the main motive for the development of EnergyPLAN was the national-scale energy systems, many other geographical scales have set the frame for EnergyPLAN analyses [10].</p>
        <p>The overarching guiding principle for the development and use of EnergyPLAN is the establishment of alternatives; it was important to create a tool which would enable the consistent comparison of various alternative development strategies of the energy system. This is founded on the idea of choice [15], where an energy transition pathway is developed in a process with a conscious and transparent evaluation of the consequences of alternative strategies.The overarching guiding principle for the development and use of EnergyPLAN is the establishment of alternatives; it was important to create a tool which would enable the consistent comparison of various alternative development strategies of the energy system. This is founded on the idea of choice [15], where an energy transition pathway is developed in a process with a conscious and transparent evaluation of the consequences of alternative strategies.</p>
        <p>As a result, 
            <rs type="software">EnergyPLAN</rs> is developed with the capability for the user to consider alternative energy system combinations in mind, and as a consequence, also with speed, user friendliness and ease of implementing changes in mind.
        </p>
        <p>Specifically regarding the establishment of scenarios, the guiding principle resulted in the following objectives [16]:Specifically regarding the establishment of scenarios, the guiding principle resulted in the following objectives [16]:</p>
        <p>EnergyPLAN should to enable the user to analyse the type of technological change which is required when transitioning to 100% renewable energy systems. To accommodate this, EnergyPLAN includes a variety of new technologies such as wave power, district heating and cooling, tidal power, concentrated solar power, thermal storage, biogas production, biomass gasification, and various Power-to-X technologies.EnergyPLAN should to enable the user to analyse the type of technological change which is required when transitioning to 100% renewable energy systems. To accommodate this, EnergyPLAN includes a variety of new technologies such as wave power, district heating and cooling, tidal power, concentrated solar power, thermal storage, biogas production, biomass gasification, and various Power-to-X technologies.</p>
        <p>EnergyPLAN should enable the transparent and consistent comparison of multiple transition alternatives. Thus, EnergyPLAN is designed to quantify the impacts of many different alternatives, instead of producing just a single optimal solution through endogenous energy system design optimisation. It is often difficult to define one ideal metric to measure the benefits of energy systems [17]. For example, an inexpensive energy system that relies on a high proportion of energy imports may be less desirable than a more expensive energy system that utilises primarily domestic resources. Therefore, if an energy system is designed based on the optimal solution that produces the lowest cost, then other issues may be overlooked. Furthermore, long-term projections of, e.g., energy prices have shown to be prone to large uncertainties [18], making endogenous system designs equally uncertain. A scenario simulation can be completed in less than 10 seconds in EnergyPLAN with the implication that users can demonstrate the impacts of various alternatives in a relatively short period of time.EnergyPLAN should enable the transparent and consistent comparison of multiple transition alternatives. Thus, EnergyPLAN is designed to quantify the impacts of many different alternatives, instead of producing just a single optimal solution through endogenous energy system design optimisation. It is often difficult to define one ideal metric to measure the benefits of energy systems [17]. For example, an inexpensive energy system that relies on a high proportion of energy imports may be less desirable than a more expensive energy system that utilises primarily domestic resources. Therefore, if an energy system is designed based on the optimal solution that produces the lowest cost, then other issues may be overlooked. Furthermore, long-term projections of, e.g., energy prices have shown to be prone to large uncertainties [18], making endogenous system designs equally uncertain. A scenario simulation can be completed in less than 10 seconds in EnergyPLAN with the implication that users can demonstrate the impacts of various alternatives in a relatively short period of time.</p>
        <p>Alternatives designed and analysed in EnergyPLAN should not be limited by existing institutional and market frameworks. This is particularly an issue within the electricity system, where some models are constructed based on the design of the day-ahead markets in current electricity markets. However, in the future energy system, the current design of electricity markets may not be suitable for 100% renewable energy systems, especially since renewable electricity technologies often have zero marginal production costs. To overcome this, EnergyPLAN has various operation strategies, including a market simulation strategy, which is based on the design of existing European electricity markets, and a technical simulation strategy. The technical simulation strategy is independent of market designs and temporal market prices and operates the energy system in order to minimise the consumption of fuels.Alternatives designed and analysed in EnergyPLAN should not be limited by existing institutional and market frameworks. This is particularly an issue within the electricity system, where some models are constructed based on the design of the day-ahead markets in current electricity markets. However, in the future energy system, the current design of electricity markets may not be suitable for 100% renewable energy systems, especially since renewable electricity technologies often have zero marginal production costs. To overcome this, EnergyPLAN has various operation strategies, including a market simulation strategy, which is based on the design of existing European electricity markets, and a technical simulation strategy. The technical simulation strategy is independent of market designs and temporal market prices and operates the energy system in order to minimise the consumption of fuels.</p>
        <p>Under these objectives, EnergyPLAN has been developed and expanded on a continuous basis since 1999 by the Sustainable Energy Planning Research Group at Aalborg University.Under these objectives, EnergyPLAN has been developed and expanded on a continuous basis since 1999 by the Sustainable Energy Planning Research Group at Aalborg University.</p>
        <p>EnergyPLAN is primarily designed for national energy system analysis, and thus has been used to investigate energy systems and energy transitions in countries such as Germany [19], Denmark [20][21], Ireland [13], Norway [22], Hungary [23], Romania [24], Portugal [25] , Singapore [26], Hong Kong [27] Jordan [28], Chile [29] and China [30]. However, to a large extent, it has also been applied to other geographical settings, such as islands like Gran Canaria [31], Pico and Faial [32] and Favignana Island [33] and cities like Aalborg [34] and Bozen-Bolzano [35]. Regions like Beijing-Hebei-Tianjin [36] and Inland Norway [37] as well as continents like Europe [38] have also been focal points of analyses.EnergyPLAN is primarily designed for national energy system analysis, and thus has been used to investigate energy systems and energy transitions in countries such as Germany [19], Denmark [20][21], Ireland [13], Norway [22], Hungary [23], Romania [24], Portugal [25] , Singapore [26], Hong Kong [27] Jordan [28], Chile [29] and China [30]. However, to a large extent, it has also been applied to other geographical settings, such as islands like Gran Canaria [31], Pico and Faial [32] and Favignana Island [33] and cities like Aalborg [34] and Bozen-Bolzano [35]. Regions like Beijing-Hebei-Tianjin [36] and Inland Norway [37] as well as continents like Europe [38] have also been focal points of analyses.</p>
        <p>Within the system (country, region or island) described in the model, EnergyPLAN simulates the electricity and the gas supplies with no spatial representation of supply and demand. The connection to the outside world is modelled as a single transmission line. However, by use of add-ons, one can build individual models of a number of countries or regions and analyse the electric transmission lines between them.Within the system (country, region or island) described in the model, EnergyPLAN simulates the electricity and the gas supplies with no spatial representation of supply and demand. The connection to the outside world is modelled as a single transmission line. However, by use of add-ons, one can build individual models of a number of countries or regions and analyse the electric transmission lines between them.</p>
        <p>Besides forming the modelling basis for energy transition strategies, EnergyPLAN is also frequently applied in analyses covering the role of certain technologies or technological systems. This includes, but is not limited to: the role of Compressed Energy Storage [39] and hydro power in the energy system [22]; the role J o u r n a l P r e -p r o o f of biogas and biomass in the energy system [40,41]; the role of district heating [30,42] as well as heating infrastructures [43] in the energy system; heat pumps [44] and V2G [45] in the energy system; the energy system value of flexible electricity demands [46], future energy market prices [21] [47] [48] and market designs [49], as well as buildings and energy efficiency [50,51] and the comparison of integrated and nonintegrated energy systems [52,53]. In general, the versatility of EnergyPLAN has led to a wide range of applications [54].Besides forming the modelling basis for energy transition strategies, EnergyPLAN is also frequently applied in analyses covering the role of certain technologies or technological systems. This includes, but is not limited to: the role of Compressed Energy Storage [39] and hydro power in the energy system [22]; the role J o u r n a l P r e -p r o o f of biogas and biomass in the energy system [40,41]; the role of district heating [30,42] as well as heating infrastructures [43] in the energy system; heat pumps [44] and V2G [45] in the energy system; the energy system value of flexible electricity demands [46], future energy market prices [21] [47] [48] and market designs [49], as well as buildings and energy efficiency [50,51] and the comparison of integrated and nonintegrated energy systems [52,53]. In general, the versatility of EnergyPLAN has led to a wide range of applications [54].</p>
        <p>In the interest of speed -computational as well as in the setting up of models -EnergyPLAN is aggregated in its system description instead of modelling each individual station and component. District heating systems are, e.g., aggregated and defined as three principle technology groups and RES technologies are likewise aggregated into, e.g., one stock of wind turbines with a set of common characteristics. The same applies to, e.g., power stations and waste incineration plants as well as to all demands.In the interest of speed -computational as well as in the setting up of models -EnergyPLAN is aggregated in its system description instead of modelling each individual station and component. District heating systems are, e.g., aggregated and defined as three principle technology groups and RES technologies are likewise aggregated into, e.g., one stock of wind turbines with a set of common characteristics. The same applies to, e.g., power stations and waste incineration plants as well as to all demands.</p>
        <p>District heating is given particular attention; thus, three different types of district heating system may be modelled as they show different behaviours in the district heating system. These are:District heating is given particular attention; thus, three different types of district heating system may be modelled as they show different behaviours in the district heating system. These are:</p>
        <p>1. District heating systems based on fuel boilers 2. District heating systems based on backpressure CHP plants 3. District heating systems based on extraction CHP plants These three typologies are referred to as DH Groups 1-3.1. District heating systems based on fuel boilers 2. District heating systems based on backpressure CHP plants 3. District heating systems based on extraction CHP plants These three typologies are referred to as DH Groups 1-3.</p>
        <p>EnergyPLAN uses what we denote "analytical programming". Rather than establishing a series of balance equations that are solved numerically as in optimisation and equilibrium models, EnergyPLAN is based on a series of endogenous priorities within, e.g., power and heat production and pre-defined procedures for simulating the operation of units that are freely dispatchable. The approach is purely deterministic with no stochastic elements.EnergyPLAN uses what we denote "analytical programming". Rather than establishing a series of balance equations that are solved numerically as in optimisation and equilibrium models, EnergyPLAN is based on a series of endogenous priorities within, e.g., power and heat production and pre-defined procedures for simulating the operation of units that are freely dispatchable. The approach is purely deterministic with no stochastic elements.</p>
        <p>As noted, 
            <rs type="software">EnergyPLAN</rs> simulates user-defined systems and does not make endogenous system optimisation. Various simulation strategies (see Section 3) determine the concrete optimisation criterion applied in an 
            <rs type="software">EnergyPLAN</rs> simulation (primary energy consumption, energy system balance, operational expenditure); however, in the design of scenarios, users can apply any of the outputs of 
            <rs type="software">EnergyPLAN</rs> or derivatives thereof. Thus, users have employed total system costs, renewable energy shares, employment generation, emissions and many more [10] in exogenous system optimisation. Some users have combined 
            <rs type="software">EnergyPLAN</rs> with other tools for exogenous scenario design based on various objectives, e.g. [55][56][57][58][59][60]. Such work has, e.g., applied genetic algorithms to identify optimal scenarios based on multiple criteria.
        </p>
        <p>
            <rs type="software">EnergyPLAN</rs> is programmed and maintained in 
            <rs type="software">Delphi Pascal</rs>. The tool along with manuals, reports and algorithm descriptions behind the tool are available from www.energyplan.eu. The training period required to use the tool can take a few days up to a month, depending on the level of competency required.
        </p>
        <p>
            <rs type="software">EnergyPLAN</rs> is a freeware. Users can be involved on a semi open source basis in which independent addons and help tools can be added. 
            <rs type="software">EnergyPLAN</rs> has a facility to include such add-ons based on any type of coding as long as they provide an exe-file. In the current version, 
            <rs type="software">EnergyPLAN</rs> includes several help tools. Moreover, the tool may be executed from other platforms such as 
            <rs type="software">Excel</rs> or 
            <rs type="software">MATLAB</rs>, which allows multiexecution [55,61].
        </p>
        <p>
            <rs type="software">EnergyPLAN</rs> simulates a one leap-year time period in total; thus, for longer spanning analyses, several simulations would have to be run. Within the one-year period, 
            <rs type="software">EnergyPLAN</rs> simulates the energy system on an hourly resolution level [11]. This entails that all demands are exogenously defined productions and are defined using hourly time series.
        </p>
        <p>The reason is that the integration of renewable energy is a key focus for EnergyPLAN. Thus, it was important to adequately factor in associated intermittencies. The hourly simulation level that this requires is contrary to some scenario tools, which simulate the system on an annual basis or some optimisation tools that are based on time slicing, where hourly sample periods are identified for more in-depth analyses.The reason is that the integration of renewable energy is a key focus for EnergyPLAN. Thus, it was important to adequately factor in associated intermittencies. The hourly simulation level that this requires is contrary to some scenario tools, which simulate the system on an annual basis or some optimisation tools that are based on time slicing, where hourly sample periods are identified for more in-depth analyses.</p>
        <p>The hourly resolution allows the user to investigate hourly, daily, weekly and seasonal differences in electricity and heat demands and, e.g., water inputs to large hydropower systems.The hourly resolution allows the user to investigate hourly, daily, weekly and seasonal differences in electricity and heat demands and, e.g., water inputs to large hydropower systems.</p>
        <p>EnergyPLAN seeks the balance between electricity production and demand with an hourly resolution. Thus, active power and frequency stability are considered at this time step. Voltage stability and short-circuit power are not modelled explicitly; however, EnergyPLAN gives the user the option of requiring certain units to have a minimum production at all hours. This requires that in each hour, a minimum share of the power production comes from ancillary service providing units, and that the share of each production category that should be interpreted as providing ancillary service should be defined. See e.g. [62,63] for analyses where this has been a focal point.EnergyPLAN seeks the balance between electricity production and demand with an hourly resolution. Thus, active power and frequency stability are considered at this time step. Voltage stability and short-circuit power are not modelled explicitly; however, EnergyPLAN gives the user the option of requiring certain units to have a minimum production at all hours. This requires that in each hour, a minimum share of the power production comes from ancillary service providing units, and that the share of each production category that should be interpreted as providing ancillary service should be defined. See e.g. [62,63] for analyses where this has been a focal point.</p>
        <p>Figure 1 provides an overview of inputs as well as outputs of the model. 
            <rs type="software">EnergyPLAN</rs> comes with a graphical user interface in which the user can type in inputs and maintain an overview of the model. Overall, the following input structure of 
            <rs type="software">EnergyPLAN</rs> refers to the aspects of an energy system:
        </p>
        <p>• Energy demands (heat, electricity, transport, etc.) • Energy production units and resources (wind turbines, power plants, oil boilers, storage, etc.) including energy conversion units such as electrolysers, biogas and gasification plants as well as hydrogenation units.• Energy demands (heat, electricity, transport, etc.) • Energy production units and resources (wind turbines, power plants, oil boilers, storage, etc.) including energy conversion units such as electrolysers, biogas and gasification plants as well as hydrogenation units.</p>
        <p>• Simulation (defining the simulation and operation of each plant and the system including technical limitations such as transmission capacity, etc.) • Costs (fuel costs, exchange of electricity and gas, taxes, variable and fixed operational costs and investment costs)• Simulation (defining the simulation and operation of each plant and the system including technical limitations such as transmission capacity, etc.) • Costs (fuel costs, exchange of electricity and gas, taxes, variable and fixed operational costs and investment costs)</p>
        <p>The outputs produced by EnergyPLAN are energy balances and resulting annual productions, fuel consumption, import/export of electricity, and total costs including income from the exchange of electricity. With a temporal resolution of 1h, results can be presented down to this resolution as well. Through the export facility, the results can be imported into a spreadsheet for further investigation or illustration.The outputs produced by EnergyPLAN are energy balances and resulting annual productions, fuel consumption, import/export of electricity, and total costs including income from the exchange of electricity. With a temporal resolution of 1h, results can be presented down to this resolution as well. Through the export facility, the results can be imported into a spreadsheet for further investigation or illustration.</p>
        <p>More immediately, results are presented in monthly and yearly overviews of production and demands within different technology categories as well as gas and electricity imports/exports. Yearly aggregates also include carbon dioxide emissions, money flows to/from an external electricity market and fuel consumption.More immediately, results are presented in monthly and yearly overviews of production and demands within different technology categories as well as gas and electricity imports/exports. Yearly aggregates also include carbon dioxide emissions, money flows to/from an external electricity market and fuel consumption.</p>
        <p>EnergyPLAN has been developed in parallel with the concept of smart energy systems as defined in a series of papers [16,[64][65][66].EnergyPLAN has been developed in parallel with the concept of smart energy systems as defined in a series of papers [16,[64][65][66].</p>
        <p>The design of EnergyPLAN thus emphasises the option of looking at the complete energy system as a whole (see Figure 2). E.g., the challenge of integrating variable power from renewable energy sources into the electricity grid by the use of smart grids should not be looked upon as an isolated issue, but should be seen as one out of various means and challenges of approaching sustainable energy systems in general. Therefore, EnergyPLAN is designed to be a tool in which, e.g., electricity smart grids can be coordinated with the utilisation of renewable energy for other purposes than electricity production.The design of EnergyPLAN thus emphasises the option of looking at the complete energy system as a whole (see Figure 2). E.g., the challenge of integrating variable power from renewable energy sources into the electricity grid by the use of smart grids should not be looked upon as an isolated issue, but should be seen as one out of various means and challenges of approaching sustainable energy systems in general. Therefore, EnergyPLAN is designed to be a tool in which, e.g., electricity smart grids can be coordinated with the utilisation of renewable energy for other purposes than electricity production.</p>
        <p>In EnergyPLAN, renewable energy is converted into other forms of carriers than electricity via different power-to-x technologies, including heat, hydrogen, e-gases and electrofuels, as well as energy conservation and efficiency improvements, such as the cogeneration of heat and power (CHP) and improved efficiencies, e.g., in the form of fuel cells.In EnergyPLAN, renewable energy is converted into other forms of carriers than electricity via different power-to-x technologies, including heat, hydrogen, e-gases and electrofuels, as well as energy conservation and efficiency improvements, such as the cogeneration of heat and power (CHP) and improved efficiencies, e.g., in the form of fuel cells.</p>
        <p>All these measures have the potential to replace fossil fuels or improve the fuel efficiency of the system. The long-term relevant systems are those in which such measures are combined with energy conservation and system efficiency improvements. Consequently, the 
            <rs type="software">EnergyPLAN</rs> tool can be used for analyses which illustrate, e.g., why electricity smart grids should be seen as part of overall smart energy systems.
        </p>
        <p>This section details the computational core of 
            <rs type="software">EnergyPLAN</rs> focusing on how it simulates energy systems.
        </p>
        <p>As displayed in Figure 6, the very first calculations are made as data is entered. E.g., if wind capacity is entered and an hourly wind distribution file is chosen from the library, 
            <rs type="software">EnergyPLAN</rs> will simultaneously calculate the annual and the hourly electricity production. Afterwards ("Stage 2" in Figure 6), 
            <rs type="software">EnergyPLAN</rs> completes a number of initial computations which do not involve electricity balancing, such as the amount of heat provided by industry, the hourly demand of heat in the three district heating systems and the hourly non-flexible electricity demand.
        </p>
        <p>Based on a user-specified simulation strategy, EnergyPLAN then branches: For the technical simulation (Stage 3A in Figure 6 -See also section 3.2), EnergyPLAN identifies the least fuel-consuming solution, while for the market-economic simulation (Stage 3B in Figure 6 -See also section 3.3), it identifies the consequences of operating each unit on the electricity market with the aim of optimising the businesseconomic profit.Based on a user-specified simulation strategy, EnergyPLAN then branches: For the technical simulation (Stage 3A in Figure 6 -See also section 3.2), EnergyPLAN identifies the least fuel-consuming solution, while for the market-economic simulation (Stage 3B in Figure 6 -See also section 3.3), it identifies the consequences of operating each unit on the electricity market with the aim of optimising the businesseconomic profit.</p>
        <p>For both simulation strategies, EnergyPLAN will finish by computing the socio-economic consequences of the system (total energy systems costs and carbon dioxide externality). As the entire calculation process only takes a few seconds, both simulation strategies can be easily completed and compared.For both simulation strategies, EnergyPLAN will finish by computing the socio-economic consequences of the system (total energy systems costs and carbon dioxide externality). As the entire calculation process only takes a few seconds, both simulation strategies can be easily completed and compared.</p>
        <p>In the following, the technical and market-economic simulations are further detailed.In the following, the technical and market-economic simulations are further detailed.</p>
        <p>With the technical energy systems simulation strategy, the computation is carried out in the following steps as illustrated in Figure 7. After each of the steps, a calculation is made of condensing power and Step 1: First, 
            <rs type="software">EnergyPLAN</rs> calculates the electricity and heat productions of the units in the district heating supply systems. As a start, all heat units are producing solely according to the heat demand, and these units are given priority on an hourly basis according to the following sequence:
        </p>
        <p>1. Solar Thermal 2. Industrial excess heat incl. electrolysers and thermal gasification 3. Heat production from waste fuel 4. Heat plant CHP 5. Heat pumps 6. Peak load boilers1. Solar Thermal 2. Industrial excess heat incl. electrolysers and thermal gasification 3. Heat production from waste fuel 4. Heat plant CHP 5. Heat pumps 6. Peak load boilers</p>
        <p>Hourly electricity productions from variable renewable sources are already calculated in Stage two.Hourly electricity productions from variable renewable sources are already calculated in Stage two.</p>
        <p>Step 2: Next, 
            <rs type="software">EnergyPLAN</rs> identifies the potential to utilise flexible electricity demand, if any, which is specified as an input. The electricity demand can either be made flexible, as specified in the next steps, or within short periods according to four time horizons. The user can choose to stipulate an annual demand that may be shifted within three timeframes -24h, 1w or 4w -within a capacity constraint.
        </p>
        <p>
            <rs type="software">EnergyPLAN</rs> calculates the best use of flexible demands to achieve a balance between demand and supply with two limitations: It must be positive at any time and it should be below a given maximum capacity (defined in the input). A normalisation of the variation ensures that the average demand for the period equals the yearly average.
        </p>
        <p>Step 3: As input, one can choose if the operation of CHP and heat pumps for district heating should seek to balance the electricity supply and demand of the overall system. If this strategy is chosen, the calculations of Step 1 are replaced by a strategy in which the export of electricity is minimised mainly by the use of heat pumps at CHP plants. This will simultaneously increase the electricity demand to the heat pumps and decrease the electricity production from CHP units, as the CHP units must decrease their heat production. By utilising unused capacity at the CHP plants in the given hour combined with heat storages, any production at condensing-mode plants is minimised and replaced by CHP production.Step 3: As input, one can choose if the operation of CHP and heat pumps for district heating should seek to balance the electricity supply and demand of the overall system. If this strategy is chosen, the calculations of Step 1 are replaced by a strategy in which the export of electricity is minimised mainly by the use of heat pumps at CHP plants. This will simultaneously increase the electricity demand to the heat pumps and decrease the electricity production from CHP units, as the CHP units must decrease their heat production. By utilising unused capacity at the CHP plants in the given hour combined with heat storages, any production at condensing-mode plants is minimised and replaced by CHP production.</p>
        <p>Step 4: Hydropower is then used for replacing the condensing-mode plants and decreasing, first, Critical Excess Electricity production (CEEP) and, secondly, Exportable Excess Electricity production (EEEP) in the following way: First, the potential of replacing the condensing-mode power plant (e Hydro-Inc ) is determined as the minimum value of the production of the condensing unit and the difference between hydropower capacity and hydropower production. In the case of reverse hydropower, i.e., a pump and lower water storage, the potential to further decrease CEEP (e Hydro-Pump-Dec-CEEP ) is determined as the minimum value of the CEEP (minus the share that is already dispatched), the pump capacity, and the content of the lower water storage, s Hydro-PUMP :Step 4: Hydropower is then used for replacing the condensing-mode plants and decreasing, first, Critical Excess Electricity production (CEEP) and, secondly, Exportable Excess Electricity production (EEEP) in the following way: First, the potential of replacing the condensing-mode power plant (e Hydro-Inc ) is determined as the minimum value of the production of the condensing unit and the difference between hydropower capacity and hydropower production. In the case of reverse hydropower, i.e., a pump and lower water storage, the potential to further decrease CEEP (e Hydro-Pump-Dec-CEEP ) is determined as the minimum value of the CEEP (minus the share that is already dispatched), the pump capacity, and the content of the lower water storage, s Hydro-PUMP :</p>
        <p>e Hydro-Pump-Dec-CEEP = MIN [(e CEEP -e Hydro-Dec-CEEP ) , C Hydro-PUMP , s Hydro-PUMP / µ Hydro-PUMP ]e Hydro-Pump-Dec-CEEP = MIN [(e CEEP -e Hydro-Dec-CEEP ) , C Hydro-PUMP , s Hydro-PUMP / µ Hydro-PUMP ]</p>
        <p>In the same way, the potential to decrease hydropower in the case of EEEP (e Hydro-DEC-EEEP ) is found. Knowing the potentials to increase and decrease the hydropower production, a balance is found in which the annual hydropower production is maintained. The reduction of CEEP is given priority over the reduction of EEEP. Differences in the storage content at the beginning and at the end of the calculation period may cause errors in the calculations. To correct these errors, the above calculation seeks to identify a solution in which the storage content at the end is the same as at the beginning. Initially, the storage content is defined as 50% of the storage capacity. After the first iteration, a new initial content is defined as the resulting content at the end of the calculation. However, one may as input specify a start and end value of the hydro storage.In the same way, the potential to decrease hydropower in the case of EEEP (e Hydro-DEC-EEEP ) is found. Knowing the potentials to increase and decrease the hydropower production, a balance is found in which the annual hydropower production is maintained. The reduction of CEEP is given priority over the reduction of EEEP. Differences in the storage content at the beginning and at the end of the calculation period may cause errors in the calculations. To correct these errors, the above calculation seeks to identify a solution in which the storage content at the end is the same as at the beginning. Initially, the storage content is defined as 50% of the storage capacity. After the first iteration, a new initial content is defined as the resulting content at the end of the calculation. However, one may as input specify a start and end value of the hydro storage.</p>
        <p>In this case, these values will be used.In this case, these values will be used.</p>
        <p>Step 5: The calculations of individual CHP and heat pump systems are based on the computation in Stage 1 in which solar thermal (if any) is given priority. If heat storage capacity is specified, EnergyPLAN will exploit the option of using the electricity productions and demands of these units to balance the electricity supply and demand of the overall system. This will update the productions on the individual CHP and heat pump systems.Step 5: The calculations of individual CHP and heat pump systems are based on the computation in Stage 1 in which solar thermal (if any) is given priority. If heat storage capacity is specified, EnergyPLAN will exploit the option of using the electricity productions and demands of these units to balance the electricity supply and demand of the overall system. This will update the productions on the individual CHP and heat pump systems.</p>
        <p>Step 6: Four electrolyser systems are described in the model. Two of these are systems which are assumed to be located next to the district heating based on backpressure units and extraction plants, respectively, along with the CHP units, heat pumps and boilers. Here, the waste heat production of the electrolysers can be utilised in the district heating supply. The two other systems produce hydrogen for micro CHP systems or for transport and hydrogenation. The electrolyser is assumed to be a hydrolyser (producing hydrogen), but it may be used for modelling any kind of equipment converting electricity into fuel and heat.Step 6: Four electrolyser systems are described in the model. Two of these are systems which are assumed to be located next to the district heating based on backpressure units and extraction plants, respectively, along with the CHP units, heat pumps and boilers. Here, the waste heat production of the electrolysers can be utilised in the district heating supply. The two other systems produce hydrogen for micro CHP systems or for transport and hydrogenation. The electrolyser is assumed to be a hydrolyser (producing hydrogen), but it may be used for modelling any kind of equipment converting electricity into fuel and heat.</p>
        <p>The calculation is based on the result of the Stage 1 calculation in which the minimum capacity of the electrolyser is identified together with the electricity demand, d ElcM . EnergyPLAN seeks to avoid CEEP/EEEP and condensing-mode power generation by reorganising the production. First, the potential to increase the production at hours of excess production, d ElcM-inc-pot , is identified as the lower value of CEEP and the difference between the capacity, C ElcM , and the production of the electrolyser: Secondly, the potential to decrease production at hours of power-only production, d ElcM-dec-pot , is identified as the minimum of the power production, e PP , and the electrolyser demand:The calculation is based on the result of the Stage 1 calculation in which the minimum capacity of the electrolyser is identified together with the electricity demand, d ElcM . EnergyPLAN seeks to avoid CEEP/EEEP and condensing-mode power generation by reorganising the production. First, the potential to increase the production at hours of excess production, d ElcM-inc-pot , is identified as the lower value of CEEP and the difference between the capacity, C ElcM , and the production of the electrolyser: Secondly, the potential to decrease production at hours of power-only production, d ElcM-dec-pot , is identified as the minimum of the power production, e PP , and the electrolyser demand:</p>
        <p>Then a balance is created in which either the potential to increase or the potential to decrease is lowered to achieve the same level as that of the annual potentials:Then a balance is created in which either the potential to increase or the potential to decrease is lowered to achieve the same level as that of the annual potentials:</p>
        <p>A new optimal temporal distribution of the electrolyser electricity demand (producing exactly the same annual fuel as before) is calculated as:A new optimal temporal distribution of the electrolyser electricity demand (producing exactly the same annual fuel as before) is calculated as:</p>
        <p>Finally, the temporal distribution is evaluated against the hydrogen storage capacity. the changes in storage content are calculated.Finally, the temporal distribution is evaluated against the hydrogen storage capacity. the changes in storage content are calculated.</p>
        <p>If the storage content based on this calculation is below zero, the production of the electrolyser is increased.If the storage content based on this calculation is below zero, the production of the electrolyser is increased.</p>
        <p>If the storage content exceeds the storage capacity, the production of the electrolyser is decreased.If the storage content exceeds the storage capacity, the production of the electrolyser is decreased.</p>
        <p>Step 7: Thermal storage in district heating systems is used to improve the possibilities for minimising the electricity export. The heat storage capacity is included in the model for each of the district heating groups 2 and 3. The storage capacities are used for minimising the excess and condensing mode power generation in the system.Step 7: Thermal storage in district heating systems is used to improve the possibilities for minimising the electricity export. The heat storage capacity is included in the model for each of the district heating groups 2 and 3. The storage capacities are used for minimising the excess and condensing mode power generation in the system.</p>
        <p>Step 8: Electric vehicles including the concept of vehicle to grid (V2G) can be operated with smart charge as well as smart discharge. One important input is the hourly distribution of the transport demand (δ V2G ), which is used for two purposes. One is to determine the number of V2G battery electric vehicles which are driving and consequently not connected to the grid in the hour in question. This, together with the V2G Max- Share (the maximum share of V2G battery electric vehicles which are driving during peak demand hour) and the V2G Connection-Share, determines the fraction of the V2G fleet that is available to the electrical system in any given hour. The other purpose of defining δ V2G is to determine the discharging of the battery storage caused by driving. The hourly transport demand, and thereby the discharging of the battery (t V2G ), is calculated as follows:Step 8: Electric vehicles including the concept of vehicle to grid (V2G) can be operated with smart charge as well as smart discharge. One important input is the hourly distribution of the transport demand (δ V2G ), which is used for two purposes. One is to determine the number of V2G battery electric vehicles which are driving and consequently not connected to the grid in the hour in question. This, together with the V2G Max- Share (the maximum share of V2G battery electric vehicles which are driving during peak demand hour) and the V2G Connection-Share, determines the fraction of the V2G fleet that is available to the electrical system in any given hour. The other purpose of defining δ V2G is to determine the discharging of the battery storage caused by driving. The hourly transport demand, and thereby the discharging of the battery (t V2G ), is calculated as follows:</p>
        <p>The grid connection capacity of the total V2G fleet on an hourly basis (c V2G ) is calculated as follows:The grid connection capacity of the total V2G fleet on an hourly basis (c V2G ) is calculated as follows:</p>
        <p>This equation includes three factors. The first factor is C Charger , the power capacity of the entire V2G fleet. This is multiplied by V2G Connection-Share , the fraction of the parked vehicles which is assumed to be plugged. The third factor, in parentheses, calculates the fraction of vehicles on the road in each hour. The third J o u r n a l P r e -p r o o f parenthesised factor is based on the sum of two terms. The first term, (1-V2G Max-Share ), represents the minimum fraction of vehicles parked. The second term is the additional fraction of vehicles parked during non-rush hours. The hourly fraction of vehicles parked is derived from the known input of hourly energy demand for the fleet. This equation yields c V2G , the power capacity of all connected V2G vehicles, in any given hour. For each hour, the model calculates as follows.This equation includes three factors. The first factor is C Charger , the power capacity of the entire V2G fleet. This is multiplied by V2G Connection-Share , the fraction of the parked vehicles which is assumed to be plugged. The third factor, in parentheses, calculates the fraction of vehicles on the road in each hour. The third J o u r n a l P r e -p r o o f parenthesised factor is based on the sum of two terms. The first term, (1-V2G Max-Share ), represents the minimum fraction of vehicles parked. The second term is the additional fraction of vehicles parked during non-rush hours. The hourly fraction of vehicles parked is derived from the known input of hourly energy demand for the fleet. This equation yields c V2G , the power capacity of all connected V2G vehicles, in any given hour. For each hour, the model calculates as follows.</p>
        <p>The V2G battery electric vehicles will charge in the case of available excess electricity production (e CEEP ) and available battery energy capacity (S V2G-Battery -s V2G-Battery ) within the limitations of the power capacity of the grid connection (c V2G ) for that particular hour. Thus, the equation is the minimum of three values:The V2G battery electric vehicles will charge in the case of available excess electricity production (e CEEP ) and available battery energy capacity (S V2G-Battery -s V2G-Battery ) within the limitations of the power capacity of the grid connection (c V2G ) for that particular hour. Thus, the equation is the minimum of three values:</p>
        <p>e Charge = min [e CEEP , (S V2G-Battry -s V2G-Battery ) / µ Charge , c V2G ] Moreover, mentioned above, the charging is forced in the case in which the transport demands of the present and the next "y" hours cannot be supplied by the battery content. Initially, the "y" value is set to one hour. If this leads to lack of battery content, the value is raised in steps of one hour.e Charge = min [e CEEP , (S V2G-Battry -s V2G-Battery ) / µ Charge , c V2G ] Moreover, mentioned above, the charging is forced in the case in which the transport demands of the present and the next "y" hours cannot be supplied by the battery content. Initially, the "y" value is set to one hour. If this leads to lack of battery content, the value is raised in steps of one hour.</p>
        <p>The minimum battery content needed is calculated: The V2G battery electric vehicles are simulated supplying the grid in the case of a potential replacement of production from power plants (e PP ) and available stored electricity in the battery after the supply of the transport demand:The minimum battery content needed is calculated: The V2G battery electric vehicles are simulated supplying the grid in the case of a potential replacement of production from power plants (e PP ) and available stored electricity in the battery after the supply of the transport demand:</p>
        <p>The resulting new battery content is then calculated as follows s V2G-Battery := s V2G-Battery -(e Inv / µ Inv ) Similar to the description for the hydropower energy storage, the above calculation is repeated until the storage content at the end is the same as at the beginning.The resulting new battery content is then calculated as follows s V2G-Battery := s V2G-Battery -(e Inv / µ Inv ) Similar to the description for the hydropower energy storage, the above calculation is repeated until the storage content at the end is the same as at the beginning.</p>
        <p>Step 9: The electricity storage is described in the model as a hydro storage consisting of the following components:Step 9: The electricity storage is described in the model as a hydro storage consisting of the following components:</p>
        <p>-Pump (converting electricity to potential energy) defined by a capacity and an efficiency -Turbine (converting potential energy to electricity) defined by a capacity and an efficiency -Storage (storing energy) defined by a capacity.-Pump (converting electricity to potential energy) defined by a capacity and an efficiency -Turbine (converting potential energy to electricity) defined by a capacity and an efficiency -Storage (storing energy) defined by a capacity.</p>
        <p>However, this hydro storage can be used for modelling any kind of electricity storage, for example batteries. The simulation of the storage is used solely to avoid critical excess electricity production. The storage facility is regulated in the following way:However, this hydro storage can be used for modelling any kind of electricity storage, for example batteries. The simulation of the storage is used solely to avoid critical excess electricity production. The storage facility is regulated in the following way:</p>
        <p>The pump is used for charging the storage in the case of critical excess production, e CEEP &gt; 0. In this case, the available capacity in the storage (S CAES -s CAES ) is calculated and the electricity demand of the pump (e Pump ) is identified as the minimum value of the following three values:The pump is used for charging the storage in the case of critical excess production, e CEEP &gt; 0. In this case, the available capacity in the storage (S CAES -s CAES ) is calculated and the electricity demand of the pump (e Pump ) is identified as the minimum value of the following three values:</p>
        <p>e CEEP , the critical excess production -(S CAES -s CAES ) / α Pump available storage capacity divided by the pump efficiency -C Pump , the maximum capacity of the pump.e CEEP , the critical excess production -(S CAES -s CAES ) / α Pump available storage capacity divided by the pump efficiency -C Pump , the maximum capacity of the pump.</p>
        <p>If e CEEP &gt; 0 then e Pump := min [ e CEEP , (S CAES -s CAES ) / α Pump , C Pump ]If e CEEP &gt; 0 then e Pump := min [ e CEEP , (S CAES -s CAES ) / α Pump , C Pump ]</p>
        <p>The turbine is used for discharging the storage, first by replacing import and then power plant production if e PP &gt; 0. In this case, the content of the storage (s CAES ) is identified and the electricity production of the turbine (e Turbine ) is identified as the minimum value of the following three parameters:The turbine is used for discharging the storage, first by replacing import and then power plant production if e PP &gt; 0. In this case, the content of the storage (s CAES ) is identified and the electricity production of the turbine (e Turbine ) is identified as the minimum value of the following three parameters:</p>
        <p>e import , e PP , electricity import or electricity production of the power plant, respectively s CAES * µ Turbine , storage content multiplied by turbine efficiency -C Turbine , the maximum capacity of the turbine. Similar to the description for the hydropower and the V2G energy storage, the above calculation is repeated until the storage content at the end of the year is the same as at the beginning.e import , e PP , electricity import or electricity production of the power plant, respectively s CAES * µ Turbine , storage content multiplied by turbine efficiency -C Turbine , the maximum capacity of the turbine. Similar to the description for the hydropower and the V2G energy storage, the above calculation is repeated until the storage content at the end of the year is the same as at the beginning.</p>
        <p>Step 10: As a final step, a number of measures to reduce Critical Excess Electricity Production, e CEEP , are calculated depending on the input specification in which one can chose between:Step 10: As a final step, a number of measures to reduce Critical Excess Electricity Production, e CEEP , are calculated depending on the input specification in which one can chose between:</p>
        <p>1: Reducing renewable electricity productions from wind, photo voltaic, wave power, etc. 2: Reducing CHP production by replacing with peak load fuel-based boilers 3: Replacing fuel-based boiler production with electric heating 4: Increasing CO 2 hydrogenation 5: Part-loading nuclear power generation (otherwise nuclear is simulated following an exogenously given temporal distribution curve)1: Reducing renewable electricity productions from wind, photo voltaic, wave power, etc. 2: Reducing CHP production by replacing with peak load fuel-based boilers 3: Replacing fuel-based boiler production with electric heating 4: Increasing CO 2 hydrogenation 5: Part-loading nuclear power generation (otherwise nuclear is simulated following an exogenously given temporal distribution curve)</p>
        <p>It is possible for the user to prioritise these measures.It is possible for the user to prioritise these measures.</p>
        <p>If market-economic simulation is chosen (see Figure 6), EnergyPLAN distinguishes between business economy (including taxes) and socio-economy (not including taxes). Basically, EnergyPLAN seeks the leastcost solution of operating the system, assuming an electricity market in which all plant operators seek to optimise their business-economic profit. The market-economic modelling is based on the identification of the electricity market price at each hour resulting from the demand and supply of electricity. Moreover, the exact production level of the various units at which the resulting market price becomes equal to the marginal production price is identified. Similarly, marginal consumption prices are found for electricityconsuming units such as heat pumps and electrolysers. The net import is identified as the difference between the electricity demand, d Total , and the supply, e Total . The market price on the external market, p X , is found as follows:If market-economic simulation is chosen (see Figure 6), EnergyPLAN distinguishes between business economy (including taxes) and socio-economy (not including taxes). Basically, EnergyPLAN seeks the leastcost solution of operating the system, assuming an electricity market in which all plant operators seek to optimise their business-economic profit. The market-economic modelling is based on the identification of the electricity market price at each hour resulting from the demand and supply of electricity. Moreover, the exact production level of the various units at which the resulting market price becomes equal to the marginal production price is identified. Similarly, marginal consumption prices are found for electricityconsuming units such as heat pumps and electrolysers. The net import is identified as the difference between the electricity demand, d Total , and the supply, e Total . The market price on the external market, p X , is found as follows:</p>
        <p>where p i is the system market price Fac depend is the price elasticity (Currency/MWh/MW) p o is the basic price level for price elasticity (input), d Net-Import is the trade on the market.where p i is the system market price Fac depend is the price elasticity (Currency/MWh/MW) p o is the basic price level for price elasticity (input), d Net-Import is the trade on the market.</p>
        <p>Import is calculated as positive and export as negative, resulting in an increase in the market price in the case of import and a decrease in the case of export.Import is calculated as positive and export as negative, resulting in an increase in the market price in the case of import and a decrease in the case of export.</p>
        <p>The production level of a certain unit at which the resulting market price becomes equal to the marginal production price is identified as an integrated part of the procedure. Here, the calculation is illustrated by the example of the geothermal power plant.The production level of a certain unit at which the resulting market price becomes equal to the marginal production price is identified as an integrated part of the procedure. Here, the calculation is illustrated by the example of the geothermal power plant.</p>
        <p>First, the net-import, d Net-Import , is calculated as well as the market price, p X , when the electricity production of the geothermal power plant is zero. Then, the balance production is calculated as follows:First, the net-import, d Net-Import , is calculated as well as the market price, p X , when the electricity production of the geothermal power plant is zero. Then, the balance production is calculated as follows:</p>
        <p>where VEEP Geothermal is the marginal production cost of geothermal power production p x is the market price before geothermal production Fac depend is the price elasticity (Currency/MWh/MW) p o is the basic price level for price elasticity (input) d Net-Import is the trade on the market before geothermal productionwhere VEEP Geothermal is the marginal production cost of geothermal power production p x is the market price before geothermal production Fac depend is the price elasticity (Currency/MWh/MW) p o is the basic price level for price elasticity (input) d Net-Import is the trade on the market before geothermal production</p>
        <p>The equation is typically subject to the limitations on power plant capacity.The equation is typically subject to the limitations on power plant capacity.</p>
        <p>The user may stipulate whether the transmission line capacity should limit dNet-Import or not. If EnergyPLAN is set to 'Transmission capacity limits the effect on the system price', then dNet-Import will be limited to the transmission line capacity of the system, in absolute values. If EnergyPLAN is set to "Transmission capacity does not limit the effect on the system price", then the transmission line capacity does not limit dNet-Import.The user may stipulate whether the transmission line capacity should limit dNet-Import or not. If EnergyPLAN is set to 'Transmission capacity limits the effect on the system price', then dNet-Import will be limited to the transmission line capacity of the system, in absolute values. If EnergyPLAN is set to "Transmission capacity does not limit the effect on the system price", then the transmission line capacity does not limit dNet-Import.</p>
        <p>The simulation is done in the following steps as illustrated in figure 8:The simulation is done in the following steps as illustrated in figure 8:</p>
        <p>Step 1: The hourly prices on an external electricity market is defined as an input. The fluctuations of the market prices are presented as an hourly distribution file for a year. The influence of import/export on the external market prices is given in terms of a dependence factor (price elasticity and a basic price level for the price elasticity). When the business-economic best operation strategy is identified for each plant in the following, the influence on the market price is taken into consideration.Step 1: The hourly prices on an external electricity market is defined as an input. The fluctuations of the market prices are presented as an hourly distribution file for a year. The influence of import/export on the external market prices is given in terms of a dependence factor (price elasticity and a basic price level for the price elasticity). When the business-economic best operation strategy is identified for each plant in the following, the influence on the market price is taken into consideration.</p>
        <p>J o u r n a l P r e -p r o o fJ o u r n a l P r e -p r o o f</p>
        <p>Step 2: All marginal production costs are calculated on the basis of fuel costs, taxes, CO 2 costs and variable operational costs. For units connected to district heating plants (such as CHP and heat pumps), power stations and individual micro CHP, marginal costs are given in currency/MWh of electricity production/consumption. Currency can be chosen by the user, e.g. DKK or EUR. For storage units such as hydrogen CHP and pump storage systems, marginal costs are given according to a multiplication factor together with an addition factor. Basically, the simulation criterion is the following:Step 2: All marginal production costs are calculated on the basis of fuel costs, taxes, CO 2 costs and variable operational costs. For units connected to district heating plants (such as CHP and heat pumps), power stations and individual micro CHP, marginal costs are given in currency/MWh of electricity production/consumption. Currency can be chosen by the user, e.g. DKK or EUR. For storage units such as hydrogen CHP and pump storage systems, marginal costs are given according to a multiplication factor together with an addition factor. Basically, the simulation criterion is the following:</p>
        <p>In which p sell is the market electricity price when selling (Currency/MWh) p buy is the market electricity price when buying (Currency/MWh) f MUL is the multiplication factor (always higher than 1) f ADD is the addition factor (Currency/MWh)In which p sell is the market electricity price when selling (Currency/MWh) p buy is the market electricity price when buying (Currency/MWh) f MUL is the multiplication factor (always higher than 1) f ADD is the addition factor (Currency/MWh)</p>
        <p>Step 3: As a starting point for the simulation, the electricity system prices are calculated on the basis of:Step 3: As a starting point for the simulation, the electricity system prices are calculated on the basis of:</p>
        <p>the electricity demand including flexible demand (calculated as described above) -the production from RESthe electricity demand including flexible demand (calculated as described above) -the production from RES</p>
        <p>The production from RES is potentially affected by the "RES influence on system electricity price" setting, which has two options:The production from RES is potentially affected by the "RES influence on system electricity price" setting, which has two options:</p>
        <p>• "Zero bidding price (RES can stop)": When using this option, the Variable RES electricity production will be curtailed at negative system electricity market prices. • "Negative bidding prices (RES cannot stop)": When using this option, the Variable RES will not be curtailed due to negative electricity market prices.• "Zero bidding price (RES can stop)": When using this option, the Variable RES electricity production will be curtailed at negative system electricity market prices. • "Negative bidding prices (RES cannot stop)": When using this option, the Variable RES will not be curtailed due to negative electricity market prices.</p>
        <p>As a starting point, all district heating is defined as supplied by boilers. The sequence of optimising the individual plant type aggregation is then identified by the subsequent procedure.As a starting point, all district heating is defined as supplied by boilers. The sequence of optimising the individual plant type aggregation is then identified by the subsequent procedure.</p>
        <p>Step 4: The least-cost solutions of buying the minimum amount of electricity needed to meet the following demands are identified, given the market price fluctuations and limitations on storage capacities, etc.:Step 4: The least-cost solutions of buying the minimum amount of electricity needed to meet the following demands are identified, given the market price fluctuations and limitations on storage capacities, etc.:</p>
        <p>for producing hydrogen for transport for charging electric vehicles for producing hydrogen for micro-CHP systems When identifying the least-cost solution for the hydrogen micro-CHP systems, the option of producing heat with a boiler using less hydrogen than the CHP unit is considered in situations of high electricity prices.for producing hydrogen for transport for charging electric vehicles for producing hydrogen for micro-CHP systems When identifying the least-cost solution for the hydrogen micro-CHP systems, the option of producing heat with a boiler using less hydrogen than the CHP unit is considered in situations of high electricity prices.</p>
        <p>In the case of smart charge EV and V2G (Vehicle to Grid) possibilities, the optimal business-economic solutions of buying and selling are found on the basis of the multiplication and addition factors identified as an input.In the case of smart charge EV and V2G (Vehicle to Grid) possibilities, the optimal business-economic solutions of buying and selling are found on the basis of the multiplication and addition factors identified as an input.</p>
        <p>Step 5: The following electricity-consuming options are sorted according to marginal consumption costs:Step 5: The following electricity-consuming options are sorted according to marginal consumption costs:</p>
        <p>replacing boiler with heat pumps in district heating Group 2 -replacing boiler with heat pumps in district heating Group 3 -replacing boiler with electrolysers in district heating Group 2 -replacing boiler with electrolysers in district heating Group 3 -replacing electric heating with heat pumps in individual houses replacing boiler with electric boiler in district heating Group 2 -replacing boiler with electric boiler in district heating Group 3replacing boiler with heat pumps in district heating Group 2 -replacing boiler with heat pumps in district heating Group 3 -replacing boiler with electrolysers in district heating Group 2 -replacing boiler with electrolysers in district heating Group 3 -replacing electric heating with heat pumps in individual houses replacing boiler with electric boiler in district heating Group 2 -replacing boiler with electric boiler in district heating Group 3</p>
        <p>J o u r n a l P r e -p r o o f -producing steam for high-temperature thermal storage if the electricity price is lower than the cost of fuel for condensing-mode power generation and power generation at the extraction-mode CHP in DH Group 3 taking efficiencies into account.J o u r n a l P r e -p r o o f -producing steam for high-temperature thermal storage if the electricity price is lower than the cost of fuel for condensing-mode power generation and power generation at the extraction-mode CHP in DH Group 3 taking efficiencies into account.</p>
        <p>Each option is then optimised according to market electricity prices, by starting with the option with the highest marginal costs and taking into consideration the fact that each change in consumption influences the market price (increases the price).Each option is then optimised according to market electricity prices, by starting with the option with the highest marginal costs and taking into consideration the fact that each change in consumption influences the market price (increases the price).</p>
        <p>Step 6: Then, the best business-economic production from concentrated solar power (CSP) is identified taking into consideration limitations on storage and generator capacities, and a similar calculation is done for hydropower. In the case of pumped hydro storage possibilities, the optimal business-economic solution of buying and selling is identified.Step 6: Then, the best business-economic production from concentrated solar power (CSP) is identified taking into consideration limitations on storage and generator capacities, and a similar calculation is done for hydropower. In the case of pumped hydro storage possibilities, the optimal business-economic solution of buying and selling is identified.</p>
        <p>Step 7: The following electricity production options are then sorted according to the lowest marginal costs of production:Step 7: The following electricity production options are then sorted according to the lowest marginal costs of production:</p>
        <p>-Nuclear -Geothermal -Condensing-mode power plants -Individual small-scale CHP units -Individual biomass CHP -CHP replacing boilers in district heating Group 2 -CHP replacing boilers in district heating Group 3 -CHP replacing heat pumps in district heating Group 2 -CHP replacing heat pumps in district heating Group 3 -CHP replacing electrolysers in district heating Group 2 -CHP replacing electrolysers in district heating Group 3-Nuclear -Geothermal -Condensing-mode power plants -Individual small-scale CHP units -Individual biomass CHP -CHP replacing boilers in district heating Group 2 -CHP replacing boilers in district heating Group 3 -CHP replacing heat pumps in district heating Group 2 -CHP replacing heat pumps in district heating Group 3 -CHP replacing electrolysers in district heating Group 2 -CHP replacing electrolysers in district heating Group 3</p>
        <p>Each option is then optimised according to market electricity prices, starting with the option with the lowest marginal costs and taking into consideration the fact that each change in consumption influences the market price (decreases the market price). Limitations on transmission lines are taken into consideration by setting a limit on the production of each unit, so that the total export will not exceed the transmission capacity (if possible). Limitations on import are calculated with regard to the condensing power plants, which will simply be activated in the case that the import transmission capacity is exceeded.Each option is then optimised according to market electricity prices, starting with the option with the lowest marginal costs and taking into consideration the fact that each change in consumption influences the market price (decreases the market price). Limitations on transmission lines are taken into consideration by setting a limit on the production of each unit, so that the total export will not exceed the transmission capacity (if possible). Limitations on import are calculated with regard to the condensing power plants, which will simply be activated in the case that the import transmission capacity is exceeded.</p>
        <p>Step 8: The optimal business-economic solution of buying and selling is identified on the basis of the abovementioned multiplication and addition factors.Step 8: The optimal business-economic solution of buying and selling is identified on the basis of the abovementioned multiplication and addition factors.</p>
        <p>Step 9: In order to calculate the impact on the simulation of the consumption units after the market price is influenced by the production options, the procedure from Steps 3 to 8 is repeated.Step 9: In order to calculate the impact on the simulation of the consumption units after the market price is influenced by the production options, the procedure from Steps 3 to 8 is repeated.</p>
        <p>Step 10: Any critical excess production is removed following the technical simulation procedure Step 10 as described in Section 3.2.Step 10: Any critical excess production is removed following the technical simulation procedure Step 10 as described in Section 3.2.</p>
        <p>J o u r n a l P r e -p r o o fJ o u r n a l P r e -p r o o f</p>
        <p>In line with the objectives set out for the tool, 
            <rs type="software">EnergyPLAN</rs> enables the user to make consistent and comparative analyses of energy systems based on renewable energy, fossil fuels, and nuclear power. The J o u r n a l P r e -p r o o f tool considers all sectors of the energy system (electricity, heat, industry and transport) and includes a wide variety of technologies. Furthermore, 
            <rs type="software">EnergyPLAN</rs> makes it possible to quickly complete the modelling without losing coherence for a large variety of systems including current systems (which are based on fossil fuel production) as well as those with radical technological changes (such as 100% renewable energy systems). The tool is a freeware with a long record of active use. It involves independent add-ons and help tools and it may be executed from other platforms such as 
            <rs type="software">Excel</rs> or 
            <rs type="software">MATLAB</rs>, which enables multiexecution. In addition, it can calculate the hourly operation of an energy system to ensure that supply and demand are reliably matched, even with the introduction of intermittent renewable energy.
        </p>
        <p>With EnergyPLAN, the modeller can also differentiate between a technical simulation, which ignores existing electricity market constructions and price levels, and a market-economic simulation, which can be adjusted using taxes. For both simulations, the tool can calculate the costs of the total system divided into investments costs, operation costs, fuel costs, CO 2 costs and other taxes. Hence, EnergyPLAN can create data for further analysis of socio-economic feasibility studies, such as the balance of payment and job creation. It is freely available for download along with detailed documentation about its operation, which enables its functionality and methodologies to be freely debated and improved.With EnergyPLAN, the modeller can also differentiate between a technical simulation, which ignores existing electricity market constructions and price levels, and a market-economic simulation, which can be adjusted using taxes. For both simulations, the tool can calculate the costs of the total system divided into investments costs, operation costs, fuel costs, CO 2 costs and other taxes. Hence, EnergyPLAN can create data for further analysis of socio-economic feasibility studies, such as the balance of payment and job creation. It is freely available for download along with detailed documentation about its operation, which enables its functionality and methodologies to be freely debated and improved.</p>
        <p>Compared to other models, the main advantages of 
            <rs type="software">EnergyPLAN</rs> are the ability to model the entire system with all sectors, the aggregation of units into representative units limiting the data requirement, the ability to quickly simulate a user-defined scenario, the transparency in how scenarios are developed, the 1h temporal simulation step and the ability to simulate an entire year with seasonal variations.
        </p>
        <p>The limitations of EnergyPLAN to some extent mirror the advantages. With a focus on the entire system and with the aggregation employed in EnergyPLAN, the detailed operation of individual units are not captured. Likewise, the exogenous and transparent system design (and resulting fast computational time) comes at the expense of larger requirements of the user; thus, some experience is required to identify favourable scenarios.The limitations of EnergyPLAN to some extent mirror the advantages. With a focus on the entire system and with the aggregation employed in EnergyPLAN, the detailed operation of individual units are not captured. Likewise, the exogenous and transparent system design (and resulting fast computational time) comes at the expense of larger requirements of the user; thus, some experience is required to identify favourable scenarios.</p>
        <p>EnergyPLAN's appropriateness is dependent on the individual user's objectives. EnergyPLAN is particularly suitable if the main objective is to analyse the impact of long-term alternatives, particularly in relation to renewable energy, and where distinct scenarios are analysed without endogenous system optimisation. Other tools can often be used in combination with 
            <rs type="software">EnergyPLAN</rs> if there are additional objectives that need to be met when completing an energy system analysis. Lastly, EnergyPLAN is undergoing continuous development to always be able to meet the modelling requirements of future energy systems. Currently, the model is being improved in its ability to identify suitable flexible use of electrolysers as well as in its ability to proper handle different assumptions on how variable renewable electricity productions influence negative electricity market prices.
        </p>
        <p>This work received funding from the SENTINEL project of the European Union's Horizon 2020 research and innovation programme under grant agreement No 837089, and the RE-Invest project which is supported by the Innovation Fund Denmark under grant agreement No 6154-00022B.This work received funding from the SENTINEL project of the European Union's Horizon 2020 research and innovation programme under grant agreement No 837089, and the RE-Invest project which is supported by the Innovation Fund Denmark under grant agreement No 6154-00022B.</p>
        <p>J o u r n a l P r e -p r o o fJ o u r n a l P r e -p r o o f</p>
        <p>☒ The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.☒ The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p>
        <p>☐The authors declare the following financial interests/personal relationships which may be considered as potential competing interests:☐The authors declare the following financial interests/personal relationships which may be considered as potential competing interests:</p>
    </text>
</tei>
