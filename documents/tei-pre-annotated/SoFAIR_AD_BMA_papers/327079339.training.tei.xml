<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T10:01+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>This document is the author's post-print version, incorporating any revisions agreed during the peer-review process. Some differences between the published version and this version may remain and you are advised to consult the published version if you wish to cite from it.</p>
        <p>The United Nations has reported that 12.3 percent of the population were over 60 years of age in 2015, and forecast to be more than 21.3 percent in 2050. Therefore, many countries face an aging population.</p>
        <p>Providing the required health care services for an aging population is a challenge for health care systems in different countries. Many countries have invested in long-term care (LTC) services to improve the cost and quality of their health care services. Long-term care is also known as home health care (HHC) if the services are provided at home. Also, pandemic situations, such as what has been observed during the COVID-19 outbreak, significantly increase the demand of home healthcare as many people are asked to stay at home while they still need health and medical services. This has prompted many countries to further invest in their home healthcare services. Home Health Care News (HHCN) (Donlan, 2020) reported that the operations of 31% of home health care providers have been affected by the spread of COVID-19 over the past few weeks.</p>
        <p>Home health care is defined as the provision of a wide range of medical and paramedical services to patients in their homes or in care facilities for elderly people. HHC services may include wound care for pressure sores or surgical wounds, injections, the monitoring of serious illnesses and unstable health statuses, etc. HHC is booming in many countries as it is less costly than hospital care and, in many cases, is more comfortable and effective than the care provided in a hospital (Akjiratikarl et al., 2007;Yuan et al., 2015).</p>
        <p>Decisions related to human resource planning in home health care can be categorized into decisions on staff dimensioning, partitioning the territory into districts (districting), assigning caregivers to patients, and the scheduling and routing of caregivers (Yalçındag et al., 2016;Sahin and Matta, 2015). A few articles have considered two levels of these decisions simultaneously, but, to the best of the authors' knowledge, there is no study focusing on all decision levels, while an integrated model considering all decision levels will lead to less cost and higher service quality. Therefore, in this study an integrated model is proposed to make integrated decisions on districting, dimensioning, assignment, and routing.</p>
        <p>Districting is the initial phase of designing an HHC system, and has significant effects on improving the efficiency of care delivery. The aim of districting is to partition the basic units (sets of patients and caregivers) into a number of larger clusters so that caregivers are able to deliver care to the patients in their cluster more quickly. This ultimately increases the patients' and the caregivers' satisfaction. Moreover, staff dimensioning is an important tactical decision as it determines the number of caregivers who need to be hired in each district. This decision is critical because recruiting or laying off caregivers during the planning horizon is costly, and the decision also affects the caregivers' satisfaction by increasing their job security.</p>
        <p>In the proposed model, the set of patients and caregivers is partitioned into districts based on the costs of the routing and staff dimensioning. The goal of the model is to determine the set of required caregivers and patients in each district and the required number of caregivers, while taking into account routing and hiring costs. The caregivers in a district can only be assigned to the patients in that district, and they start their visiting tour from their homes. Based on our review of real case situations, we found that HHC centers often try to allocate patients to the caregivers who live in the same residential zone and would like to design the schedule so that the starting and finishing locations for each caregiver are as close as possible. However, if this assumption is not imposed, the routing decisions can be replaced by the open vehicle routing problem in the proposed model. Caregivers have a predefined maximum number of working hours per day. Similarity between caregivers' skills and continuity of care, which are known to be important points in dimensioning, assignment, scheduling, and routing problems, are considered in the proposed model, to optimize the routing and assignment costs. Continuity of care guarantees that each patient is visited by one caregiver or a limited number of caregivers. Continuity of care decreases the data transmission between caregivers, increases patients' comfort, and, as a result, improves the relationships between the caregivers and the patients. In real situations, the values of some parameters are stochastic and can be characterized in various scenarios. Hence, in this paper, a two-stage stochastic programming model is proposed to deal with uncertain travelling and servicing times. In several studies of stochastic vehicle routing problems, travel and service times are considered as uncertain parameters (Pillac et al., 2013). In the proposed two-stage model, the districting and staff dimensioning are the first stage decision variables, and the assignment and routing decisions are defined as the second stage variables.</p>
        <p>To solve the proposed model, a new matheuristic algorithm is proposed. The proposed algorithm has of four phases. In the first phase, the problem size is decreased by determining the visiting sequence for the patients and obtaining a restricted set of the number of potential districts. An initial solution is determined in phase 2, based on the visiting sequence and the set of the numbers of potential districts obtained in phase 1. The progressive hedging based algorithm is employed to solve the proposed model in the second phase. In phase 3, an infeasible solution is repaired by using an iterative approach based on a fix and optimize method.</p>
        <p>The obtained solution is improved in the last phase of the algorithm by using a procedure based on the fix and optimize method. This paper is organized as follows. Studies related to human resource planning in home health care are briefly reviewed in Section 2. The problem is defined and formulated in Section 3, and the proposed mathematical model based algorithm is explained in Section 4. Section 5 is devoted to numerical examples.</p>
        <p>Finally, the conclusions and some perspectives are provided in the last section. For a better illustration of the current research stream, a road map of the whole study is depicted in Figure 1.</p>
        <p>Home health care planning deals with different types of decision variables. Decisions related to home health care planning based on a planning horizon can be divided into three classes. These classes are the strategic, tactical, and operational decisions. Districting and staff dimensioning decisions are at the strategic and tactical levels, respectively, and assignment and routing decisions are at the operational level. The studies related to human resource planning in home health care are reviewed in this section on the basis of the type of decision.</p>
        <p>A basic unit is defined as a postal area, a street, a geo-code address, etc. Using the definition of basic unit in HHC, patients are grouped into basic units to reduce the problem size in the districting phase (i.e., basic units are used for districting instead of each individual patient's address). Therefore, districting in HHC is defined as grouping basic units into larger clusters (districts) (Blais et al., 2003;Benzarti et al., 2013). In districting, a territory is partitioned into a number of districts and each caregiver is assigned to a district. Districting not only improves service quality but also increases patients' and caregivers' satisfaction.</p>
        <p>It decreases travel time, and consequently improves caregivers' efficiency in serving patients. Only a few studies in the context of home health care planning are devoted to districting. In these studies, several basic units (where a basic unit is defined as a set of patients) are assigned to districts, by considering different criteria. Blais et al. (2003) considered criteria such as the indivisibility of basic units, mobility, connectivity, workload equilibrium, and respect of borough boundaries in a home health care districting problem. The objective function of their model consisted of two terms, including the mobility measure and workload equilibrium, with the other criteria being included as hard constraints. The mobility measure determines the total distance travelled in one year. The authors used a Tabu Search algorithm to solve the problem. Benzarti et al. (2013) proposed two models for an HHC districting problem by considering the indivisibility of basic units, compactness, workload balance between caregivers, and compatibility. Compatibility covers mobility and connectivity criteria. Balancing the workload of caregivers in different districts was the objective function of their first model, and minimizing the compactness measure (the maximum distance between basic units in the same district) was the objective function of their second model. In their models, caregivers' workload consists of the travelling time between patients and the time required to deliver the care service. Blais et al. (2003) and Benzarti et al. (2013) defined a basic unit as a group of patients, but the starting nodes of the caregivers were not taken into account. It should be noted that the starting nodes can affect the efficiency of the home health care planning, and can help managers to decide on a cost effective system by decreasing the routing cost and the number of caregivers required. In addition, both papers assumed that caregivers are identical in terms of their level of skills, and the similarity between the skill level of the caregivers and the patients' requirements was not considered. Also, all parameters were deterministic in their models. A comparison between the current study and these studies is shown in Table 1.</p>
        <p>Staff dimensioning is defined as determining the number of caregivers required in the home health care system to meet the demands of different types of patients. Caregivers' travelling time between patients, and factors such as the similarity between the patient's demands and the caregiver's level of skills, continuity of care and limitations on caregivers' working time, must be considered in staff dimensioning. In spite of the fact that staff dimensioning is critical in HHC planning, there is only one study in the literature dedicated to this problem. Rodriguez et al. (2015) proposed a two-stage stochastic model for staff dimensioning in HHC when the demands of patients are uncertain. The number of caregivers at each skill level was the first stage decision variable, and the assignment of caregivers to patients was the second stage variable in their model. They developed an integrated model that simultaneously considers staff dimensioning, assignment, and routing decisions. They proposed a two-phase algorithm to solve their model. In the first phase, the minimum number of required caregivers at each skill level is determined to serve all demands under each scenario. Then, the number of caregivers required to satisfy a defined level of performance is obtained by solving a master problem. The authors assumed that all demands had to be met in a single period.</p>
        <p>Most studies in home health care planning focus on scheduling and routing problems. Fikar and Hirsch (2017) and Cissé et al. (2017) reviewed the studies related to scheduling and routing problems in home health care. They classified the studies, based on the planning horizon, into two clusters. In the first cluster, a single period is considered, and most studies in the context of scheduling and routing problems are in this category. Fikar and Hirsch (2017) surveyed the articles according to different criteria, such as solution method, objective function, and constraints. They highlighted that mathematics-based (matheuristic) heuristic algorithms were proposed by Bertels and Fahle (2006), Bredström and Rönnqvist (2008), and Fikar and Hirsch (2015). Several articles on single period scheduling and routing problems in home health care considered uncertainty in different parameters, such as demand or service time. Lanzarone and Matta (2014) assumed the demands of the patients to be uncertain. Yuan et al. (2015) proposed a two-stage stochastic programming model for a scheduling and routing problem in home health care when the service times and skill requirements are stochastic. They solved their model using a branch-and-price algorithm.</p>
        <p>In the second cluster, caregivers work on multiple days and the services required by patients are spread over different days. The assignment, scheduling, and routing decisions are considered to be integrated in this cluster of problems. Because the assignment of caregivers is considered and the services required by patients are spread over different days, some factors, such as continuity of care, are defined in this type of problem.</p>
        <p>Despite the importance of the continuity of care, only a few studies have paid attention to it. Continuity of care was considered as a term in the objective function in some studies, e.g. (Carello and Lanzarone, 2014;Wirnitzer et al., 2016) or as a soft or hard constraint in others e.g. (Duque et al., 2015;Cappanera and Scutellà, 2014).</p>
        <p>Different solution methods have been proposed in the studies on assignment, scheduling, and routing problems. In most of these studies, heuristic and meta-heuristic algorithms have been proposed, e.g. (Nickel et al., 2012). Furthermore, in some studies, matheuristic algorithms were developed. Barrera et al. (2012) proposed a mathematics-based heuristic approach to solve a multi-objective assignment, scheduling, and routing problem. This approach is defined on the basis of lexicographic optimization, which was used as the method for solving multi-objective problems. Duque et al. (2015) proposed a two-phase mathematics-based heuristic solution method. In the first phase, the feasible visiting schemes were generated, and then an optimal visiting scheme was determined for each patient using a mathematical model. A heuristic approach was then used to determine the routing decision, based on the scheme obtained in the previous phase.</p>
        <p>There are several studies on assignment, scheduling, and routing problems focused on uncertainty, con sidering the demands, travel time, and servicing time as uncertain parameters. Yuan et al. (2018) proposed a two-stage stochastic programming model for when the servicing and travel times are stochastic. They also used a branch-and-price algorithm to solve the problem. Carello and Lanzarone (2014) proposed a robust model for assigning patients to caregivers when their demands are uncertain.</p>
        <p>A comparison between the proposed model and the studies related to HHC with uncertain parameters is presented in Table 2. This table shows that in the context of resource planning in HHC there are few studies that consider uncertain parameters. It can be concluded that most studies are related to the scheduling and routing of the caregivers, and that there is no study considering the districting, staff dimensioning, scheduling, and routing decisions simultaneously. Driver Scheduling Problem (Perumal et al., 2018), staff dimensioning in an emergency department (Andersen et al., 2019), pricing problem (Oliveira et al., 2019), a patient to bed assignment problem (Guido et al., 2018), and a vehicle reservation assignment (Oliveira et al., 2014).</p>
        <p>Based on our literature review, the contribution of this study can be stated as follows: we propose a model to consider human resource planning decisions (districting, staff dimensioning, assignment, and routing) in HHC, simultaneously. Based on the reviewed papers in Tables 1 and2, our study is the first one that considers these decisions simultaneously. We treat travel and service times as uncertain parameters and handle them by a two-stage stochastic programming, and consider the factors that affect the patients' satisfaction such as continuity of care. We propose a new mathematical model-based heuristic algorithm to solve the problem. proposed. In the last phase of the proposed algorithm, the obtained solutions for the routing and assignment decisions are improved by using a fix and optimize method.</p>
        <p>The stochastic districting-staff dimensioning-assignment-routing problem (SDDARP) is outlined as</p>
        <p>In this section, the proposed mathematical model for districting, based on staff dimensioning and routing costs, is presented. In the proposed model, M is defined as the maximum number of districts, and K is the number of caregivers. This problem is defined by a graph G(V, A), where V = { 1, 2, ..., N, N + 1, N + 2, ..., N + K } is the set of nodes and A = {(i, j)|i, j ∈ V, i = j} is the set of arcs. N = { 1, 2, ..., N } is the patient set, which determines the home location of each patient, and the set N c = { N +1, N +2, ..., N +K } is used to define the locations of the caregivers. Therefore, N c defines the locations of the start and end point of the tours. The assumptions in the proposed model are as follows:</p>
        <p>• The number of patients served by the HHC system is known and is not updated during the planning horizon.</p>
        <p>• Each basic unit must be assigned to exactly one district.</p>
        <p>• The caregivers in each district can only be assigned to patients in that district.</p>
        <p>• The start and end points for each caregiver are his/her home.</p>
        <p>• Patients in a given basic unit require different types of services. The lowest skill level that the caregiver should have to perform the required service for each patient is determined by assigning a number from the set {1, 2, . . . , R} to the caregiver.</p>
        <p>• Patients need different number of visits in the planning horizon, based on their type of services. The schedule of visiting patients is determined by the mathematical model.</p>
        <p>• Each patient can be visited at most once a day.</p>
        <p>• Each caregiver can serve a limited number of patients. On the other hand, the working time of each caregiver is less than a predetermined value.</p>
        <p>• Caregivers have different levels of skills, and they can serve patients if the required service matches their skills. The level of skill for each caregiver is determined by assigning a number from the set {1, 2, . . . , Q} (Q ≥ R) to the caregiver, where 1 and Q denote the lowest and highest level of skills, respectively. In addition, a caregiver can serve a patient when the minimum required level of skill for that patient is equal to or lower than her/his skill level. Therefore if the level of skill for a caregiver is equal to 2, patients with required services in levels 1 or 2 can be served by the caregiver.</p>
        <p>• The optimal number of districts in the design is unknown in advance and is determined by the model.</p>
        <p>However, the maximum number of districts M is known and is defined by M = min (K,L). Where K is the number of available caregivers and L was defined above, as the number of basic units.</p>
        <p>• Two basic units are incompatible if traveling between them is difficult or impossible. This may be because of geographical obstacles. This assumption is called "incompatibility" and considered as a hard constraint.</p>
        <p>• The maximum allowable travel time between two basic units in a district is considered. This is called "neighbouring" and considered as a soft constraint. Two basic units are neighbours if the maximum travel time between them is less than a predefined value.</p>
        <p>• Continuity of care is considered.</p>
        <p>• Districting and staff dimensioning are strategic and tactical decisions and are fixed for a long time period.</p>
        <p>• Travel and service times are considered as uncertain parameters and their values are determined for each scenario.</p>
        <p>The sets, parameters, and decision variables of the proposed model are as follows:</p>
        <p>Sets:</p>
        <p>V Set of all nodes (patients and caregivers),</p>
        <p>Set of basic units that are incompatible with basic unit l (l ∈ L).</p>
        <p>l L N Set of basic units that are not in the neighbourhood of l th (l ∈ L) basic unit (tr ll &gt; td). Parameters:</p>
        <p>The lowest required skill level that a caregiver should have to serve the i th (i ∈ N ) patient.</p>
        <p>q k The skill level of the k th (k ∈ K) caregiver.</p>
        <p>λ i Number of required visits for the i th (i ∈ N ) patient.</p>
        <p>st i (ξ) Service time for the i th (i ∈ N ) patient under scenario (ξ ∈ Ξ).</p>
        <p>tt ij (ξ) Travel time between the i th and the j th (i, j ∈ V) nodes under scenario (ξ ∈ Ξ).</p>
        <p>Probability of scenario ξ (ξ ∈ Ξ).</p>
        <p>b i Latest allowable servicing start time of i th ( i ∈ N ) patient.</p>
        <p>tr ll w</p>
        <p>The mean value of maximum travel time between the basic units l and l ' , (l, l ' ∈ L). Decision variables:</p>
        <p>The time that servicing starts at the i th (i ∈ N ) patient by the k th (k ∈ K) caregiver in day</p>
        <p>π ll w 1 if basic units l and l' (l, l ' ∈ L) are assigned to the same district, 0 otherwise.</p>
        <p>Here, a two-stage stochastic programming model is proposed for SDDARP when travel and service times are uncertain. Districting and staff dimensioning are strategic and tactical decision variables, respectively, and assignment and routing are operational decision variables. Therefore, districting and staff dimensioning are the first stage decision variables, and assignment and routing are defined as the second stage decision variables. The objective function consists of three terms, including the costs of hiring and of violating the neighbouring criterion, as well as the expected value of the transportation cost. The proposed two-stage stochastic programming model is defined as follows:</p>
        <p>(SDDARP)</p>
        <p>j∈V m∈M i∈V d∈D k∈K ξ∈Ξ j� =i s.t.:</p>
        <p>The objective function (1) minimizes the hiring, violation of the neighbouring criterion, and transportation costs, defined as a function of travel time. The constraints of the SDDARP model are classified into five groups including constraints related to partitioning the basic units into districts, hiring caregivers, assigning patients to caregivers, routing, and continuity of care. The constraints related to each class are defined here.</p>
        <p>The constraints related to partitioning basic units to districts are as follows:</p>
        <p>Constraints (2) guarantee that each basic unit is assigned to exactly one district. Constraints (3) guaran tee the compatibility and maximum allowable distance between two basic units in a district. Constraints (4) determine that the basic units in terms of which violations of the neighboring criterion are defined. Con straints (5) state that each patient can be assigned to exactly one district, and this district must be the same as the district assigned to that patient's basic unit.</p>
        <p>The constraints related to hiring caregivers are described as follows:</p>
        <p>Constraints (6) ensure that if there are any patients in a district, at least one caregiver is assigned to that district. Constraints (7) state that caregivers are not hired for a district with no patients.</p>
        <p>The constraints related to assigning patients to caregivers are explained in the following text:</p>
        <p>Constraints (8) ensure that the required visits for each patient are scheduled in the planning horizon for different caregivers, considering the consistency between the services required for the patient and the skill levels of the caregivers. Constraints (9) guarantee that each patient is visited by at most one caregiver in each day. Constraints (10) guarantee that the working time of each caregiver is less than the maximum value for the working time of a caregiver. Constraints (11) ensure that a node can be assigned to a caregiver if there is a caregiver in the same district. Constraints (12) state that a patient can be assigned to hired caregivers.</p>
        <p>Constraints (13) ensure that a caregiver can be assigned to patients in a day if she/he leaves her/his home in that day.</p>
        <p>The constraints related to routing decisions are as follows:</p>
        <p>Constraints (14) guarantee that each node (patient and caregiver) j can be visited as a successor of node (patient and caregiver) i in a route if they are assigned to the same district. Constraints (15) state that if the i th patient is assigned to the k th caregiver in day d, she/he must be visited in the route of this caregiver th on that day. Constraints ( 16) and ( 17) ensure that the start and end points of the k th route in the m district are from the k th caregiver's home if the k th caregiver is hired in this district. Constraints (18) are flow conservation constraints. Constraints ( 19) are sub-tour elimination constraints. Constraints (20) are time window constraints.</p>
        <p>The constraints related to continuity of care are introduced here:</p>
        <p>Constraints (21) determine the caregivers who are assigned to each patient. Constraints ( 22) guarantee continuity of care. Constraints ( 23) to ( 25) define the domain of the decision variables.</p>
        <p>To solve the problem efficiently, a matheuristic algorithm is proposed, called Math-1. The proposed algorithm includes four main phases as depicted in Figure 3</p>
        <p>A ik (ξ) Set of nodes (caregivers and patients) that are visited after the i th (i ∈ V) node in the obtained tour in Phase 1 of Math-1 algorithm for the k th (k ∈ K) caregiver under scenario ξ (ξ ∈ Ξ).</p>
        <p>B ik (ξ) Set of nodes (caregivers and patients) that are visited before the i th (i ∈ V) node in the obtained tour in Phase 1 of of Math-1 algorithm for the k th (k ∈ K) caregiver under scenario Decision variables:</p>
        <p>1 if basic units l and l' (l, l ' ∈ L) are assigned to the m th district.</p>
        <p>The objective value of obtained solution.</p>
        <p>As mentioned previously, the maximum number of potential districts (M ) is obtained on the basis of the numbers of basic units and caregivers (M = min(K, L)), so the number of potential districts must lie</p>
        <p>The objective function (26) minimizes the maximum travel cost between the basic units in the same district and cost of violation in neighbouring constraint. Constraints (27) guarantee that each basic unit is assigned to one district. Constraints (28) ensure that each district consists of at least one basic unit.</p>
        <p>Constraints (29) guarantee that two basic units can belong to a district if they are assigned to the same district. Constraints (30) ensure that a patient can be assigned to a district if a caregiver with the required skill has been assigned to the same district. Constraints (31) determine the domain of the intermediate model (Int.M1) decision variables.</p>
        <p>In another step of the current phase, which is based on the algorithm proposed by Solyalı and Süral (2017), a Traveling Salesman Problem (TSP) is solved for each caregiver over all patients in all basic units under each scenario. Caregivers' locations are assumed to be the start and end points of their corresponding tours.</p>
        <p>On the other hand, the TSP model is solved S × K times and an initial sequence of patient visits for each caregiver is obtained. The succeeding and preceding nodes of each caregiver and patient (i) in an achieved tour (k) under each scenario (ξ) define the sets A ik (ξ) and B ik (ξ), respectively. An example is presented to clarify the definition of these sets. Two caregivers, five patients, and one scenario are considered, and it is assumed that the tours obtained for the first and second caregivers are 6-1-3-2-4-5-6 and 7-3-2-5-1-4-7, respectively. The sets obtained are shown in Table 3. In this example, nodes 6 and 7 are the first and second caregivers' locations, respectively.</p>
        <p>By considering the sets A ik (ξ) and B ik (ξ), the size of the problem in phase 2 is decreased, because subtour elimination constraints are removed. Sub-tour elimination constraints are known as constraints that make a problem harder to solve, and the number of these constraints increases as the number of patients and caregivers increases. Therefore, using these sets will decrease the computational time of the proposed clustering based model in phase 2. Then the basic units are partitioned into g districts. Determining an initial solution is the goal of this phase.</p>
        <p>The decision variables x ijm (ξ) and w imkd (ξ) are replaced by x ij (ξ) and w ikd (ξ), respectively in the model by adding new variables µ ll w m to reduce the number of binary variables. The Int.M2 model is presented as follows:</p>
        <p>(Int.M2(g)) min</p>
        <p>Constraints ( 36) guarantee that at least one caregiver is hired in each district. Constraints ( 40) and ( 41) guarantee that µ ll w m is equal to 1 if the basic units l and l ' are assigned to the same district. Constraints (42) state that the i th patient can be assigned to the k th caregiver if they are in the same district. Constraints (45) ensure that nodes i and j can be visited sequentially if they have been assigned to the same district.</p>
        <p>Constraints (53) ensure that the k th caregiver can be hired in the m th district if the caregiver is assigned to that district.</p>
        <p>An advantage of the proposed model in this phase is that using A ik (ξ) and B ik (ξ) decreases the com plexity of the problem by determining the sequence of patient visits and may lead to an improvement in the computational efficiency.</p>
        <p>The complexity of Int.M2 increases with increasing number of scenarios, therefore, a progressive hedging based algorithm is used to solve the proposed model. The progressive hedging algorithm was proposed by Rockafellar and Wets (1991) as a scenario based decomposition method and was based on an augmented Lagrangian theory by relaxing non-anticipativity constraints. It has been proved that this algorithm can obtain a global optimum solution when all decision variables are continuous, while in the case of mixed integer programming, finding the global optimum solution is not guaranteed. Nevertheless, the progressive hedging algorithm can be considered an efficient heuristic algorithm in the case of mixed integer programming (Guo et al., 2015). Boland et al. (2018) proposed an algorithm based on a combination of the progressive As mentioned previously, the districting decisions are considered as binary first stage decision variables.</p>
        <p>In this paper it is assumed that those basic units assigned to the same district are important in spite of the labels used for defining the districts, and permutations of labels used for defining districts are considered as alternative solutions. Two solutions for districting ten basic units are illustrated in Figure 4. In these solutions, the basic units assigned to the same district are similar, while the labels of districts are different in these solutions. For example, the basic units 2, 5 and 8 are in the same district in both solutions but the label of the district is 1 in the first solution whereas it is 3 in the second solution. Therefore, these solutions The basic units are assigned to each district are shown in Table 4 based on the obtained solution for decision variable ẑlm (ξ) under two different scenarios. The solutions in Table 4 are considered as alternative solutions of Int.M2 for the districting decision. As long as they are treated as different solutions in the PH-FW algorithm, the algorithm cannot converge to a unique solution, or at least in some cases the computational time increases significantly.</p>
        <p>Algorithm 2: The framework of PH-FW algorithm for solving Int.M2 model in the second phase of Math-1 algorithm.</p>
        <p>Phase 1: for ξ ∈ Ξ do Optimize the following model then determine the decision variables (ẑ lm (ξ) ûmk (ξ) μll w m (ξ) dk a ˆik (ξ), w ˆikd (ξ) xij (ξ)) when basic units partitioned into g districts;</p>
        <p>i∈V j∈A ik (ξ) d∈D k∈K s.t. ( 33)-( 54) Using Algorithm 3 to obtain the adjusted solution (The value of first stage decision variables are input of this algorithm and adjusted versions of first stage decision variables are output of this algorithm);</p>
        <p>for ξ ∈ Ξ do Optimize the following model then determine the decision variables</p>
        <p>i∈V j∈A ik (ξ) d∈D k∈K m∈G g l∈L 33)-(54) Using Algorithm 3 to obtain the adjusted solution;</p>
        <p>Optimize the following model then determine the decision variables</p>
        <p>Result: z ¯lm , u ¯mk , µ ¯ll w m , w ˆikd (ξ), route kd (ξ) District Scenario 1 Scenario 2</p>
        <p>An algorithm is proposed to make the obtained solutions similar. In this algorithm, a solution is considered as a reference solution. In this paper, the obtained solution for the districting decision variables for the first scenario in the first iteration of PH-FW algorithm is considered as a reference solution. A criterion is defined to determine the degree of similarity between basic units in different pairs of districts. The value of this ' criterion (ind mm w ) for districts m and m is obtained based on the difference between the number of similar basic units in these districts and number of different basic units in them. For example, for the first district ' of scenario 1 and second district of scenario 2 (m and m are equal to 1 and 2, respectively), there are no common basic units in these districts and they have five different basic units. Therefore, the value of ind 12 is equal to 0 -5 = -5. The value of ind for different pair of districts for the solutions presented in Table 4 are shown in Table 5.</p>
        <p>Table 5: Values for the "ind" for the solutions in Table 4 when solution for the first scenario is reference solution. The obtained values for ind mm w are used to determine the degree of similarity between the basic units in each pair of districts in a reference solution and a given solution. At first, a district from the given solution is selected (e.g., the m 'th district is selected), then the district from the reference solution that has the maximum maxdegree degree of similarity with the selected district is identified by m = arg max {ind mm w }. For example,</p>
        <p>if the first district of the solution related to the second scenario is selected, then a district from the reference solution with the maximum degree of similarity with the selected district is determined based on the values maxdegree for ind reported in Table 5. Therefore, the third district of the reference solution is selected as m 1</p>
        <p>because it has the maximum degree of similarity (the greatest value of ind). Then an adjusted version of the solution is constructed by placing the basic units in the selected district of the solution in the district with maximum degree of similarity. In the mentioned example, basic unit 7 is in the first district of the solution related to the second scenario and this district has the maximum degree of similarity with the third district in the reference solution. Therefore, basic unit 7 is located in the third district in the adjusted version of the solution. The solutions of the first and second scenarios and adjusted version of this solution are represented in Table 6. As shown in Table 6, the adjusted version of the solution for the second scenario is completely similar to the reference solution (the solution corresponding to the first scenario). Considering the adjusted version of the solution for the second scenario instead of the obtained solution can affect the efficiency of the Frank and Wolf algorithm. Therefore, it can be concluded that employing this algorithm increases the efficiency of the PH-FW algorithm for the proposed model. The pseudo code of the proposed algorithm is presented in Algorithm 3. 40) -( 44), ( 51) -(53),</p>
        <p>The objective function (58) minimizes the hiring, violation of the neighbouing constraint, and estimated routing costs. As mentioned previously, L f e is defined as the set of basic units assigned to the feasible districts. On the other hand, the basic units in this set are assigned to the districts in which the time window constraints are not violated for any patients in them. Constraints (59) ensure that the districting decision is fixed for l ∈ L f e . Constraints (60) guarantee that the assignment decision is fixed for the nodes (patients and caregivers) assigned to the feasible districts (i ∈ I f e ). The set I f e consists of the nodes in the districts which the time window constraints are not violated for any patients in that district. Constraints (61) state that the caregivers used in the obtained solution from Int.M2 must be used in the repaired solution. Constraints (62) determine the domains of the decision variables.</p>
        <p>As mentioned previously, the districting, staff dimensioning and assignment decisions are determined by the estimated routing cost in Int.M3. In this model, the parameter σ ikd (ξ) determines the cost corresponding to visiting the i th patient by the k th caregiver in day d under scenario ξ, and is obtained in each iteration based on the achieved routes in the previous iteration. In the first iteration, σ ikd (ξ) is calculated based on the routes obtained from the second phase. While in other iterations a series of TSPs are solved in each district for each caregiver at each day under each scenario TSP(mkdξ) based on the obtained assignment decision from solving Int.M3 and the corresponding routes determined. The proposed procedure to calculate this parameter is presented in Algorithm 4. Based on the proposed procedure, if the i th node exists in the route corresponding to the k th caregiver in day d under scenario ξ, the parameter σ ikd (ξ) is calculated by</p>
        <p>, where i -and i + denote the predecessor and successor nodes of patient i in this route, respectively. But under the conditions that the i th node is not visited by the k th caregiver in day d under scenario ξ, the i th node is inserted in different positions of that route and the insertion cost related to each position is calculated. Then the cheapest insertion cost is taken as σ ikd (ξ).</p>
        <p>Also to guarantee the feasibility of the obtained solutions from Int.M3, a large value of σ ikd (ξ) is assigned to any position that makes the obtained route infeasible.</p>
        <p>The routing and assignment decisions are determined based on estimated routing cost in the second and third phases of the algorithm. Therefore, these decisions are improved in this section by using an iterative procedure and the fix and optimize method. In this procedure some patients are selected and their corresponding assignment and routing decisions are improved when the first stage decision variables and routing and assignment decisions are fixed for the other patients. These patients are selected based on σ.</p>
        <p>First, the set of patients for improvement in their corresponding decisions (N * (ξ)) must be determined. For this reason, the value of σ ikd (ξ) is computed for each patient. In the first iteration, σ ikd (ξ) is computed based on the routing decision obtained from the second or third phases and the method mentioned in Algorithm 4 is used for calculating σ ikd (ξ). In other iterations, σ ikd (ξ) is computed from the solutions achieved from the previous iteration according to the procedure proposed in Algorithm 4. Algorithm 5: The framework of proposed procedure to improve routing and assignment decisions in the fourth phase of Math-1 algorithm.</p>
        <p>Input: parameter of Int.M4 model, w ˆikd (ξ) for ξ ∈ Ξ do while N * (ξ) is not empty do i * is selected randomly from the set N * (ξ); i * is removed from the set N * (ξ);</p>
        <p>The parameter σ i * kd for patient i * is calculated based on the procedure in Algorithm 4; Solve the Int.M4 model for patient i * and determine ŵikd (ξ) ; Solve series of TSPs in each district for each caregiver at each day under each scenarios (TSP(mkdξ)) and determine route kd (ξ). ;</p>
        <p>Result: w ˆikd (ξ) and route kd (ξ) numbers drawn in the range [5,15]. In this section, five instances (Ins 1, Ins 2,..., Ins 5) are considered for each combination of number of patients and scenarios, as a result, 80 instances are examined in this section. The generated instances can be found at https://github.com/bashirimahdi/SDDARP-for-HHC. The computations were performed on a 3.5 GHz Workstation with 32 GB RAM and 6 cores operating with</p>
        <p>
            <rs type="software">Windows</rs>
            <rs type="version">10</rs> (64-bit) and using the 
            <rs type="software">Julia</rs> software. 
            <rs type="software">Cplex</rs>
            <rs type="version">12.7.1</rs> has been used as a solver. Parameters Corresponding values or distribution In this section, the necessity of the simultaneous consideration of decisions related to human resource planning is investigated. In most of the previous studies related to districting in HHC, the objective function minimizes the distances between the basic units, and overlooks routing and assignment decisions. We show that the aggregation of these decisions decreases the routing cost. The results for different numbers of patients and considering one scenario are presented in Table 9. The Int.M1 model is optimized for different numbers of districts (g) to obtain districting decisions without considering the staff dimensioning and routing costs.
        </p>
        <p>Then the achieved districting decision for each value of g is fixed in the SDDARP model and it is solved to obtain the objective value as well as the values of the other decision variables. The routing cost corresponding to the best objective value amongst the obtained objective values for different values of g is shown in Table 9. In addition, the relative cost reduction (RCR) is indicated. The results indicate that by considering the decisions simultaneously, the routing cost decreases 18.45% on average. Also, the individual values of the differences for each combination of parameters are illustrated in Figure 7.</p>
        <p>The differences between the objective values obtained by the commercial solver and those using the PH-FW algorithm for different combinations of parameters (ρ 2 and ρ 3 ) are indicated in this figure. Based on the obtained results, it is shown that the progressive hedging algorithm finds a better solution by considering the combinations (50, 0.5) and (25, 2), but the average computational time of combination (50, 0.5) is 1.5 times longer than the average computational time of combination (25, 2). Therefore, ρ 2 = 25 and ρ 3 = 2 are selected to use in the other instances.</p>
        <p>In this paper, an integrated stochastic model is proposed to consider the districting, staff dimensioning, assignment, and routing decisions required in the delivery of home health care (HHC), simultaneously. Taking all the human resource planning decisions into consideration in HHC has significant effects on being able to plan in a cost effective manner. However, no study has been done in this context. In this study, districting and staff dimensioning are accomplished based on routing and hiring costs, and some constraints, such as continuity of care and similarity between the type of care required by patients and the caregivers' skills, are taken into account to make more realistic decisions.</p>
        <p>A two-stage stochastic programming model has been developed to accommodate uncertain travel and service times, which are important and uncertain parameters in HHC. In the proposed model, districting and staff dimensioning are the first stage variables, and routing and assignment are the second stage variables.</p>
        <p>Moreover, considering these decisions in an integrated way increases the complexity of the proposed model.</p>
        <p>Hence, a mathematical programming based algorithm is proposed as the solution strategy. This algorithm consists of four phases. Also, the PH-FW algorithm is used for solving the intermediate model in the second phase (Int.M2) and an acceleration procedure is proposed to speed up the convergence of this algorithm. The efficiency and validity of the algorithm are explored using numerous instances. The proposed algorithm can find optimal or near-optimal solutions in a reasonable computational time, even for large instances that could not be solved by the commercial solver. The results show that the matheuristic without using the PH-FW algorithm performs better in small size problems, while the matheuristic with the PH-FW algorithm is more efficient when the problem size increases. Also, the commercial solver cannot find any feasible solution in 10,000 seconds when the number of scenarios increases even beyond five, but the matheuristic algorithm can obtain near optimal solutions in less than 10,000 seconds in these cases. In this research, the proposed matheuristic is constructed by decomposing the main problem, which paves the way for further extensions by including other decomposition approaches in our proposed algorithm for solving the HHC and other resource planning problems.</p>
        <p>Multi-period, SP: Single period, TS: Two-stage stochastic programming, RP: Robust programming, PC: Probabilistic constraint (Chance constraint), IB: Indivisibility of basic units, WL: Workload equilibrium, CM: Compactness measure, AC: Accessibility, HC: Hiring Cost, RC: Routing Cost, E: Exact, MH: Matheuristic, TT: Travel time, ST: Service time.</p>
        <p>rest ← g rest ∪ g F best ← ∞; condition ← f alse; g ← 2 while condition is false do G g ← {1, 2, ..., g}; Phase 2: Determining an initial solution Optimize the Int.M2(g) according to sets A ik (ξ) and B ik (ξ) then determine an initial solution (z lm , ūmk , w ˆikd (ξ) and route kd (ξ)) when basic units are partitioned into g districts; if g &gt; |g rest | then condition ← true; Result: F best M = {1, 2, ..., M}.</p>
        <p>4.2. Phase 2: Determining an initial solution</p>
        <p>In this section, a clustering based intermediate model (Int.M2) is proposed, in which the potential visiting sequence for patients obtained in the previous phase is entered in the models. The sets A ik (ξ) and B ik (ξ) are used in the proposed model to determine the domain of the indices i and j in the routing constraints. This model is solved for different numbers of districts based on the restricted set for the potential number of districts (g ∈ g rest ). Therefore, the clustering based model is solved |g rest | times. In this model, clustering is performed based on minimizing the costs of hiring, violating the neighbouring constraint, and traveling.</p>
        <p>Algorithm 3: The framework of proposed procedure to speed up thePH-FW convergence in the second phase of Math-1 algorithm.</p>
        <p>Input: z ˆlm (ξ), u ˆmk (ξ), µ ˆll w m (ξ), g sol ref ← z ˆlm (1); for ξ ∈ Ξ do An appropriate value for m adj is selected from the set m randomly; Algorithm 4: The framework of proposed procedure to repair infeasibility in the third phase of Math-1 algorithm. Input: condition2, parameter of Int.M3 model while condition2 is false do for m ∈ G g do j j th if the m district faces by infeasibility then for l ∈ L do if z ¯lm = 1 then</p>
        <p>The insertion cost corresponding to the i th patient in the j th (cc ij ) position of route kd (ξ) is obtained by</p>
        <p>where i - j and i + j denote predecessor and successor nodes of patient i in position j. if Inserting the i th patient make route kd (ξ) infeasible then</p>
        <p>Optimize the Int.M3(g) according the estimated routing cost and determine the value of decision variables (z lm , ūmk and ŵikd (ξ) ); Solve series of TSP models in each district for each caregiver at each day under each scenario (TSP(mkdξ)) and determine route kd (ξ) ; if Time window constraint is not violated then Feasibility ← true condition2 ← true else if Maximum number of iteration achieved then condition2 ← true Result: z ¯lm , ūmk and ŵikd (ξ), Feasibility and route kd (ξ)</p>
        <p>i∈N d∈D k∈K s.t.: (37) -( 39), ( 42) -( 44), ( 51), ( 52),</p>
        <p>The objective function ( 63) minimizes the estimated routing cost. Constraints (64) ensure that the assignment decision is fixed for patients other than the selected one. Constraints ( 65) and ( 66) guarantee that the first stage decision variables are fixed. Constraints (67) determine the domains of the decision variables.</p>
        <p>In this section, the validity of the proposed main model (SDDARP) is examined through numerical examples. The efficiency of the proposed mathematics-based algorithm is also illustrated. Our instances were generated based on real-world data provided by the Austrian Red Cross (Fikar and Hirsch, 2015).</p>
        <p>The data was generated based on five instances in an urban region by considering 75 nodes. As mentioned previously, the patients that are located in close proximity of each other form a basic unit to decrease the size of the problem. Therefore, to generate instances, the k -means algorithm (MacQueen, 1967) is used to determine the nodes located close to each other and construct the basic units. The nodes related to patients and caregivers are partitioned into L groups (L basic units) by using the k -means algorithm. Three sizes of problem are examined in this section. Their specifications are shown in Table 7. The parameters that are used in the proposed model are not defined in the dataset, so the modified values for the parameters are shown in Table 8. The travel times between nodes are generated based on driving</p>
        <p>Where, α(ξ) are random 5.3. Evaluating the effects of the proposed procedure for speeding up the PH-FW</p>
        <p>As mentioned previously in the description of the progressive hedging algorithm, the efficiency of the PH FW algorithm is improved by proposing an acceleration procedure. The tolerance of the PH-FW algorithm in each iteration of this algorithm is compared with the tolerance of the PH-FW algorithm in the case of using an acceleration procedure and depicted in Figure 8. As illustrated in this figure, the proposed procedure can help to speed up the convergence of the PH-FW algorithm. In the case of using the proposed procedure, the PH-FW algorithm converges within 16 iterations. However, late convergence is observed in 41 iterations when the acceleration procedure is not used in the PH-FW algorithm. (ρ 2 , ρ 3 )=(50, 0.5)</p>
        <p>The efficiency of the proposed mathematics-based algorithm (Math-1) for solving the proposed model is presented in this section. The results obtained from the proposed matheuristic algorithm are compared with the result using a commercial solver for small size instances (up to 15 patients), as reported in Ta ble 11. The best objective function value of the SDDARP model obtained by the commercial optimiza tion software in 10,000 seconds and the obtained objective function values achieved by the matheuris tic algorithm with and without using the progressive hedging algorithm are reported in columns 4, 6, and 9, respectively. If the optimal solution was not obtained by solving the SDDARP model in 10,000 seconds, the best solution provided by the commercial solver is denoted in column 4. Gap 1 and Gap 2 represent the deviations of the values of the objective function from the values obtained by the solver:</p>
        <p>Also, the computational times of the 
            <rs type="software">M ath-1</rs> commercial solver and the matheuristic algorithm with and without using the progressive hedging algorithm are reported in Table 11.
        </p>
        <p>The results obtained show the efficiency of the proposed matheuristic algorithm. The proposed algorithm can find near-optimal solutions, and the average gap is almost equal for matheuristic algorithm with and without using the progressive hedging algorithm, but the average computational times of the matheuristic with and without using the PH algorithm are 420.42 seconds and 289.69 seconds, respectively. Therefore, it can be concluded that the matheuristic algorithm without using the PH-FW algorithm has a better performance than the matheuristic algorithm using the PH-FW algorithm in instances with a small size.</p>
        <p>More analyses were performed by using the paired t-test to examine the equality of the obtained objective values by the matheuristic algorithm and matheuristic algorithm with the PH-FW algorithm when the alternative hypothesis assumes that the mean value of the differences between the objective values obtained from matheuristic algorithm with and without using PH-FW algorithm is greater than zero. The box plot of differences between the obtained objective values and p-values are illustrated in Figure 9 for different numbers of patients and scenarios. This figure indicates that the PH-FW algorithm can obtain good quality solutions in instances of a small size. Also, the effects of using the PH-FW algorithm in matheuristic for increasing numbers of scenarios with ten patients are shown in Figure 10. The mean values of the objective and of the computational times of the matheuristic algorithm with and without the PH-FW algorithm are compared in this figure when the number of scenarios are equal to 10 and 30. The results show that the efficiency of the matheuristic algorithm with PH-FW increases with an increasing number of scenarios. The efficiency of the proposed matheuristic algorithm for medium and large numbers of instances are reported in Tables 12 and13, respectively. In these tables, Obj CS is the best objective value obtained by the commercial solver in 10,000 seconds.</p>
        <p>For the medium and large sizes, a limited computational time (3600 seconds) is considered for Int-M2.</p>
        <p>Table 12 shows that the computational time of the matheuristic algorithm with the PH-FW algorithm is better than the computational time of the matheuristic algorithm without the PH-FW algorithm. Therefore, the matheuristic algorithm with the PH-FW algorithm has a better performance than the matheuristic algorithm without the PH-FW algorithm for solving the proposed (SDDARP) problem. The results in Table 12 show that the average value of the solutions obtained by the matheuristic algorithm without using the PH-FW algorithm is 0.05% better than the average value of the solutions obtained by the matheuristic algorithm with the use of the PH-FW algorithm, while the computational time of the matheuristic algorithm without using the PH-FW algorithm is almost 1.3 times longer than the computational time of the matheuristic algorithm with the PH-FW algorithm. Also, the commercial solver cannot find any feasible solution in 4 instances when 30 patients and 5 scenarios are considered. But the proposed matheuristic algorithm finds solutions in a reasonable time for these instances. The solutions achieved by the matheuristic algorithm with and without the PH-FW algorithm are on average 25% better than the solutions obtained with the commercial solver in 10,000 seconds.</p>
        <p>In Table 13, Gap represents the deviation of the values of the objective function from the value obtained by the matheuristic algorithm without the FW-PH algorithm: Gap = (Obj P H-F W M ath-1 -Obj M ath-1 ) Obj M ath-1 × 100%. The results reported in Table 13 indicate that the commercial solver can not find any feasible solutions in 10,000 seconds, while the proposed matheuristic algorithm with and without using the PH-FW algorithm obtain good quality solution. The average computational time of the matheuristic algorithm without using the PH-FW algorithm is 1.25 times greater than the computational time of the matheuristic algorithm with the PH-FW algorithm. Also, the matheuristic algorithm with the PH-FW algorithm can find better solutions in most cases, the average gap between the obtained solutions is -0.68. Therefore, it can be concluded that using the PH-FW algorithm for solving Int.M2 increases the efficiency of the proposed matheuristic algorithm for medium and large instances.</p>
    </text>
</tei>
