<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T12:14+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>High-throughput sequencing projects generate genome-scale sequence data for specieslevel phylogenies [1][2][3] . However, state-of-the-art Bayesian methods for inferring timetrees are computationally limited to small datasets and cannot exploit the deluge of new genomes 4 . In the case of mammals, molecular-clock analyses of limited datasets have produced conflicting estimates of clade ages with large uncertainties 5,6 and, thus, the timescale of placental mammal evolution remains contentious [7][8][9][10] . Here we develop a Bayesian molecular-clock dating approach to estimate a timetree of 4,705 mammal species integrating information from 72 mammal genomes. We show increasingly larger phylogenomic datasets produce diversification time estimates with progressively smaller uncertainties, facilitating precise tests of macroevolutionary hypotheses. For example, we confidently reject an explosive model of placental mammal origination in the Paleogene 8 and show crown Placentalia originated in the Late Cretaceous with unambiguous ordinal diversification in the Paleocene/Eocene. Our new Bayesian methodology facilitates analysis of complete genomes and thousands of species within an integrated framework, making it possible to address hitherto intractable research questions on species diversifications. As such, our approach can be used to tackle other contentious cases of animal and plant diversifications that require analysis of species-level phylogenomic datasets.</p>
        <p>High-throughput sequencing projects are generating hundreds 1 to thousands 2 of genome sequences, with imminent plans to sequence more than a million species 11 . However, the accumulation of sequenced genomes is now outpacing the analytical capacity of computer software and many of the tools required to extract information from these vast datasets are lacking 12 . This is particularly the case for Bayesian Markov Chain Monte Carlo (MCMC) molecular-clock methods that are used routinely to infer evolutionary timescales 4 , for groups as diverse as pathogens 13 , plants 14 , and animals 15 , but which are computationally expensive. Consequently, these methods have been limited in their application to datasets comprising dozens of genes for many species 5,16 or many genes for dozens of species 7,17 , constraining the scope of evolutionary questions that can be addressed. Although fast non-Bayesian clock-dating methods have been developed 18 , these typically do not incorporate uncertainties on evolutionary branch lengths 19 or arbitrary fossil calibration densities 20,21 . On the other hand, the Bayesian approach, despite its computational expense, is appealing because it facilitates explicit integration of these uncertainties 4 . Furthermore, large genomic datasets allow inference of precise timelines that can be used to obtain correlations between diversification events and the geological and climatic evolution of our planet 4 . Although increased precision of estimates is not a guarantee the estimates will be more accurate (particularly if errors in fossil calibrations or in the clock model are present, in which case the estimates may be biased 21,22 ), statistical theory shows that, when the prior and model are appropriate, Bayesian estimates of clade ages using genomic data will converge to a limiting distribution centred on their true values 20,22,23 . The limitations of Bayesian molecular-clock analyses on small datasets have become starkly apparent in studies of mammal diversification. Bayesian estimates using few genes typically have uncertainties so large that credibility intervals on the ages of ordinal crown-groups straddle a mid-Cretaceous to Paleogene interval 5,6,24,25 , despite a decidedly post-K-Pg fossil record of ordinal crown groups [26][27][28][29] . Critically, these Bayesian estimates cannot help to discriminate among competing scenarios of mammal diversification with respect to the K-Pg mass extinction [30][31][32] . Although Bayesian analyses have been carried out on genome-scale datasets 7,33,34 , only a small number of taxa have been used and, therefore, the increased precision of phylogenomic analyses has not been propagated through to species-level mammal phylogenies. Thus, despite several decades of research, the precise timeline of mammal evolution remains unresolved [5][6][7][8][9]34 . Furthermore, efforts to incorporate species-level alignments into the Bayesian analysis of mammals have been unsatisfactory. For example, in the backbone-and-patch approach, a limited number of genes is used to estimate divergence times on a main tree of few species 6 . Divergence times for key nodes are then used to calibrate the root of densely sampled subtrees, resulting in a species-level phylogeny. However, the backbone-and-patch method is not a valid Bayesian approach because the loci used in subtree estimation are the same loci used to estimate the main tree, resulting in duplicate use of the same data and a squaring of the likelihood 35 . In Bayesian clock-dating, likelihood squaring leads to convergence to the wrong limiting distribution of node ages 23,36 . Sequential Bayesian dating of subtrees</p>
        <p>Here we overcome the limitations of previous Bayesian clock-dating studies on small datasets by developing the Bayesian sequential-subtree approach (Fig. 1), which we use to infer a timetree of 4,705 mammal species. First, a genome-scale alignment (15,268 one-toone orthologs, 33.2M aligned bases) and a suite of 32 fossil calibrations are used to infer the timetree for 72 species. The resulting posterior distribution of node ages is then used, together with a further set of 60 fossil calibrations, to date 13 subtrees encompassing 4,705 species with new alignments (182 loci, up to 5.33 x 10 5 aligned bases), thus avoiding data duplication in the likelihood (see Methods). Our approach is feasible because we use the approximate likelihood calculation 37 , which provides a 1,000x speed-up over traditional MCMC timetree inference without loss of accuracy 37,38 . This facilitates analysis of more taxa and much longer alignments than has been possible previously (Table 1). By using the flexible Skew-t and Skew-normal distributions to model the posterior time estimates from the 72-genome analysis, we accurately transfer information from the genome-scale analysis into the subtree analysis 35 , augmented by the additional subtree-specific fossil calibrations. Our fossil calibrations restrict the minimum ages of clades based on the oldest unequivocal members of crown groups and, in most cases, also their maximum age through consideration of the presence and absence of stem and sister groups, their palaeoecology, palaeobiogeography, and comparative taphonomy 39 (see Supplementary Information). Analyses of small phylogenies 36 and simulated data 23,36 indicate that genome-scale data should lead to asymptotic reduction of uncertainty in divergence time estimates. We demonstrate this for our mammal data by performing random sampling of loci and calculating divergence times on the 72-species phylogeny. By increasing the number of loci analysed from 1 to 15K, uncertainties in time estimates are progressively reduced irrespective of the relaxed-clock model used (Fig. 2a). Average relative uncertainty on node ages stabilises at 23.6%-25.0% for the 15K loci. This means that, for each 1 Myr of divergence, ~250 Kyr of uncertainty is added to the width of the credibility intervals, which is substantially less than previous Bayesian analyses based on a limited number of genes 5,6 (Table 1). Although reduction in uncertainty is modest beyond 1,000 loci (Fig. 2a), the analysis of the full dataset comes with little extra computational cost because the approximate likelihood calculation depends on the number of taxa, not the alignment length 37 . We next assessed the fit of the relaxed-clock models by using the stepping-stones integrator 40 . This is critical because the competing autocorrelated (geometric Brownian motion or GBM 23,41 ) and independent log-normal (ILN 23,42 ) rate models can produce dramatically different time estimates when using the same fossil calibrations 35 . Clock-model testing has not previously been conducted at large scale because marginal likelihood inference requires expensive exact likelihood calculation. We overcame this problem by implementing stationary block resampling 43 to obtain reliable estimates of the standard error of the log-marginal likelihood estimates. In this way, we can guarantee the MCMC sample is large enough to obtain an acceptable error for calculating the posterior probabilities of the clock models. We find that, for 71.3% of the 645 loci analysed (Fig. 2b), GBM has a posterior probability &gt;95%, whereas ILN has a posterior &gt;95% for only 10.7% of loci. Some topological relationships among major groups of mammals, such as the placement of the placental root, the position of Scandentia with respect to Primates and Glires, and the position of several major groups within Laurasiatheria (Carnivora, Perissodactyla, Chiroptera and Artiodactyla), have been difficult to resolve 32,33,44 . We selected seven re-arrangements of these major groups and estimated the divergence times using the 15K loci and the 72species phylogeny. We find these topological re-arrangements have a marginal effect on estimated divergence times (Fig. 2c), apparently because these topological uncertainties are characterised by small internal branches.</p>
        <p>Using the results from the 72-genome analysis, we then proceeded with the sequentialsubtree approach to date the 4,705-species phylogeny using the GBM rate model. The resulting species-level timetree (Fig. 3a) provides a high-resolution timeline for the diversification of mammals, a timeline with substantially less uncertainty than has been characteristic of previous Bayesian studies, facilitating tests of competing models of ordinal diversification. With this timetree, we have effected the advances set out by Murphy and colleagues 32 to improve the estimated timescale of mammalian evolution, viz. (a) "more contiguous and accurate genome alignments that improve upon detection of orthologous sequences" 45 , (b) "improvements in the calibration of nodes with fossils" 21,35 , and (c) "improvements in relaxed-clock methodologies" 35,43 . Furthermore, we have also assessed asymptotics and topological uncertainty to address their impact on the estimated timescale. Generally, we find that, in comparison to previous analyses, clade age estimates are younger and more precise. It appears unlikely, given our asymptotic results (Fig. 2a), that a further increase in precision could be achieved simply by greater sampling of sequence data. Instead, more precise fossil constraints will have a material impact here. Our results, in comparison to previous studies, show a greater proximity between the origination of ordinal level crown-groups and the K-Pg event (Fig. 3a, Extended Data Fig. 1-2), implying a late Cretaceous prehistory to "modern mammals" with diversification that continued into the Paleogene (Fig. 3b). This timescale is incompatible with previous scenarios positing a deep-Cretaceous origin of ordinal level crown placental groups 46 , and also incompatible with the explosive model, which envisages crown Placentalia originating in the Paleogene 8 . Among proposed mammal diversification models 32 , our timetree appears compatible with the soft explosive 10 and long fuse 31 models. However, discriminating among these is challenging because, as formulated 32 , these hypotheses lack taxonomic precision. We find crown Placentalia diverged 83. 3-77.6 Ma, while the fundamental clades (Boreoeutheria, Laurasiatheria, and Euarchontoglires) diverged within the last ~10 Myr of the Cretaceous. Furthermore, 17 out of 18 crown placental orders and all crown marsupial orders originated after the K-Pg (Fig. 2a), indicating the bulk of extant mammal ordinal diversity is a post-K-Pg phenomenon. In terms of inter-ordinal diversity, our results are compatible with both (i) an origin of placental inter-ordinal crown clades following the profound K-Pg extinction in which few lineages survived; and (ii) diverse inter-ordinal stemlineage representatives surviving the K-Pg extinction, but with this diversity later pared back (due to later extinctions) to the current crown-clades which diverged after the K-Pg. Reconciling these competing hypotheses will require integrated co-analysis of living and fossil species 47 , to reveal the diversification dynamics that resulted in extant mammal diversity.</p>
        <p>The species-level MCMC sampling required about 80K hours of computing time in a highperformance computing cluster and released ~16.7K metric tonnes of CO 2 48 . Without the technological improvements used here, these analyses would have required hundreds of years of CPU time and emitted over 1.9M tonnes of CO 2 (see Supplementary Information). By using existing tools and combining them in a novel way within the sequential-subtree approach, we have demonstrated that hierarchical Bayesian analysis of species-level timetrees integrating genomes is now feasible. Thus, the methodology developed here can be used to tackle other contentious cases of species diversification that, so far, have been analysed using limited datasets. By integrating our method with the million and more genomes currently planned for sequencing 11 , the prospect of obtaining a reliable evolutionary timescale for the entirety of the tree of life now appears within reach. a. Bayesian studies are shown in bold typeface. b,c. Numbers in brackets are the number of complete genomes in the alignment (b), and number of genes for the genomescale part of the alignment (c). d. Numbers in brackets are the number of nucleotide sites for the genome-scale part of the alignment. In this study, subtree alignment lengths range from 5.11 x 10 4 to 5.33 x 10 5 bases. Missing data range from 46% to 60% in the genomic partitions and from 17% to 99% in the subtree partitions (see Methods). e. Age in Mega annum (Ma) given as the 95% credibility/confidence interval.</p>
        <p>Figure 1. Summary of the Bayesian sequential subtree dating approach. The pipeline is divided into molecular data preparation (blue), dating step 1 (green) and dating step 2 (orange). Number of taxa ranges from 10 to 72 among genomic loci (50% of loci have at least 67 taxa and 90% at least 53 taxa), and from 48 to 3,986 in the 182 gene set. A hidden-Markov model (HMM) 45 was used to detect homology and construct the subtree alignments, thus bypassing unreliable homology annotations (see Methods). SN and ST: Skew-normal and Skew-t distributions. plotted against the number of loci for two relaxed-clock models. Sets of n = 1, 10, 30, 50, 100, and 1,000 loci were sampled randomly from the full set of 15K loci (also included) and grouped into four partitions (except for n = 1), with times estimated using approximate likelihood calculation in MCMCtree. b, Among the 15K loci, 645 loci have all 72 species present. These loci were used to estimate posterior probabilities for the two relaxed-clock models using exact likelihood and the stepping-stones integrator. The histogram of Pr(GBM | D) is shown with black outline, and the 95% confidence interval of the histogram, obtained using the stationary block bootstrap, are shown in a blue shade. Vertical black bars are results for individual loci. c, Seven dated variations of the mammal topology. T1-T5 have the Atlantogenata rooting of Placentalia 44,49 . Extended Data Figure 2. Impact of fossil calibration strategies on node age estimates. The posterior of node ages for the 72-taxon phylogeny is estimated using two additional fossil calibration strategies (y-axis) and plotted against the main estimates using best practice in calibration choice 39 (x-axis). In all cases the fossil minima are the same, but the calibration maxima changes. In the first strategy (black dots), calibration densities are narrow and close to the fossil ages. A truncated-Cauchy with a short tail (using p = 0 and c = 0.001, which extends the tail to about 110% of the fossil age) is used 21 . This strategy assumes the fossil record is a good indicator of the true node ages. In the second strategy (red dots), a truncated-Cauchy with a heavy tail (using p = 0.1 and c = 1, which extends the tail to over 900% of the fossil age) is used 21 . This strategy ignores the presence and absence of stem and sister groups, their palaeoecology, palaeobiogeography, and comparative taphonomy 39 ; and instead, assumes the node ages can be arbitrarily old. Dots are plotted at the posterior mean ages and vertical and horizontal bars indicate 95% CIs. The solid line is the x = y line.</p>
        <p>The dashed lines are the regression lines for the corresponding data points.</p>
        <p>We downloaded the set of one-to-one protein-coding orthologs for the 72 mammal genomes available in 
            <rs type="software">Ensembl</rs> release 
            <rs type="version">98</rs> (
            <rs type="url">http://www.ensembl.org</rs>, accessed 2019/11/15) using 
            <rs type="software">EnsemblBioMarts</rs> 51 (
            <rs type="url">https://m.ensembl.org/biomart/martview)</rs>. Sequences that did not meet the following requirements were removed from further analysis: (i) present in both human and mouse, (ii) not containing internal stop codons or gene/transcript mismatches, (iii) present in at least 10 species, and (iv) at least 100 codons in length. This left a total of 15,569 orthologs, which we partitioned into two data blocks: (i) first and second codon positions (12CP) and (ii) third codon positions (3CP). For each ortholog, an alignment was built with PRANK v140603 52 and the best-scoring maximum-likelihood (ML) trees were inferred with 
            <rs type="software">RAxML</rs> v
            <rs type="version">8.2.10 53</rs> . Note we used only the alignments with the 12CP-partition in the subsequent Bayesian molecular-clock analyses.
        </p>
        <p>We further filtered the dataset using the estimated best-scoring ML trees for each gene to identify those having a branch length larger than 60% of the total tree length (the sum of all branch lengths). The relative branch length test is useful to detect misaligned or misidentified orthologs in the alignments 7,54 , which may result in unusually long branch lengths. Let be the i-th branch length for gene tree j , and let n be the number of branches in the tree, then the relative branch length is ∑ .</p>
        <p>(1) We identified 133 ortholog alignments associated with at least one relative branch length larger than 60%. These ortholog alignments were removed from further analyses. Then, we estimated the pairwise distance between each ortholog in Mus musculus and Homo sapiens using the R (v3.5 to v4.0) function ape::dist.dna 55 v5.5. There were 4 genes (ENSG00000132185, ENSG00000204544, ENSG00000120937, and ENSG00000236699) for which the distances were returned as NaN or were larger than 0.75 for at least one of the substitution models used (i.e., TN93, JC69, and raw). Furthermore, when we plotted the percentage of the tree length inferred for each ortholog alignment versus the corresponding largest branch length (also in percentage), we found an outlier (ENSG00000176973, see Figure S1). We removed these 5 ortholog alignments, resulting in 15,431 orthologous gene alignments. Of those, 163 orthologs were removed as they are used in the construction of dataset 2 (see below). This filtering step resulted in 15,268 ortholog alignments (Table S1). The 15,268 ortholog alignments were sorted from fast-to slow-evolving according to the pairwise-distance estimates and grouped into four partitions with the same number of genes. Each of the four partitions contained the concatenated 12CP of the orthologs for the partition (Table S2). The rationale for this partitioning strategy is as follows. In previous work 35,56 , we tested phylogenomic data partitioning according to locus rate, principal component analysis of relative branch lengths, and amino acid composition at loci. However, those analyses showed no noticeable differences in posterior time estimates across the partitioning strategies 35,56 . On the other hand, we have shown that uncertainty in time estimates is sensitive to the number of partitions used 7,22 , with more partitions producing more precise estimates, but at the cost of additional computation time. It appears four partitions give a reasonable trade-off between computational speed and precision of estimates. For example, twenty partitions would produce slightly more precise estimates but at 5 times the computational cost.</p>
        <p>We downloaded 832 complete mammal mitochondrial genomes from NCBI RefSeq (accessed: 2016/01/14). Twelve extinct and two redundant entries were removed, leaving 818 genomes. Twelve protein-coding genes (all but ND6) and the two non-coding RNA genes were extracted from each genome. The overlapping region in ATP8 (position 95 to end) and overlapping codons at the end of ND4L were deleted. To increase the nuclear and mitochondrial datasets, we mined sequences deposited in the European Nucleotide Archive (ENA, https://www.ebi.ac.uk/ena). The GenBank taxonomy (ftp://ftp.ncbi.nih.gov/pub/taxonomy/) was used to search for non-
            <rs type="software">Ensembl</rs> mammalia species (this taxonomy is only used for ENA searches and not for any other analyses). A total of 7,188 taxa were found, 83 of which were extinct. The GenBank identifiers were used to reference the corresponding taxa in the ENA, from which all matching coding and noncoding sequences for non-
            <rs type="software">Ensembl</rs> mammal taxa were downloaded (accessed: 2016/01/17): we found 6,453 taxa with coding sequences and 3,239 taxa with non-coding sequences (6,606 distinct taxa). This project started in early 2016. At the time, we downloaded 15K nuclear orthologous gene alignments for 43 mammal taxa from 
            <rs type="software">Ensembl</rs>
            <rs type="version">83</rs> and used these orthologs to create HMM sequence profiles with 
            <rs type="software">HMMER</rs> 57 . The HMM profiles were then used to identify orthologs for additional taxa from GenBank (https://www.ncbi.nlm.nih.gov/genbank/), bypassing unreliable GenBank homology annotations, and thus allowing reliable construction of large mammal subtrees. In late 2019, we updated the 15K orthologs to 72 genomes using 
            <rs type="software">Ensembl</rs>
            <rs type="version">98</rs> (see above), but the HMM profiles and corresponding homology searches were based on the 2016 mining of 
            <rs type="software">Ensembl</rs>. HMM profiles were also created for mitochondrial protein-coding and non-coding genes and used for taxa extension of the corresponding alignments. DNA homology searches were performed with 
            <rs type="software">nhmmer</rs> 45 using the following match criteria:
        </p>
        <p>• Sequences with E-value for a single gene were collected (i.e., sequences with multiple low E-values for different genes were removed).</p>
        <p>• Matched sequences had to be at least 70% as long as the shortest Ensembl sequence in the alignment because many deposited sequences are partial sequences. • Matches from hybrid/cross species were removed.</p>
        <p>• Unspecified species (sp.) were excluded, unless no other member of the genus was represented (4 taxa included). • Unconfirmed species (cf.) were excluded, unless no other member of the genus was represented (1 taxa included). • Coding sequences were checked for correct open reading frame and translation. Nuclear genes resulting in an expanded set of at least 50 taxa were selected, resulting in a set of 168 nuclear genes. These 168 genes correspond to 163 genes in the 2019 
            <rs type="software">Ensembl</rs> mining (5 genes did not pass filtering criteria for the 72 taxa, but they did pass the criteria with the 43 taxa). Thus, dataset 1, based on the 2019 
            <rs type="software">Ensembl</rs> mining, was reduced from 15,431 genes to 15,268 (Table S1) to avoid data duplication in the sequential dating approach. For new mined taxa, sequence annotations were extracted, sorted, and visually inspected to help verify homology. Alignments were then extended with homology-matched sequences using 
            <rs type="software">PAGAN</rs> v0
            <rs type="version">.61 58</rs> . Sequences were added in order of decreasing length (i.e., longest sequences were added to the alignment first). Table S3 gives summaries of the numbers of taxa and alignment lengths for datasets 1 and 2. We then used 
            <rs type="software">RAxML</rs> to estimate the topology for each one of the 182 loci (168 nuclear + 14 mitochondrial) under the GTR+G model. We then manually inspected the trees and further filtered taxa following these criteria:
        </p>
        <p>• Remove taxa that did not share genes with their order, family, and genus. This is done to avoid unidentifiable positioning of taxa in the subtrees: if a species does not share genes with its close relatives, then several positionings of the species within the subtree will have the same likelihood (a.k.a. "likelihood terraces").</p>
        <p>• Keep only one member of each species while maintaining maximum locus coverage, that is, remove redundant subspecies. Many subspecies slow the analysis down and are not informative about deep divergences (e.g., Rangifer tarandus tarandus). Also, subspecies annotations are missing for many loci, leading to integrity problems when resolving tips. • Outdated taxonomic names according to the literature were removed.</p>
        <p>• Remove taxonomically mismatched or mislabelled taxa.</p>
        <p>• Flag taxa with large topological placement discrepancy with the literature.</p>
        <p>• Outliers with unusually long branches in estimated trees were removed (three sequences in two genes). Taxa were subdivided according to the following taxonomic groups: Afrotheria, Xenarthra, Marsupialia, Euarchonta, Lagomorpha, Laurasiatheria, and Rodentia. Laurasiatheria, Rodentia and Chiroptera, which are species-rich, were further divided into additional subsets to speed-up the dating analysis. Monotremata was added as an outgroup to all subtrees. The final dataset has 4,705 taxa and 182 loci divided into 13 subtree alignments. Each alignment was divided into five-partitions: (i) mitochondrial 12CP, (ii) mitochondrial 3CP, (iii) mitochondrial RNA, (iv) nuclear 12CP, (v) nuclear 3CP (Tables S4-S7). A 
            <rs type="software">RAxML</rs> analysis (GTR+G) was then run on each subtree with the genome-scale tree used as a backbone constraint. The final phylogeny has two manual adjustments. In the original tree, tenrecs are a sister clade to the rest of Afrotheria but, following recent work 6,33 , we adjusted tenrecs as a sister clade to chrysochlorids. In the original tree, Dromiciops is placed as sister to Notoryctes but, following recent work 59 , we placed Dromiciops basal to the rest of Australidelphia.
        </p>
        <p>All divergence-time estimation analyses were carried out with the 
            <rs type="software">MCMCtree</rs> v
            <rs type="version">4.9h/i</rs> dating software from the 
            <rs type="software">PAML package</rs> 60 . The following analyses were carried out: (1) asymptotic analysis of uncertainties in time estimates as a function of number of loci, (2) Bayesian selection of relaxed-clock model, and (3) analysis of time estimates for seven topological rearrangements of the mammal tree. Analyses 1-3 were carried out on the 72-taxon dataset. Last, we ran the (4) sequential-subtree analysis, which is divided into two parts: (i) estimation of times in 72-taxon tree, and (ii) estimation of times for the set of subtrees (4,705 taxa) using the time posterior of step I as the time prior.
        </p>
        <p>To evaluate how our phylogenomic-scale data leads to asymptotic reduction of uncertainty in divergence time estimates, we randomly sampled data subsets with n = 1, 10, 30, 50, 100, and 1,000 loci from dataset 1, and grouped them into four partitions with roughly the same number of genes (except for n = 1). We then estimated the divergence times using the approximate likelihood calculation in MCMCtree, under both the independent log-normal (ILN) and the autocorrelated (geometric Brownian motion or GBM) rate models for each data subset (see 3 below for details on approximate likelihood method). Then, for each subset, we calculated the ratio of the 95% credibility interval width over the posterior mean of the node age. The uncertainty ratios across all 71 node ages were then averaged. This provides us with a measure of the average uncertainty in posterior node ages. For example, if the ratio is 20%, it means that, on average, the CI width is equivalent to 20% of the node age, or alternatively, that 20 My of uncertainty are added to the CI width for every 100 My of divergence.</p>
        <p>(2) Bayesian rate model selection We assessed adequacy of the ILN against the GBM rate models by using the steppingstones approach 40 . Because an MCMC sample is a stationary time series, the stationary bootstrap 61 can be used to estimate the standard error of the log-marginal likelihood estimate while accommodating the autocorrelation of the MCMC. Let log L i be the vector of log-likelihood values sampled from the i-th power posterior. We sample, with replacement, blocks of observations from log L i , and the random blocks are stitched together to form a bootstrap sample log L i *. The size of the blocks has a geometric distribution with mean equal to 10% of the length of log L i . The procedure is repeated for each power-posterior sample and the log-marginal likelihood is then calculated using the stepping-stones formula 40 . The procedure is repeated 100 times to obtain 100 bootstrap estimates of the marginal-log likelihood, which are then used to estimate the standard error of the estimate. We validated the algorithm by comparing bootstrap standard error estimates against those obtained from brute-force re-calculation of the marginal likelihood, the latter being very computationally expensive as it involves running many independent stepping-stones analyses. We used the 645 genes that were present in all the 72 taxa. Analyses were carried out using exact likelihood because the approximation is not good in the tails of the likelihood function, and tail values have a large impact on the marginal likelihood estimates. The age of the root was set to have a prior mean of 1 using the gamma density . We used diffuse gamma priors on the mean rate, μ ~ and σ 2 ~ . The birth and death prior was set to , and , which generates an approximately uniform density 20 . Analyses were carried out using the main tree topology (Figure S2 b,T2). Each gene was analysed separately under the HKY85+G5 nucleotide substitution model [62][63][64] , and sampling was done over 32 beta points in the power posterior. Choice of beta points, application of the stepping-stones formula, and bootstrap block-sampling were done with the 
            <rs type="software">mcmc3r</rs> v
            <rs type="version">0.4.3</rs> package 35 . In total, rate model selection required 41,280 MCMC chains (645 genes x 2 rate models x 32 beta points), totalling four months of wall time (2M hours or &gt;200 years of CPU time) in a high-performance computer cluster. We also carried out a maximum likelihood ratio test of the strict molecular clock 65 . The strict clock was rejected in 642 out of 645 loci (after false-discovery rate correction at the 5% level).
        </p>
        <p>(</p>
        <p>The seven tree topologies used are shown in Figure S2 (a-g). Time estimation was carried out using dataset 1 under approximate likelihood calculation. All analysis setups were as in step I of the sequential Bayesian approach (see below).</p>
        <p>We use the approximate likelihood method to speed up computation during MCMC sampling 37 . This involves obtaining the maximum-likelihood estimates (MLEs) of the branch lengths, b, on a partition, together with the gradient, g, and Hessian, H, of the log-likelihood evaluated at the MLEs. Then b, g, and H are used to approximate the likelihood during MCMC sampling (see 66 for a tutorial). We used 
            <rs type="software">BASEML</rs> 60 
            <rs type="version">v4.9h</rs>/i to calculate b, g, and H for each of the 4 partitions in the 72-genome alignment using the HKY+G5 substitution model 62,63 . We tested 7 different topological relationships among mammals (Figure S2), with each tree topology requiring calculation of its own set of b, g, and H.
        </p>
        <p>Nodes are calibrated using uniform distributions based on the fossil record. The distributions have soft bounds, that is, there are probabilities, p L and p U , that the node age falls outside lower and upper calibration bounds. Here we tested two approaches for setting these probabilities: (1) using p L = p U = 0.025, and (2) p L = 0.001 and p U = 0.1. The second approach assumes the probability of violation of the minimum bound is very small (i.e., assuming fossil placement and dating are accurate), while allowing for a larger upper-bound probability. We find that choice of p L and p U have a small impact on time estimates on the 72-genome phylogeny (Figure S3). However, for the second analysis step (subtree time estimation), we find that, when p L = 0.001 and p U = 0.1, the fitted Skew-t calibration densities are too asymmetrical and with heavy tails, leading to convergence problems in the MCMC (e.g., see 67 for a discussion of convergence on distribution tails). Thus, we favour the use of Skew-t calibrations based on the posterior using p L = p U = 0.025 for the rest of the analyses (see below for details on Skew-t distribution fitting). Table S8 lists the fossil calibrations used for the 72-species phylogeny. Our fossil calibrations include previously published constraints on clade age 33,68 , plus new calibrations that we have formulated following established best practice 69 . Briefly, minima are based on the oldest unequivocal member of a crown group and we follow the youngest age interpretations. Maxima are more challenging to establish since absence of fossil evidence cannot simply be interpreted as evidence of the absence of a lineage at a given time interval. Hence, we use evidence of the presence of outgroup lineages with comparable ecology and taphonomy to serve as evidence of the absence of ingroup lineages since, were they present, the preservation of outgroup relatives demonstrates that they should be preserved 39 . However, there remains a non-zero probability that lineages existed before our maxima and hence we implement them as soft constraints, which allows the analysis to explore older ages for the origination of a calibrated clade but at low prior probability. Detailed justifications for all calibrations are provided in the Annex of the Supplementary Information. We note our fossil calibrations were set at the project beginnings in 2016. Table S8 provides the latest geochronological updates (Sep 2021). The old calibrations are used for the asymptotic and topology variation analyses, while the updated calibrations are used in the sequential dating approach. The calibration updates are very small, usually below the sampling error of the MCMC, and thus have little effect on time estimates (Figure S4). The birth and death process 23 , used to specify the time prior for nodes with no calibrations, was set to , and sampling fraction to , which gives an approximately uniform kernel. The GBM rate model is used with a gamma-Dirichlet prior 56 on the mean i-th partition rate,</p>
        <p>, and on the relaxed-clock parameter, . This setting gives a diffuse prior on the rate that is roughly centered on the average substitution rate of nuclear genes in mammals 56,66 . We ran 
            <rs type="software">MCMCtree</rs> without data to sample from the time prior. This is done to verify the prior is sensible and not in conflict with the calibration densities used 21,70 . To ensure MCMC convergence and increase effective sample size (ESS), we ran several MCMC chains of sufficient length. We used Tracer 71 v1.7 and the coda::effectiveSize 72 v0.19.4 to make sure the ESS was larger than 200 for all estimated parameters (Table S9). We also used the R function rstan::monitor 73 v2.21.2 to calculate the ESS for bulk and tail quantiles and the potential scale reduction factor on rank normalised split chains (Rhat). Values over 100 for the former are considered good, while Rhat values need to be either smaller than or equal to 1.05 to show chain convergence. We further explored chain convergence by visually plotting the distributions of the different chains ran in 
            <rs type="software">MCMCtree</rs> with the 
            <rs type="software">R</rs> package 
            <rs type="software">MCMCtreeR</rs> 74 
            <rs type="version">v1.1</rs> (see Figure S5). Figure S6 shows the convergence plots for each tree hypothesis, which show excellent convergence.
        </p>
        <p>We used the posterior time estimates sampled during the MCMC runs under the GBM model to fit Skew-t (ST) distributions to the 71 internal nodes of the 72-species tree. This was done with the R function sn::st.mple 75 v2.0.0 under the BFGS method for parameter optimisation. To check if the fitted ST distributions were sensible, we sampled, using 
            <rs type="software">MCMCtree</rs>, from the new ST-based prior (i.e., without the alignment data), and checked whether the sampled prior distributions matched the original ST distributions. This is necessary because of the constraint that nodes are younger than their parents. This means ST calibrations on adjacent nodes could suffer from truncation effects and the resulting prior could be in conflict with the ST densities. We did not observe any such conflict (see Figure S7). For the crown-lagomorpha node, however, the corresponding ST calibration caused convergence problems when dating the lagomorpha subtree (dataset 2). This ST calibration, which has a heavy tail, was replaced by an essentially equivalent Skew-normal calibration, which has a light tail, thus solving the convergence problem.
        </p>
        <p>Hessian and gradient calculation for each partition on each subtree were done using the HKY+G5 substitution model, as for dataset 1. Subtrees were calibrated using the fitted ST densities and 60 additional soft-bound calibrations (Tables S10-S11). These calibrations are also updated according to new geochronology. The same rate and birth-death model priors as in step I were used. For each subtree, we ran 32 independent MCMC chains to check convergence and ensure enough samples were collected to approximate the posterior (see Figure S8 and Tables S12-13), although some of those did not pass quality filters and were not included (see Figure S8). We ran 
            <rs type="software">MCMCtree</rs> without data to sample from, and verify the integrity of, the prior. We repeated this analysis twice: once including only the ST calibrations and a second time with both ST and soft-bound calibrations in the subtrees. This was necessary to assess whether the soft bounds were in conflict with the ST densities, producing truncation problems. In a few cases, after examining the prior, we observed conflict between the ST densities and the soft bounds. In such cases, calibrations were adjusted so that the resulting prior CI limits were within ~5% of the original ST density quantiles. Adjustments included either nudging the maximum age of a soft-bound calibration or nudging the ST calibration densities themselves.
        </p>
        <p>Time calibrated subtrees were attached to the corresponding node in the 72-species mammal phylogeny using a custom Python (v
            <rs type="version">3.8.5</rs>) 
            <rs type="software">script</rs>. Outgroup (Monotremata) and any marker taxa were removed before merging the subtrees into the main tree. Marker taxa were needed in the Rodentia and Laurasiatheria subtrees to guarantee integrity of ST-calibrated nodes. That is, when splitting these large subtrees for divergence times estimation, some nodes shared with the main 72-species tree would disappear in some subtrees. Consequently, marker taxa (shared with a sister subtree) were added back into the corresponding subtree to retain the calibrated node and guarantee integrity during merging (see supplementary data). The result of the subtree merging is the fully-dated 4,705-taxon phylogeny. We verified integrity of time estimates by repeating analyses on subsets of shared data cross partitions (see Supplementary Information, Fig. S9).
        </p>
        <p>The fossil data were downloaded from the Paleobiology Database (https://paleobiodb.org/, accessed March 2021), using the API service with resolution set to genus level, excluding uncertain genera, only body fossil taxa (i.e., no ichnotaxa), and accepted names only. The data were cleaned by removing individual stratigraphic occurrences that had an age range greater than 20 million years, as this suggests the dating of the occurrence is uncertain or incorrect on the database. The higher clade classifications were added to the genera, and some manual corrections to the fossil classifications were made. The maximum and minimum ages for each genus were extracted, as well as whether the genus is extant or extinct. The genera with age ranges approaching or equal to 0 million years were double checked against the literature to ensure the extinct/extant status was correct. The number of extinct species for each genus was also extracted from the Paleobiology Database 50 and added to the dataset.</p>
        <p>Tables and Figures cited in the "Methods" section "Divergence Time Estimation" can be found below. They are shown in the same order in which they are cited in the corresponding subsections. Table S9. Measures of effective sample size (ESS). For each tree (T1-T7), the ESS for bulk and tail quantiles together with the Rhat were measured for each parameter with the 
            <rs type="software">R</rs> package 
            <rs type="software">rstan</rs>:
            <rs type="software">:monitor</rs>. In addition, the ESS calculated with the coda::effectiveSampleSize has been included for comparison. Note: An ESS for bulk and tail quantiles &gt; 100 per chain is considered good. If Rhat ≤ 1.05, convergence is assumed. The ESS estimated with the coda package needs to be larger than or equal to 200. 1 Values calculated with the posterior time estimates obtained when using the calibrations according to the geochronology updated as of September 2021. 2 Values calculated with the posterior time estimates obtained when using the calibrations prior to September 2021. Note: Time unit is 100 Ma. Calibrations are specified in 
            <rs type="software">MCMCtree</rs> format, with "B(max, min)" giving the minimum and maximum bounds respectively and "L(min)" giving the minimum bound. 1 The maximum ages of these calibrations are set to be the 2.5% quantile of the ST distributions on the corresponding ancestors. This adjustment is done to avoid truncation artefacts against the ST and soft-bound calibrations. 2 The posterior age of the parent node, Cetruminantia (derived from the 72-taxon tree), is in conflict with its fossil calibration (Himalayacetus, 50.7 Ma, from the Yipressian deposits of the Subathu Formation, India), with the 2.5% quantile of the posterior close to ~48 Ma. This node, Whippomorpha, uses the same fossil constraint as its parent, thus creating a conflict with the ST calibration on its parent node. We deal with this conflict by dating the Artiodactyla subtree twice, once using the 50.7 Ma minimum, and again using a minimum of 47.8 Ma, which is the top of the Ypressian. The 'B' calibration results are used in the stitched tree of 4,705 taxa. Note: Time unit is 100 Ma. Calibrations are specified in 
            <rs type="software">MCMCtree</rs> format. ST calibrations are given as "ST(a, b, c, d)", with a, b, c, and b being the location, scale, shape and degrees of freedom respectively (see MCMCtree's manual for details). Skew-normal distributions are given as "SN(a, b, c)", with parameters to be the same as in ST but without the degrees of freedom. For Cetruminantia, Bovidae, and Ovies-Capra, two versions are provided corresponding to the B and L calibrations on Whippomorpha, respectively (Table S10).
        </p>
        <p>We assessed integrity of time estimates across dating steps and partitions. Figure S9 a shows the estimates of divergence times from step I (using the 72 genomes) vs those from step II (using 4,705 taxa) for the 71 nodes shared between the analyses. The posterior mean time estimates between the analyses are highly correlated. This does not appear surprising given the posterior of times in step I is used as the prior in step II. However, note the posterior means and 95% CIs do differ between the two analyses. This is a consequence of the increased taxon sampling in step II with corresponding use of additional fossil calibrations. We also assessed whether the nuclear and mitochondrial loci from the step II dataset produced similar time estimates. We extracted the 72 taxa from the 182 loci dataset and re-estimated the divergence times using the original fossil calibrations, with the mitochondrial and nuclear loci analysed separately (Figure S10 b-d). Time estimates are highly correlated and consistent when compared against the estimates from the 15K loci analysis (Figure S10 b-c) and when compared against each other (Figure S10 d).</p>
        <p>The sequential Bayesian approach with subtree stitching used here is approximate. The joint posterior of divergence times on a phylogeny contains a correlation structure. This correlation structure is discarded when fitting the ST and SN densities to the marginal posteriors and when using these fitted densities as priors in the second step of the analysis 1 .</p>
        <p>A potential source of correlation may emerge from the constraint that nodes cannot be older than their ancestors. In divergence dating, this means the joint density of ages of nodes and their parents are truncated along the x = y diagonal 2 . For example, consider the sample from two joint independent normals with mean = 0 and s.d. = 0.5. If a truncation along the x = y line is applied so that samples in the x &lt; y region are discarded, a positive correlation is generated on the remaining samples in the x &gt; y region (Figure S10, left panel). On the other hand, if we sample from two joint independent normals with means 2 and -2, both with s.d. = 0.5, and apply the same truncation, no positive correlation is generated because the joint density is far from the x = y line and no data are discarded (Figure S10, right panel). If the marginal posterior densities on the ages of a node and its parent overlap, truncation means a positive correlation is present in the joint posterior, similar to the case of the left panel of Figure S10. Thus, when fitting ST or SN densities to the marginal posteriors, this correlation is discarded. In this case, the sequential Bayesian approach may not work well because the ST and SN calibrations will be a poorer approximation to the joint posterior of the corresponding node ages. On the other hand, if the marginal posterior densities of the ages of a node and its parent do not overlap (as in the right panel of Figure S10), then truncation is not an issue and the fitted ST and SN calibrations will provide an appropriate approximation.</p>
        <p>Consequently, we recommend users examine the joint posterior of node ages in the first step of the sequential approach to assess whether truncation is present. If the marginal posterior density of the age of a node overlaps extensively with those of its ancestors, then truncation will be present and it will be substantial; using the sequential approach in this case may result in a poor approximation. In particular, if truncation is substantial and if the posterior of a daughter node's age is used to calibrate the root of a subtree, it may not be possible to stitch the subtree back into the main tree because the mean posterior age of the subtree's root may, for example, be older than the posterior mean of the parent node in the main tree (a consequence of ignoring truncation and correlation).</p>
        <p>We performed a benchmarking analysis to calculate the computational time savings of our Bayesian sequential-subtree approach. We ran one MCMC chain for each subtree (using its appropriate fossil calibrations and rate prior, and approximate likelihood) with a burn-in of 150,000 iterations and a total of 10,000 samples collected every 100 iterations (note that, in 
            <rs type="software">MCMCtree</rs>, one iteration is one cycle in which all model parameters are sampled sequentially 3 ). We then calculated the ESS of the divergence times per hour of computation (Figure S11). For example, the smallest subtree, Xenarthra (33 taxa), achieved a median ESS of 2,400 per hour. As the number of taxa increases, the computational efficiency decreases (Figure S11). The largest subtree, "Rest of Rodentia (II)" (691 taxa) has an expected median of only ESS of 0.903 per hour (Figure S11), a 2,657x reduction in sampling efficiency per time unit when compared to Xenarthra. Extrapolating these results to 4,705 taxa, we get an expected median ESS per hour of 7.8 x 10 -3 (Figure S11). This means that obtaining a median ESS of 1,000 on the 4,705-taxon phylogeny would require running the MCMC chain for ~15 years (128K hours). Of course, the analysis could be parallelised, but this would require many months per chain and each chain would still need its own expensive burn-in period. In total, we estimate a 115x time saving when comparing the required MCMC lengths for our largest subtree against the full 4,705-taxon phylogeny.
        </p>
        <p>Computational improvements are also due to the use of approximate likelihood calculation 4 , which a previous benchmarking study 5 places very close to 1000x. Three of the most widely used Bayesian molecular-clock dating programs (
            <rs type="software">MrBayes</rs>, 
            <rs type="software">BEAST</rs>, and 
            <rs type="software">PhyloBayes</rs>) implement exact likelihood only. Thus, if using exact likelihood, our largest subtrees would be expected to need over 1.12 M hours (126 years) of computation to achieve a median ESS of 1,000. This appears unfeasible, and thus subtrees would need to be made smaller (less taxa) and chains would have to run for shorter times to achieve an ESS in the order of 100 or less. Such small ESSs would sacrifice precision of MCMC parameter estimates. We note the ESS per hour may depend not only on the number of taxa in the tree, but also on the number of partitions, the clock model, the number of fossil calibrations used, the variance of the calibration densities, and whether the calibrations are in conflict or not. Thus, it may be possible to further adjust these to reduce computation time at the cost of information loss.
        </p>
        <p>We estimate the totality of the approximate likelihood analysis here (excluding the clock model selection analysis which used exact likelihood) took ~80K hours or ~9 years of CPU time. Because 1 day of CPU computing emits ~5 Kg CO2 (see 6 ), this means our analysis emitted roughly 16.7K metric tonnes of CO2. Without the subtree approach (i.e., attempting to estimate the times on the whole 4,705-taxon tree directly), the analyses would have required over 115x more CPU time and thus would have emitted over 1.9 million tonnes of CO2. Without the use of approximate likelihood, computation times and CO2 emissions would have increased by 1,000 fold. Approximate likelihood: Directory inBV/ contains the estimated gradient and Hessian for each alignment partition, which are required to estimate the divergence times under the approximate likelihood method. This directory is subdivided into step01 and step02 subdirectories corresponding to the data for the 72 genomes and the 4,705-taxon subtrees respectively.</p>
        <p>Phylogenetic trees: Directory trees/ contains the trees with fossil calibrations in Newick format. As per above, subdirectories step01 and step02 contain the corresponding trees for the 72 genomes and 4,705 taxa respectively. These trees are required, together with the alignment and in.BV files to estimate the divergence times with 
            <rs type="software">MCMCtree</rs>. Directory timetrees/ contains the estimated posterior timetrees in Nexus format. These are suitable for plotting with 
            <rs type="software">FigTree</rs> v
            <rs type="version">1.3</rs> (
            <rs type="url">http://tree.bio.ed.ac.uk/software/figtree/)</rs>. For the 4,705 taxa, both the separate subtrees and the fully stitched 4,705-taxon tree are provided.
        </p>
        <p>Other files: Directory clocktest/ contains the full results for the Bayesian selection of relaxed-clock model, while directory paleodb/ contains the data mined from the Paleobiology Database. Note that all directories contain README.md files that provide additional information on the directory contents.</p>
        <p>For nodes without a maximum justification, the maximum is constrained to be the 2.5% quantile of the fitted ST/SN density in an ancestral node. This is done to avoid truncation artefacts between fossil calibration and fitted densities. Calibrations integrate geochronological updates as of September 2021. Discussion. Luo et al. 17 hypothesized that Juramaia sinensis from the late Jurassic was the geologically oldest therian mammal, more closely related to crown placentals than to other mammals and therefore eutherian (see also Bi et al. 13 ). Some subsequent analyses have corroborated this result 5,8 , but others have not, placing Juramaia instead on the stem to Theria (e.g., 10 ). Other candidates for the oldest crown therians include Sinodephys 18 and Eomaia 19 originally argued to be on the stems to Marsupialia and Placentalia, respectively. Again, Eomaia in more recent studies has been placed on the therian stem 10,20 , and Sinodelphys appears more consistently on the stem leading to either Placentalia 13 or Marsupialia ). These correlate with the Ypresian, the top of which is 47.8Ma. The record of archaeocete whales (Himalayacetus, described below) is likely younger in absolute terms, but is found in deposits with intercalated marine deposits (NP zones 11-12, 52.4 Ma), and thus can be correlated with the marine record at an older age than early Eocene Asian and North American records of perissodactyls. ; Honrovits from the early Eocene of Wyoming may be related to natalids 59 ; Witwatia and Dizzya from the early Eocene of Tunisia may be vespertilionoids 60,61 Discussion. The topology within paenungulates is less certain that most other inter-ordinal branches among mammals. Several recent studies support a proboscideanhyrax clade to the exclusion of sirenians 64,65 ; others support a proboscidean-sirenian clade to the exclusion of hyracoids 66,67</p>
        <p>Riversleigh could also serve as the mimimum, including a potorine ("Kyeema mahoneyi") and a pseudocheirid from the Edadunna Faunal Zone "A" 73,74 . The term Eometatheria dates to Simpson 75 , who used it as we do, to encapsulate Australasian marsupials. The term was subsequently used by Kirsch 76 and Asher et al. 77 to imply Australasian marsupials excluding peramelians, based on the now overturned idea 71,78,79 that peramelians are the basal-most australidelphians. Given this somewhat complicated history, Beck 79 and Mitchell et al. 71 used the taxon "Eomarsupialia" for this clade (australidelphians excluding Dromiciops) instead. Arguably, however, the importance of precedent and minimizing the introduction of novel taxa would favor retaining older terms that have been used to delineate broadly similar (and in the case of Simpson</p>
        <p>of taxa and orthologs, alignment length, corresponding site pattern counts, and missing data for each data subset and partition scheme. Partitions go from fastest-evolving (1) to slowest-evolving (4).</p>
        <p>of taxa (alignment length | site pattern counts) for mitochondrial subtrees and partitions. Monotremata is an outgroup in all subtrees.</p>
        <p>number of taxa and alignment length (across all partitions) for each subtree. Monotremata is an outgroup in all subtrees.</p>
        <p>1</p>
        <p>.</p>
        <p>Fossil taxon and specimen. Bathonian australosphenidans such as Ambondro mahabo (UA 10602 University of Antananarivo, Madagascar; Flynn et al. 2</p>
        <p>). Phylogenetic justification. Puttick et al. 3 compared application of the Mk model in 
            <rs type="software">MrBayes</rs> to implied and equal-weights parsimony, and supported the interpretation of Jenkins et al. 4 and Luo et al. 5 that Triassic haramiyids fall outside of crown Mammalia. Minimum Age. 164.1 Ma. Maximum Age. 252.2 Ma.
        </p>
        <p>Age Justification. Ambondro comes from the upper part of the Isalo "Group" (middle Jurassic, Bathonian) of Madagascar 2 ), dated as generally Bathonian, so we select the top of the Bathonian as the hard minimum calibration date, 165.3 Ma ± 1.1 Myr, or 164.1 Ma 6 . Following Tarver et al.</p>
        <p>1</p>
        <p>we revise our maximum calibration to allow for the possibility that the monotreme stem lineage really does extend into the upper Triassic</p>
        <p>7,8</p>
        <p>. Specifically, the soft maximum is set at the Permian-Triassic boundary, dated at the base of the Induan, 251.9 Ma ± 0.3 Myr 9 or 252.2 Ma. Discussion. Our calibration for this node contrasts to suggestions (e.g.,</p>
        <p>7,8,10</p>
        <p>) that Triassic Thomasia and</p>
        <p>Fossil taxon and specimen. Chororapithecus abyssinicus CHO-BT 4 from the Beticha locality, Chorora Fm, Ethiopia.</p>
        <p>Phylogenetic justification.</p>
        <p>Suwa et al. 30 identify shared, derived characters of their dental fossils with the lineage of Gorilla. Minimum age. 5.33 Ma. Maximum age. 33.9 Ma. Age justification. 29 . The soft maximum date is as for Catarrhini, above. Discussion. Fossil taxon and specimen. Macaca libyca, YPM 21551 (Benefit et al. 33 : fig. 2) from Wadi Natrun, Egypt. Phylogenetic justification. As for cercopithecines, above. Minimum age. 5.33 Ma. Soft maximum age. 33.9 Ma. Minimum age. 48.07 Ma. Maximum age. 59.24 Ma. Age justification. The Kuldana Formation of Pakistan has been dated as early-middle Eocene, and ages may differ in different regions of northern India, and mammals occur in different horizons.</p>
        <p>09 Node calibrated. Common ancestor of</p>
        <p>Caniformia (dogs, bears, raccoons, seals)</p>
        <p>and</p>
        <p>Feliformia (cats, mongooses, hyaenas)</p>
        <p>, excluding stem carnivoramorphans sensu Wesley Hunt and Flynn</p>
        <p>53</p>
        <p>. Following</p>
        <p>Benton et al. 11</p>
        <p>but with the geochronology revised following</p>
        <p>23</p>
        <p>.</p>
        <p>Fossil taxon and specimen. Eppsinycteris anglica</p>
        <p>55</p>
        <p>, BMNH M13776 from the Lessness Shell Bed, Blackheath Beds, Abbey Wood, Ypresian.</p>
        <p>Phylogenetic justification.</p>
        <p>Phylogenetic justification. See Afrotheria. Minimum age. 56 Ma. Soft maximum age. 162.5 Ma. Age justification. See Afrotheria.</p>
        <p>Soft maximum age. 56.0 Ma. Age justification.</p>
        <p>86</p>
        <p>: fig.</p>
        <p>3</p>
        <p>).</p>
        <p>Phylogenetic justification.</p>
        <p>Oldest crown fossil. Dendrohyrax validus 107 . Pickford &amp; Hlusko 107 describe many specimens of Dendrohyrax cf. validus from Lemudong'o, Narok, Kenya,, one of which is KNM-NK 36534 (left mandible with p4-m2)).</p>
        <p>Minimum age: 14 Ma.</p>
        <p>Age justification.</p>
        <p>Fossil taxon and specimen. Incakujira anillodefuego GNHM Fs-098-1 (Gamagori Natural History Museum, Gamagori, Japan) from Cosmopolitodus-bearing horizons of the Pisco Formation, Aguada de Lomas, near Puerto de Lomas, approximately 80 km south of Nazca, Peru.</p>
        <p>Phylogenetic justification. taxon and specimen. Proailurus lemanensis;</p>
        <p>Holotype: MNHN SG 3509, skull from Saint-Gérard-le-Puy, France 189 .</p>
        <p>Phylogenetic justification.</p>
        <p>Fossil taxon and specimen. Proneotherium repenningi;</p>
        <p>Fossil taxon and specimen. Maximum age. 9.112 Ma.</p>
        <p>Age justification.</p>
        <p>Tables and Figures cited in the "Methods" section "Data Collection and Filtering" can be found below. They are shown in the same order in which they are cited in the corresponding subsections.</p>
        <p>Figure S1: Quality control check of the estimated relative branch lengths (%) for each gene tree in comparison to the corresponding total tree length (log-scale). One of the criteria we had to keep a gene alignment was that the relative branch lengths (x-axis) could not be larger than or equal to 60% of the total length of the tree (y-axis). This plot shows how most of the gene trees have relative branch lengths that are 10-30% of the length of the tree, while few gene trees have relative branch lengths very close to the threshold (60%). Nevertheless, there is one outlier whose tree length in the log-scale is 4 units despite the relative branch length not accounting for more than 60% of the tree; there are at least two very long branch lengths in this gene tree. This plot is useful to visually identify which gene trees should be deleted according to the total log tree length that the relative branch lengths of each gene tree account for with regards to a specific threshold.</p>
        <p>The data (available at DOI: 10.6084/m9.figshare.14885691) are released as a single zip file (~450 Mb) containing alignments, trees, and other files.</p>
        <p>Alignments: Directory aln/00_step_01/ contains the alignments for the 72 genomes in phylip format. Directory aln/01_step_02/ contains the uncompressed, raw subtree alignments for the 4,705 taxa, with missing species represented as sequences of gaps (see Table S7). Directory aln/01_step_02_patterns/ contains the same alignments after processing, that is, with missing species removed and with the alignments compressed into site patterns (see 
            <rs type="software">MCMCtree</rs> and 
            <rs type="software">PAML</rs> documentation for alignment formats). The processed alignments are the ones used by 
            <rs type="software">MCMCtree</rs> to calculate the likelihood during estimation of gradient and Hessian. Note each alignment file contains several alignment blocks, with each block corresponding to an alignment partition. If you load an alignment file into an alignment editor, make sure your editor allows you to see all partition blocks and not just the first one.
        </p>
    </text>
</tei>
