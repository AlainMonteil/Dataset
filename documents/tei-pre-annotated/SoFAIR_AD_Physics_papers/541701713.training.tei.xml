<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-14T14:24+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>Advancing quantum information, communication and sensing relies on the generation and control of quantum correlations in complementary degrees of freedom. Here, we demonstrate the preparation of electron-photon pair states using the phase-matched interaction of free electrons with the evanescent vacuum field of a photonic-chip-based optical microresonator. Spontaneous inelastic scattering produces intracavity photons coincident with energy-shifted electrons. Harnessing these pairs for correlationenhanced imaging, we achieve a two-orders of magnitude contrast improvement in cavity-mode mapping by coincidence-gated electron spectroscopy. This parametric pair-state preparation will underpin the future development of freeelectron quantum optics, providing a pathway to quantum-enhanced imaging, electron-photon entanglement, and heralded single-electron and Fock-state photon sources.Advancing quantum information, communication and sensing relies on the generation and control of quantum correlations in complementary degrees of freedom. Here, we demonstrate the preparation of electron-photon pair states using the phase-matched interaction of free electrons with the evanescent vacuum field of a photonic-chip-based optical microresonator. Spontaneous inelastic scattering produces intracavity photons coincident with energy-shifted electrons. Harnessing these pairs for correlationenhanced imaging, we achieve a two-orders of magnitude contrast improvement in cavity-mode mapping by coincidence-gated electron spectroscopy. This parametric pair-state preparation will underpin the future development of freeelectron quantum optics, providing a pathway to quantum-enhanced imaging, electron-photon entanglement, and heralded single-electron and Fock-state photon sources.</p>
        <p>Optical parametric processes generate quantum correlations of photons, without changing the state of the optical medium involved. Entangled photons from parametric down conversion [1] are an essential resource for quantum communication [2], heralded single photon sources [3,4], and quantum teleportation [5]. Over the past decade, such "twin beam" pairs have been extended to other physical contexts, including photon-phonon correlations [6], non-classical states [7] and entanglement of micro-mechanical systems [8]. Free-electron beams are an emerging target for quantum manipulation and sensing, promising quantum-enhanced imaging [9][10][11][12][13], spectroscopy [14][15][16][17][18][19][20], and excitation [21][22][23][24]. A variety of technologies bridging electron microscopy and photonics [25,26] are being established to join the most powerful probes in atomic-scale imaging and spectroscopy, respectively. Among these, stimulated near-field scattering [27][28][29] offers mode-specific probing of optical properties [30][31][32][33][34][35], whereas spontaneous electron energy loss and cathodoluminescence access electronic transitions and the total photonic density of states [25,26,36]. Structural design has been shown to allow for a tailoring of the spectral and spatial properties of electrondriven radiation [37][38][39][40][41][42]. Harnessing quantum optics approaches, measurements of photon statistics have been employed to reveal single quantum emitters [43] or photon bunching [44][45][46]. Theoretical work predicted singlephoton cathodoluminescence into a fiber waveguide [47], and recent experiments studied the electron-induced excitation of whispering gallery modes [48,49] and optical fibers [46,50]. However, impeded by a lack of modespecific and sufficiently strong coupling, correlations between electrons and well-defined photonic states have remained elusive. In this work, we employ spontaneous inelastic scattering via the evanescent field of a high-Q photonic-chip-based optical microresonator to generate free-electron cavity-photon pair states. We characterize the dual-particle heralding efficiencies and demonstrate that coincidence imaging of the cavity mode yields a drastic background suppression compared to mapping with either electrons or photons alone.Optical parametric processes generate quantum correlations of photons, without changing the state of the optical medium involved. Entangled photons from parametric down conversion [1] are an essential resource for quantum communication [2], heralded single photon sources [3,4], and quantum teleportation [5]. Over the past decade, such "twin beam" pairs have been extended to other physical contexts, including photon-phonon correlations [6], non-classical states [7] and entanglement of micro-mechanical systems [8]. Free-electron beams are an emerging target for quantum manipulation and sensing, promising quantum-enhanced imaging [9][10][11][12][13], spectroscopy [14][15][16][17][18][19][20], and excitation [21][22][23][24]. A variety of technologies bridging electron microscopy and photonics [25,26] are being established to join the most powerful probes in atomic-scale imaging and spectroscopy, respectively. Among these, stimulated near-field scattering [27][28][29] offers mode-specific probing of optical properties [30][31][32][33][34][35], whereas spontaneous electron energy loss and cathodoluminescence access electronic transitions and the total photonic density of states [25,26,36]. Structural design has been shown to allow for a tailoring of the spectral and spatial properties of electrondriven radiation [37][38][39][40][41][42]. Harnessing quantum optics approaches, measurements of photon statistics have been employed to reveal single quantum emitters [43] or photon bunching [44][45][46]. Theoretical work predicted singlephoton cathodoluminescence into a fiber waveguide [47], and recent experiments studied the electron-induced excitation of whispering gallery modes [48,49] and optical fibers [46,50]. However, impeded by a lack of modespecific and sufficiently strong coupling, correlations between electrons and well-defined photonic states have remained elusive. In this work, we employ spontaneous inelastic scattering via the evanescent field of a high-Q photonic-chip-based optical microresonator to generate free-electron cavity-photon pair states. We characterize the dual-particle heralding efficiencies and demonstrate that coincidence imaging of the cavity mode yields a drastic background suppression compared to mapping with either electrons or photons alone.</p>
        <p>The interaction of electron beams with cavities and resonant structures represents a universal scheme for generating electromagnetic radiation. In the quantum optical description, the inelastic scattering can be modeled as a coupling of free electrons to optical vacuum fields (cf. Fig. 1) [51]. Scattering with the evanescent field of the optical microresonator (cf. Fig. 1a), an electron at energy E generates intracavity photons at frequencies ω in an energy-conserving manner, described by the scattering matrix Ŝ = exp g qu â †b -h.c. , where â † is the creation operator of the optical mode, b is the electronenergy lowering operator and g qu is the vacuum coupling strength [29]. The interaction induces entanglement between the electron energy and the cavity population, and results in the stateThe interaction of electron beams with cavities and resonant structures represents a universal scheme for generating electromagnetic radiation. In the quantum optical description, the inelastic scattering can be modeled as a coupling of free electrons to optical vacuum fields (cf. Fig. 1) [51]. Scattering with the evanescent field of the optical microresonator (cf. Fig. 1a), an electron at energy E generates intracavity photons at frequencies ω in an energy-conserving manner, described by the scattering matrix Ŝ = exp g qu â †b -h.c. , where â † is the creation operator of the optical mode, b is the electronenergy lowering operator and g qu is the vacuum coupling strength [29]. The interaction induces entanglement between the electron energy and the cavity population, and results in the state</p>
        <p>with the coefficients c n = exp(-with the coefficients c n = exp(-</p>
        <p>2 )2 )</p>
        <p>n! corresponding to Poissonian scattering probabilities [15,16]. For a weak vacuum coupling strength |g qu | 1, the state is dominated by the zero-and one-photon contributions:n! corresponding to Poissonian scattering probabilities [15,16]. For a weak vacuum coupling strength |g qu | 1, the state is dominated by the zero-and one-photon contributions:</p>
        <p>Our measurements are designed to probe this state by detecting single photons in coincidence with inelastically scattered electrons. In the experiment, a continuous electron beam at 120-keV energy is traversing a photonic chip based microresonator in an aloof geometry (Fig. 1b). The Si 3 N 4 microresonator, fabricated using the photonic damascene process [35,52,53], is designed for low optical loss, efficient fiber coupling and free-space near-field access (for optical characteristics, see Methods). The narrow cross-section of the resonator (2.1 µm × 650 nm) is chosen such as to achieve electron-light velocity phase matching, and thereby enhanced coupling to the dielectric structure [35,[54][55][56][57][58], with predicted total photon generation probabilities of up to about 10%. This results in a population of the empty cavity, with a peak emission around 0.8-eV photon energy (corresponding to an optical wavelength of 1.5 µm). The energy and arrival time of each electron is measured with an event-based detector behind a magnetic prism spectrometer (Fig. 1c). Cavity photons generated in the scattering process are coupled out to a bus waveguide, and further guided by optical fibers to a single-photon avalanche diode (SPAD). Figure 1d illustrates the preparation and detection of the electron-photon pair state via scattering at the resonator, followed by electron energy projection and coincidence measurement.Our measurements are designed to probe this state by detecting single photons in coincidence with inelastically scattered electrons. In the experiment, a continuous electron beam at 120-keV energy is traversing a photonic chip based microresonator in an aloof geometry (Fig. 1b). The Si 3 N 4 microresonator, fabricated using the photonic damascene process [35,52,53], is designed for low optical loss, efficient fiber coupling and free-space near-field access (for optical characteristics, see Methods). The narrow cross-section of the resonator (2.1 µm × 650 nm) is chosen such as to achieve electron-light velocity phase matching, and thereby enhanced coupling to the dielectric structure [35,[54][55][56][57][58], with predicted total photon generation probabilities of up to about 10%. This results in a population of the empty cavity, with a peak emission around 0.8-eV photon energy (corresponding to an optical wavelength of 1.5 µm). The energy and arrival time of each electron is measured with an event-based detector behind a magnetic prism spectrometer (Fig. 1c). Cavity photons generated in the scattering process are coupled out to a bus waveguide, and further guided by optical fibers to a single-photon avalanche diode (SPAD). Figure 1d illustrates the preparation and detection of the electron-photon pair state via scattering at the resonator, followed by electron energy projection and coincidence measurement.</p>
        <p>We position the sample inside a transmission electron microscope (TEM), focus the low-convergence electron beam (25-nm diameter) in proximity of the photonic chip based resonator (cf. Fig. 2a), and detect outcoupled photons, i.e., the cathodoluminescence. Measured with an optical spectrometer, the spectral density of the emission exhibits a comb-like structure (cf. Fig. 2b), as a result of free-electron coupling to the microresonator modes a µ (µ: mode index). The overall scattering probability P = µ |g qu,µ | 2 is derived from the individual mode contributions g qu,µ (a multi-mode description of the interaction is found in the SI). The spacing of the emission peaks in wavelength by 1.58 nm matches the optically-characterized quasi-TM free-spectral-range (FSR) of 194 GHz, implying the spontaneous excitation of these initially empty cavity modes. The predominant coupling to the quasi-TM mode family follows from its considerable azimuthal electric field component along the electron trajectory [35]. In comparison, quasi-TE and higher-order spatial modes have a weaker coupling to the mode-selective bus waveguide. The overall spectral range of detected modes spans from 1520-1620 nm, and is limited by the bandwidth of electron-light phase matching, wavelength-dependent coupling to the bus waveguide, as well as the detector spectral bandwidth, in good agreement with numerical simulations (cf. Fig. 2b).We position the sample inside a transmission electron microscope (TEM), focus the low-convergence electron beam (25-nm diameter) in proximity of the photonic chip based resonator (cf. Fig. 2a), and detect outcoupled photons, i.e., the cathodoluminescence. Measured with an optical spectrometer, the spectral density of the emission exhibits a comb-like structure (cf. Fig. 2b), as a result of free-electron coupling to the microresonator modes a µ (µ: mode index). The overall scattering probability P = µ |g qu,µ | 2 is derived from the individual mode contributions g qu,µ (a multi-mode description of the interaction is found in the SI). The spacing of the emission peaks in wavelength by 1.58 nm matches the optically-characterized quasi-TM free-spectral-range (FSR) of 194 GHz, implying the spontaneous excitation of these initially empty cavity modes. The predominant coupling to the quasi-TM mode family follows from its considerable azimuthal electric field component along the electron trajectory [35]. In comparison, quasi-TE and higher-order spatial modes have a weaker coupling to the mode-selective bus waveguide. The overall spectral range of detected modes spans from 1520-1620 nm, and is limited by the bandwidth of electron-light phase matching, wavelength-dependent coupling to the bus waveguide, as well as the detector spectral bandwidth, in good agreement with numerical simulations (cf. Fig. 2b).</p>
        <p>A spatial characterization of the intracavity excitation is obtained by raster-scanning the electron beam near the waveguide using scanning transmission electron micoscopy (STEM) (Fig. 2a, dark blue ring/box) and detecting the emitted light with a SPAD. The total and mode-specific coupling strengths are obtained by recording the photon count rate without (Fig. 2c, left panel) and with (right panel), respectively, a spectral filter that selects a single TM cavity mode (indicated in Fig. 2b). Regions where the electrons directly impinge on the chip show no photon signal, creating a sharp edge in the recorded 2D map. The strongest coupling and most efficient photon generation is observed for electrons passing the ring resonator tangentially, as expected for phasematched free-electron light interaction. Both signals decay exponentially with distance from the structure, tracing the near-field mode profile in this spectral range.A spatial characterization of the intracavity excitation is obtained by raster-scanning the electron beam near the waveguide using scanning transmission electron micoscopy (STEM) (Fig. 2a, dark blue ring/box) and detecting the emitted light with a SPAD. The total and mode-specific coupling strengths are obtained by recording the photon count rate without (Fig. 2c, left panel) and with (right panel), respectively, a spectral filter that selects a single TM cavity mode (indicated in Fig. 2b). Regions where the electrons directly impinge on the chip show no photon signal, creating a sharp edge in the recorded 2D map. The strongest coupling and most efficient photon generation is observed for electrons passing the ring resonator tangentially, as expected for phasematched free-electron light interaction. Both signals decay exponentially with distance from the structure, tracing the near-field mode profile in this spectral range.</p>
        <p>However, there are pronounced differences for the position dependence of the coupling strengths along the surface of the structure: the unfiltered count rate measured by the photon detector shows one prominent peak of the intracavity excitation and a smooth decay towards the resonator ring center, whereas the single-mode photon rate exhibits oscillations along the chip edge. The oscillatory behavior of the single-mode coupling along the chip surface is caused by Ramsey-type interference [59] between phase-mismatched sequential interactions of an electron (cf. Fig. 2a, red dots) with the cavity vacuum field, as also observed for single-mode excitation of an externally-pumped ring resonators [35]. Figure 2d plots the position-dependent count rates along the chip surface, which are in good agreement with numerical simulations of the scattering probability P (Fig. 2e, see SI for details). Note that such interferences from sequential interactions or multipath scattering are characteristic of coherent cathodoluminescence [37,60,61].However, there are pronounced differences for the position dependence of the coupling strengths along the surface of the structure: the unfiltered count rate measured by the photon detector shows one prominent peak of the intracavity excitation and a smooth decay towards the resonator ring center, whereas the single-mode photon rate exhibits oscillations along the chip edge. The oscillatory behavior of the single-mode coupling along the chip surface is caused by Ramsey-type interference [59] between phase-mismatched sequential interactions of an electron (cf. Fig. 2a, red dots) with the cavity vacuum field, as also observed for single-mode excitation of an externally-pumped ring resonators [35]. Figure 2d plots the position-dependent count rates along the chip surface, which are in good agreement with numerical simulations of the scattering probability P (Fig. 2e, see SI for details). Note that such interferences from sequential interactions or multipath scattering are characteristic of coherent cathodoluminescence [37,60,61].</p>
        <p>The electron-driven spontaneous generation of photons in the photonic microresonator is expected to satisfy energy-momentum conservation [47]. Therefore, each individual scattering event should change the energy of an electron by -ω and transfer the corresponding momentum to a cavity photon in the forward-propagating mode (clockwise around the resonator in Fig. 2a). Investigating this process on the single-electron and single-photon level, we conduct event-based electron spectroscopy and time-tagged photon counting simultaneously. To this end, the electron beam is held fixed in the near field of the cavity, at a ∼ 160-nm distance from the surface. At this position, we detect photons with a probability of 4.6 × 10 -5 per electron passing the structure. Considering coupling and detection losses (see Methods), this corresponds to an intrinsic generation probability of about ∼ 0.025. The arrival time and kinetic energy of each electron is measured by event-based detection, using the stream of photons recorded by the SPAD as a time-tagging sig- nal (cf. Fig. 1a and Methods for details). Figure 3a shows the energy-and time-dependent histogram of electron arrivals relative to the photon detection event closest in time. The two main features observed are a timeindependent background of accidental coincidences, and a sharp peak around 0.8-eV energy loss and 0-ns time delay (electronic and propagation delays subtracted, see Methods). The spectral distribution of the correlation peak (blue, yellow) and the uncorrelated signal (red), integrated over appropriate time intervals, are shown in Fig. 3b. The correlated electron spectrum is downshifted by one photon energy, but otherwise closely matches the zero-loss-peak (ZLP) spectrum of the unscattered electrons in broadening and shape (∼ 0.5 eV width). This is consistent with the simulated and measured comparatively narrow electron-light phase matching bandwidth (∼ 50 meV, cf. Fig. 2b).The electron-driven spontaneous generation of photons in the photonic microresonator is expected to satisfy energy-momentum conservation [47]. Therefore, each individual scattering event should change the energy of an electron by -ω and transfer the corresponding momentum to a cavity photon in the forward-propagating mode (clockwise around the resonator in Fig. 2a). Investigating this process on the single-electron and single-photon level, we conduct event-based electron spectroscopy and time-tagged photon counting simultaneously. To this end, the electron beam is held fixed in the near field of the cavity, at a ∼ 160-nm distance from the surface. At this position, we detect photons with a probability of 4.6 × 10 -5 per electron passing the structure. Considering coupling and detection losses (see Methods), this corresponds to an intrinsic generation probability of about ∼ 0.025. The arrival time and kinetic energy of each electron is measured by event-based detection, using the stream of photons recorded by the SPAD as a time-tagging sig- nal (cf. Fig. 1a and Methods for details). Figure 3a shows the energy-and time-dependent histogram of electron arrivals relative to the photon detection event closest in time. The two main features observed are a timeindependent background of accidental coincidences, and a sharp peak around 0.8-eV energy loss and 0-ns time delay (electronic and propagation delays subtracted, see Methods). The spectral distribution of the correlation peak (blue, yellow) and the uncorrelated signal (red), integrated over appropriate time intervals, are shown in Fig. 3b. The correlated electron spectrum is downshifted by one photon energy, but otherwise closely matches the zero-loss-peak (ZLP) spectrum of the unscattered electrons in broadening and shape (∼ 0.5 eV width). This is consistent with the simulated and measured comparatively narrow electron-light phase matching bandwidth (∼ 50 meV, cf. Fig. 2b).</p>
        <p>Figure 3c displays the energy-time-histogram using a higher electron flux and the zero-loss peak largely elim-inated with a mechanical slit in the electron spectrometer to prevent detector saturation. The backgroundcorrected time profile (Fig. 3c inset) shows the precise temporal structure of the correlated electron-photon pairs with a width of 3.91 ns (FWHM). In principle, the temporal correlation should reproduce the cavity decay time, but it is not resolved in the present experiments (current device: ∼0.5-ns lifetime for a quality factor of Q ∼ 5.5 × 10 5 ; see Methods).Figure 3c displays the energy-time-histogram using a higher electron flux and the zero-loss peak largely elim-inated with a mechanical slit in the electron spectrometer to prevent detector saturation. The backgroundcorrected time profile (Fig. 3c inset) shows the precise temporal structure of the correlated electron-photon pairs with a width of 3.91 ns (FWHM). In principle, the temporal correlation should reproduce the cavity decay time, but it is not resolved in the present experiments (current device: ∼0.5-ns lifetime for a quality factor of Q ∼ 5.5 × 10 5 ; see Methods).</p>
        <p>By selecting loss-scattered electrons within a specific time window, we identify correlated events on a single-particle basis. This enables inter-particle heralding schemes for either electrons or photons, quantified in terms of the measured rates of electrons (R e ), photons (R p ) and correlated events (R pe ). The Klyshko heralding efficiencies η i K = R pe /R j (i, j=e, p, i = j) describe the conditional probability of actually detecting a heralded particle [4]. For the data shown in Fig. 3c, we measure η p K ∼ 0.11% and η e K ∼ 57% for photons and electrons, respectively. The much more efficient heralding of electrons follows from considerably higher losses in the output coupling and detection of photons (cf. Methods). Not being a fundamental physical limitation, we expect significant improvements on the photon collection efficiency with technical optimizations, including use of superconducting detectors and strongly over-coupled resonators. Taking into account particle losses in transmission and detection, we estimate intrinsic heralding efficiencies η i I of approximately 50%. More generally, the phase-matched coupling to a specific mode family, and the aloof beam geometry that avoids undesired materials excitations, promise heralding efficiencies near unity (see detailed estimate of η i I in Methods &amp; SI). We note that the measurement of the electron energy for each single event, in contrast to conventional optical spontaneous parametric down conversion, presents a direct measure of the energy quanta deposited in the optical cavity. In conjunction with the narrow phasematching bandwidth, the event-based electron energy detection conditioned on the first energy loss sideband therefore represents an optical state projection onto a (non-classical) single-photon intracavity Fock state. Interactions with multiple electrons-relevant for studying electron-electron correlations [62][63][64]-can be excluded considering the multi-hit capability of the detector.By selecting loss-scattered electrons within a specific time window, we identify correlated events on a single-particle basis. This enables inter-particle heralding schemes for either electrons or photons, quantified in terms of the measured rates of electrons (R e ), photons (R p ) and correlated events (R pe ). The Klyshko heralding efficiencies η i K = R pe /R j (i, j=e, p, i = j) describe the conditional probability of actually detecting a heralded particle [4]. For the data shown in Fig. 3c, we measure η p K ∼ 0.11% and η e K ∼ 57% for photons and electrons, respectively. The much more efficient heralding of electrons follows from considerably higher losses in the output coupling and detection of photons (cf. Methods). Not being a fundamental physical limitation, we expect significant improvements on the photon collection efficiency with technical optimizations, including use of superconducting detectors and strongly over-coupled resonators. Taking into account particle losses in transmission and detection, we estimate intrinsic heralding efficiencies η i I of approximately 50%. More generally, the phase-matched coupling to a specific mode family, and the aloof beam geometry that avoids undesired materials excitations, promise heralding efficiencies near unity (see detailed estimate of η i I in Methods &amp; SI). We note that the measurement of the electron energy for each single event, in contrast to conventional optical spontaneous parametric down conversion, presents a direct measure of the energy quanta deposited in the optical cavity. In conjunction with the narrow phasematching bandwidth, the event-based electron energy detection conditioned on the first energy loss sideband therefore represents an optical state projection onto a (non-classical) single-photon intracavity Fock state. Interactions with multiple electrons-relevant for studying electron-electron correlations [62][63][64]-can be excluded considering the multi-hit capability of the detector.</p>
        <p>Harnessing correlations of electrons with visible [65] or x-ray [66] emission shows promise for enhancing contrast and resolution in electron spectroscopy [13], with a wide range of applications in the study of core-level [67] and very recently valence electronic excitations in nanomaterials [68]. Correlation-enhanced measurements isolate physical scattering events from uncorrelated noise such as detector dark counts. As a figure of merit, the coincidence-to-accidental ratio CAR = (R pe -R acc )/R acc describes the rate of coincidence events R pe over the uncorrelated background R acc [4]. Figure 3d displays the fraction of true coincidences, (1-1/CAR) as a function of selected time delay and energy loss, reaching 98.6%, i.e., a CAR ∼ 75. This demonstrates the high-fidelity generation of correlated electron-photon pairs for enhanced imaging.Harnessing correlations of electrons with visible [65] or x-ray [66] emission shows promise for enhancing contrast and resolution in electron spectroscopy [13], with a wide range of applications in the study of core-level [67] and very recently valence electronic excitations in nanomaterials [68]. Correlation-enhanced measurements isolate physical scattering events from uncorrelated noise such as detector dark counts. As a figure of merit, the coincidence-to-accidental ratio CAR = (R pe -R acc )/R acc describes the rate of coincidence events R pe over the uncorrelated background R acc [4]. Figure 3d displays the fraction of true coincidences, (1-1/CAR) as a function of selected time delay and energy loss, reaching 98.6%, i.e., a CAR ∼ 75. This demonstrates the high-fidelity generation of correlated electron-photon pairs for enhanced imaging.</p>
        <p>We provide a proof-of-concept demonstration by coincidence-gated raster-mapping of the resonator mode. Specifically, Figs. 4a,b show the time-integrated electron and photon signals, respectively, and Fig. 4c displays the correlated events only. To quantify the correlationinduced improvement in image contrast, Figure 4d compares the respective count rates for the individual and correlated signals on a logarithmic scale. Both the photon and electron signals trace the exponential decay of the evanescent field away from the structure, leveling off at constant values for larger distances. These background offsets are determined by the uncorrelated noise rates, i.e., the photodetector dark counts (130 cts/s) and residual overlap of the ZLP with the energetic gate (1.5 × 10 4 cts/s), respectively. In comparison, the correlated signal (cf. Fig. 4d, yellow curve) displays a reduced count rate, resulting from imperfect Klyshko heralding efficiencies η i K &lt; 1. However, the evanescent decay is resolved over longer distances, with the uncorrelated background noise suppressed by the narrow correlation window. As a result, the dynamic range (DR) is improved by two orders of magnitude, limited by the vanishing counts at large distances for the given integration time. (For a detailed analysis of the dynamic ranges and their relative enhancements, see the SI.)We provide a proof-of-concept demonstration by coincidence-gated raster-mapping of the resonator mode. Specifically, Figs. 4a,b show the time-integrated electron and photon signals, respectively, and Fig. 4c displays the correlated events only. To quantify the correlationinduced improvement in image contrast, Figure 4d compares the respective count rates for the individual and correlated signals on a logarithmic scale. Both the photon and electron signals trace the exponential decay of the evanescent field away from the structure, leveling off at constant values for larger distances. These background offsets are determined by the uncorrelated noise rates, i.e., the photodetector dark counts (130 cts/s) and residual overlap of the ZLP with the energetic gate (1.5 × 10 4 cts/s), respectively. In comparison, the correlated signal (cf. Fig. 4d, yellow curve) displays a reduced count rate, resulting from imperfect Klyshko heralding efficiencies η i K &lt; 1. However, the evanescent decay is resolved over longer distances, with the uncorrelated background noise suppressed by the narrow correlation window. As a result, the dynamic range (DR) is improved by two orders of magnitude, limited by the vanishing counts at large distances for the given integration time. (For a detailed analysis of the dynamic ranges and their relative enhancements, see the SI.)</p>
        <p>Our findings demonstrate and apply the high-fidelity generation and detection of correlated electron-photon pairs. Besides showing the capability for contrast enhancement in correlation-gated imaging, we implement flexible on-chip electron-heralded photon and photonheralded single-electron sources with unique features and, in principle, near-unity heralding efficiency. The integrated photonics platform allows for flexible electronlight phase-matching and spectral tuning of the generated cavity state. Post-selection of multi-loss electron events will facilitate the generation of tailored and higherorder photon Fock states. By merging free-electron quantum optics with integrated photonics, we provide a pathway towards a new class of hybrid quantum technology relying on entangled electrons and photons, with applications ranging from photonic quantum state synthesis to quantum-enhanced sensing and imaging.Our findings demonstrate and apply the high-fidelity generation and detection of correlated electron-photon pairs. Besides showing the capability for contrast enhancement in correlation-gated imaging, we implement flexible on-chip electron-heralded photon and photonheralded single-electron sources with unique features and, in principle, near-unity heralding efficiency. The integrated photonics platform allows for flexible electronlight phase-matching and spectral tuning of the generated cavity state. Post-selection of multi-loss electron events will facilitate the generation of tailored and higherorder photon Fock states. By merging free-electron quantum optics with integrated photonics, we provide a pathway towards a new class of hybrid quantum technology relying on entangled electrons and photons, with applications ranging from photonic quantum state synthesis to quantum-enhanced sensing and imaging.</p>
        <p>Assuming the electron beam trajectory is along the ẑ direction with the transverse coordinates (x, y), the mode-specific vacuum coupling strength between the electron and photon can be expressed as gqu,µ(x, y) = e √ 2 µ ωµVµ dze izωµ/ve u * µ (x, y, z) (quantization procedure, see SI). Here, e is the electron charge, ve the electron group velocity, µ the optical mode permittivity, ωµ the angular frequency, Vµ the mode volume, and uµ(x, y, z) the ẑ projection of the normalized electric field function along the electron trajectory. The factor dze izωµ/ve u * µ (z) reflects the phase-matching condition, and defines the phase-matching bandwidth dependent on the mode-specific dispersion of the resonator's effective refractive index. Using our current resonator design with a small waveguide cross-section and a long interaction length of ∼40 µm (200 fs interaction time), the single-mode coupling strength is numerically predicted to be as high as |gqu,µ| ∼ 0.03 (equivalent coupling rate |g 0,µ |/2π ∼ 2 × 10 10 Hz) with an impact parameter of 50 nm from the resonator surface, consistent with the experimental results.Assuming the electron beam trajectory is along the ẑ direction with the transverse coordinates (x, y), the mode-specific vacuum coupling strength between the electron and photon can be expressed as gqu,µ(x, y) = e √ 2 µ ωµVµ dze izωµ/ve u * µ (x, y, z) (quantization procedure, see SI). Here, e is the electron charge, ve the electron group velocity, µ the optical mode permittivity, ωµ the angular frequency, Vµ the mode volume, and uµ(x, y, z) the ẑ projection of the normalized electric field function along the electron trajectory. The factor dze izωµ/ve u * µ (z) reflects the phase-matching condition, and defines the phase-matching bandwidth dependent on the mode-specific dispersion of the resonator's effective refractive index. Using our current resonator design with a small waveguide cross-section and a long interaction length of ∼40 µm (200 fs interaction time), the single-mode coupling strength is numerically predicted to be as high as |gqu,µ| ∼ 0.03 (equivalent coupling rate |g 0,µ |/2π ∼ 2 × 10 10 Hz) with an impact parameter of 50 nm from the resonator surface, consistent with the experimental results.</p>
        <p>For numerical simulations of the single mode coupling strength, we obtain the modal frequencies and field profiles via finite-elementmethod electromagnetic simulations (COMSOL Multiphysics). The vacuum coupling parameter for cavity modes ωµ is then calculated using: gqu,µ(x, y) = e 2 ωµ nFor numerical simulations of the single mode coupling strength, we obtain the modal frequencies and field profiles via finite-elementmethod electromagnetic simulations (COMSOL Multiphysics). The vacuum coupling parameter for cavity modes ωµ is then calculated using: gqu,µ(x, y) = e 2 ωµ n</p>
        <p>where Ez is the z-directional complex electric field obtained from electromagnetic simulations [35], and n µ ph is the intracavity photon number inferred from power calculations. For the calculation of the photon generation (CL) and corresponding inelastic electron energy loss (EELS) probabilities, we assume a single-scattering electron-photon interaction with a weak interaction strength for individual modes |gqu,µ| 1, consistent with our experimental conditions. The Poissonian process is then simplified to: P (|0µ ) = exp -|gqu,µ| 2 ≈ 1 -|gqu,µ| 2 and P (|1µ ) = exp -|gqu,µ| 2 |gqu,µ| 2 ≈ |gqu,µ| 2 . For EELS, the electron energy-loss probability for emitting a photon in the ωµ mode is |gqu,µ| 2 . For CL, the photon (ωµ-mode) detection probability is |gqu,µ| 2 η(ωµ)S(ωµ), considering the efficiency and bandwidth of the bus-waveguide-microresonator coupling η(ω) and the single-photon avalanche diode (SPAD) spectral sensitivity S(ω). Fiber optics loss is not considered at this point as it is frequency insensitive over the phase matching bandwidth. The SPAD response is taken from vendor specifications, and the buswaveguide-microresonator coupling efficiency is calculated from η(ω) = κex(ω)/(κ 0 (ω) + κex(ω)) with experimentally measured external coupling rate κex(ω) and intrinsic loss rate κ 0 (ω). More details can be found in the Supplementary Information.where Ez is the z-directional complex electric field obtained from electromagnetic simulations [35], and n µ ph is the intracavity photon number inferred from power calculations. For the calculation of the photon generation (CL) and corresponding inelastic electron energy loss (EELS) probabilities, we assume a single-scattering electron-photon interaction with a weak interaction strength for individual modes |gqu,µ| 1, consistent with our experimental conditions. The Poissonian process is then simplified to: P (|0µ ) = exp -|gqu,µ| 2 ≈ 1 -|gqu,µ| 2 and P (|1µ ) = exp -|gqu,µ| 2 |gqu,µ| 2 ≈ |gqu,µ| 2 . For EELS, the electron energy-loss probability for emitting a photon in the ωµ mode is |gqu,µ| 2 . For CL, the photon (ωµ-mode) detection probability is |gqu,µ| 2 η(ωµ)S(ωµ), considering the efficiency and bandwidth of the bus-waveguide-microresonator coupling η(ω) and the single-photon avalanche diode (SPAD) spectral sensitivity S(ω). Fiber optics loss is not considered at this point as it is frequency insensitive over the phase matching bandwidth. The SPAD response is taken from vendor specifications, and the buswaveguide-microresonator coupling efficiency is calculated from η(ω) = κex(ω)/(κ 0 (ω) + κex(ω)) with experimentally measured external coupling rate κex(ω) and intrinsic loss rate κ 0 (ω). More details can be found in the Supplementary Information.</p>
        <p>The Si 3 N 4 microresonator (wafer D66 01 F1 C20) was fabricated using the photonic Damascene process [52,53]. Si 3 N 4 exhibits very low absorption losses in the telecom region (&lt; 1 dB/m for 1550nm) and can be engineered to achieve optimal dispersion, and therefore phase-matching conditions with the passing electrons, as well as good fiber coupling [69]. The used resonator structure with a 2.1 µm × 650 nm waveguide size and a ring radius of 113.75 µm (194 GHz free spectral range for quasi-TM mode family) was designed for phase matching at an optical wavelength around 1550 nm and an electron energy of 120 keV. The mean quality factor (Q-factor) of the observed resonances is ∼ 5.5 × 10 5 , with the resonator-waveguide coupling efficiency degraded to ∼ 17% during the experiment, likely caused by an increased intrinsic loss from charging induced carbon deposition on the resonator surface. More details on the chip fabrication can be found in [35].The Si 3 N 4 microresonator (wafer D66 01 F1 C20) was fabricated using the photonic Damascene process [52,53]. Si 3 N 4 exhibits very low absorption losses in the telecom region (&lt; 1 dB/m for 1550nm) and can be engineered to achieve optimal dispersion, and therefore phase-matching conditions with the passing electrons, as well as good fiber coupling [69]. The used resonator structure with a 2.1 µm × 650 nm waveguide size and a ring radius of 113.75 µm (194 GHz free spectral range for quasi-TM mode family) was designed for phase matching at an optical wavelength around 1550 nm and an electron energy of 120 keV. The mean quality factor (Q-factor) of the observed resonances is ∼ 5.5 × 10 5 , with the resonator-waveguide coupling efficiency degraded to ∼ 17% during the experiment, likely caused by an increased intrinsic loss from charging induced carbon deposition on the resonator surface. More details on the chip fabrication can be found in [35].</p>
        <p>The chip is transferred into the TEM via a custom made holder with a hollowed-out tube and a KF blind flange with vacuum fiber feedthroughs at the end. This allows fibers connected to the chip at the holder tip to be fed through the holder to the feedthroughs and through them be connected to the outside of the TEM. The adapter piece and T-shaped base plate at the tip of the holder are designed to place the chip into the rotation axis of the holder, allowing for precise chip rotation in the sample plane of the electron microscope.The chip is transferred into the TEM via a custom made holder with a hollowed-out tube and a KF blind flange with vacuum fiber feedthroughs at the end. This allows fibers connected to the chip at the holder tip to be fed through the holder to the feedthroughs and through them be connected to the outside of the TEM. The adapter piece and T-shaped base plate at the tip of the holder are designed to place the chip into the rotation axis of the holder, allowing for precise chip rotation in the sample plane of the electron microscope.</p>
        <p>The bus waveguide on the photonic chip is connected to ultrahigh numerical aperture (UHNA-7) fibers (mode field diameter of ∼ 3.2 µm at 1550nm), which are spliced to standard single-mode fibers (SMF-28) with a splicing loss of &lt; 0.2 dB [70]. The optical transmission of photons coupled into the bus waveguide to the output of the external fiber connector of the holder is measured to be ∼ 40%.The bus waveguide on the photonic chip is connected to ultrahigh numerical aperture (UHNA-7) fibers (mode field diameter of ∼ 3.2 µm at 1550nm), which are spliced to standard single-mode fibers (SMF-28) with a splicing loss of &lt; 0.2 dB [70]. The optical transmission of photons coupled into the bus waveguide to the output of the external fiber connector of the holder is measured to be ∼ 40%.</p>
        <p>The experiments are conducted at the Göttingen UTEM instrument that is based on a Schottky field-emission TEM (JEOL JEM 2100F) [71]. The electron gun is operated with a continuous electron beam in the extended Schottky regime with an under-heated emitter, resulting in an energy spread of 0.5 eV at a beam energy of 120 keV. The overall beam current is adjusted by the emitter temperature and condenser aperture to prevent oversaturation of the detectors (Fig. 3a&amp;b 40-µm aperture, Fig. 3c&amp;d 100-µm aperture). Reducing beam clipping at the spatially extended structures, the low-magnification STEM mode (LM-STEM) is used in the experiments, achieving an electron focal spot sizes of &lt; 25 nm. The beam is held fixed above the sample surface (Fig. 3, e.g. 100-200 nm distance) or raster scanned (Fig. 2&amp;4, 30-ms dwell time). The event-based spectral analysis of the transmitted electron beam is described below.The experiments are conducted at the Göttingen UTEM instrument that is based on a Schottky field-emission TEM (JEOL JEM 2100F) [71]. The electron gun is operated with a continuous electron beam in the extended Schottky regime with an under-heated emitter, resulting in an energy spread of 0.5 eV at a beam energy of 120 keV. The overall beam current is adjusted by the emitter temperature and condenser aperture to prevent oversaturation of the detectors (Fig. 3a&amp;b 40-µm aperture, Fig. 3c&amp;d 100-µm aperture). Reducing beam clipping at the spatially extended structures, the low-magnification STEM mode (LM-STEM) is used in the experiments, achieving an electron focal spot sizes of &lt; 25 nm. The beam is held fixed above the sample surface (Fig. 3, e.g. 100-200 nm distance) or raster scanned (Fig. 2&amp;4, 30-ms dwell time). The event-based spectral analysis of the transmitted electron beam is described below.</p>
        <p>The photons generated at the mounted microresonator are guided to the detectors through standard single-mode patch cables (SMF-28). We carried out an evaluation on existing photon loss channels between the generation and detection, including fiber transmission and detection efficiencies (table see SI), leading to a full transmission and detection probability of 0.3(2)%. The spectral detection bandwidth of the optical setup is mainly given by the wavelength-dependent coupling efficiency between the resonator and the bus waveguide as well as the detection bandwidth of the detectors.The photons generated at the mounted microresonator are guided to the detectors through standard single-mode patch cables (SMF-28). We carried out an evaluation on existing photon loss channels between the generation and detection, including fiber transmission and detection efficiencies (table see SI), leading to a full transmission and detection probability of 0.3(2)%. The spectral detection bandwidth of the optical setup is mainly given by the wavelength-dependent coupling efficiency between the resonator and the bus waveguide as well as the detection bandwidth of the detectors.</p>
        <p>The optical spectra shown in Fig. 2b are measured using a Czerny-Turner spectrometer (Horiba iHR550, 600 l/mm grating, 50 µm slit width, 0.4 nm estimated spectral resolution) with a fiber adapter and a liquid nitrogen cooled, NIR sensitive InGaAs camera (Horiba Symphony II, 512×1 pixel, 50-µm pixel size, 800-1650 nm detection bandwidth). Spectral calibration was performed with a strongly attenuated fiber-coupled and tunable continuous-wave (cw) laser (Toptica, CTL 1550).The optical spectra shown in Fig. 2b are measured using a Czerny-Turner spectrometer (Horiba iHR550, 600 l/mm grating, 50 µm slit width, 0.4 nm estimated spectral resolution) with a fiber adapter and a liquid nitrogen cooled, NIR sensitive InGaAs camera (Horiba Symphony II, 512×1 pixel, 50-µm pixel size, 800-1650 nm detection bandwidth). Spectral calibration was performed with a strongly attenuated fiber-coupled and tunable continuous-wave (cw) laser (Toptica, CTL 1550).</p>
        <p>All further experiments are conducted with a single-photon avalanche diode (SPAD ID230, IDQuantique SA, 900-1700 nm full detection bandwidth) operated in Geiger mode and cooled to -90 • C. The detector is set to a detection efficiency of &gt; 25% (1560 nm wavelength, specified by the manufacturer). Adjusting for the overall photon count rate, the detector dead time is set either to 10 or 50 µs, resulting in dark count rates of 2000 cts/s or 130 cts/s, respectively, reaching the specified intrinsic dark count rates. At high count rates, detector saturation is corrected for the data shown in Fig. 2 (see SI). The photon arrival at the SPAD is translated to a LV-TTL signal (≈ 150-ps resolution, 100-ns pulse width) and passed to the event-based electron detector for further counting and correlation.All further experiments are conducted with a single-photon avalanche diode (SPAD ID230, IDQuantique SA, 900-1700 nm full detection bandwidth) operated in Geiger mode and cooled to -90 • C. The detector is set to a detection efficiency of &gt; 25% (1560 nm wavelength, specified by the manufacturer). Adjusting for the overall photon count rate, the detector dead time is set either to 10 or 50 µs, resulting in dark count rates of 2000 cts/s or 130 cts/s, respectively, reaching the specified intrinsic dark count rates. At high count rates, detector saturation is corrected for the data shown in Fig. 2 (see SI). The photon arrival at the SPAD is translated to a LV-TTL signal (≈ 150-ps resolution, 100-ns pulse width) and passed to the event-based electron detector for further counting and correlation.</p>
        <p>For optical mode filtering, the reflection from a manually tunable fiber Bragg grating (FBG, Advanced Optics Solutions GmbH, 1540-1550 nm tuning range, bandwidth FWHM ∼100 GHz ) is employed (along with a circulator). The FBG leads to an overall loss of about 50% (see SI). For pre-alignment of the FBG to a resonance, we connect the cw laser to the other side of the resonator bus waveguide while observing the transmission signal on a photodiode. Precise tuning is done by optimizing the SPAD signal, excluding potential thermal drifts of the resonance wavelength induced by the laser. We note, that the ratio of the single-and multi-mode count rates at the resonator position (cf. Fig. 2d) indicates that about 100 modes contribute to the unfiltered map shown in Fig. 2c.For optical mode filtering, the reflection from a manually tunable fiber Bragg grating (FBG, Advanced Optics Solutions GmbH, 1540-1550 nm tuning range, bandwidth FWHM ∼100 GHz ) is employed (along with a circulator). The FBG leads to an overall loss of about 50% (see SI). For pre-alignment of the FBG to a resonance, we connect the cw laser to the other side of the resonator bus waveguide while observing the transmission signal on a photodiode. Precise tuning is done by optimizing the SPAD signal, excluding potential thermal drifts of the resonance wavelength induced by the laser. We note, that the ratio of the single-and multi-mode count rates at the resonator position (cf. Fig. 2d) indicates that about 100 modes contribute to the unfiltered map shown in Fig. 2c.</p>
        <p>The experiments measuring single particles are performed using a commercial hybrid pixel electron detector based on the Timepix3 ASIC (EM CheeTah T3, Amsterdam Scientific Instruments B.V.) mounted behind an energy-dispersive spectrometer (CEFID, CEOS GmbH). The camera generates a stream of data packages containing the position and timing of electron-activated detector pixels digitized with 1.56-ns time bins. Additional data packages are generated from the internally synchronized LV-TTL input at one of two Time-to-Digital-Converters (TDCs) of the SPIDR readout system with ∼260-ps timing precision. Hereby, an external synchronization of the electron arrival time and photon counts at the SPAD becomes possible using the joint global time stamp of the detector and TDC channels. Technologically, event-based imaging in electron microscopy enables new experimental concept, including background suppression in X-ray spectroscopy [66], continuous illumination picosecond imaging [72] and dose-optimized high-speed STEM [73,74].The experiments measuring single particles are performed using a commercial hybrid pixel electron detector based on the Timepix3 ASIC (EM CheeTah T3, Amsterdam Scientific Instruments B.V.) mounted behind an energy-dispersive spectrometer (CEFID, CEOS GmbH). The camera generates a stream of data packages containing the position and timing of electron-activated detector pixels digitized with 1.56-ns time bins. Additional data packages are generated from the internally synchronized LV-TTL input at one of two Time-to-Digital-Converters (TDCs) of the SPIDR readout system with ∼260-ps timing precision. Hereby, an external synchronization of the electron arrival time and photon counts at the SPAD becomes possible using the joint global time stamp of the detector and TDC channels. Technologically, event-based imaging in electron microscopy enables new experimental concept, including background suppression in X-ray spectroscopy [66], continuous illumination picosecond imaging [72] and dose-optimized high-speed STEM [73,74].</p>
        <p>Each image pixel shows a fixed timing offset relative to the mean detector response, that must be determined for precise measurement of the time of arrival (ToA) of the electrons [75]. This perpixel calibration is performed with a pulsed electron beam generated by photoemission using a femtosecond laser amplifier (Pharos, Light Conversion). Considering the sub-picosecond electron pulses generated [71] and a &lt;500-ps timing jitter of the laser trigger output, a sub-ns timing precision is achieved. Specifically, the average offset in time of arrival is determined for integrating 1750 hits per pixel, showing a spread of up to 8 ns in the raw data over the entire four-quadrant detector (512×512 pixel) that can be corrected for.Each image pixel shows a fixed timing offset relative to the mean detector response, that must be determined for precise measurement of the time of arrival (ToA) of the electrons [75]. This perpixel calibration is performed with a pulsed electron beam generated by photoemission using a femtosecond laser amplifier (Pharos, Light Conversion). Considering the sub-picosecond electron pulses generated [71] and a &lt;500-ps timing jitter of the laser trigger output, a sub-ns timing precision is achieved. Specifically, the average offset in time of arrival is determined for integrating 1750 hits per pixel, showing a spread of up to 8 ns in the raw data over the entire four-quadrant detector (512×512 pixel) that can be corrected for.</p>
        <p>In the analysis of electron-photon correlations, all electrongenerated detector hits are tagged with their relative timing to the closest TDC data packet from the SPAD output. For the different experiments, the dead time of the SPAD was chosen between 10 µs and 50 µs and only hits within 600-ns relative timing are taken for the further data analysis. Therefore, all considered electrons can be uniquely assigned to specific photon counts of the SPAD.In the analysis of electron-photon correlations, all electrongenerated detector hits are tagged with their relative timing to the closest TDC data packet from the SPAD output. For the different experiments, the dead time of the SPAD was chosen between 10 µs and 50 µs and only hits within 600-ns relative timing are taken for the further data analysis. Therefore, all considered electrons can be uniquely assigned to specific photon counts of the SPAD.</p>
        <p>Single-particle clustering using the k-means++ clusters algorithm (implemented in 
            <rs type="software">MATLAB</rs>
            <rs type="version">2020b</rs>, 
            <rs type="creator">MathWorks Inc</rs>.) is applied on the stream of detector hits to form event clusters, each representing a single electron. At 120-keV beam energy, the maximum distance of hits in a cluster is set to 5 pixels or 125 ns, preventing mixing of events and maintaining the multi-hit capability of the detector. Event localization is performed by retrieving the arithmetic mean position and the earliest arrival time of all hits within a cluster. The overall electron current on the detector is estimated by the number of hits per time and typical cluster-size distribution at 120 kev (on average 4 hits per cluster, detector saturation at 120 MHit/s or 4.8 pA for homogeneous illumination).
        </p>
        <p>Finally, a 2D histogram of the electron energy and the relative TDC timings results in the plots shown in Figure 3a&amp;b. The data is binned in time units of the TDC channels of ∼ 260 ps (1/3.84 GHz) and the spectral pixel size of 0.11 eV/px. The overall temporal width of the correlation peak of 3.91 ns (FWHM, see Fig. 3c) is mostly determined by strong variations in cluster size and shape for high-energy electrons and might be improved in future studies using advanced clustering methods considering real particle traces (cf. Ref. [76]). The absolute electronic and propagation delays are subtracted for clarity and the data is centered in time around the peak of correlated events. Residual 50-Hz and further uncorrelated timing jitter in the experiment is corrected in the energy disperse axis by considering the uncorrelated electron background with 100µs time bins.Finally, a 2D histogram of the electron energy and the relative TDC timings results in the plots shown in Figure 3a&amp;b. The data is binned in time units of the TDC channels of ∼ 260 ps (1/3.84 GHz) and the spectral pixel size of 0.11 eV/px. The overall temporal width of the correlation peak of 3.91 ns (FWHM, see Fig. 3c) is mostly determined by strong variations in cluster size and shape for high-energy electrons and might be improved in future studies using advanced clustering methods considering real particle traces (cf. Ref. [76]). The absolute electronic and propagation delays are subtracted for clarity and the data is centered in time around the peak of correlated events. Residual 50-Hz and further uncorrelated timing jitter in the experiment is corrected in the energy disperse axis by considering the uncorrelated electron background with 100µs time bins.</p>
        <p>The efficiency of the heralding scheme can be estimated using the Klyshko heralding efficiency (also called total heralding efficiency) η i K = Rpe/R j (i, j=e, p, i = j) and the intrinsic heralding efficiency η i I = η i K /(η i D T i ) [4], with the measured rates of electrons Re, photons Rp and correlated events Rpe. While the intrinsic heralding efficiency describes the probability of a pair generation source, in our case the resonator as electron-cavity interaction region, to produce a particle pair, the Klyshko efficiency adds the particle losses due to the setup. The various sources of photon loss in the measurement setup, consisting of coupling efficiency from the resonator to the bus waveguide, various fiber coupling and propagation losses, SPAD detection efficiency, saturation losses and overlap with the expected photon bandwidth, as well as losses due to photons scattered into the backwards-propagating direction, were analysed individually, taking into account the respective error margins (see SI). On the electron side, the quantum efficiency of the event-based electron detector is calibrated by measuring the electron beam current at the entrance of the EELS spectrometer. Further transmission losses of electrons may include partial clipping of the beam at the photonic chip itself, or at apertures along the way to the detector. These were not included in the analysis since no precise current measurement is available at the sample position, which may lead to an underestimation of the intrinsic heralding efficiency η e I . We estimate an intrinsic photon heralding efficiency η p I reaching 49(21)%, with larger uncertainties to be studied in future experiments (see SI). Considering known loss channels, for heralding single electrons, we experimentally retrieve an intrinsic heralding efficiency η e I above 63(10)%.The efficiency of the heralding scheme can be estimated using the Klyshko heralding efficiency (also called total heralding efficiency) η i K = Rpe/R j (i, j=e, p, i = j) and the intrinsic heralding efficiency η i I = η i K /(η i D T i ) [4], with the measured rates of electrons Re, photons Rp and correlated events Rpe. While the intrinsic heralding efficiency describes the probability of a pair generation source, in our case the resonator as electron-cavity interaction region, to produce a particle pair, the Klyshko efficiency adds the particle losses due to the setup. The various sources of photon loss in the measurement setup, consisting of coupling efficiency from the resonator to the bus waveguide, various fiber coupling and propagation losses, SPAD detection efficiency, saturation losses and overlap with the expected photon bandwidth, as well as losses due to photons scattered into the backwards-propagating direction, were analysed individually, taking into account the respective error margins (see SI). On the electron side, the quantum efficiency of the event-based electron detector is calibrated by measuring the electron beam current at the entrance of the EELS spectrometer. Further transmission losses of electrons may include partial clipping of the beam at the photonic chip itself, or at apertures along the way to the detector. These were not included in the analysis since no precise current measurement is available at the sample position, which may lead to an underestimation of the intrinsic heralding efficiency η e I . We estimate an intrinsic photon heralding efficiency η p I reaching 49(21)%, with larger uncertainties to be studied in future experiments (see SI). Considering known loss channels, for heralding single electrons, we experimentally retrieve an intrinsic heralding efficiency η e I above 63(10)%.</p>
        <p>We thank R. Haindl and E. Maddox for discussions on the timing calibration and event clustering. We thank M. Möller for the support on the STEM alignment. We thank J. Borchert and T. Weitz for providing us with the NIR liquid-nitrogen cooled spectrometer. We thank members of the eBEAM consortium, in particular A. Polman, F. J. García de Abajo, N. Talebi, J. Verbeeck, and M. Kociak, for useful discussions and feedback. Funding Information: All samples were fabricated in the Center of MicroNanoTechnology (CMi) at EPFL. This material is based upon work supported by the Air Force Office of Scientific Research under award number FA9550-19-1-0250. This work was further supported by the Swiss National Science Foundation under grant agreements 185870 (Ambizione), 182103 and 176563 (BRIDGE). The work at the Göttingen UTEM Lab was funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) through 432680300/SFB 1456 (project C01) and the Gottfried Wilhelm Leibniz program, and the European Union's Horizon 2020 research and innovation programme under grant agreement No. 101017720 (FET-Proactive EBEAM). Y.Y. acknowledges support from the EU H2020 research and innovation program under the Marie Sklodowska-Curie IF grant agreement No. 101033593 (SEPhIM). O.K. acknowledges the Max Planck Society for funding from the Manfred Eigen Fellowship for postdoctoral fellows from abroad.We thank R. Haindl and E. Maddox for discussions on the timing calibration and event clustering. We thank M. Möller for the support on the STEM alignment. We thank J. Borchert and T. Weitz for providing us with the NIR liquid-nitrogen cooled spectrometer. We thank members of the eBEAM consortium, in particular A. Polman, F. J. García de Abajo, N. Talebi, J. Verbeeck, and M. Kociak, for useful discussions and feedback. Funding Information: All samples were fabricated in the Center of MicroNanoTechnology (CMi) at EPFL. This material is based upon work supported by the Air Force Office of Scientific Research under award number FA9550-19-1-0250. This work was further supported by the Swiss National Science Foundation under grant agreements 185870 (Ambizione), 182103 and 176563 (BRIDGE). The work at the Göttingen UTEM Lab was funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) through 432680300/SFB 1456 (project C01) and the Gottfried Wilhelm Leibniz program, and the European Union's Horizon 2020 research and innovation programme under grant agreement No. 101017720 (FET-Proactive EBEAM). Y.Y. acknowledges support from the EU H2020 research and innovation program under the Marie Sklodowska-Curie IF grant agreement No. 101033593 (SEPhIM). O.K. acknowledges the Max Planck Society for funding from the Manfred Eigen Fellowship for postdoctoral fellows from abroad.</p>
        <p>The code and data used to produce the plots within this work will be released on the repository Zenodo upon publication of this preprint.The code and data used to produce the plots within this work will be released on the repository Zenodo upon publication of this preprint.</p>
        <p>Additional information: Correspondence and requests for materials should be addressed to C.R. and T.J.K. (claus.ropers@mpinat.mpg.de, tobias.kippenberg@epfl.ch)Additional information: Correspondence and requests for materials should be addressed to C.R. and T.J.K. (claus.ropers@mpinat.mpg.de, tobias.kippenberg@epfl.ch)</p>
        <p>Competing financial interests: The authors declare no competing financial interests.Competing financial interests: The authors declare no competing financial interests.</p>
    </text>
</tei>
