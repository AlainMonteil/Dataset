<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-13T14:05+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>
            <rs type="software">RPANDA</rs> provides investigators with a set of tools for exploring patterns in phylogenetic trees and fitting various models to these trees, thereby contributing to the on-going development of phylogenetics in the life sciences.
        </p>
        <p>A number of approaches for studying macroevolution using phylogenetic trees have been developed in the last few years. Here, we present 
            <rs type="software">RPANDA</rs>, an 
            <rs type="software">R</rs> package that implements model-free and model-based phylogenetic comparative methods for macroevolutionary analyses.
        </p>
        <p>The model-free approaches implemented in 
            <rs type="software">RPANDA</rs> are recently developed approaches stemming from graph theory that allow summarizing the information contained in phylogenetic trees, computing distances between trees, and clustering them accordingly. They also allow identifying distinct branching patterns within single trees.
        </p>
        <p>
            <rs type="software">RPANDA</rs> also implements likelihood-based models for fitting various diversification models to phylogenetic trees. It includes birth-death models with i) constant, ii) time-dependent, and iii) environmental-dependent speciation and extinction rates. It also includes models with equilibrium diversity derived from the coalescent process, as well as a likelihood-based inference framework to fit the individual-based model of Speciation by Genetic Differentiation, which is an extension of Hubbell's Neutral Theory of Biodiversity.
        </p>
        <p>
            <rs type="software">RPANDA</rs> can be used to: i) characterise trees by plotting their spectral density profiles ii) compare trees and cluster them according to their similarities, iii) identify and plot distinct branching patterns within trees, iv) compare the fit of alternative diversification models to phylogenetic trees, ii) estimate rates of speciation and extinction, iii) estimate and plot how these rates have varied with time and environmental variables, and iv) deduce and plot estimates of species richness through geological time.
        </p>
        <p>Phylogenetic approaches have become a central component of various areas of the life sciences. A number of packages are available to handle and utilise phylogenetic trees (e.g. 'ape ' Paradis et al. 2004), in order to understand, for example, community assembly (e.g. 'picante ' Kembel et al. 2010, 'DAMOCLES ' Pigot &amp; Etienne 2015), trait evolution (e.g.Phylogenetic approaches have become a central component of various areas of the life sciences. A number of packages are available to handle and utilise phylogenetic trees (e.g. 'ape ' Paradis et al. 2004), in order to understand, for example, community assembly (e.g. 'picante ' Kembel et al. 2010, 'DAMOCLES ' Pigot &amp; Etienne 2015), trait evolution (e.g.</p>
        <p>'Coevol ' Lartillot &amp; Poujol 2011, 'geiger' Pennell et al. 2014), and diversification (e.g.'Coevol ' Lartillot &amp; Poujol 2011, 'geiger' Pennell et al. 2014), and diversification (e.g.</p>
        <p>'BayesRate ' Silvestro et al. 2011, 'TreePar' Stadler 2011a, 'diversitree' Fitzjohn 2012, 'DDD' Etienne et al. 2012, 'geiger' Pennell et al. 2014, 'BAMM' Rabosky et al. 2014).'BayesRate ' Silvestro et al. 2011, 'TreePar' Stadler 2011a, 'diversitree' Fitzjohn 2012, 'DDD' Etienne et al. 2012, 'geiger' Pennell et al. 2014, 'BAMM' Rabosky et al. 2014).</p>
        <p>Here, we present and describe the 
            <rs type="software">R</rs> package 
            <rs type="software">RPANDA</rs>, which implements both model-free and model-based phylogenetic approaches that are not implemented in previous packages. The model-free approaches are inspired from graph theory and described in detail in Lewitus &amp; Morlon (2015). They are designed to compare and classify phylogenetic trees without any a priori formulation of a model of cladogenesis underlying tree shape. The model-based approaches aim to fit various models of cladogenesis to phylogenetic trees by maximum likelihood. They are described in detail in Morlon et al. (2010Morlon et al. ( , 2011)), Condamine et al. (2013) and Manceau et al. (2015).
        </p>
        <p>Within the category of model-based approaches, the package includes three main classes of models: birth-death models, coalescent models, and individual-based models (see Morlon 2014 for a review of these three different types of models). Birth-death models are those that were originally considered by Nee et al. (1992) and are at the basis of most diversification models used today. The present package allows fitting of birth-death models: i) with speciation and extinction rates varying as a function of time, with any type of functional form and with potential periods of diversity decline (Morlon et al. 2011), and ii) with speciation and extinction rates varying as a function of any variable that has been measured through geological time (e.g., temperature, Condamine et al. 2013). Models based on the coalescent process were designed to consider scenarios of equilibrium diversity (Morlon et al. 2010). Finally, individual-based models have been extensively studied in ecology, but likelihood-based inferences from phylogenies are typically not available. The present package allows likelihood inference for the model of Speciation by Genetic Differentiation (Manceau et al. 2015), which is an extension of the Neutral Theory of Biodiversity (Hubbell 2001).Within the category of model-based approaches, the package includes three main classes of models: birth-death models, coalescent models, and individual-based models (see Morlon 2014 for a review of these three different types of models). Birth-death models are those that were originally considered by Nee et al. (1992) and are at the basis of most diversification models used today. The present package allows fitting of birth-death models: i) with speciation and extinction rates varying as a function of time, with any type of functional form and with potential periods of diversity decline (Morlon et al. 2011), and ii) with speciation and extinction rates varying as a function of any variable that has been measured through geological time (e.g., temperature, Condamine et al. 2013). Models based on the coalescent process were designed to consider scenarios of equilibrium diversity (Morlon et al. 2010). Finally, individual-based models have been extensively studied in ecology, but likelihood-based inferences from phylogenies are typically not available. The present package allows likelihood inference for the model of Speciation by Genetic Differentiation (Manceau et al. 2015), which is an extension of the Neutral Theory of Biodiversity (Hubbell 2001).</p>
        <p>
            <rs type="software">RPANDA</rs> is an 
            <rs type="software">R</rs> package (
            <rs type="creator">R Development Core Team</rs> 2014) than can be installed from the 
            <rs type="software">CRAN</rs> repository (
            <rs type="url">http://cran.r-project.org)</rs>. 
            <rs type="software">RPANDA</rs> relies on the 
            <rs type="software">R</rs> packages '
            <rs type="software">ape</rs>' (Paradis et al. 2004), '
            <rs type="software">picante</rs>' (Kembel et al. 2010), '
            <rs type="software">phytools</rs>' (Revell 2012), '
            <rs type="software">deSolve</rs>' (Soetaert et al. 2010), and '
            <rs type="software">igraph</rs>' (Csardi &amp; Nepusz 2006).
        </p>
        <p>The main functions of the package are listed in 'Phyllostomidae' is the family-level phylogeny and 'Phyllostomidae_genera' is a list of 25 phylogenies corresponding to Phyllostomidae genera with more than one species.The main functions of the package are listed in 'Phyllostomidae' is the family-level phylogeny and 'Phyllostomidae_genera' is a list of 25 phylogenies corresponding to Phyllostomidae genera with more than one species.</p>
        <p>We recently developed a new approach, described in detail in Lewitus &amp; Morlon (2015), to efficiently summarize the shape of a phylogenetic tree. This approach can be used to measure similarities between trees and to cluster them accordingly, for example in order to identify phylogenies shaped by similar versus dissimilar diversification patterns. It can also help in identifying regions of a tree that have distinct branching patterns, which can for example reflect shifts in modes or rates of diversification. We summarize the shape of a phylogeny by its spectral density, which is a smoothed version of the frequencies of eigenvalues associated with a matrix (the graph Laplacian) built from the pairwise phylogenetic distances between nodes (see Lewitus &amp; Morlon 2015 for a more detailed description). The function 
            <rs type="software">spectR</rs> computes the eigenvalues associated with a given phylogeny, and characteristics associated with the spectrum of eigenvalues, namely the principal eigenvalue, asymmetry (skewness), two measures of peakedness (kurtosis and peak height), and eigengap. The eigengap is given by the position of the largest difference between successive eigenvalues listed in descending order. This number is related to the number of peaks in the spectral density plot and is indicative of the number of modalities (i.e. distinct branching patterns) in a phylogeny.
        </p>
        <p>&gt; res&lt;-spectR(Phyllostomidae)&gt; res&lt;-spectR(Phyllostomidae)</p>
        <p>returns the above information for the Phyllostomidae phylogeny. In particular, res$eigengap returns the number of modalities, suggesting three distinct branching patterns in this bat family.returns the above information for the Phyllostomidae phylogeny. In particular, res$eigengap returns the number of modalities, suggesting three distinct branching patterns in this bat family.</p>
        <p>displays the spectral density profile and a plot of the eigenvalues ranked in descending order (Figure 1).displays the spectral density profile and a plot of the eigenvalues ranked in descending order (Figure 1).</p>
        <p>Once the putative number of modalities is identified, the BICompare function can be used to assess the significance of these modalities and to identify their location on the phylogeny. The statistical significance of the modalities is assessed by comparing the Bayesian Information Criterion (BIC) for detecting i clusters in the distance matrix of the empirical phylogeny and in randomly bifurcating trees parameterized on that tree (Lewitus &amp; Morlon 2015). The function also identifies the location of the distinct branching patterns on the phylogeny by k-means clustering and returns the ratio of between-cluster sum of squares (BSS) to total sum of squares (TSS) for the clustering identified by the algorithm. The highest the BSS/TSS ratio, the more distinct the modalities are from each other. Different iterations of the k-means clustering algorithm can lead to different modality configurations, and BSS/TSS values allow the comparison between these configurations (configurations with high BSS/TSS should be preferred).Once the putative number of modalities is identified, the BICompare function can be used to assess the significance of these modalities and to identify their location on the phylogeny. The statistical significance of the modalities is assessed by comparing the Bayesian Information Criterion (BIC) for detecting i clusters in the distance matrix of the empirical phylogeny and in randomly bifurcating trees parameterized on that tree (Lewitus &amp; Morlon 2015). The function also identifies the location of the distinct branching patterns on the phylogeny by k-means clustering and returns the ratio of between-cluster sum of squares (BSS) to total sum of squares (TSS) for the clustering identified by the algorithm. The highest the BSS/TSS ratio, the more distinct the modalities are from each other. Different iterations of the k-means clustering algorithm can lead to different modality configurations, and BSS/TSS values allow the comparison between these configurations (configurations with high BSS/TSS should be preferred).</p>
        <p>&gt; res&lt;-BICompare(Phyllostomidae,3)&gt; res&lt;-BICompare(Phyllostomidae,3)</p>
        <p>returns the above information for the Phyllostomidae phylogeny. The BIC score for the Phyllostomidae phylogeny is nearly a magnitude smaller than it is for the randomly bifurcating trees parameterized on that phylogeny, suggesting that the three modalities are significant. Typically, a BIC ratio ≤ 0.25 is deemed significant.returns the above information for the Phyllostomidae phylogeny. The BIC score for the Phyllostomidae phylogeny is nearly a magnitude smaller than it is for the randomly bifurcating trees parameterized on that phylogeny, suggesting that the three modalities are significant. Typically, a BIC ratio ≤ 0.25 is deemed significant.</p>
        <p>&gt; plot_BICompare(Phyllostomidae,res)&gt; plot_BICompare(Phyllostomidae,res)</p>
        <p>displays the Phyllostomidae phylogeny with branches coloured according to the modality they belong to, as assessed by the k-means clustering algorithm (Figure 2).displays the Phyllostomidae phylogeny with branches coloured according to the modality they belong to, as assessed by the k-means clustering algorithm (Figure 2).</p>
        <p>Spectral densities are particularly useful for comparing phylogenies. The JSDtree function computes the pairwise distances between a list of phylogenies, measured as the Jensen-Shannon distance between their spectral densities. The JSDtree_cluster function uses these pairwise distances (or potentially other distance metrics) to cluster phylogenies into groups. The clustering is implemented using the hierarchical clustering and k-medoid clustering algorithms. To illustrate this approach, we compare the 25 phylogenies corresponding to Phyllostomidae genera with more than one species.Spectral densities are particularly useful for comparing phylogenies. The JSDtree function computes the pairwise distances between a list of phylogenies, measured as the Jensen-Shannon distance between their spectral densities. The JSDtree_cluster function uses these pairwise distances (or potentially other distance metrics) to cluster phylogenies into groups. The clustering is implemented using the hierarchical clustering and k-medoid clustering algorithms. To illustrate this approach, we compare the 25 phylogenies corresponding to Phyllostomidae genera with more than one species.</p>
        <p>&gt; res&lt;-JSDtree(Phyllostomidae_genera)&gt; res&lt;-JSDtree(Phyllostomidae_genera)</p>
        <p>returns the matrix containing the pairwise Jensen-Shannon distances between the 25 phylogenies.returns the matrix containing the pairwise Jensen-Shannon distances between the 25 phylogenies.</p>
        <p>&gt; JSDtree_cluster(res)&gt; JSDtree_cluster(res)</p>
        <p>plots the heatmap and hierarchical cluster (Figure 3) as well as the hierarchical cluster with bootstrap support (not shown here). It also returns the optimal number of clusters given by the k-medoids algorithm, here suggesting that Phyllostomidae genera cluster into two meaningful groups. The function returns the assignment of each phylogeny to each of the two groups, as well as a measure of statistical support for this assignment.plots the heatmap and hierarchical cluster (Figure 3) as well as the hierarchical cluster with bootstrap support (not shown here). It also returns the optimal number of clusters given by the k-medoids algorithm, here suggesting that Phyllostomidae genera cluster into two meaningful groups. The function returns the assignment of each phylogeny to each of the two groups, as well as a measure of statistical support for this assignment.</p>
        <p>One of the most popular approaches for analysing the diversification of clades consists in fitting various models of diversification to molecular phylogenies using maximum likelihood inference, comparing the likelihood support of the different models, and estimating the parameters of the model (see (Stadler 2011b) and TESS (Höhna 2013). The one exception is the sim_sgd function that simulates phylogenies under the model of Speciation by Genetic Differentiation (Manceau et al. 2015).One of the most popular approaches for analysing the diversification of clades consists in fitting various models of diversification to molecular phylogenies using maximum likelihood inference, comparing the likelihood support of the different models, and estimating the parameters of the model (see (Stadler 2011b) and TESS (Höhna 2013). The one exception is the sim_sgd function that simulates phylogenies under the model of Speciation by Genetic Differentiation (Manceau et al. 2015).</p>
        <p>Fitting a diversification model to a phylogeny consists in finding the parameters that maximize the likelihood associated with the model. The 'fit' functions, therefore, take as argument, at minimum, a phylogeny (phylo), initial parameter values (par), and the maximization algorithm to be used (meth). The various likelihood expressions all depend on the fraction of extant species that are sampled in the phylogeny; this fraction (f), therefore, also needs to be specified. Finally, tot_time specifies the age of the phylogeny. We often have access only to the crown age, in which case tot_time is given by max(node.age(phylo)$ages). If the stem age is known, specifying this older age in tot_time can provide a different and complementary inference.Fitting a diversification model to a phylogeny consists in finding the parameters that maximize the likelihood associated with the model. The 'fit' functions, therefore, take as argument, at minimum, a phylogeny (phylo), initial parameter values (par), and the maximization algorithm to be used (meth). The various likelihood expressions all depend on the fraction of extant species that are sampled in the phylogeny; this fraction (f), therefore, also needs to be specified. Finally, tot_time specifies the age of the phylogeny. We often have access only to the crown age, in which case tot_time is given by max(node.age(phylo)$ages). If the stem age is known, specifying this older age in tot_time can provide a different and complementary inference.</p>
        <p>RPANDA can be used to test whether (and how) diversification rates varied through time (Morlon et al. 2011). To illustrate the approach we fit a birth-death model with time-varying rates to the Phyllostomidae phylogeny. We first need to specify the assumed functional form of the time-dependency. For example, if we want to fit a model with an exponential variation of the speciation rate with time (f.lamb), and a constant extinction rate (f.mu), we define these functions as follows: Finally, we fit the model by maximum likelihood using the following command:RPANDA can be used to test whether (and how) diversification rates varied through time (Morlon et al. 2011). To illustrate the approach we fit a birth-death model with time-varying rates to the Phyllostomidae phylogeny. We first need to specify the assumed functional form of the time-dependency. For example, if we want to fit a model with an exponential variation of the speciation rate with time (f.lamb), and a constant extinction rate (f.mu), we define these functions as follows: Finally, we fit the model by maximum likelihood using the following command:</p>
        <p>&gt; res&lt;-fit_bd(Phyllostomidae,tot_time,f.lamb,f.mu,lamb_par_init, mu_par_init,f=150/165,expo.lamb=TRUE,cst.mu=TRUE)&gt; res&lt;-fit_bd(Phyllostomidae,tot_time,f.lamb,f.mu,lamb_par_init, mu_par_init,f=150/165,expo.lamb=TRUE,cst.mu=TRUE)</p>
        <p>The two options expo.lamb=TRUE and cst.mu=TRUE are set to TRUE to speed up the computation by using analytical solutions; such solutions have been implemented for exponential, linear, and constant functions. If the options are set to TRUE when the time-dependency is not of the proper form (exponential, linear, or constant), the code will not return the proper answer. When in doubt, it is better to prefer the default FALSE option. There is an additional dt option (not used in the examples here) that can also speed up the computation by using piecewise constant approximations in the computation of the integrals. There is also an option that specifies whether we are working with crown or stem ages, which has consequences for the conditioning that should be used in the computation of the likelihood: the process should be conditioned on survival when working with stem ages, and conditioned on a speciation event at the crown and survival of the two descending lines when working with crown ages (Morlon et al. 2011). The default (used here) is the cond="crown" option, but it should be set to cond="stem" if tot_time is the stem age. The output res of the fit contains the maximum log-likelihood value (-469.36), the corrected Akaike information criterion (AICc) (944.89), and the maximum likelihood parameter estimates. For example, &gt; res$lamb_par [1] returns the maximum parameter estimate of y[1], which is the speciation rate at time t=0 , i.e. the present (here 0.099).The two options expo.lamb=TRUE and cst.mu=TRUE are set to TRUE to speed up the computation by using analytical solutions; such solutions have been implemented for exponential, linear, and constant functions. If the options are set to TRUE when the time-dependency is not of the proper form (exponential, linear, or constant), the code will not return the proper answer. When in doubt, it is better to prefer the default FALSE option. There is an additional dt option (not used in the examples here) that can also speed up the computation by using piecewise constant approximations in the computation of the integrals. There is also an option that specifies whether we are working with crown or stem ages, which has consequences for the conditioning that should be used in the computation of the likelihood: the process should be conditioned on survival when working with stem ages, and conditioned on a speciation event at the crown and survival of the two descending lines when working with crown ages (Morlon et al. 2011). The default (used here) is the cond="crown" option, but it should be set to cond="stem" if tot_time is the stem age. The output res of the fit contains the maximum log-likelihood value (-469.36), the corrected Akaike information criterion (AICc) (944.89), and the maximum likelihood parameter estimates. For example, &gt; res$lamb_par [1] returns the maximum parameter estimate of y[1], which is the speciation rate at time t=0 , i.e. the present (here 0.099).</p>
        <p>&gt; res$lamb_par [2] returns the maximum parameter estimate of y[2], which is the rate of change in speciation rate, with time running from the present to the past (here 0.022). A positive rate of change with time running from the present to the past -as estimated heresuggests a negative rate of change (decline in speciation rate) during the clade's history.&gt; res$lamb_par [2] returns the maximum parameter estimate of y[2], which is the rate of change in speciation rate, with time running from the present to the past (here 0.022). A positive rate of change with time running from the present to the past -as estimated heresuggests a negative rate of change (decline in speciation rate) during the clade's history.</p>
        <p>&gt; plot_fit_bd(res,tot_time)&gt; plot_fit_bd(res,tot_time)</p>
        <p>returns three plots, which represent speciation, extinction and net diversification (i.e.returns three plots, which represent speciation, extinction and net diversification (i.e.</p>
        <p>speciation minus extinction) rates through time (Figure 4). If a model without extinction is fitted:speciation minus extinction) rates through time (Figure 4). If a model without extinction is fitted:</p>
        <p>&gt; res_noext&lt;-fit_bd(Phyllostomidae,tot_time,f.lamb,f.mu, lamb_par_init,mu_par_init,f=150/165,expo.lamb=TRUE,fix.mu=TRUE) &gt; plot_fit_bd(res_noext,tot_time)&gt; res_noext&lt;-fit_bd(Phyllostomidae,tot_time,f.lamb,f.mu, lamb_par_init,mu_par_init,f=150/165,expo.lamb=TRUE,fix.mu=TRUE) &gt; plot_fit_bd(res_noext,tot_time)</p>
        <p>returns two plots, which represent speciation and net diversification rates through time (in this case, these two rates are equal).returns two plots, which represent speciation and net diversification rates through time (in this case, these two rates are equal).</p>
        <p>Once estimates of the temporal variation in speciation and extinction rates have been obtained (as described above), estimates of how species richness varied through time can be computed by resolving the appropriate differential equation (Morlon et al. 2011;Morlon 2014).Once estimates of the temporal variation in speciation and extinction rates have been obtained (as described above), estimates of how species richness varied through time can be computed by resolving the appropriate differential equation (Morlon et al. 2011;Morlon 2014).</p>
        <p>&gt; plot_dtt(res,tot_time,N0=165)&gt; plot_dtt(res,tot_time,N0=165)</p>
        <p>plots the result of this estimation procedure, as illustrated in Figure 5.plots the result of this estimation procedure, as illustrated in Figure 5.</p>
        <p>RPANDA can also be used to test the potential effect that past environmental conditions had on diversification (Condamine et al. 2013). Fitting the environmental-dependent birth-death model is very similar to fitting the time-dependent birth-death model. In addition to a phylogeny, this model requires knowledge (typically an estimate) of how a given environmental variable varied through time. The example provided in RPANDA is temperature variation through the Cenozoic, estimated using oxygen isotope ratios (Zachos et al. 2008). We begin by loading the temperature data:RPANDA can also be used to test the potential effect that past environmental conditions had on diversification (Condamine et al. 2013). Fitting the environmental-dependent birth-death model is very similar to fitting the time-dependent birth-death model. In addition to a phylogeny, this model requires knowledge (typically an estimate) of how a given environmental variable varied through time. The example provided in RPANDA is temperature variation through the Cenozoic, estimated using oxygen isotope ratios (Zachos et al. 2008). We begin by loading the temperature data:</p>
        <p>InfTemp is a two-column dataframe in which the first column reports time (measured from the present to the past) and the second column reports the corresponding estimated temperature at each time (Condamine et al. 2013). Any other (abiotic or biotic) environmental variable in this format can be used in place of InfTemp in order to test the potential effect that this variable had on diversification (e.g. sea-level fluctuations, Condamine et al. 2015). Here, diversification rates can depend on time as well as on the environmental variable; the f.lamb and f.mu functions therefore take two arguments (time t and the environmental variable x) in addition to the parameters y to be estimated. We fit a simple model with an exponential dependence of the speciation rate on the environmental variable, no time dependence, and no extinction.InfTemp is a two-column dataframe in which the first column reports time (measured from the present to the past) and the second column reports the corresponding estimated temperature at each time (Condamine et al. 2013). Any other (abiotic or biotic) environmental variable in this format can be used in place of InfTemp in order to test the potential effect that this variable had on diversification (e.g. sea-level fluctuations, Condamine et al. 2015). Here, diversification rates can depend on time as well as on the environmental variable; the f.lamb and f.mu functions therefore take two arguments (time t and the environmental variable x) in addition to the parameters y to be estimated. We fit a simple model with an exponential dependence of the speciation rate on the environmental variable, no time dependence, and no extinction.</p>
        <p>We thus define: returns the maximum parameter estimate of y[1], which is the speciation rate that would correspond to a temperature of 0°C (here 0.077).We thus define: returns the maximum parameter estimate of y[1], which is the speciation rate that would correspond to a temperature of 0°C (here 0.077).</p>
        <p>&gt; res$lamb_par [2] returns the maximum parameter estimate of y[2], which is the rate of change in speciation rate with temperature (here 0.083). A positive value thus suggests a positive effect of the environmental variable (here temperature) on speciation rates.&gt; res$lamb_par [2] returns the maximum parameter estimate of y[2], which is the rate of change in speciation rate with temperature (here 0.083). A positive value thus suggests a positive effect of the environmental variable (here temperature) on speciation rates.</p>
        <p>Note that the environmental model fitted here receives a better support than the model with an exponential dependency of speciation rate with time (∆AICc = 944.89 -940.97 = 3.92).Note that the environmental model fitted here receives a better support than the model with an exponential dependency of speciation rate with time (∆AICc = 944.89 -940.97 = 3.92).</p>
        <p>&gt; plot_fit_env(res,InfTemp,tot_time)&gt; plot_fit_env(res,InfTemp,tot_time)</p>
        <p>plots diversification rates as a function of the environmental variable and time (Figure 6). returns the maximum log-likelihood (-466), the AICc (938), and the estimated birth (1e7), growth (0.157), and mutation (0.198) rates. As explained in Manceau et al. (2015), the likelihood surface is quite flat with respect to the birth rate, such that this parameter cannot be estimated with confidence. Birth rate estimates are thus sensitive to the choice of the initial parameter values and should not be trusted.plots diversification rates as a function of the environmental variable and time (Figure 6). returns the maximum log-likelihood (-466), the AICc (938), and the estimated birth (1e7), growth (0.157), and mutation (0.198) rates. As explained in Manceau et al. (2015), the likelihood surface is quite flat with respect to the birth rate, such that this parameter cannot be estimated with confidence. Birth rate estimates are thus sensitive to the choice of the initial parameter values and should not be trusted.</p>
        <p>sets the initial parameter values defining the f.lamb speciation function, and &gt; mu_par_init&lt;-c(0.005) sets the initial parameter values defining the f.mu extinction function. The result of the fitting procedure should not depend on the choice of the initial parameter values, which can be checked by running the model with several sets of (realistic) initial values. For example, the speciation rate at present (lamb_par_init[1]) typically takes value ranging between 0.01 and 1 (event per lineage, per million years). The rate of variation of the speciation rate (lamb_par_init[2]) can then be chosen such that the resulting speciation rate (output of f.lamb(t,lamb_par_init)) remains within this realistic range throughout the clade history (i.e. for t ranging from 0 to crown or stem age). And finally, the initial extinction parameters set in mu_par_init can be chosen such that the resulting extinction rate (output of f.mu(t,mu_par_init)) is smaller than the speciation rate at the beginning of clade's history (i.e. for t set to the crown or stem age) and remains positivesets the initial parameter values defining the f.lamb speciation function, and &gt; mu_par_init&lt;-c(0.005) sets the initial parameter values defining the f.mu extinction function. The result of the fitting procedure should not depend on the choice of the initial parameter values, which can be checked by running the model with several sets of (realistic) initial values. For example, the speciation rate at present (lamb_par_init[1]) typically takes value ranging between 0.01 and 1 (event per lineage, per million years). The rate of variation of the speciation rate (lamb_par_init[2]) can then be chosen such that the resulting speciation rate (output of f.lamb(t,lamb_par_init)) remains within this realistic range throughout the clade history (i.e. for t ranging from 0 to crown or stem age). And finally, the initial extinction parameters set in mu_par_init can be chosen such that the resulting extinction rate (output of f.mu(t,mu_par_init)) is smaller than the speciation rate at the beginning of clade's history (i.e. for t set to the crown or stem age) and remains positive</p>
        <p>We thank members of HM's group, as well as reviewers D.S. Caetano and D. Silvestro for comments on a previous version of the paper. The development of RPANDA is supported by grant CHEX-ECOEVOBIO from the Agence Nationale de la Recherche and grant 616419-PANDA from the European Research Council awarded to HM.We thank members of HM's group, as well as reviewers D.S. Caetano and D. Silvestro for comments on a previous version of the paper. The development of RPANDA is supported by grant CHEX-ECOEVOBIO from the Agence Nationale de la Recherche and grant 616419-PANDA from the European Research Council awarded to HM.</p>
        <p>All data used in this manuscript is available through the 
            <rs type="software">R</rs> package 
            <rs type="software">RPANDA</rs>, available on 
            <rs type="software">CRAN</rs>
            <rs type="url">https://cran.r-project.org/web/packages/RPANDA/index.html</rs>.
        </p>
        <p>
            <rs type="software">RPANDA</rs> is an open source package available for download on the CRAN repository at 
            <rs type="url">https://cran.r-project.org/web/packages/RPANDA/index.html</rs>. It includes illustrative data and a detailed manual. The package is constantly evolving. Bayesian implementations and functions that allow fitting new models of phenotypic evolution, such as the matching competition model (Drury et al. 2015), are already under development. Contributions are welcome; automatic tests have been implemented to facilitate a collaborative development and to insure the replicability of results. The most recent version is available on github at 
            <rs type="url">https://github.com/hmorlon/PANDA</rs>.
        </p>
    </text>
</tei>
