<?xml version="1.0" encoding="UTF-8"?>
<tei xmlns="http://www.tei-c.org/ns/1.0">
    <teiHeader>
        <fileDesc xml:id="_1"/>
        <encodingDesc>
            <appInfo>
                <application version="0.8.1-SNAPSHOT" ident="GROBID" when="2024-06-24T16:31+0000">
                    <ref target="https://github.com/kermitt2/grobid">A machine learning software for extracting information from scholarly documents</ref>
                </application>
            </appInfo>
        </encodingDesc>
    </teiHeader>
    <text xml:lang="en">
        <p>This is a PDF file of an article that has undergone enhancements after acceptance, such as the addition of a cover page and metadata, and formatting for readability, but it is not yet the definitive version of record. This version will undergo additional copyediting, typesetting and review before it is published in its final form, but we are providing this version to give early visibility of the article. Please note that, during the production process, errors may be discovered which could affect the content, and all legal disclaimers that apply to the journal pertain.</p>
        <p>Over the past three decades deep brain stimulation (DBS) has become a mainstream surgical procedure with the potential to directly probe dysfunctional brain circuits and deliver adjustable stimulation for therapeutic effects in neurological and psychiatric diseases. To investigate the neural substrates underlying therapeutic stimulation, it is integral to establish a direct relationship between the brain areas stimulated by DBS and the resulting clinical response. To do so, precise electrode localizations are necessary, which require the use of dedicated and highly specialized software pipelines. Several platforms -both open source and commercial -have been introduced for electrode localization and reconstruction in recent years (Ahrens et al., 2005;Johansson et al., 2019;Lauro et al., 2016;Miocinovic et al., 2007). The majority of these tools, however, are currently aimed at clinical applications in individual patients. Furthermore, knowledge of the methodological details of commercial tools is limited by intellectual property constraints. Finally, numerous tools have lost support or have been discontinued over time. With the introduction of Lead-DBS in 2014, an open-source platform became available to the DBS community offering a semiautomated pipeline for image registration, electrode localization, and stimulation volume modeling (Horn and Kühn, 2015). Following its initial publication, development efforts for the platform continued at multiple institutions providing important methodological updates (Ewert et al., 2018a(Ewert et al., , 2019a;;Hellerbach et al., 2018;Horn et al., 2014Horn et al., , 2019a;;Horn and Blankenburg, 2016;Husch et al., 2018;Wang et al., 2021). The introduction of the Lead-Group toolbox in particular constituted a crucial addition to the platform offering -for the first time -an integrated solution for largescale analyses of DBS outcomes on a group level (Treu et al., 2020). The tool not only allowed comparison of lead localizations across patients and research sites, but also featured rudimentary tools for statistical analysis. Currently, Lead-DBS constitutes the only mature opensource solution that is actively maintained and frequently used in the literature. The repository has received code-contributions by 39 developers from multiple institutions (alongside numerous contributors of data) and consists of 
            <rs type="software">Matlab</rs>, Python, 
            <rs type="software">C</rs> and Fortran 
            <rs type="software">code</rs> components. While the main GUI is currently accessible via 
            <rs type="software">Matlab</rs>, a compiled standalone 
            <rs type="software">version</rs> is available, which can be readily used with a GUI or from the command line, without the need for a Matlab installation.
        </p>
        <p>Since the introduction of Lead-Group, group-level analysis of DBS outcomes have become a powerful framework to probe the local and network substrates associated with clinical outcomes, behavioral responses, and side-effects during DBS (Horn and Fox, 2020a). Recognizing its potential, a large international community has emerged in recent years developing and applying a vast array of statistical methods to map clinical regressors across DBS applications (Al-Fatly et al., 2019;Dembek et al., 2019;Elias et al., 2020;Horn et al., 2017c;Johnson et al., 2020;Li et al., 2020;Mosley et al., 2020;Neudorfer et al., 2021;Siddiqi et al., 2021). The Lead-DBS toolbox has empowered &gt;500 peer-reviewed papers to date (also see https://www.lead-dbs.org/about/publications/) and has been considered the most comprehensive tool for these analyses by others (Husch et al., 2018;Milchenko et al., 2018).</p>
        <p>Accuracy of Lead-DBS derived electrode reconstructions was electrophysiologically validated in recent publications from four different groups (Al Awadhi et al., 2022;Nowacki et al., 2018;Oxenford et al., 2021;Rappel et al., 2020). Furthermore, the open-source nature of Lead-DBS and its broad application across continents may foster standardization, or -to paraphrase Latorre et al. -a growing democratization and increased speed of advances in the field (Latorre et al., 2021). With inclusion of novel features into the pipeline, a growing diversity and complexity of employed methods emerges, which bears the risk of jeopardizing the reproducibility of findings. Indeed, it has become increasingly challenging for users to understand the complexities and intricacies of methods included in the Lead-DBS pipeline, which settings to choose and which strategies to follow. For all of the above reasons, we document here the recent methodological advances that have led to Lead-DBS v3.0.</p>
        <p>Given the growth and complexity of preprocessing and statistical tools available in Lead-DBS (Figure 2), it is unfeasible to properly address, document, and evaluate each feature introduced since version 2.0 (Horn et al., 2019a) in a single publication as the present one. However, most novel features were already described independently in peer-reviewed work, and key citations are featured within the graphical user interface of the software tool itself. Rather than providing an exhaustive empirical evaluation of each single tool in Lead-DBS, the present manuscript focuses on describing the most salient updates (Figure 1, bold font). Some of these tools, such as Sweetspot, Fiber Filtering, and 
            <rs type="software">Network Mapping Explorer</rs> could be considered software with substantial complexity that justify their own methodological papers (e.g. see similar work based on simulated data for sweetspot identification (Dembek et al., 2021a). Here, our aim is to provide an overview of the methods available in Lead-DBS and demonstrate their applicability in single patient-as well as group-level analyses, to provide current and future users with an approachable resource to guide software applications.
        </p>
        <p>In the present manuscript, novel features of Lead-DBS v3.0 were demonstrated either i) in a single example patient, or ii) on a group level, using a previously published cohort of 51 DBS patients. The example patient was an additional 57-year-old male with a 9-year history of Parkinson's disease (PD), who underwent bilateral implantation of segmented DBS leads into the subthalamic nucleus (STN). The patient had a baseline Unified-Parkinson's Disease Rating Scale (UPDRS) III score of 58 (Hoehn and Yahr Scale: 2; Med-OFF), which improved markedly in the ON medication state. Electrode implantation was performed under awake conditions and guided by microelectrode recordings and stimulation testing. In the postoperative course, the patient demonstrated a 55.2% improvement on the UPDRS-III at 12-months follow-up in the Med-OFF state. For group-level analysis we retrospectively evaluated 51 patients (18 females, mean age: 60.0  7.9 years) suffering from treatment-refractory PD. These patients had been well characterized in prior retrospective studies (Horn et al., 2017c(Horn et al., , 2017b(Horn et al., , 2019a;;Sobesky et al., 2021a;Treu et al., 2020) and underwent bilateral STN-DBS (model 3389, Medtronic, MN) at Charité -Universitätsmedizin, Berlin between March 2007 and May 2014. Consistent use of this "standard cohort" in the present study had the aim of making results directly comparable to findings previously published in the literature (Horn et al., 2017c(Horn et al., , 2019a;;Sobesky et al., 2021a;Treu et al., 2020). Pre-and postoperative T1-weighted (T1w) and T2-weighted (T2w) magnetic resonance imaging (MRI) scans were obtained using a 1.5 Tesla clinical MRI scanner (NT Intera; Philips Medical Systems, Best, Netherlands). In six of the 51 patients postoperative computed tomography (CT) scans were acquired instead. A detailed overview of employed acquisition parameters can be obtained from the Supplementary Material.</p>
        <p>The surgical techniques associated with STN-DBS have been reported previously (Horn et al., 2017c). In brief, targeting of STN was performed based on T1w and T2w sequences. The preliminary target (reflecting the center of the most distal contact) was identified 12.5 mm lateral, 1.8 mm posterior and 3.5 mm ventral to the midcommissural point (MCP). Intraoperatively, test stimulation and microelectrode recordings were used to guide lead placement and determine the location of optimal symptom improvement. Following electrode implantation, leads were internalized and connected to an internal pulse generator under general anesthesia.</p>
        <p>A detailed description of the methods used to perform co-registration and nonlinear normalization in Lead-DBS has been reported previously (Horn et al., 2019a;Horn and Kühn, 2015). In brief, following nonparametric, nonuniform, intensity normalization (N4) bias field correction (Tustison et al., 2010) of multimodal preoperative imaging scans, an anchor modality (typically, the preoperative T1w sequence) was identified in each patient and up-sampled to isotropic 0.7 mm resolution. MRI acquisitions were then co-registered to the anchor modality using 
            <rs type="software">SPM</rs>
            <rs type="version">12</rs> (
            <rs type="url">https://www.fil.ion.ucl.ac.uk/spm/software/spm12/)</rs>. Similarly, postoperative CT scans containing the lead location information were co-registered using Advanced Normalization Tools (ANTs; http://stnava.github.io/ANTs/). Results were visually validated to confirm accurate and complete pre-processing.
        </p>
        <p>To evaluate lead placement with respect to neuroanatomical atlases and allow inferences on a group-level (Treu et al., 2020) co-registered patient scans were transformed into ICBM 2009b Nonlinear Asymmetric ('MNI') space applying ANTs Symmetric Normalization (SyN) algorithm (Avants et al., 2011) with the 'effective: low variance + subcortical refinement' preset. This approach has been specifically optimized for non-linear registration of subcortical structures (Ewert et al., 2019a;Vogel et al., 2020) and constitutes the current state-of-the-art in the field (Edlow et al., 2019;Elias et al., 2020;Ewert et al., 2019b;Li et al., 2020). To account for potential pneumocephalus and associated non-linear deformation of brain tissue brain shift correction was applied to postoperative scans (Horn et al., 2019a).</p>
        <p>While the aforementioned registration protocol has been used to create reliable DBS models capable of explaining variance in out-of-sample data (Horn et al., 2017c), automated algorithms may still yield misalignment in the area of interest in some cases. Automated registration of the basal ganglia in particular proves challenging to intensity-based registration methods owing to the lack of image contrast (Neudorfer et al., 2022). This is further emphasized by the need to perform manual performance checks in each patient -even for the best performing algorithms -to ensure consistent registration quality (Ewert et al., 2019a). However, while visual inspection may allow the identification and exclusion of subpar registrations, there is a current lack of tools allowing targeted refinement of registration in the area of interest.</p>
        <p>
            <rs type="software">WarpDrive</rs> is a manual refinement toolbox that allows direct manipulation of deformation fields generated during normalization and was specifically created for use within Lead-DBS (Oxenford et al., 2021). The application of 
            <rs type="software">WarpDrive</rs> constitutes an optional step during normalization and is aimed for use in cases where normalization errors are clearly visible and image quality allows unambiguous refinement. It features a diverse set of tools, which allow identification and correction of registration mismatches based on point-to-point or line-to-line fiducials, as well as a smudge tool to freely add local displacements that are applied with a Gaussian smooth kernel. Following WarpDrive-based refinement, the generated transform is applied to both, electrode and contact positions to accurately map lead locations to MNI space. Conversely, since the generated transform is diffeomorphic, atlas structures may be similarly mapped from MNI space into native space with the same accuracy, hence facilitating precise subcortical segmentations. Here, we demonstrate the applicability of the tool highlighting qualitative differences between automated registration approaches (ANTs SyN, protocol used in Lead-DBS v2) and combined automated and manual approaches (ANTs SyN + 
            <rs type="software">WarpDrive</rs>). To this end we performed registration of two high-resolution imaging resources, 
            <rs type="software">BigBrain</rs> (Amunts et al., 2013) and the 7T MRI ex-vivo human brain template (Edlow et al., 2019), investigating registration performance of landmarks crucial to functional neurosurgery, namely STN and anterior commissure. The utility of 
            <rs type="software">WarpDrive</rs> in a clinical research context was further showcased in the example patient. A quantitative evaluation of 
            <rs type="software">WarpDrive</rs> will be reported elsewhere.
        </p>
        <p>Electrode localization was carried out in all patients using the advanced processing pipeline of Lead-DBS v2 (Horn et al., 2019a). Specifically, leads were first automatically pre-reconstructed using either the 
            <rs type="software">PaCER toolbox</rs> (Husch et al., 2018) or the (refined) TRAC/CORE approach (Horn and Kühn, 2015). In cases where these algorithms failed, pre-reconstruction was performed manually using the integrated point-and-click tool or the interface between Lead-DBS and 
            <rs type="software">3D Slicer</rs> using the fiducial-based implementation (Fedorov et al., 2012). Electrode localizations were then visualized in the provided user interface and manually refined. Given that the example patient featured directional leads an additional step was required to determine the electrode orientation. Here, version 2.0 of the Directional Orientation Detection (DiODe) algorithm (Dembek et al., 2021b) was adapted for inclusion within Lead-DBS which allows fullyautomated and unambiguous detections of lead orientation. Based on a postoperative CT scan this algorithm identifies the slices that feature the strongest electrode artifacts and matches the intensity profile extracted from these artifacts to the expected artifact locations of the DBS lead. Importantly, DiODe v2.0 has only been validated for the Cartesia TM directional lead (Boston Scientific, MA, USA). However, while not phantom-validated, support for the bimodal marker of segmented SenSight TM electrodes by the manufacturer Medtronic have been included as well. Also, based on our experience, the algorithm works well for other manufacturers, e.g., the St. Jude Medical Infinity TM directional leads (Abbott Laboratories, IL, USA), however, imaging constraints would need to be evaluated more carefully for these electrodes owing to the smaller size of their stereotactic markers. For a detailed description and validation of DiODe v2 please refer to (Dembek et al., 2021b).
        </p>
        <p>Computational models that estimate the electric field distribution and the extent of stimulated neural tissue are common steps in mapping the local and network effects of DBS on both patient-specific and group level. Recognizing the need for flexible implementation strategies, Lead-DBS v3.0 features different approaches to approximate the electric potential and current distribution of electric fields within neural tissue. In general, excitability metrics have been either based on the electric field (E-field) (Åström et al., 2015;Baniasadi et al., 2020;Horn et al., 2019a) or computational axon models (Butenko et al., 2020;Butson and McIntyre, 2005;Gunalan et al., 2017;McIntyre et al., 2002). Owing to its computational efficiency and ease of implementation, E-fields are broadly used in neuromodulation research and were applied here to investigate both local and network effects of DBS on a group level. Based on these, binary stimulation volumes were additionally calculated in native space using an adaptation of the 
            <rs type="software">SimBio/FieldTrip pipeline</rs> (Vorwerk et al., 2018) as introduced in Lead-DBS v2 and refined for robustness and precision. Briefly, using the finite element method (FEM), the static formulation of the Laplace equation was solved in a discretized domain represented by a tetrahedral fourcompartment mesh constituting gray matter, white matter, metal, and insulating electrode parts (in native patient space). Following the approach by Åström et al., a heuristic value of 0.2 V/mm was used to threshold E-Field magnitude values into a binary stimulation volume (VTA) (Åström et al., 2015;Horn et al., 2017c;Vasques et al., 2009). In addition, voxel values were represented as (unthresholded) E-field magnitudes in the E-field approach. Finally, stimulation volumes were transformed into MNI space using the same refined deformation fields described earlier.
        </p>
        <p>A more elaborate concept to model the biophysical effects of DBS is the one of pathway or tract activation models that take into account underlying white matter anatomy to estimate electric effects of DBS directly on the prevalent tracts (Gunalan et al., 2017;Howell et al., 2019). Instead of quantifying a stimulation volume surrounding the electrodes, this concept places axonal cable models alongside anatomical tracts and estimates whether the electric current imposed by the electrode would induce action potentials. Recently, this concept has entered the opensource domain in form of the OSS-DBS toolbox which facilitates a reproducible, time-efficient, and automated estimation of pathway/tract activation models (Butenko et al., 2020). The development of a bidirectional interface between Lead-DBS and OSS-DBS platforms, as introduced in the present manuscript, extends the capability and functionality of both tools by allowing a seamless transition between platforms. Here, we demonstrate the capabilities of this integrated platform in a cohort of 51 PD patients and further showcase the relationship between stimulation amplitude and extent of activation in a single example case. Details about the applied field and pathway activation modeling are described in (Butenko et al., 2020).</p>
        <p>While Lead-DBS was originally developed to facilitate the localization and reconstruction of DBS electrodes (Horn and Kühn, 2015), significant effort in recent years has been directed towards establishing a reliable and efficient pipeline for group-level neuroimaging analysis. A key development in this process was Lead Group (Treu et al., 2020), a toolbox implemented within 
            <rs type="software">Lead-</rs>DBS which allows visualization of electrodes and calculation of stimulation volumes within and across patient cohorts, as well as rudimentary statistical analyses on a local and network level. As the field of neuroimaging-based DBS research continues to grow, however, novel and increasingly sophisticated methods have been developed to make assumptions about the neuroanatomical and network substrates underlying electrical stimulation. These methods can be generally subdivided into three domains -local mapping approaches, tract level analyses, and network level analyses -each incorporating their own, unique pipelines based on a common denominator, the stimulation volume. To accommodate the richness and diversity of statistical methods that have been introduced within each domain, three distinct toolboxes were implemented in 
            <rs type="software">Lead-DBS</rs> v
            <rs type="version">3.0</rs>, each exhibiting a graphical user interface tailored towards accurate and reproducible analysis of group-level data. First, the Sweetspot 
            <rs type="software">Explorer</rs> has been developed to map local hot-and coldspots to anatomy within and around the DBS target region. Second, the Fiber Filtering 
            <rs type="software">Explorer</rs> can be used to identify tracts associated with observed changes in clinical (or behavioral) outcome. These tracts can be derived from a structural connectome or pathway model. Third, the 
            <rs type="software">Network Mapping Explorer</rs> can be used to associate observed effects with distributed functional or structural brain networks. A classical use-case for all three tools is to map clinical improvement to a local, tract-or network-level. However, virtually any effect (e.g., pre-vs. postoperative changes in behavioral variables or symptoms such as risk-taking/impulsivity, changes in a behavioral task comparing ON vs. OFF stimulation, long-term effects such as cognitive decline) may in principle be mapped using these tools. All toolboxes feature a common workflow in the graphical user interface (or command line) that can be divided into i) Model Setup, ii) Visualization &amp; Thresholding, and iii) Crossvalidation &amp; Prediction:
        </p>
        <p>During Model Setup the methods and parameters to generate the computational model are defined. This process incorporates decisions about cohort and subcohort selection, type and extent of stimulation volume, selection of the dependent variable and potential covariates, statistical tests, and -in the case of connectivity analyses -selection of the connectome to be used for seeding. The generated model can be visualized and further adjusted during Visualization &amp; Thresholding. Specifically, this step allows thresholding of the generated maps based on a predefined significance level and correction for multiple comparison. For more advanced post-hoc analyses, 
            <rs type="software">Lead-</rs>DBS v3.
            <rs type="version">0</rs> offers the option to export the generated maps in the NIfTI file format, and additionally as weighted streamlines in the Fiber Filtering Explorer. Crossvalidation &amp; Prediction constitutes the final step in each of the three tools. This step is crucial in the workflow as it establishes the validity of generated models within and generalizability across cohorts. Validation strategies include permutation-based (Leave-Nothing-Out) approaches, as well as Leave-One-Patient-Out, Leave-One-Cohort-Out, and k-fold (randomized) cross-validations. In addition, it is possible to customize this process and generate predictions for individual patients, as well as predefined (sub-)cohorts and sets. The present study demonstrates the individual frameworks in the context of retrospective analysis of the n=51 patient cohort introduced earlier using Leave-One-Patient-Out and 10-fold crossvalidation as measures for model validity.
        </p>
        <p>To identify local clusters associated with clinical change Lead-DBS v3.0 has harmonized the fundamental methodological choices of multiple prior publications (Butson et al., 2011;Dembek et al., 2019;Eisenstein et al., 2014;Elias et al., 2020;Horn et al., 2021;Reich et al., 2019) within one single tool. These prior publications used different concepts, such as t-tests vs. Wilcoxon signed rank tests, N-maps, thresholding, and alternate choices of a null model, yielding an extensive parameter space of potential settings. These parameters can be freely adjusted and explored by the user allowing easy implementation of novel concepts, however, to facilitate navigation of methodological choices, the Sweetspot 
            <rs type="software">Explorer</rs> features a "inspired by…" dropdown menu that pre-selects choices as they had been made in aforementioned publications. It is important to note, however, that not all provided presets constitute exact reproductions of the analysis pipelines originally used by these groups, but rather reflect the general methodological choices and statistics employed in the different publications. For example, Butson et al. employed a different approach to derive stimulation volumes (Butson et al., 2011), whereas Eisenstein et al. did not rely on calculating binary stimulation volumes, at all (Eisenstein et al., 2014). Similarly, several groups performed additional post-hoc analyses, such as cluster thresholding (Reich et al., 2019) or permutation statistics (Dembek et al., 2019;Eisenstein et al., 2014), which have not been implemented in the tool. A warning dialog notifies the user of these crucial differences and we chose to call the presets "inspired by…" to emphasize that exact reproductions of all methods into a single tool are not possible. All but the approach by Horn et al. 2022, are based on binarized stimulation volumes. Hence, patient-specific E-field vector magnitudes were first thresholded at 0.2 V/mm and weighted by their corresponding relative motor improvement from baseline as assessed using UPDRS-III. To this end, each voxel within a patient's stimulation volume was assigned the relative improvement score reported in this patient. These values were then aggregated across patients in a voxelwise manner and -depending on the employed method -normalized based on stimulation volume (Elias et al., 2020) or amplitude (Dembek et al., 2019). The group mean was then computed by averaging the sum of clinically weighted volumes overlapping a given voxel. In addition to these (binarized) stimulation volume based models, the Sweetspot Explorer also incorporates an E-field based approach which has been introduced recently (Horn et al., 2021). This preset calculates the Spearman correlation coefficient between E-field magnitudes and clinical outcome in a voxel-wise manner across cohorts. While some approaches used high thresholds for the raw average improvement maps to control for outlier voxels (Butson et al., 2011) other approaches relied on the generation of n-maps. N-maps provide voxel-wise insight into the number of stimulation volumes overlapping each voxel and may be thresholded to penalize areas encompassed only by a minority of stimulation volumes and remove outlier voxels. In the present study these n-maps were thresholded empirically at 30%. Finally, voxelwise statistics were performed using one-sample t-test (Eisenstein et al., 2014), two-sample ttest (Reich et al., 2019), or Wilcoxon-signed rank test (Dembek et al., 2019;Elias et al., 2020) to calculate a p-map. This p-map was then used to mask the n-masked average improvement map. Finally, identified clusters were validated using Leave-One-Patient-Out and 10-fold crossvalidation. A complete description of the presets used to compute hotspots within the Sweetspot Explorer is outlined in Supplementary Table 1. In-fold predictions can be obtained from Supplementary Table 2.
        </p>
        <p>Note that the terms 'streamlines' and 'fibers' are used interchangeably in the present manuscript. Code and concepts to identify and isolate streamlines associated with clinical outcome during DBS have been implemented in prior versions of Lead-DBS (Baldermann et al., 2019). However, several methodological advancements have been made subsequently, prompting the development of a proper tool for flexible analyses, the Fiber Filtering 
            <rs type="software">Explorer</rs>. Specifically, the tool incorporates the two key analysis strategies pioneered by our group, as well as a novel integration with OSS-DBS for pathway activation modeling (Butenko et al., 2020). The first strategy relies on a combination of binary stimulation volumes and two-sample t-tests to derive streamlines associated with clinical outcome (Baldermann et al., 2019). Here, each individual streamline is iteratively assigned a weight in mass-univariate fashion based on a two-sample t-test that compares clinical outcomes between patients' stimulation volumes that either traverse or do not traverse the respective streamline. In other words, for each single streamline, this method divides the investigated cohort into two groups whose underlying stimulation volumes either 'activate' it or not. The second strategy involves a combination of (non-binary) E-fields and correlation coefficients (Irmen et al., 2020). Similar to the first strategy, this approach iterates across streamlines in a mass-univariate manner. However, the weight assigned to each streamline is determined by the correlation coefficient calculated between E-field vector magnitudes ('fiber activation') and clinical improvements across patients. The third strategy is comparable to the first and applies the same two-sample t-test strategy. However, instead of splitting the cohort based on intersections between tract and patient-specific stimulation volumes, binary tract activations are assessed using the doublecable axon model ( (Butenko et al., 2020;Butson and McIntyre, 2005;Gunalan et al., 2017;McIntyre et al., 2002) coupled with the extracellular electric field within OSS-DBS. Streamlines are then weighted by again comparing clinical outcome across activated vs. not activated streamlines. Finally, Lead-DBS also features an option to visualize activated streamlines without conducting statistical tests for both VTA-based and OSS-DBS based approaches. This option can be helpful to visually compare tracts activated e.g., in the top-vs. bottom-responding patients within a cohort.
        </p>
        <p>Using the retrospective patient cohort, the present manuscript demonstrates and compares different methodological approaches comprised within the Fiber Filtering Explorer. Specifically, we employed the DBS tractography atlas by Middlebrooks et al. (Middlebrooks et al., 2020) to seed streamlines associated with PD symptom change from VTAs and E-fields, respectively. The three methods described above were then applied.</p>
        <p>To identify sensible models of structural connectivity, different combinations of the parameters contained within the Fiber Filtering Explorer were iteratively applied across the parameter space using results of a 10-fold cross-validation as an objective function (for a full description of parameters please refer to Supplementary Table 2). For example, for a predefined set of nthresholds ('Tracts connected to &gt; X% of VTAs') R-values based on 10-fold cross validation were derived by iterating through the full parameter space (i.e., all other parameter choices) while keeping the threshold fixed. This process yielded a distribution of R-values associated with each defined parameter and -when plotted against the remaining set of parameters -would allow assumptions regarding the contribution of a specific parameter to the overall performance of a model. The best performing models (defined based on the highest correlation strength using 10-fold cross-validation) were visualized and compared across analysis streams.</p>
        <p>While localized hotspots and tracts associated with optimal improvement are meaningful conceptual surrogates to improve DBS targeting and programming, a different question is which whole-brain network should optimally be modulated. Derivation of these estimates involves projections to the cortical surface and calculation of cortico-subcortical connectivity strength by means of voxel-wise correlation. The resulting maps have the potential to inform noninvasive neuromodulation strategies (Fox et al., 2014;Weigand et al., 2018) and lead to a better understanding of diseases and therapeutic strategies (Horn and Fox, 2020a). The DBS network mapping framework was established in 2017 (Horn et al., 2017c) and further developed into a dedicated explorer tool in the latest version of Lead-DBS to facilitate grouplevel analyses of functional connectivity.</p>
        <p>By seeding from calculated stimulation volumes within a functional connectome (derived from resting-state functional MRI (rs-fMRI) data either in the individual patient or in a reference cohort of subjects/patients), estimates of polysynaptic network connectivity across the brain may be derived using the 
            <rs type="software">Network Mapping Explorer</rs>. The tool internally calls 
            <rs type="software">Lead Connectome Mapper</rs> (Horn et al., 2019a) and has been updated to accommodate the methodological advancements of recently published work (Ganos et al., 2022;Li et al., 2021;Sobesky et al., 2021a). Furthermore, the 
            <rs type="software">Network Mapping Explorer</rs> allows to effectively generate, explore, and statistically validate network models in a single graphical user interface. Normative functional connectivity maps (fingerprints) seeded from patient-specific stimulation volumes were estimated with the aim of computing an R-map associated with optimal outcome in our retrospective patient cohort. For this purpose, a normative, high-resolution rs-fMRI connectome derived from the Brain Genomics Superstruct Project (Yeo et al., 2011) was used to seed average blood-oxygen level dependent (BOLD) signal fluctuations comprised within patient-specific bilateral stimulation volumes from a total of 1000 healthy subjects. The strength of correlation between the seeded time series and every other voxel outside the stimulation volume was then calculated, averaged across the normative sample, and Fisher ztransformed to derive a normalized connectivity fingerprint for each patient. The resulting fingerprint maps were then correlated with clinical outcome in a voxel-wise manner across the cohort to derive an R-map model associated with optimal connectivity. To this end, several established and robust correlation coefficients were investigated, namely Pearson, Spearman, and Percentage Bend correlation. Model performance was evaluated using Leave-One-Patient-Out and 10-fold cross-validation on unthresholded, p-thresholded (=0.05), and false discovery rate (FDR) corrected (q&lt;0.05) R-maps. Of note, while not demonstrated here, 
            <rs type="software">the Network Mapping</rs> Explorer also allows analysis of DWI-derived connectivity maps and their correlation with clinical outcome in the context of whole-brain connectivity analysis. This adjustment can be easily made by choosing the respective DWI dataset during connectome selection. However, use cases for structural connectivity analysis 
            <rs type="software">with Network Mapping</rs> Explorer maximally overlap with 
            <rs type="software">the Fiber Filtering</rs> Explorer. The former would calculate voxel-wise statistics, the latter tract-wise statistics, which could be statistically advantageous (since the same tract can be modulated in different regions).
        </p>
        <p>In the past decade DBS research has evolved radically with studies acquiring rich and complex data ranging from electrode types, stimulation parameters, patient demographics, and outcome measures to multidimensional electrophysiology, imaging, and behavioral datasets. This source data typically serves as the starting point for a multitude of image-processing pipelines that yield highly specific and heterogeneous files and data formats. Although the number of DBS studies using multimodal datasets has drastically increased over the past years there has been no consensus on how to organize and share this data. Currently, DBS data are stored in many different structures, with labs adopting their own methods for data and metadata organization. An extension to the brain imaging data structure (BIDS) standard for iEEG data has been proposed (Holdgraf et al., 2019), but primarily focuses on electrophysiological data. The growth of Lead-DBS and the continuous implementation of methods developed by external contributors and our own group alike has yielded complex folder structures that have been iteratively advanced and extended, albeit at the cost of comprehensibility. This imposes a substantial barrier to data sharing, reproducibility, and efficiency in a highly collaborative field that frequently relies on data exchange across centers to confirm, validate, and generalize findings (Li et al., 2020). Overall, there is a clear need in the community for a standard to better describe DBS imaging data and its experimental context.</p>
        <p>In 2016, Gorgolewski et al. introduced BIDS as a standard for organizing and describing neuroscience data and metadata with the aim to make datasets more reproducible, transparent, and reusable (Gorgolewski et al., 2016). BIDS features a standardized specification for folder and file naming, the choice of data formats, and the representation of metadata. Importantly, it is modality-agnostic, offering the opportunity for community-driven extension to new modalities. As a result, BIDS has been successfully extended to fields outside the original specification (written for MRI) including EEG (Pernet et al., 2019), MEG (Niso et al., 2018), and intracranial EEG (Holdgraf et al., 2019). This paper introduces the extension of the BIDS specification for Lead-DBS with the goal of modularizing single-subject and group-level data imported and generated within Lead-DBS. Specifically, while Lead-DBS has been capable of importing BIDS datasets for a while, the present addition includes storage of a BIDS derivatives format of output files created by Lead-DBS, necessitating a much more thorough rewrite of the code-base (295.4k code line additions and 59.4k deletions).</p>
        <p>Figure 1 features a comprehensive overview of novel tools, that have been implemented in Lead-DBS v3.0. Walkthrough tutorials demonstrating the capabilities of the herein presented modifications, including preprocessing, lead localization, statistical analysis, as well as transition to the BIDS format are available at https://www.lead-dbs.org/helpsupport/knowledge-base/walkthrough-videos/.</p>
        <p>The cohort of 51 PD patients featured a marked alleviation of parkinsonian symptoms following DBS with a 45.3  23.0% improvement on the UPDRS III motor scale and a consecutive 52.8% reduction in levodopa equivalent daily dosage (LEDD). For a detailed description of patient outcomes please refer to Horn et al. (Horn et al., 2017c(Horn et al., , 2019a)). A similar response in clinical outcome was observed in the 57-year-old example patient who demonstrated a 55.2% UPDRS III improvement 12-months following surgery.</p>
        <p>While normalization algorithms have advanced in recent years demonstrating accuracies comparable to manual expert segmentation (Ewert et al., 2019b;Vogel et al., 2020) their overall performance may vary across subjects, brain regions, imaging modalities, and template spaces. This is demonstrated in example cases in Figure 2A-D, where automatic registration of high-resolution templates yielded distinct mismatches at the level of the mesencephalon and the anterior commissure, respectively. Similarly, the low contrast-to-noise ratio within the basal ganglia may impede accurate registration in clinical research settings, resulting in a blurry amalgamation of anatomical structures that lack precision and anatomical detail (Figure 2E-F). Importantly, poor registration accuracy as a result of poor imaging contrast directly translates into lead localization errors and biased models of DBS response (Neudorfer et al., 2022). 
            <rs type="software">WarpDrive</rs> allows users to account for the inaccuracies introduced by the normalization algorithm in the region of interest (Figure 2, right column) reaching expert-level registration accuracy by means of fiducial-based manual refinement of the deformation field (Sharp et al., 2010). While future studies are needed to quantify differences in registration accuracy and determine the amount of variance explained in clinical outcome across normalization strategies, 
            <rs type="software">WarpDrive</rs> has the potential to pave the way towards clinical applications of registration-dependent methodologies. Specifically, accurate transformation of atlas resources, high-resolution templates, hotspots, and connectivity derived targets into patient-space may be crucial in complementing clinical decision making and informing DBS programming as well as surgical targeting (Oxenford et al., 2021). Furthermore, the adjusted deformation transform allows for a more refined group-level analysis in normalized (e.g., MNI) space. A demo application of 
            <rs type="software">WarpDrive</rs> demonstrating the refinement of patient-to-atlas fit in a surgical case is provided at https://www.youtube.com/watch?v=VcBXu5BURVI.
        </p>
        <p>To identify areas associated with greatest clinical improvement and determine the neuroanatomical substrates subserving outcome in PD symptom severity we employed and evaluated six different mapping strategies as previously described (Butson et al., 2011;Dembek et al., 2019;Eisenstein et al., 2014;Elias et al., 2020;Horn et al., 2022;Reich et al., 2019). Inspection of these maps revealed clusters within the diencephalon encompassing the motor aspect of STN, extending posteriorly into zona incerta (ZI) and inferiorly into associative STN (Figure 3). Clusters featured a mean volume of 95.1  19.0 mm 3 (range: 56.4 -102.9 mm 3 ). The peak intensities of each respective cluster consistently broadly converged onto the sensorimotor aspect of STN, with approaches by Butson, Elias, Dembek, and Horn each localizing to the dorsoposterolateral aspect of STN (Figure 3). More dorsal intensity peaks were identified by the Eisenstein method, whereas the approach by Reich yielded peak intensities at the border between sensorimotor and associative STN. The centers of gravity of all investigated approaches formed a distinct cluster within the sensorimotor aspect of STN in close proximity to the center of gravity of the subdivision (average Euclidean distance: 1.61 0.2 mm) and an optimal PD target as meta-analytically defined by Caire et al. (Caire et al., 2013) (converted to MNI space in (Horn et al., 2017a); average Euclidean distance: 1.27 0.22 mm). Validation of robustness by means of Leave-One-Patient-Out and 10-fold cross-validation revealed significant correlations for all investigated approaches with the approaches by Elias et al. and Butson et al. explaining the highest amount of variance in Leave-One-Patient-Out (R=0.48, p&lt;1.0e-16) and 10-fold cross-validation (R=0.46, p&lt;1.0e-16) designs, respectively. These results, however, were similar and not significantly different to other methods, e.g., the only E-field-based approach (Leave-One-Patient-Out: R=0.36, p=0.001; 10-fold cross-validation: R=0.36, p=0.001). A detailed overview of out-of-sample validations across approaches can be obtained from Figure 3.</p>
        <p>The Fiber Filtering Explorer complements the sweetspot analysis by identifying streamlines associated with changes in clinical outcome. In contrast to the sweetspot analysis, which was informed empirically by previously published approaches (Butson et al., 2011;Dembek et al., 2019;Eisenstein et al., 2014;Elias et al., 2020;Horn et al., 2021;Reich et al., 2019), a datadriven approach was employed to derive suitable preset choices for fiber filtering. Specifically, the parameter space of this methodological framework was probed by iteratively adjusting each tunable parameter without any a-priori assumptions. This approach yielded 2552 models returning predictions, that were validated using 10-fold cross-validation to identify variables that drove model performance and determine the best performing models across analysis streams.</p>
        <p>Figure 4 features the distribution of correlation coefficients associated with 10-fold crossvalidation of probed fiber filtering models. By fixing the variables underlying a specific tuning parameter, variables driving model performance could be identified. For example, retention of  50% of streamlines consistently yielded better performing models across analysis streams. In contrast, transformation of arbitrary streamline value distributions to normal distributions by means of Fisher Z or van Albada transformation yielded less consistent models as compared to no normalization. This was highlighted in particular in the VTA and pathway activation model approaches, where normalization yielded bimodal distributions. The Fiber Filtering Explorer allows the omission of streamlines that were only encompassed by a minority of stimulation volumes. Adjustment of this threshold in the range between 10% and 50% yielded overall similar distributions in the E-field and pathway activation model approach suggesting an overall minor effect of n-thresholding on model performance. For the E-field approach, a trend towards improved model performance was observed when using Pearson correlation, followed by Percentage Bend and Spearman correlation.</p>
        <p>In a final step, we sought to compare the best performing models derived from each of the three data-driven analysis streams. Identified top performing models were able to explain at least 12% of the observed variance (R=0.30, p=0.011) during Leave-one-out cross-validation and at least 20% of the observed variance (R=0.33, p=0.008) during 10-fold cross-validation, respectively (Figure 4, correlation plots). A detailed description of the settings used for model setup, visualization, thresholding, and prediction can be obtained from Supplementary Table 3. Investigation of discriminative tracts revealed overlapping connectivity patterns across models associating streamlines within the hyperdirect pathway with optimal clinical improvements along the motor UPDRS III scale. Similarly, models identified the ansa subthalamica as well as cerebellar streamlines that were likely engaged by encroachment of stimulation volumes onto the cerebellothalamic tract within the posterior subthalamic area (PSA). These streamlines were particularly prominent in the pathway activation model (Figure 4C). Finally, both the Efield approach and the pathway activation model sparsely identified streamlines connecting STN to prefrontal and temporal cortex, suggesting involvement of non-motor regions with optimal clinical outcome.</p>
        <p>Taken together, results across fiber filtering analysis streams were overall consistent, revealing comparable models with similar structural connectivity despite employment of different tuning parameters for model generation. Furthermore, we identified a trend of more complex models (OSS-DBS based pathway activation models) yielding slightly more predictive models. Finally, our findings suggest that specific variable presets (see Supplementary Table 3) may be associated with improved and more consistent model performance. These have now been included as default parameter settings within Lead-DBS v3.0.</p>
        <p>As OSS-DBS is optimized for pathway activation modeling, its integration within Lead-DBS generates an efficient workflow for the calculation, visualization, and analysis of fibers activated during DBS. Beyond the aforementioned group-level analysis, this was further demonstrated in an example patient where the dose-response relationship between stimulation amplitude and extent of pathway activation was modeled following electrode localization and reconstruction in Lead-DBS (Figure 5). Stimulation particularly emphasized the hyperdirect pathway motor fibers, that featured strong activation at low amplitudes that quickly saturated as stimulation currents were increased (Figures 5A-B). Surrounding tracts demonstrated a sigmoidal activation profile that typically reached its maximum activation at amplitudes &gt; 4mA (Figure 5C) emphasizing the increased potential for adverse side effects that are commonly observed under these stimulation conditions (Dayal et al., 2017).</p>
        <p>To derive estimates of polysynaptic functional network connectivity across the brain we leveraged the parameter space of the 
            <rs type="software">Network Mapping Explorer</rs> (Figure 6). A detailed description of the settings used for model setup, visualization, thresholding, and prediction can be obtained from Supplementary Table 5. In-fold predictions for the best performing model based on 10-fold cross-validation are featured in Supplementary Table 6. Of note, the 
            <rs type="software">Network Mapping Explorer</rs> features the overall lowest user degrees of freedom across mapping tools. One reason for this may be that the field of rs-fMRI has already converged on many community standards such as the preprocessing pipelines (Esteban et al., 2019), or the choice of how to calculate functional connectivity from time series (typically Pearson correlation instead of alternative metrics such as mutual information or spectral coherence). Out-of-sample validation identified significant network predictors of clinical outcome across all investigated models with FDR corrected models yielding the highest predictive power in Leave-One-Patient-Out (R Bend =0.46, p&lt;1.0e-16) and 10-fold cross-validation (R Pearson =0.34, p=0.005) designs.
        </p>
        <p>Identified functional connectivity profiles were consistent across methodologically different approaches featuring activity patterns comparable to previously published literature (Horn et al., 2017c;Sobesky et al., 2021a). Specifically, models identified a positive correlation of clinical outcome with connectivity to premotor (PMA) and supplementary motor area (SMA), anterior cingulate cortex, medial prefrontal cortex (mPFC), thalamus, and cerebellum. In contrast, connectivity to M1 correlated negatively with clinical outcome. In contrast, connectivity to M1 correlated negatively with clinical outcome. The observed anticorrelation may be attributed to reduced positive connectivity to M1, i.e., clinical outcome improved more strongly in patients in which DBS electrode connectivity to M1 was less positive. Alternatively, positive outcome may be associated with stronger negative connectivity. To disambiguate between the two scenarios, we plotted voxel-wise correlations of connectivity to stimulation volumes with clinical improvement (Supplementary Figure 1). Correlation plots revealed that reduced connectivity in M1 was associated with improvement in clinical outcome (Supplementary Figure 1). This has been demonstrated in numerous prior studies (Boutet et al., 2021b;Fox et al., 2014;Horn et al., 2019cHorn et al., , 2017d;;Sobesky et al., 2021b).</p>
        <p>Aiming to standardize folder and file naming conventions and enhance user accessibility, Lead-DBS was modified to (i) read in BIDS formatted input data (raw data) and (ii) write out data as a BIDS derivative in a format inspired by existing BIDS standards. Especially the latter part constituted a major effort (800 commits, 770 changed files with 295.4k additions and 59.4k deletions) within our group, which led to a redesigned folder structure including a graphicaluser-interface to convert DICOM data into BIDS-conform raw data. Figure 7 features a comparison between the original data structure implemented in previous versions of Lead-DBS and the updated format conforming to the BIDS standard. Of note, while the raw data folder follows the published BIDS standard, the derivatives folder of Lead-DBS has been adjusted in accordance with the Lead-DBS processing pipeline and passes the BIDS validator. The folder structure follows a logical order incorporating preprocessing, coregistration, normalization, brain shift correction, electrode reconstruction, and stimulation volume modeling steps. Within the Lead-DBS /derivatives folder, image files are stored in the NifTI (.nii) format, whereas metadata are stored either in 
            <rs type="software">MATLAB</rs> format for tabular data (.mat) or JavaScript Object Notation (JSON) format for 'key:value' pairs (.json). Going forward, we aim to further migrate all .mat files with a low data component to .json format. Support of the compressed NIfTI (.nii.gz) format is currently only implemented in parts of the pipeline since core components heavily build upon reading in headers or single slices / probing NifTI files at specific coordinates. This is not possible in the .gz format without decompressing (and hence reading in) the entire volume, which would lead to extensive speed decrease and I/O load for some of the highresolution applications that were incorporated within Lead-DBS. While this limitation of the .gz standard does not impede most pipelines, it does so for the precision-imaging case of DBS, where fast and repeated access to uncompressed files is needed in some steps. Finally, log files generated during registration and normalization use the text file format (TXT) extension (.txt). For a detailed overview of how folder and file naming conventions changed and how to translate the original naming convention into the BIDS specification please refer to Figure 7 and Supplementary Table 7. A walkthrough tutorial demonstrating the migration of Lead-DBS datasets to the BIDS standard is available at https://www.lead-dbs.org/helpsupport/knowledge-base/walkthrough-videos/. Material and tutorials for implementation of the BIDS standard in the broader context of neuroscience can be obtained from https://bids.neuroimaging.io/get_started.html.
        </p>
        <p>Given that the herein presented BIDS derivative has not been reviewed and accepted by the BIDS community as of yet, our addition should be considered a proposal (or derivatives extension) on how to store DBS imaging data. We explicitly welcome developers of similar or accompanying tools to adopt or refine our standard going forward. We argue that adhering to the same storage format could facilitate using multiple different tools on the same dataset and help to further maximize reproducibility and standardization.</p>
        <p>Lead-DBS hosts a large variety of atlases and resources provided by the DBS and neuroimaging community. A general overview of all resources available in Lead-DBS is featured at https://www.lead-dbs.org/helpsupport/knowledge-base/atlasesresources/; table 1 provides a summary of atlases, connectomes, hotspots, and connectivity maps that have been included in Lead-DBS v3.0. Inclusion of datasets into Lead-DBS does not mean endorsement or approval of these external resources by the Lead-DBS development team (https://www.lead-dbs.org/about/data-code-inclusion-philosophy/).</p>
        <p>Based on support by a broad international community, Lead-DBS has evolved into a comprehensive software platform that seamlessly integrates a wide array of neuroimaging tools dedicated to lead localization, reconstruction, and visualization (Horn et al., 2019a;Horn and Kühn, 2015). However, as the field of neuroimaging-based DBS, the number of available research tools, and the community continue to grow there is an ongoing need to maintain, update, and standardize the code base of Lead-DBS. These efforts have culminated in the present manuscript which aims to summarize these major changes and amendments to the Lead-DBS pipeline in recent years. With this new release, the largest coding effort in the history of the tool was undertaken and three comprehensive analysis tools as well as two preprocessing tools and an interface to a sister toolbox for electric modeling were developed. Lead-DBS now also adheres to a more systematic input and output file structure within the BIDS framework, which required extensive re-writes of major parts of the software. To demonstrate these modifications, results of various processing steps were visualized in a single patient example and at the group level in a cohort of 51 patients that underwent STN-DBS for treatment-refractory PD. In the former, important changes to the Lead-DBS preprocessing pipeline were demonstrated, namely manual refinement of deformation fields using 
            <rs type="software">WarpDrive</rs>, unambiguous detection of segmented electrode orientation using 
            <rs type="software">DiODe</rs> v2, pathway activation modeling, and implementation of the BIDS standard. In the latter, we demonstrated different analysis streams for group-level analysis, their underlying methodological choices, and their overall convergence onto a consistent profile of optimal outcome across mapping tools. Finally, we showed that the amount of variance explained varies based on the methodological choices.
        </p>
        <p>Consistent with previous reports, analysis streams derived from Sweetspot, Fiber Filtering, and Network Mapping Explorers identified profiles of clinical improvement within the dorsolateral motor region of STN (Dembek et al., 2019;Elias et al., 2020) connecting to PMA, SMA, ACC, mPFC, and cerebellum, (Boutet et al., 2021b;Horn et al., 2017c;Shen et al., 2020;Sobesky et al., 2021a) and mediating the treatment response by means of hyperdirect pathways from SMA and cerebellothalamic tract modulation (Akram et al., 2017;Gunalan et al., 2017;Nambu et al., 2002;Neumann et al., 2018). Overall these findings are not novel and have been validated previously by independent groups using different modeling approaches (Horn, 2019;Horn and Fox, 2020b). The established PD circuit model, however, allowed us to leverage a well characterized PD cohort (Horn et al., 2017c(Horn et al., , 2019a;;Sobesky et al., 2021a;Treu et al., 2020) to demonstrate the spectrum of methodological approaches contained within Lead-DBS v3.0.</p>
        <p>Previous publications have addressed and compared methodological choices in neuroimagingbased DBS scenarios. For example, Dembek et al. derived local predictors of clinical outcome using simulated data (Dembek et al., 2021a). By defining the sensorimotor aspect of STN as the optimal stimulation target, the authors noted marked differences with respect to the spatial distribution of hotspots. Methods employing voxel-wise statistics against average outcomes yielded the best overall performance as evaluated using Dice coefficient and linear regression.</p>
        <p>In the present study we relied on a well characterized clinical cohort to identify local predictors of DBS response. While all investigated models led to significant correlations during crossvalidation, differences were observed with respect to the amount of variance explained across models and the location of peak intensities (Figure 3).</p>
        <p>Taken together, our local mapping findings demonstrate the versatility of the Sweetspot Explorer in investigating the impact of fundamentally different methodological approaches, but also highlight distinct limitations that need to be addressed in future research. Indeed, in our analysis, we noted stark differences in solutions when applying different methodological concepts. For example, one key issue during sweet spot mapping (when relying on binary VTAs) is that 'rim regions' only receive data from a small number of patients and have the tendency to artifactually drive peak intensities (Dembek et al., 2021a). Given that there is currently no solution to this statistical limitation, we chose to mitigate this issue by employing comparatively high n-thresholds. Overall, this finding illustrates, however, that the optimal method to calculate DBS hotspots has not yet been found or converged upon. Furthermore, it is unclear how well the parameter choices in the present sweetspot analysis generalize to other outcome measures, indications, and DBS targets. This holds especially true given that the Sweetspot Explorer features a vast parameter space that has only been explored in the context of the six previously published presets in the present study ("inspired by" parameter suggestions), not probing the entire parameter space of the tool. Indeed, a proper study exploring exactly why different methods yield different results and which one of them is superior should be undertaken -optimally across multiple datasets, targets, and diseases -in the future. While in prior work, research labs implemented their own code and concepts to map hotspots for research studies, the open-source framework of the Sweetspot Explorer facilitates studies that compare different approaches and could ultimately lead to a gold standard and consensus on how DBS hotspots should be mapped to maximize their validity and reliability.</p>
        <p>Structural connectivity analysis was performed using a data-driven approach, which identified the best performing models across three methodologically distinct analysis streams. Investigation of distributions associated with each methodological choice revealed trends with respect to improved model performance when omitting streamlines based on significance and number of stimulation volumes encompassing a streamline. Furthermore, Fisher Z and van Albada transformation yielded less consistent models as compared to no normalization. The reason for this could be that both concepts add a transformation of the results that is different in each cross-validation step. For instance, when the first of the ten folds of patients was left out, the fiber model was created on the remaining nine and the results were z-scored / Gaussianized. In the second fold, the same happened, but this transform was potentially different, adding noise to the final estimates across folds. It is noteworthy that streamlines associated with clinical improvements based on pathway activation models bore similarity to the ones calculated based on simplified models, albeit yielding the overall highest predictive ability (Figure 4). This finding is in alignment with recent work by Gunalan et al. who identified field cable models to be most accurate for estimating axonal pathway activation as compared to driving force and VTA-based approaches (Gunalan et al., 2018). This finding has relevant implications for future studies seeking to model structural connectivity, since axon activation models come with computational cost and technical demands. Here -depending on the underlying research question -less computationally demanding approaches may serve as an acceptable middle ground to derive estimates of structural connectivity. This could prove especially relevant in clinical settings where access to high performance computers is typically limited, albeit at the cost of a (potentially substantial) decline in predictive accuracy. In contrast, biophysical modeling of DBS associated structural connectivity may provide a more accurate and comprehensive approach to quantify theoretical responses to stimulation at the cellular level (Duffley et al., 2019).</p>
        <p>The modeling choices for voxel-wise connectivity estimates as implemented in the 
            <rs type="software">Network Mapping Explorer</rs> are constrained to the choice of correlation coefficient, p-threshold, and method to correct for multiple comparison. Validation of models using Leave-One-Patient-Out and 10-fold cross-validation yielded spatially comparable predictors of outcome, with FDR corrected models demonstrating the overall best performance (Figure 6). This finding is not surprising, as the removal of false positive voxels likely yields fewer type I errors, hence increasing statistical power.
        </p>
        <p>The mapping tools introduced here offer an extensive range of methodological choices that can be leveraged for model generation, validation, and prediction. This holds especially true for the Sweetspot and Fiber Filtering Explorer that each offer a larger parameter space that may introduce a risk for bias and confounding. To mitigate this bias for sweetspot mapping, we adopted previously published methodological choices reported by other groups. It is important to note, however, that no unambiguous or conceptual 'ground truth' exists for many of the tunable parameters chosen by these authors. Even if such thresholds existed one could never be certain that the generated models genuinely reflected clinical reality. In consequence, while the methodological choices in the present manuscript may guide future exploration of DBS data, they do not constitute mandatory parameters to be followed rigorously. Since Lead-DBS is a scientific tool, we chose to provide users with the opportunity to instantiate their models in the most sensible fashion to address their scientific questions in use-case scenarios without making a-priori decisions on exactly how data should be analyzed. This opens the possibility for flexible and transparent research where models reported in the literature could be reliably reproduced and expanded on. Indeed, the ideal modeling strategy may not rely on fixed and arbitrary thresholds owing to their sensitivity to idiosyncrasies in use-case scenarios. As such, one could envision disease-, target-, and symptom-specific models that are first tuned and cross-validated within training cohorts, confirmed in out-of-sample hold-out test datasets and finally confirmed in prospective fashion within clinical studies.</p>
        <p>While the key focus of Lead-DBS is on facilitating DBS imaging research, in many of the tools could be interesting to the broader neuroimaging community. For instance, Lead-DBS unites a multitude of coregistration and normalization algorithms in a single convenient tool (such as FSL's FLIRT/FNIRT, SPM's Segment, DARTEL &amp; 
            <rs type="software">SHOOT</rs> and multiple presets for 
            <rs type="software">BRAINSfit</rs> and ANTs based registrations) as well as 
            <rs type="software">WarpDrive</rs>, which was introduced here. Taken togehter, these tools make Lead-DBS a versatile "normalization toolbox" that could be useful for most registration problems in the field. The sister application lead connectome is a fully fledged structural and functional connectivity pipeline that is integrated with Lead-DBS, but has been used for other purposes (such as general resting-state, tractography and subsequent modeling analyses as carried out here (Deco et al., 2021;Horn et al., 2019c;Kringelbach et al., 2020)). Finally, the new tools, namely Sweetspot, Fiber Filtering, and Network Mapping Explorer could be modified to map brain lesions associated with specific symptoms, corresponding to a form of voxel-based lesion mapping, disconnectome analysis and functional lesion network mapping analysis. While the 
            <rs type="software">Lead Mapper</rs> tool has already been used for functional lesion network mapping on multiple occasions (Darby et al., 2017;Ganos et al., 2022;Joutsa et al., 2018a), first reports have applied it for structural lesion network mapping, as well (Bowren et al., 2022;Trapp et al., 2022).
        </p>
        <p>This present version of Lead-DBS constitutes a major update of the Lead-DBS pipeline, however, despite ongoing development, several limitations persist, which will be described and discussed as follows: i) Accuracy. In DBS research 'millimeters matter' (Horn et al., 2019a) and considerable effort has been invested in the Lead-DBS pipeline to reduce errors associated with image registration, normalization, and lead localization (Dembek et al., 2021b) (Horn et al., 2019a) (Husch et al., 2018). Despite sophisticated tools, however, residual errors may remain, especially in patients featuring changes in brain morphology. Manual refinement tools, such as 
            <rs type="software">WarpDrive</rs>, may also introduce observer bias and hold the potential of reducing replicability and reproducibility across users and groups. This is further emphasized by the fact that manual refinement of deformation fields requires expert-level understanding of both local anatomy and neuroimaging acquisition/processing. Moving towards potential clinical applications of registration and normalization pipelines (Oxenford et al., 2021) the consideration of residual errors and the quantification thereof remain crucial factors to be addressed.
        </p>
        <p>ii) Stimulation volume modeling. Modeling of DBS E-field distributions is based on multiple assumptions and thresholds, many of which have been defined empirically and remain poorly validated. The findings of the present study indicate that E-field based models perform equally as well as VTA-based models during sweetspot mapping and functional connectivity analysis, while explaining more variance during structural connectivity analysis. Hence, E-field based approaches could be considered a viable alternative to VTA-based approaches. With the introduction of OSS-DBS, sophisticated tools for pathway activation modeling have become openly available that are able to account for some of these limitations, albeit at the cost of computational complexity and cost, as well as necessity of additional prior assumptions. In a research setting, computational cost may have less relevance; in clinical practice, however, there is a need to strike a balance between model tractability and accuracy calling for optimized solutions for stimulation volume modeling in the future.</p>
        <p>iii) Statistical methods. Lead-DBS v3.
            <rs type="version">0</rs> introduces three distinct mapping tools, each endowed with a large parameter space. Probing this space currently constitutes a challenge given the need for empirical data, prior assumptions, parameter choices, and thresholds, many of which are poorly validated. In addition, it is currently unclear how well the methodological choices of the 
            <rs type="software">Explorer</rs> tools generalize to other targets, diseases, and outcome parameters. Hence, it is important to emphasize that Lead-DBS aims to provide useful tools for data analysis without making a-priori decisions on exactly how data should be analyzed. Stated bluntly, Lead-DBS should be considered a tool that enables users to carry out scientific analyses, not a tool that carries out these analyses for them. Further research is necessary to evaluate the performance, robustness, and generalizability of demonstrated statistical methods. iv) Normative connectomes. While the employment of normative connectomes was able to validate clinical outcome in out-of-sample data (Al-Fatly et al., 2019;Germann et al., 2021;Horn et al., 2017cHorn et al., , 2022;;Johnson et al., 2020;Li et al., 2020) it is important to note that these datasets lack patient-and pathology-specificity. In contrast to native imaging, however, connectomes offer superior data quality owing to acquisition on specialized hardware, optimized acquisition parameters, and specialized image-processing pipelines (Glasser et al., 2016(Glasser et al., , 2013;;Yeo et al., 2011).
        </p>
        <p>While Lead-DBS v3.0 has been greatly improved ever since the release of v2
            <rs type="version">.0</rs>, further development is planned to address current limitations. During volume registration a major focus will be the optimization and acceleration of registration and normalization routines by means of parallel computing and implementation of neural networks. Recognizing the need for patient-specific analysis, we have further started the implementation of tools to accurately parcellate deep brain structures and reconstruct surfaces in native space using 
            <rs type="software">Freesurfer</rs> (
            <rs type="url">http://surfer.nmr.mgh.harvard.edu/)</rs>. Another major focus will be the refinement and expansion of statistical methods available in the introduced 
            <rs type="software">Explorer</rs> tools. Specifically, we are currently investigating the vast parameter space contained within Sweetspot, Fiber Filtering, and Network Mapping Explorer to identify methodological choices driving model performance. Understanding of these relationships may aide in the optimization of existing tools by e.g., discarding parameter choices that do not contribute to changes in model performance, or refining parameters driving predictions. Finally, novel tools are planned to identify symptomspecific treatment targets with the goal to optimize and tailor stimulation to an individual patient's symptom profile and subjective priorities (Hollunder et al., 2021). As the landscape of neuroimaging and functional neurosurgery continues to evolve and change, further adaptations of the existing pipeline will be required. For example, Lead-DBS currently does not support reconstruction of surface electrodes and electrocorticography (ECoG) arrays. The increased employment of cortical recordings in the field of DBS will, however, requires the implementation of such tools in the future (Gilron et al., 2021;Merk et al., 2021). Future updates will have to address these limitations.
        </p>
        <p>In conclusion, we present a thoroughly revised and updated version of the Lead-DBS platform extending its functionality beyond image registration and lead localization to mapping and validation DBS effects to local and network predictors of clinical outcome. Open-source code, version-controlled development, and adherence to widely adopted data standards allow excellent reproducibility necessary to fulfill commonly applied key criteria of good scientific practice. Such transparent research practices constitute crucial steps in validating models prior to translation into clinical practice. (Amunts et al., 2013;Edlow et al., 2019) featured on coronal (A-B) and sagittal sections (C-D) were transformed into MNI space using a state-of-the art nonlinear registration pipeline (
            <rs type="software">ANTs SyN</rs>) (left column) and manually refined using 
            <rs type="software">WarpDrive</rs> (right column). Red outlines feature atlas structures in MNI space (Ewert et al., 2018b;Neudorfer et al., 2020). Note the mismatch between outlines and underlying anatomical structures during automated registration that can be accounted for by means of manual A data-driven approach was employed to derive distributions of model performance using the correlation coefficient derived from 10-fold cross-validation as target. For each analysis stream, the parameter space was probed by iteratively changing the presets contained within the Fiber Filtering 
            <rs type="software">Explorer</rs>; for each analysis stream the distribution of R-values is featured fixing the variables underlying a specific tuning parameter. For each analysis stream (volume of tissue activated vs. E-Field vs pathway activation model) the top performing model was selected and visualized. Note the overall agreement of identified discriminative streamlines despite methodologically different approaches and presets. Correlation plots feature the model performance based on Leave-One-Patient-Out and 10-fold cross-validation. A detailed description of the settings used for model setup, visualization, thresholding, and prediction can be obtained from Supplementary Table 3. With the introduction of the BIDS standard into Lead-DBS, the conventional folder structure (left column) underwent radical reorganization yielding a modularized layout that features separate folders for each processing step within the Lead
            <rs type="software">-DBS</rs> pipeline. In addition, the naming convention for imaging data, tabular data, and metadata was revised. A translation of the original naming convention to the BIDS specification is provided in the figure. For an itemized overview please refer to Supplementary Table 7. The atlas features a (normative) hypointensity marker derived from FGATIR sequences in n=46 subjects that coincides with the optimal DBS target for essential tremor. The probabilistic hot-and coldspots used for validation are provided as well. Dystonia Subcortical pathway atlas featuring streamlines associated with (Horn et al., response tract atlas optimal treatment response in a total of n=80 patients with generalized and cervical dystonia.
        </p>
        <p>Lesion network map derived from n=11 patients with ischemic stroke lesions, who experienced relief of pre-existing essential tremor following stroke. (Joutsa et al., 2018b)</p>
        <p>The authors would like to thank all the collaborators and contributors to Lead-DBS. A.H. was supported by the German Research Foundation (Deutsche Forschungsgemeinschaft, 424778381 -TRR 295), Deutsches Zentrum für Luft-und Raumfahrt (DynaSti grant within the EU Joint Programme Neurodegenerative Disease Research, JPND), the National Institutes of Health (2R01 MH113929) as well as the New Venture Fund (FFOR Seed Grant). B.H. received support via a scholarship issued by the Einstein Center for Neurosciences Berlin. K.B. was funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) -SFB 1270/1 -299150580 and TRR 295 -424778381. K.B.F. was supported by an Australian Government Research Training Program Scholarship. L.L.G. was supported by the BIH Charité Junior Clinician Scientist Program funded by the Charité -Universitätsmedizin Berlin, and the Berlin Institute of Health at Charité (BIH). MDF was supported by the NIH (R01MH113929, R21MH126271, R56AG069086, R21NS123813) the Ellison / Baszucki Foundation, and the Kaye Family Research Fund). T.A.D. is supported by the Cologne Clinician Scientist Program (CCSP), Faculty of Medicine, University of Cologne and the German Research Foundation (DFG, FI 773/15-1). He also received travel grants and speaker honoraria by Boston Scientific. T.A.K.N. was supported by the Swiss National Science Foundation (186142).</p>
        <p>All 
            <rs type="software">code</rs> used to analyze data presented in the present manuscript is openly available within the 
            <rs type="software">Lead-DBS</rs> software suite (
            <rs type="url">https://github.com/netstim/leaddbs</rs>; 
            <rs type="url">https://www.lead-dbs.org/)</rs>. A detailed description of the settings used for model setup, visualization, thresholding, and prediction for Sweetspot, Fiber Filtering, and 
            <rs type="software">Network Mapping Explorer</rs> is available in the Supplementary Material of the present manuscript. Raw data (patient MRI and postoperative CTs) cannot be openly shared because they contain identifiable patient information.
        </p>
    </text>
</tei>
